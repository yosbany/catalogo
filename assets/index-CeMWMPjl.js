function NC(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const i in n)if(i!=="default"&&!(i in e)){const s=Object.getOwnPropertyDescriptor(n,i);s&&Object.defineProperty(e,i,s.get?s:{enumerable:!0,get:()=>n[i]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function r(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=r(i);fetch(i.href,s)}})();function RC(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var wy={exports:{}},u0={},Ey={exports:{}},Be={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Sc=Symbol.for("react.element"),PC=Symbol.for("react.portal"),OC=Symbol.for("react.fragment"),DC=Symbol.for("react.strict_mode"),bC=Symbol.for("react.profiler"),LC=Symbol.for("react.provider"),MC=Symbol.for("react.context"),BC=Symbol.for("react.forward_ref"),UC=Symbol.for("react.suspense"),WC=Symbol.for("react.memo"),VC=Symbol.for("react.lazy"),Ig=Symbol.iterator;function jC(e){return e===null||typeof e!="object"?null:(e=Ig&&e[Ig]||e["@@iterator"],typeof e=="function"?e:null)}var ky={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Ty=Object.assign,Sy={};function Co(e,t,r){this.props=e,this.context=t,this.refs=Sy,this.updater=r||ky}Co.prototype.isReactComponent={};Co.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Co.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function Cy(){}Cy.prototype=Co.prototype;function Wp(e,t,r){this.props=e,this.context=t,this.refs=Sy,this.updater=r||ky}var Vp=Wp.prototype=new Cy;Vp.constructor=Wp;Ty(Vp,Co.prototype);Vp.isPureReactComponent=!0;var Ag=Array.isArray,Iy=Object.prototype.hasOwnProperty,jp={current:null},Ay={key:!0,ref:!0,__self:!0,__source:!0};function Fy(e,t,r){var n,i={},s=null,a=null;if(t!=null)for(n in t.ref!==void 0&&(a=t.ref),t.key!==void 0&&(s=""+t.key),t)Iy.call(t,n)&&!Ay.hasOwnProperty(n)&&(i[n]=t[n]);var o=arguments.length-2;if(o===1)i.children=r;else if(1<o){for(var l=Array(o),c=0;c<o;c++)l[c]=arguments[c+2];i.children=l}if(e&&e.defaultProps)for(n in o=e.defaultProps,o)i[n]===void 0&&(i[n]=o[n]);return{$$typeof:Sc,type:e,key:s,ref:a,props:i,_owner:jp.current}}function HC(e,t){return{$$typeof:Sc,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Hp(e){return typeof e=="object"&&e!==null&&e.$$typeof===Sc}function zC(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var Fg=/\/+/g;function ih(e,t){return typeof e=="object"&&e!==null&&e.key!=null?zC(""+e.key):t.toString(36)}function Pu(e,t,r,n,i){var s=typeof e;(s==="undefined"||s==="boolean")&&(e=null);var a=!1;if(e===null)a=!0;else switch(s){case"string":case"number":a=!0;break;case"object":switch(e.$$typeof){case Sc:case PC:a=!0}}if(a)return a=e,i=i(a),e=n===""?"."+ih(a,0):n,Ag(i)?(r="",e!=null&&(r=e.replace(Fg,"$&/")+"/"),Pu(i,t,r,"",function(c){return c})):i!=null&&(Hp(i)&&(i=HC(i,r+(!i.key||a&&a.key===i.key?"":(""+i.key).replace(Fg,"$&/")+"/")+e)),t.push(i)),1;if(a=0,n=n===""?".":n+":",Ag(e))for(var o=0;o<e.length;o++){s=e[o];var l=n+ih(s,o);a+=Pu(s,t,r,l,i)}else if(l=jC(e),typeof l=="function")for(e=l.call(e),o=0;!(s=e.next()).done;)s=s.value,l=n+ih(s,o++),a+=Pu(s,t,r,l,i);else if(s==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return a}function Qc(e,t,r){if(e==null)return e;var n=[],i=0;return Pu(e,n,"","",function(s){return t.call(r,s,i++)}),n}function $C(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var kr={current:null},Ou={transition:null},GC={ReactCurrentDispatcher:kr,ReactCurrentBatchConfig:Ou,ReactCurrentOwner:jp};function Ny(){throw Error("act(...) is not supported in production builds of React.")}Be.Children={map:Qc,forEach:function(e,t,r){Qc(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return Qc(e,function(){t++}),t},toArray:function(e){return Qc(e,function(t){return t})||[]},only:function(e){if(!Hp(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Be.Component=Co;Be.Fragment=OC;Be.Profiler=bC;Be.PureComponent=Wp;Be.StrictMode=DC;Be.Suspense=UC;Be.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=GC;Be.act=Ny;Be.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=Ty({},e.props),i=e.key,s=e.ref,a=e._owner;if(t!=null){if(t.ref!==void 0&&(s=t.ref,a=jp.current),t.key!==void 0&&(i=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(l in t)Iy.call(t,l)&&!Ay.hasOwnProperty(l)&&(n[l]=t[l]===void 0&&o!==void 0?o[l]:t[l])}var l=arguments.length-2;if(l===1)n.children=r;else if(1<l){o=Array(l);for(var c=0;c<l;c++)o[c]=arguments[c+2];n.children=o}return{$$typeof:Sc,type:e.type,key:i,ref:s,props:n,_owner:a}};Be.createContext=function(e){return e={$$typeof:MC,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:LC,_context:e},e.Consumer=e};Be.createElement=Fy;Be.createFactory=function(e){var t=Fy.bind(null,e);return t.type=e,t};Be.createRef=function(){return{current:null}};Be.forwardRef=function(e){return{$$typeof:BC,render:e}};Be.isValidElement=Hp;Be.lazy=function(e){return{$$typeof:VC,_payload:{_status:-1,_result:e},_init:$C}};Be.memo=function(e,t){return{$$typeof:WC,type:e,compare:t===void 0?null:t}};Be.startTransition=function(e){var t=Ou.transition;Ou.transition={};try{e()}finally{Ou.transition=t}};Be.unstable_act=Ny;Be.useCallback=function(e,t){return kr.current.useCallback(e,t)};Be.useContext=function(e){return kr.current.useContext(e)};Be.useDebugValue=function(){};Be.useDeferredValue=function(e){return kr.current.useDeferredValue(e)};Be.useEffect=function(e,t){return kr.current.useEffect(e,t)};Be.useId=function(){return kr.current.useId()};Be.useImperativeHandle=function(e,t,r){return kr.current.useImperativeHandle(e,t,r)};Be.useInsertionEffect=function(e,t){return kr.current.useInsertionEffect(e,t)};Be.useLayoutEffect=function(e,t){return kr.current.useLayoutEffect(e,t)};Be.useMemo=function(e,t){return kr.current.useMemo(e,t)};Be.useReducer=function(e,t,r){return kr.current.useReducer(e,t,r)};Be.useRef=function(e){return kr.current.useRef(e)};Be.useState=function(e){return kr.current.useState(e)};Be.useSyncExternalStore=function(e,t,r){return kr.current.useSyncExternalStore(e,t,r)};Be.useTransition=function(){return kr.current.useTransition()};Be.version="18.3.1";Ey.exports=Be;var Q=Ey.exports;const Ry=RC(Q),KC=NC({__proto__:null,default:Ry},[Q]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var XC=Q,YC=Symbol.for("react.element"),qC=Symbol.for("react.fragment"),QC=Object.prototype.hasOwnProperty,JC=XC.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,ZC={key:!0,ref:!0,__self:!0,__source:!0};function Py(e,t,r){var n,i={},s=null,a=null;r!==void 0&&(s=""+r),t.key!==void 0&&(s=""+t.key),t.ref!==void 0&&(a=t.ref);for(n in t)QC.call(t,n)&&!ZC.hasOwnProperty(n)&&(i[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)i[n]===void 0&&(i[n]=t[n]);return{$$typeof:YC,type:e,key:s,ref:a,props:i,_owner:JC.current}}u0.Fragment=qC;u0.jsx=Py;u0.jsxs=Py;wy.exports=u0;var L=wy.exports,Oy={exports:{}},Gr={},Dy={exports:{}},by={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(ee,M){var se=ee.length;ee.push(M);e:for(;0<se;){var xe=se-1>>>1,A=ee[xe];if(0<i(A,M))ee[xe]=M,ee[se]=A,se=xe;else break e}}function r(ee){return ee.length===0?null:ee[0]}function n(ee){if(ee.length===0)return null;var M=ee[0],se=ee.pop();if(se!==M){ee[0]=se;e:for(var xe=0,A=ee.length,B=A>>>1;xe<B;){var D=2*(xe+1)-1,b=ee[D],K=D+1,ie=ee[K];if(0>i(b,se))K<A&&0>i(ie,b)?(ee[xe]=ie,ee[K]=se,xe=K):(ee[xe]=b,ee[D]=se,xe=D);else if(K<A&&0>i(ie,se))ee[xe]=ie,ee[K]=se,xe=K;else break e}}return M}function i(ee,M){var se=ee.sortIndex-M.sortIndex;return se!==0?se:ee.id-M.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var a=Date,o=a.now();e.unstable_now=function(){return a.now()-o}}var l=[],c=[],u=1,f=null,h=3,d=!1,m=!1,p=!1,g=typeof setTimeout=="function"?setTimeout:null,x=typeof clearTimeout=="function"?clearTimeout:null,_=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function v(ee){for(var M=r(c);M!==null;){if(M.callback===null)n(c);else if(M.startTime<=ee)n(c),M.sortIndex=M.expirationTime,t(l,M);else break;M=r(c)}}function E(ee){if(p=!1,v(ee),!m)if(r(l)!==null)m=!0,ve(N);else{var M=r(c);M!==null&&de(E,M.startTime-ee)}}function N(ee,M){m=!1,p&&(p=!1,x(O),O=-1),d=!0;var se=h;try{for(v(M),f=r(l);f!==null&&(!(f.expirationTime>M)||ee&&!j());){var xe=f.callback;if(typeof xe=="function"){f.callback=null,h=f.priorityLevel;var A=xe(f.expirationTime<=M);M=e.unstable_now(),typeof A=="function"?f.callback=A:f===r(l)&&n(l),v(M)}else n(l);f=r(l)}if(f!==null)var B=!0;else{var D=r(c);D!==null&&de(E,D.startTime-M),B=!1}return B}finally{f=null,h=se,d=!1}}var I=!1,w=null,O=-1,P=5,W=-1;function j(){return!(e.unstable_now()-W<P)}function U(){if(w!==null){var ee=e.unstable_now();W=ee;var M=!0;try{M=w(!0,ee)}finally{M?J():(I=!1,w=null)}}else I=!1}var J;if(typeof _=="function")J=function(){_(U)};else if(typeof MessageChannel<"u"){var ge=new MessageChannel,fe=ge.port2;ge.port1.onmessage=U,J=function(){fe.postMessage(null)}}else J=function(){g(U,0)};function ve(ee){w=ee,I||(I=!0,J())}function de(ee,M){O=g(function(){ee(e.unstable_now())},M)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(ee){ee.callback=null},e.unstable_continueExecution=function(){m||d||(m=!0,ve(N))},e.unstable_forceFrameRate=function(ee){0>ee||125<ee?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):P=0<ee?Math.floor(1e3/ee):5},e.unstable_getCurrentPriorityLevel=function(){return h},e.unstable_getFirstCallbackNode=function(){return r(l)},e.unstable_next=function(ee){switch(h){case 1:case 2:case 3:var M=3;break;default:M=h}var se=h;h=M;try{return ee()}finally{h=se}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(ee,M){switch(ee){case 1:case 2:case 3:case 4:case 5:break;default:ee=3}var se=h;h=ee;try{return M()}finally{h=se}},e.unstable_scheduleCallback=function(ee,M,se){var xe=e.unstable_now();switch(typeof se=="object"&&se!==null?(se=se.delay,se=typeof se=="number"&&0<se?xe+se:xe):se=xe,ee){case 1:var A=-1;break;case 2:A=250;break;case 5:A=1073741823;break;case 4:A=1e4;break;default:A=5e3}return A=se+A,ee={id:u++,callback:M,priorityLevel:ee,startTime:se,expirationTime:A,sortIndex:-1},se>xe?(ee.sortIndex=se,t(c,ee),r(l)===null&&ee===r(c)&&(p?(x(O),O=-1):p=!0,de(E,se-xe))):(ee.sortIndex=A,t(l,ee),m||d||(m=!0,ve(N))),ee},e.unstable_shouldYield=j,e.unstable_wrapCallback=function(ee){var M=h;return function(){var se=h;h=M;try{return ee.apply(this,arguments)}finally{h=se}}}})(by);Dy.exports=by;var eI=Dy.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var tI=Q,zr=eI;function re(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Ly=new Set,Ll={};function ua(e,t){lo(e,t),lo(e+"Capture",t)}function lo(e,t){for(Ll[e]=t,e=0;e<t.length;e++)Ly.add(t[e])}var gi=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),od=Object.prototype.hasOwnProperty,rI=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Ng={},Rg={};function nI(e){return od.call(Rg,e)?!0:od.call(Ng,e)?!1:rI.test(e)?Rg[e]=!0:(Ng[e]=!0,!1)}function iI(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function sI(e,t,r,n){if(t===null||typeof t>"u"||iI(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Tr(e,t,r,n,i,s,a){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=i,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=a}var Zt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Zt[e]=new Tr(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Zt[t]=new Tr(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Zt[e]=new Tr(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Zt[e]=new Tr(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Zt[e]=new Tr(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Zt[e]=new Tr(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Zt[e]=new Tr(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Zt[e]=new Tr(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Zt[e]=new Tr(e,5,!1,e.toLowerCase(),null,!1,!1)});var zp=/[\-:]([a-z])/g;function $p(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(zp,$p);Zt[t]=new Tr(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(zp,$p);Zt[t]=new Tr(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(zp,$p);Zt[t]=new Tr(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Zt[e]=new Tr(e,1,!1,e.toLowerCase(),null,!1,!1)});Zt.xlinkHref=new Tr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Zt[e]=new Tr(e,1,!1,e.toLowerCase(),null,!0,!0)});function Gp(e,t,r,n){var i=Zt.hasOwnProperty(t)?Zt[t]:null;(i!==null?i.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(sI(t,r,i,n)&&(r=null),n||i===null?nI(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):i.mustUseProperty?e[i.propertyName]=r===null?i.type===3?!1:"":r:(t=i.attributeName,n=i.attributeNamespace,r===null?e.removeAttribute(t):(i=i.type,r=i===3||i===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var Si=tI.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Jc=Symbol.for("react.element"),Ra=Symbol.for("react.portal"),Pa=Symbol.for("react.fragment"),Kp=Symbol.for("react.strict_mode"),ld=Symbol.for("react.profiler"),My=Symbol.for("react.provider"),By=Symbol.for("react.context"),Xp=Symbol.for("react.forward_ref"),cd=Symbol.for("react.suspense"),ud=Symbol.for("react.suspense_list"),Yp=Symbol.for("react.memo"),bi=Symbol.for("react.lazy"),Uy=Symbol.for("react.offscreen"),Pg=Symbol.iterator;function $o(e){return e===null||typeof e!="object"?null:(e=Pg&&e[Pg]||e["@@iterator"],typeof e=="function"?e:null)}var mt=Object.assign,sh;function il(e){if(sh===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);sh=t&&t[1]||""}return`
`+sh+e}var ah=!1;function oh(e,t){if(!e||ah)return"";ah=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var n=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){n=c}e.call(t.prototype)}else{try{throw Error()}catch(c){n=c}e()}}catch(c){if(c&&n&&typeof c.stack=="string"){for(var i=c.stack.split(`
`),s=n.stack.split(`
`),a=i.length-1,o=s.length-1;1<=a&&0<=o&&i[a]!==s[o];)o--;for(;1<=a&&0<=o;a--,o--)if(i[a]!==s[o]){if(a!==1||o!==1)do if(a--,o--,0>o||i[a]!==s[o]){var l=`
`+i[a].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}while(1<=a&&0<=o);break}}}finally{ah=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?il(e):""}function aI(e){switch(e.tag){case 5:return il(e.type);case 16:return il("Lazy");case 13:return il("Suspense");case 19:return il("SuspenseList");case 0:case 2:case 15:return e=oh(e.type,!1),e;case 11:return e=oh(e.type.render,!1),e;case 1:return e=oh(e.type,!0),e;default:return""}}function fd(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Pa:return"Fragment";case Ra:return"Portal";case ld:return"Profiler";case Kp:return"StrictMode";case cd:return"Suspense";case ud:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case By:return(e.displayName||"Context")+".Consumer";case My:return(e._context.displayName||"Context")+".Provider";case Xp:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Yp:return t=e.displayName||null,t!==null?t:fd(e.type)||"Memo";case bi:t=e._payload,e=e._init;try{return fd(e(t))}catch{}}return null}function oI(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return fd(t);case 8:return t===Kp?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function us(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Wy(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function lI(e){var t=Wy(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var i=r.get,s=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(a){n=""+a,s.call(this,a)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(a){n=""+a},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Zc(e){e._valueTracker||(e._valueTracker=lI(e))}function Vy(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=Wy(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function Zu(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function hd(e,t){var r=t.checked;return mt({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function Og(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=us(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function jy(e,t){t=t.checked,t!=null&&Gp(e,"checked",t,!1)}function dd(e,t){jy(e,t);var r=us(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?pd(e,t.type,r):t.hasOwnProperty("defaultValue")&&pd(e,t.type,us(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function Dg(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function pd(e,t,r){(t!=="number"||Zu(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var sl=Array.isArray;function Ga(e,t,r,n){if(e=e.options,t){t={};for(var i=0;i<r.length;i++)t["$"+r[i]]=!0;for(r=0;r<e.length;r++)i=t.hasOwnProperty("$"+e[r].value),e[r].selected!==i&&(e[r].selected=i),i&&n&&(e[r].defaultSelected=!0)}else{for(r=""+us(r),t=null,i=0;i<e.length;i++){if(e[i].value===r){e[i].selected=!0,n&&(e[i].defaultSelected=!0);return}t!==null||e[i].disabled||(t=e[i])}t!==null&&(t.selected=!0)}}function md(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(re(91));return mt({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function bg(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(re(92));if(sl(r)){if(1<r.length)throw Error(re(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:us(r)}}function Hy(e,t){var r=us(t.value),n=us(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function Lg(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function zy(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function gd(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?zy(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var eu,$y=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,i){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,i)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(eu=eu||document.createElement("div"),eu.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=eu.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Ml(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var dl={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},cI=["Webkit","ms","Moz","O"];Object.keys(dl).forEach(function(e){cI.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),dl[t]=dl[e]})});function Gy(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||dl.hasOwnProperty(e)&&dl[e]?(""+t).trim():t+"px"}function Ky(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,i=Gy(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,i):e[r]=i}}var uI=mt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function vd(e,t){if(t){if(uI[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(re(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(re(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(re(61))}if(t.style!=null&&typeof t.style!="object")throw Error(re(62))}}function xd(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var _d=null;function qp(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var yd=null,Ka=null,Xa=null;function Mg(e){if(e=Ac(e)){if(typeof yd!="function")throw Error(re(280));var t=e.stateNode;t&&(t=m0(t),yd(e.stateNode,e.type,t))}}function Xy(e){Ka?Xa?Xa.push(e):Xa=[e]:Ka=e}function Yy(){if(Ka){var e=Ka,t=Xa;if(Xa=Ka=null,Mg(e),t)for(e=0;e<t.length;e++)Mg(t[e])}}function qy(e,t){return e(t)}function Qy(){}var lh=!1;function Jy(e,t,r){if(lh)return e(t,r);lh=!0;try{return qy(e,t,r)}finally{lh=!1,(Ka!==null||Xa!==null)&&(Qy(),Yy())}}function Bl(e,t){var r=e.stateNode;if(r===null)return null;var n=m0(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(re(231,t,typeof r));return r}var wd=!1;if(gi)try{var Go={};Object.defineProperty(Go,"passive",{get:function(){wd=!0}}),window.addEventListener("test",Go,Go),window.removeEventListener("test",Go,Go)}catch{wd=!1}function fI(e,t,r,n,i,s,a,o,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(r,c)}catch(u){this.onError(u)}}var pl=!1,ef=null,tf=!1,Ed=null,hI={onError:function(e){pl=!0,ef=e}};function dI(e,t,r,n,i,s,a,o,l){pl=!1,ef=null,fI.apply(hI,arguments)}function pI(e,t,r,n,i,s,a,o,l){if(dI.apply(this,arguments),pl){if(pl){var c=ef;pl=!1,ef=null}else throw Error(re(198));tf||(tf=!0,Ed=c)}}function fa(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function Zy(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Bg(e){if(fa(e)!==e)throw Error(re(188))}function mI(e){var t=e.alternate;if(!t){if(t=fa(e),t===null)throw Error(re(188));return t!==e?null:e}for(var r=e,n=t;;){var i=r.return;if(i===null)break;var s=i.alternate;if(s===null){if(n=i.return,n!==null){r=n;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===r)return Bg(i),e;if(s===n)return Bg(i),t;s=s.sibling}throw Error(re(188))}if(r.return!==n.return)r=i,n=s;else{for(var a=!1,o=i.child;o;){if(o===r){a=!0,r=i,n=s;break}if(o===n){a=!0,n=i,r=s;break}o=o.sibling}if(!a){for(o=s.child;o;){if(o===r){a=!0,r=s,n=i;break}if(o===n){a=!0,n=s,r=i;break}o=o.sibling}if(!a)throw Error(re(189))}}if(r.alternate!==n)throw Error(re(190))}if(r.tag!==3)throw Error(re(188));return r.stateNode.current===r?e:t}function ew(e){return e=mI(e),e!==null?tw(e):null}function tw(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=tw(e);if(t!==null)return t;e=e.sibling}return null}var rw=zr.unstable_scheduleCallback,Ug=zr.unstable_cancelCallback,gI=zr.unstable_shouldYield,vI=zr.unstable_requestPaint,St=zr.unstable_now,xI=zr.unstable_getCurrentPriorityLevel,Qp=zr.unstable_ImmediatePriority,nw=zr.unstable_UserBlockingPriority,rf=zr.unstable_NormalPriority,_I=zr.unstable_LowPriority,iw=zr.unstable_IdlePriority,f0=null,Vn=null;function yI(e){if(Vn&&typeof Vn.onCommitFiberRoot=="function")try{Vn.onCommitFiberRoot(f0,e,void 0,(e.current.flags&128)===128)}catch{}}var Tn=Math.clz32?Math.clz32:kI,wI=Math.log,EI=Math.LN2;function kI(e){return e>>>=0,e===0?32:31-(wI(e)/EI|0)|0}var tu=64,ru=4194304;function al(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function nf(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,i=e.suspendedLanes,s=e.pingedLanes,a=r&268435455;if(a!==0){var o=a&~i;o!==0?n=al(o):(s&=a,s!==0&&(n=al(s)))}else a=r&~i,a!==0?n=al(a):s!==0&&(n=al(s));if(n===0)return 0;if(t!==0&&t!==n&&!(t&i)&&(i=n&-n,s=t&-t,i>=s||i===16&&(s&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-Tn(t),i=1<<r,n|=e[r],t&=~i;return n}function TI(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function SI(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,i=e.expirationTimes,s=e.pendingLanes;0<s;){var a=31-Tn(s),o=1<<a,l=i[a];l===-1?(!(o&r)||o&n)&&(i[a]=TI(o,t)):l<=t&&(e.expiredLanes|=o),s&=~o}}function kd(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function sw(){var e=tu;return tu<<=1,!(tu&4194240)&&(tu=64),e}function ch(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function Cc(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Tn(t),e[t]=r}function CI(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var i=31-Tn(r),s=1<<i;t[i]=0,n[i]=-1,e[i]=-1,r&=~s}}function Jp(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-Tn(r),i=1<<n;i&t|e[n]&t&&(e[n]|=t),r&=~i}}var Xe=0;function aw(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var ow,Zp,lw,cw,uw,Td=!1,nu=[],Ji=null,Zi=null,es=null,Ul=new Map,Wl=new Map,Mi=[],II="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Wg(e,t){switch(e){case"focusin":case"focusout":Ji=null;break;case"dragenter":case"dragleave":Zi=null;break;case"mouseover":case"mouseout":es=null;break;case"pointerover":case"pointerout":Ul.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Wl.delete(t.pointerId)}}function Ko(e,t,r,n,i,s){return e===null||e.nativeEvent!==s?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:s,targetContainers:[i]},t!==null&&(t=Ac(t),t!==null&&Zp(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,i!==null&&t.indexOf(i)===-1&&t.push(i),e)}function AI(e,t,r,n,i){switch(t){case"focusin":return Ji=Ko(Ji,e,t,r,n,i),!0;case"dragenter":return Zi=Ko(Zi,e,t,r,n,i),!0;case"mouseover":return es=Ko(es,e,t,r,n,i),!0;case"pointerover":var s=i.pointerId;return Ul.set(s,Ko(Ul.get(s)||null,e,t,r,n,i)),!0;case"gotpointercapture":return s=i.pointerId,Wl.set(s,Ko(Wl.get(s)||null,e,t,r,n,i)),!0}return!1}function fw(e){var t=bs(e.target);if(t!==null){var r=fa(t);if(r!==null){if(t=r.tag,t===13){if(t=Zy(r),t!==null){e.blockedOn=t,uw(e.priority,function(){lw(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Du(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=Sd(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);_d=n,r.target.dispatchEvent(n),_d=null}else return t=Ac(r),t!==null&&Zp(t),e.blockedOn=r,!1;t.shift()}return!0}function Vg(e,t,r){Du(e)&&r.delete(t)}function FI(){Td=!1,Ji!==null&&Du(Ji)&&(Ji=null),Zi!==null&&Du(Zi)&&(Zi=null),es!==null&&Du(es)&&(es=null),Ul.forEach(Vg),Wl.forEach(Vg)}function Xo(e,t){e.blockedOn===t&&(e.blockedOn=null,Td||(Td=!0,zr.unstable_scheduleCallback(zr.unstable_NormalPriority,FI)))}function Vl(e){function t(i){return Xo(i,e)}if(0<nu.length){Xo(nu[0],e);for(var r=1;r<nu.length;r++){var n=nu[r];n.blockedOn===e&&(n.blockedOn=null)}}for(Ji!==null&&Xo(Ji,e),Zi!==null&&Xo(Zi,e),es!==null&&Xo(es,e),Ul.forEach(t),Wl.forEach(t),r=0;r<Mi.length;r++)n=Mi[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<Mi.length&&(r=Mi[0],r.blockedOn===null);)fw(r),r.blockedOn===null&&Mi.shift()}var Ya=Si.ReactCurrentBatchConfig,sf=!0;function NI(e,t,r,n){var i=Xe,s=Ya.transition;Ya.transition=null;try{Xe=1,em(e,t,r,n)}finally{Xe=i,Ya.transition=s}}function RI(e,t,r,n){var i=Xe,s=Ya.transition;Ya.transition=null;try{Xe=4,em(e,t,r,n)}finally{Xe=i,Ya.transition=s}}function em(e,t,r,n){if(sf){var i=Sd(e,t,r,n);if(i===null)_h(e,t,n,af,r),Wg(e,n);else if(AI(i,e,t,r,n))n.stopPropagation();else if(Wg(e,n),t&4&&-1<II.indexOf(e)){for(;i!==null;){var s=Ac(i);if(s!==null&&ow(s),s=Sd(e,t,r,n),s===null&&_h(e,t,n,af,r),s===i)break;i=s}i!==null&&n.stopPropagation()}else _h(e,t,n,null,r)}}var af=null;function Sd(e,t,r,n){if(af=null,e=qp(n),e=bs(e),e!==null)if(t=fa(e),t===null)e=null;else if(r=t.tag,r===13){if(e=Zy(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return af=e,null}function hw(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(xI()){case Qp:return 1;case nw:return 4;case rf:case _I:return 16;case iw:return 536870912;default:return 16}default:return 16}}var $i=null,tm=null,bu=null;function dw(){if(bu)return bu;var e,t=tm,r=t.length,n,i="value"in $i?$i.value:$i.textContent,s=i.length;for(e=0;e<r&&t[e]===i[e];e++);var a=r-e;for(n=1;n<=a&&t[r-n]===i[s-n];n++);return bu=i.slice(e,1<n?1-n:void 0)}function Lu(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function iu(){return!0}function jg(){return!1}function Kr(e){function t(r,n,i,s,a){this._reactName=r,this._targetInst=i,this.type=n,this.nativeEvent=s,this.target=a,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(r=e[o],this[o]=r?r(s):s[o]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?iu:jg,this.isPropagationStopped=jg,this}return mt(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=iu)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=iu)},persist:function(){},isPersistent:iu}),t}var Io={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},rm=Kr(Io),Ic=mt({},Io,{view:0,detail:0}),PI=Kr(Ic),uh,fh,Yo,h0=mt({},Ic,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:nm,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Yo&&(Yo&&e.type==="mousemove"?(uh=e.screenX-Yo.screenX,fh=e.screenY-Yo.screenY):fh=uh=0,Yo=e),uh)},movementY:function(e){return"movementY"in e?e.movementY:fh}}),Hg=Kr(h0),OI=mt({},h0,{dataTransfer:0}),DI=Kr(OI),bI=mt({},Ic,{relatedTarget:0}),hh=Kr(bI),LI=mt({},Io,{animationName:0,elapsedTime:0,pseudoElement:0}),MI=Kr(LI),BI=mt({},Io,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),UI=Kr(BI),WI=mt({},Io,{data:0}),zg=Kr(WI),VI={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},jI={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},HI={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function zI(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=HI[e])?!!t[e]:!1}function nm(){return zI}var $I=mt({},Ic,{key:function(e){if(e.key){var t=VI[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Lu(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?jI[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:nm,charCode:function(e){return e.type==="keypress"?Lu(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Lu(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),GI=Kr($I),KI=mt({},h0,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),$g=Kr(KI),XI=mt({},Ic,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:nm}),YI=Kr(XI),qI=mt({},Io,{propertyName:0,elapsedTime:0,pseudoElement:0}),QI=Kr(qI),JI=mt({},h0,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),ZI=Kr(JI),e4=[9,13,27,32],im=gi&&"CompositionEvent"in window,ml=null;gi&&"documentMode"in document&&(ml=document.documentMode);var t4=gi&&"TextEvent"in window&&!ml,pw=gi&&(!im||ml&&8<ml&&11>=ml),Gg=" ",Kg=!1;function mw(e,t){switch(e){case"keyup":return e4.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function gw(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Oa=!1;function r4(e,t){switch(e){case"compositionend":return gw(t);case"keypress":return t.which!==32?null:(Kg=!0,Gg);case"textInput":return e=t.data,e===Gg&&Kg?null:e;default:return null}}function n4(e,t){if(Oa)return e==="compositionend"||!im&&mw(e,t)?(e=dw(),bu=tm=$i=null,Oa=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return pw&&t.locale!=="ko"?null:t.data;default:return null}}var i4={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Xg(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!i4[e.type]:t==="textarea"}function vw(e,t,r,n){Xy(n),t=of(t,"onChange"),0<t.length&&(r=new rm("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var gl=null,jl=null;function s4(e){Aw(e,0)}function d0(e){var t=La(e);if(Vy(t))return e}function a4(e,t){if(e==="change")return t}var xw=!1;if(gi){var dh;if(gi){var ph="oninput"in document;if(!ph){var Yg=document.createElement("div");Yg.setAttribute("oninput","return;"),ph=typeof Yg.oninput=="function"}dh=ph}else dh=!1;xw=dh&&(!document.documentMode||9<document.documentMode)}function qg(){gl&&(gl.detachEvent("onpropertychange",_w),jl=gl=null)}function _w(e){if(e.propertyName==="value"&&d0(jl)){var t=[];vw(t,jl,e,qp(e)),Jy(s4,t)}}function o4(e,t,r){e==="focusin"?(qg(),gl=t,jl=r,gl.attachEvent("onpropertychange",_w)):e==="focusout"&&qg()}function l4(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return d0(jl)}function c4(e,t){if(e==="click")return d0(t)}function u4(e,t){if(e==="input"||e==="change")return d0(t)}function f4(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Fn=typeof Object.is=="function"?Object.is:f4;function Hl(e,t){if(Fn(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var i=r[n];if(!od.call(t,i)||!Fn(e[i],t[i]))return!1}return!0}function Qg(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Jg(e,t){var r=Qg(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=Qg(r)}}function yw(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?yw(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function ww(){for(var e=window,t=Zu();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=Zu(e.document)}return t}function sm(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function h4(e){var t=ww(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&yw(r.ownerDocument.documentElement,r)){if(n!==null&&sm(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var i=r.textContent.length,s=Math.min(n.start,i);n=n.end===void 0?s:Math.min(n.end,i),!e.extend&&s>n&&(i=n,n=s,s=i),i=Jg(r,s);var a=Jg(r,n);i&&a&&(e.rangeCount!==1||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==a.node||e.focusOffset!==a.offset)&&(t=t.createRange(),t.setStart(i.node,i.offset),e.removeAllRanges(),s>n?(e.addRange(t),e.extend(a.node,a.offset)):(t.setEnd(a.node,a.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var d4=gi&&"documentMode"in document&&11>=document.documentMode,Da=null,Cd=null,vl=null,Id=!1;function Zg(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Id||Da==null||Da!==Zu(n)||(n=Da,"selectionStart"in n&&sm(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),vl&&Hl(vl,n)||(vl=n,n=of(Cd,"onSelect"),0<n.length&&(t=new rm("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=Da)))}function su(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var ba={animationend:su("Animation","AnimationEnd"),animationiteration:su("Animation","AnimationIteration"),animationstart:su("Animation","AnimationStart"),transitionend:su("Transition","TransitionEnd")},mh={},Ew={};gi&&(Ew=document.createElement("div").style,"AnimationEvent"in window||(delete ba.animationend.animation,delete ba.animationiteration.animation,delete ba.animationstart.animation),"TransitionEvent"in window||delete ba.transitionend.transition);function p0(e){if(mh[e])return mh[e];if(!ba[e])return e;var t=ba[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in Ew)return mh[e]=t[r];return e}var kw=p0("animationend"),Tw=p0("animationiteration"),Sw=p0("animationstart"),Cw=p0("transitionend"),Iw=new Map,ev="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function _s(e,t){Iw.set(e,t),ua(t,[e])}for(var gh=0;gh<ev.length;gh++){var vh=ev[gh],p4=vh.toLowerCase(),m4=vh[0].toUpperCase()+vh.slice(1);_s(p4,"on"+m4)}_s(kw,"onAnimationEnd");_s(Tw,"onAnimationIteration");_s(Sw,"onAnimationStart");_s("dblclick","onDoubleClick");_s("focusin","onFocus");_s("focusout","onBlur");_s(Cw,"onTransitionEnd");lo("onMouseEnter",["mouseout","mouseover"]);lo("onMouseLeave",["mouseout","mouseover"]);lo("onPointerEnter",["pointerout","pointerover"]);lo("onPointerLeave",["pointerout","pointerover"]);ua("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));ua("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));ua("onBeforeInput",["compositionend","keypress","textInput","paste"]);ua("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));ua("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));ua("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ol="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),g4=new Set("cancel close invalid load scroll toggle".split(" ").concat(ol));function tv(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,pI(n,t,void 0,e),e.currentTarget=null}function Aw(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],i=n.event;n=n.listeners;e:{var s=void 0;if(t)for(var a=n.length-1;0<=a;a--){var o=n[a],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==s&&i.isPropagationStopped())break e;tv(i,o,c),s=l}else for(a=0;a<n.length;a++){if(o=n[a],l=o.instance,c=o.currentTarget,o=o.listener,l!==s&&i.isPropagationStopped())break e;tv(i,o,c),s=l}}}if(tf)throw e=Ed,tf=!1,Ed=null,e}function nt(e,t){var r=t[Pd];r===void 0&&(r=t[Pd]=new Set);var n=e+"__bubble";r.has(n)||(Fw(t,e,2,!1),r.add(n))}function xh(e,t,r){var n=0;t&&(n|=4),Fw(r,e,n,t)}var au="_reactListening"+Math.random().toString(36).slice(2);function zl(e){if(!e[au]){e[au]=!0,Ly.forEach(function(r){r!=="selectionchange"&&(g4.has(r)||xh(r,!1,e),xh(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[au]||(t[au]=!0,xh("selectionchange",!1,t))}}function Fw(e,t,r,n){switch(hw(t)){case 1:var i=NI;break;case 4:i=RI;break;default:i=em}r=i.bind(null,t,r,e),i=void 0,!wd||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(i=!0),n?i!==void 0?e.addEventListener(t,r,{capture:!0,passive:i}):e.addEventListener(t,r,!0):i!==void 0?e.addEventListener(t,r,{passive:i}):e.addEventListener(t,r,!1)}function _h(e,t,r,n,i){var s=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var a=n.tag;if(a===3||a===4){var o=n.stateNode.containerInfo;if(o===i||o.nodeType===8&&o.parentNode===i)break;if(a===4)for(a=n.return;a!==null;){var l=a.tag;if((l===3||l===4)&&(l=a.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;a=a.return}for(;o!==null;){if(a=bs(o),a===null)return;if(l=a.tag,l===5||l===6){n=s=a;continue e}o=o.parentNode}}n=n.return}Jy(function(){var c=s,u=qp(r),f=[];e:{var h=Iw.get(e);if(h!==void 0){var d=rm,m=e;switch(e){case"keypress":if(Lu(r)===0)break e;case"keydown":case"keyup":d=GI;break;case"focusin":m="focus",d=hh;break;case"focusout":m="blur",d=hh;break;case"beforeblur":case"afterblur":d=hh;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":d=Hg;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":d=DI;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":d=YI;break;case kw:case Tw:case Sw:d=MI;break;case Cw:d=QI;break;case"scroll":d=PI;break;case"wheel":d=ZI;break;case"copy":case"cut":case"paste":d=UI;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":d=$g}var p=(t&4)!==0,g=!p&&e==="scroll",x=p?h!==null?h+"Capture":null:h;p=[];for(var _=c,v;_!==null;){v=_;var E=v.stateNode;if(v.tag===5&&E!==null&&(v=E,x!==null&&(E=Bl(_,x),E!=null&&p.push($l(_,E,v)))),g)break;_=_.return}0<p.length&&(h=new d(h,m,null,r,u),f.push({event:h,listeners:p}))}}if(!(t&7)){e:{if(h=e==="mouseover"||e==="pointerover",d=e==="mouseout"||e==="pointerout",h&&r!==_d&&(m=r.relatedTarget||r.fromElement)&&(bs(m)||m[vi]))break e;if((d||h)&&(h=u.window===u?u:(h=u.ownerDocument)?h.defaultView||h.parentWindow:window,d?(m=r.relatedTarget||r.toElement,d=c,m=m?bs(m):null,m!==null&&(g=fa(m),m!==g||m.tag!==5&&m.tag!==6)&&(m=null)):(d=null,m=c),d!==m)){if(p=Hg,E="onMouseLeave",x="onMouseEnter",_="mouse",(e==="pointerout"||e==="pointerover")&&(p=$g,E="onPointerLeave",x="onPointerEnter",_="pointer"),g=d==null?h:La(d),v=m==null?h:La(m),h=new p(E,_+"leave",d,r,u),h.target=g,h.relatedTarget=v,E=null,bs(u)===c&&(p=new p(x,_+"enter",m,r,u),p.target=v,p.relatedTarget=g,E=p),g=E,d&&m)t:{for(p=d,x=m,_=0,v=p;v;v=Sa(v))_++;for(v=0,E=x;E;E=Sa(E))v++;for(;0<_-v;)p=Sa(p),_--;for(;0<v-_;)x=Sa(x),v--;for(;_--;){if(p===x||x!==null&&p===x.alternate)break t;p=Sa(p),x=Sa(x)}p=null}else p=null;d!==null&&rv(f,h,d,p,!1),m!==null&&g!==null&&rv(f,g,m,p,!0)}}e:{if(h=c?La(c):window,d=h.nodeName&&h.nodeName.toLowerCase(),d==="select"||d==="input"&&h.type==="file")var N=a4;else if(Xg(h))if(xw)N=u4;else{N=l4;var I=o4}else(d=h.nodeName)&&d.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(N=c4);if(N&&(N=N(e,c))){vw(f,N,r,u);break e}I&&I(e,h,c),e==="focusout"&&(I=h._wrapperState)&&I.controlled&&h.type==="number"&&pd(h,"number",h.value)}switch(I=c?La(c):window,e){case"focusin":(Xg(I)||I.contentEditable==="true")&&(Da=I,Cd=c,vl=null);break;case"focusout":vl=Cd=Da=null;break;case"mousedown":Id=!0;break;case"contextmenu":case"mouseup":case"dragend":Id=!1,Zg(f,r,u);break;case"selectionchange":if(d4)break;case"keydown":case"keyup":Zg(f,r,u)}var w;if(im)e:{switch(e){case"compositionstart":var O="onCompositionStart";break e;case"compositionend":O="onCompositionEnd";break e;case"compositionupdate":O="onCompositionUpdate";break e}O=void 0}else Oa?mw(e,r)&&(O="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(O="onCompositionStart");O&&(pw&&r.locale!=="ko"&&(Oa||O!=="onCompositionStart"?O==="onCompositionEnd"&&Oa&&(w=dw()):($i=u,tm="value"in $i?$i.value:$i.textContent,Oa=!0)),I=of(c,O),0<I.length&&(O=new zg(O,e,null,r,u),f.push({event:O,listeners:I}),w?O.data=w:(w=gw(r),w!==null&&(O.data=w)))),(w=t4?r4(e,r):n4(e,r))&&(c=of(c,"onBeforeInput"),0<c.length&&(u=new zg("onBeforeInput","beforeinput",null,r,u),f.push({event:u,listeners:c}),u.data=w))}Aw(f,t)})}function $l(e,t,r){return{instance:e,listener:t,currentTarget:r}}function of(e,t){for(var r=t+"Capture",n=[];e!==null;){var i=e,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=Bl(e,r),s!=null&&n.unshift($l(e,s,i)),s=Bl(e,t),s!=null&&n.push($l(e,s,i))),e=e.return}return n}function Sa(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function rv(e,t,r,n,i){for(var s=t._reactName,a=[];r!==null&&r!==n;){var o=r,l=o.alternate,c=o.stateNode;if(l!==null&&l===n)break;o.tag===5&&c!==null&&(o=c,i?(l=Bl(r,s),l!=null&&a.unshift($l(r,l,o))):i||(l=Bl(r,s),l!=null&&a.push($l(r,l,o)))),r=r.return}a.length!==0&&e.push({event:t,listeners:a})}var v4=/\r\n?/g,x4=/\u0000|\uFFFD/g;function nv(e){return(typeof e=="string"?e:""+e).replace(v4,`
`).replace(x4,"")}function ou(e,t,r){if(t=nv(t),nv(e)!==t&&r)throw Error(re(425))}function lf(){}var Ad=null,Fd=null;function Nd(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Rd=typeof setTimeout=="function"?setTimeout:void 0,_4=typeof clearTimeout=="function"?clearTimeout:void 0,iv=typeof Promise=="function"?Promise:void 0,y4=typeof queueMicrotask=="function"?queueMicrotask:typeof iv<"u"?function(e){return iv.resolve(null).then(e).catch(w4)}:Rd;function w4(e){setTimeout(function(){throw e})}function yh(e,t){var r=t,n=0;do{var i=r.nextSibling;if(e.removeChild(r),i&&i.nodeType===8)if(r=i.data,r==="/$"){if(n===0){e.removeChild(i),Vl(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=i}while(r);Vl(t)}function ts(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function sv(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var Ao=Math.random().toString(36).slice(2),Un="__reactFiber$"+Ao,Gl="__reactProps$"+Ao,vi="__reactContainer$"+Ao,Pd="__reactEvents$"+Ao,E4="__reactListeners$"+Ao,k4="__reactHandles$"+Ao;function bs(e){var t=e[Un];if(t)return t;for(var r=e.parentNode;r;){if(t=r[vi]||r[Un]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=sv(e);e!==null;){if(r=e[Un])return r;e=sv(e)}return t}e=r,r=e.parentNode}return null}function Ac(e){return e=e[Un]||e[vi],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function La(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(re(33))}function m0(e){return e[Gl]||null}var Od=[],Ma=-1;function ys(e){return{current:e}}function st(e){0>Ma||(e.current=Od[Ma],Od[Ma]=null,Ma--)}function tt(e,t){Ma++,Od[Ma]=e.current,e.current=t}var fs={},fr=ys(fs),Nr=ys(!1),Ks=fs;function co(e,t){var r=e.type.contextTypes;if(!r)return fs;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in r)i[s]=t[s];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function Rr(e){return e=e.childContextTypes,e!=null}function cf(){st(Nr),st(fr)}function av(e,t,r){if(fr.current!==fs)throw Error(re(168));tt(fr,t),tt(Nr,r)}function Nw(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var i in n)if(!(i in t))throw Error(re(108,oI(e)||"Unknown",i));return mt({},r,n)}function uf(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||fs,Ks=fr.current,tt(fr,e),tt(Nr,Nr.current),!0}function ov(e,t,r){var n=e.stateNode;if(!n)throw Error(re(169));r?(e=Nw(e,t,Ks),n.__reactInternalMemoizedMergedChildContext=e,st(Nr),st(fr),tt(fr,e)):st(Nr),tt(Nr,r)}var ri=null,g0=!1,wh=!1;function Rw(e){ri===null?ri=[e]:ri.push(e)}function T4(e){g0=!0,Rw(e)}function ws(){if(!wh&&ri!==null){wh=!0;var e=0,t=Xe;try{var r=ri;for(Xe=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}ri=null,g0=!1}catch(i){throw ri!==null&&(ri=ri.slice(e+1)),rw(Qp,ws),i}finally{Xe=t,wh=!1}}return null}var Ba=[],Ua=0,ff=null,hf=0,nn=[],sn=0,Xs=null,ni=1,ii="";function Ns(e,t){Ba[Ua++]=hf,Ba[Ua++]=ff,ff=e,hf=t}function Pw(e,t,r){nn[sn++]=ni,nn[sn++]=ii,nn[sn++]=Xs,Xs=e;var n=ni;e=ii;var i=32-Tn(n)-1;n&=~(1<<i),r+=1;var s=32-Tn(t)+i;if(30<s){var a=i-i%5;s=(n&(1<<a)-1).toString(32),n>>=a,i-=a,ni=1<<32-Tn(t)+i|r<<i|n,ii=s+e}else ni=1<<s|r<<i|n,ii=e}function am(e){e.return!==null&&(Ns(e,1),Pw(e,1,0))}function om(e){for(;e===ff;)ff=Ba[--Ua],Ba[Ua]=null,hf=Ba[--Ua],Ba[Ua]=null;for(;e===Xs;)Xs=nn[--sn],nn[sn]=null,ii=nn[--sn],nn[sn]=null,ni=nn[--sn],nn[sn]=null}var Hr=null,Vr=null,lt=!1,xn=null;function Ow(e,t){var r=an(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function lv(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Hr=e,Vr=ts(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Hr=e,Vr=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=Xs!==null?{id:ni,overflow:ii}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=an(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,Hr=e,Vr=null,!0):!1;default:return!1}}function Dd(e){return(e.mode&1)!==0&&(e.flags&128)===0}function bd(e){if(lt){var t=Vr;if(t){var r=t;if(!lv(e,t)){if(Dd(e))throw Error(re(418));t=ts(r.nextSibling);var n=Hr;t&&lv(e,t)?Ow(n,r):(e.flags=e.flags&-4097|2,lt=!1,Hr=e)}}else{if(Dd(e))throw Error(re(418));e.flags=e.flags&-4097|2,lt=!1,Hr=e}}}function cv(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Hr=e}function lu(e){if(e!==Hr)return!1;if(!lt)return cv(e),lt=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Nd(e.type,e.memoizedProps)),t&&(t=Vr)){if(Dd(e))throw Dw(),Error(re(418));for(;t;)Ow(e,t),t=ts(t.nextSibling)}if(cv(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(re(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){Vr=ts(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}Vr=null}}else Vr=Hr?ts(e.stateNode.nextSibling):null;return!0}function Dw(){for(var e=Vr;e;)e=ts(e.nextSibling)}function uo(){Vr=Hr=null,lt=!1}function lm(e){xn===null?xn=[e]:xn.push(e)}var S4=Si.ReactCurrentBatchConfig;function qo(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(re(309));var n=r.stateNode}if(!n)throw Error(re(147,e));var i=n,s=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===s?t.ref:(t=function(a){var o=i.refs;a===null?delete o[s]:o[s]=a},t._stringRef=s,t)}if(typeof e!="string")throw Error(re(284));if(!r._owner)throw Error(re(290,e))}return e}function cu(e,t){throw e=Object.prototype.toString.call(t),Error(re(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function uv(e){var t=e._init;return t(e._payload)}function bw(e){function t(x,_){if(e){var v=x.deletions;v===null?(x.deletions=[_],x.flags|=16):v.push(_)}}function r(x,_){if(!e)return null;for(;_!==null;)t(x,_),_=_.sibling;return null}function n(x,_){for(x=new Map;_!==null;)_.key!==null?x.set(_.key,_):x.set(_.index,_),_=_.sibling;return x}function i(x,_){return x=ss(x,_),x.index=0,x.sibling=null,x}function s(x,_,v){return x.index=v,e?(v=x.alternate,v!==null?(v=v.index,v<_?(x.flags|=2,_):v):(x.flags|=2,_)):(x.flags|=1048576,_)}function a(x){return e&&x.alternate===null&&(x.flags|=2),x}function o(x,_,v,E){return _===null||_.tag!==6?(_=Ah(v,x.mode,E),_.return=x,_):(_=i(_,v),_.return=x,_)}function l(x,_,v,E){var N=v.type;return N===Pa?u(x,_,v.props.children,E,v.key):_!==null&&(_.elementType===N||typeof N=="object"&&N!==null&&N.$$typeof===bi&&uv(N)===_.type)?(E=i(_,v.props),E.ref=qo(x,_,v),E.return=x,E):(E=Hu(v.type,v.key,v.props,null,x.mode,E),E.ref=qo(x,_,v),E.return=x,E)}function c(x,_,v,E){return _===null||_.tag!==4||_.stateNode.containerInfo!==v.containerInfo||_.stateNode.implementation!==v.implementation?(_=Fh(v,x.mode,E),_.return=x,_):(_=i(_,v.children||[]),_.return=x,_)}function u(x,_,v,E,N){return _===null||_.tag!==7?(_=Vs(v,x.mode,E,N),_.return=x,_):(_=i(_,v),_.return=x,_)}function f(x,_,v){if(typeof _=="string"&&_!==""||typeof _=="number")return _=Ah(""+_,x.mode,v),_.return=x,_;if(typeof _=="object"&&_!==null){switch(_.$$typeof){case Jc:return v=Hu(_.type,_.key,_.props,null,x.mode,v),v.ref=qo(x,null,_),v.return=x,v;case Ra:return _=Fh(_,x.mode,v),_.return=x,_;case bi:var E=_._init;return f(x,E(_._payload),v)}if(sl(_)||$o(_))return _=Vs(_,x.mode,v,null),_.return=x,_;cu(x,_)}return null}function h(x,_,v,E){var N=_!==null?_.key:null;if(typeof v=="string"&&v!==""||typeof v=="number")return N!==null?null:o(x,_,""+v,E);if(typeof v=="object"&&v!==null){switch(v.$$typeof){case Jc:return v.key===N?l(x,_,v,E):null;case Ra:return v.key===N?c(x,_,v,E):null;case bi:return N=v._init,h(x,_,N(v._payload),E)}if(sl(v)||$o(v))return N!==null?null:u(x,_,v,E,null);cu(x,v)}return null}function d(x,_,v,E,N){if(typeof E=="string"&&E!==""||typeof E=="number")return x=x.get(v)||null,o(_,x,""+E,N);if(typeof E=="object"&&E!==null){switch(E.$$typeof){case Jc:return x=x.get(E.key===null?v:E.key)||null,l(_,x,E,N);case Ra:return x=x.get(E.key===null?v:E.key)||null,c(_,x,E,N);case bi:var I=E._init;return d(x,_,v,I(E._payload),N)}if(sl(E)||$o(E))return x=x.get(v)||null,u(_,x,E,N,null);cu(_,E)}return null}function m(x,_,v,E){for(var N=null,I=null,w=_,O=_=0,P=null;w!==null&&O<v.length;O++){w.index>O?(P=w,w=null):P=w.sibling;var W=h(x,w,v[O],E);if(W===null){w===null&&(w=P);break}e&&w&&W.alternate===null&&t(x,w),_=s(W,_,O),I===null?N=W:I.sibling=W,I=W,w=P}if(O===v.length)return r(x,w),lt&&Ns(x,O),N;if(w===null){for(;O<v.length;O++)w=f(x,v[O],E),w!==null&&(_=s(w,_,O),I===null?N=w:I.sibling=w,I=w);return lt&&Ns(x,O),N}for(w=n(x,w);O<v.length;O++)P=d(w,x,O,v[O],E),P!==null&&(e&&P.alternate!==null&&w.delete(P.key===null?O:P.key),_=s(P,_,O),I===null?N=P:I.sibling=P,I=P);return e&&w.forEach(function(j){return t(x,j)}),lt&&Ns(x,O),N}function p(x,_,v,E){var N=$o(v);if(typeof N!="function")throw Error(re(150));if(v=N.call(v),v==null)throw Error(re(151));for(var I=N=null,w=_,O=_=0,P=null,W=v.next();w!==null&&!W.done;O++,W=v.next()){w.index>O?(P=w,w=null):P=w.sibling;var j=h(x,w,W.value,E);if(j===null){w===null&&(w=P);break}e&&w&&j.alternate===null&&t(x,w),_=s(j,_,O),I===null?N=j:I.sibling=j,I=j,w=P}if(W.done)return r(x,w),lt&&Ns(x,O),N;if(w===null){for(;!W.done;O++,W=v.next())W=f(x,W.value,E),W!==null&&(_=s(W,_,O),I===null?N=W:I.sibling=W,I=W);return lt&&Ns(x,O),N}for(w=n(x,w);!W.done;O++,W=v.next())W=d(w,x,O,W.value,E),W!==null&&(e&&W.alternate!==null&&w.delete(W.key===null?O:W.key),_=s(W,_,O),I===null?N=W:I.sibling=W,I=W);return e&&w.forEach(function(U){return t(x,U)}),lt&&Ns(x,O),N}function g(x,_,v,E){if(typeof v=="object"&&v!==null&&v.type===Pa&&v.key===null&&(v=v.props.children),typeof v=="object"&&v!==null){switch(v.$$typeof){case Jc:e:{for(var N=v.key,I=_;I!==null;){if(I.key===N){if(N=v.type,N===Pa){if(I.tag===7){r(x,I.sibling),_=i(I,v.props.children),_.return=x,x=_;break e}}else if(I.elementType===N||typeof N=="object"&&N!==null&&N.$$typeof===bi&&uv(N)===I.type){r(x,I.sibling),_=i(I,v.props),_.ref=qo(x,I,v),_.return=x,x=_;break e}r(x,I);break}else t(x,I);I=I.sibling}v.type===Pa?(_=Vs(v.props.children,x.mode,E,v.key),_.return=x,x=_):(E=Hu(v.type,v.key,v.props,null,x.mode,E),E.ref=qo(x,_,v),E.return=x,x=E)}return a(x);case Ra:e:{for(I=v.key;_!==null;){if(_.key===I)if(_.tag===4&&_.stateNode.containerInfo===v.containerInfo&&_.stateNode.implementation===v.implementation){r(x,_.sibling),_=i(_,v.children||[]),_.return=x,x=_;break e}else{r(x,_);break}else t(x,_);_=_.sibling}_=Fh(v,x.mode,E),_.return=x,x=_}return a(x);case bi:return I=v._init,g(x,_,I(v._payload),E)}if(sl(v))return m(x,_,v,E);if($o(v))return p(x,_,v,E);cu(x,v)}return typeof v=="string"&&v!==""||typeof v=="number"?(v=""+v,_!==null&&_.tag===6?(r(x,_.sibling),_=i(_,v),_.return=x,x=_):(r(x,_),_=Ah(v,x.mode,E),_.return=x,x=_),a(x)):r(x,_)}return g}var fo=bw(!0),Lw=bw(!1),df=ys(null),pf=null,Wa=null,cm=null;function um(){cm=Wa=pf=null}function fm(e){var t=df.current;st(df),e._currentValue=t}function Ld(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function qa(e,t){pf=e,cm=Wa=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Ir=!0),e.firstContext=null)}function un(e){var t=e._currentValue;if(cm!==e)if(e={context:e,memoizedValue:t,next:null},Wa===null){if(pf===null)throw Error(re(308));Wa=e,pf.dependencies={lanes:0,firstContext:e}}else Wa=Wa.next=e;return t}var Ls=null;function hm(e){Ls===null?Ls=[e]:Ls.push(e)}function Mw(e,t,r,n){var i=t.interleaved;return i===null?(r.next=r,hm(t)):(r.next=i.next,i.next=r),t.interleaved=r,xi(e,n)}function xi(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var Li=!1;function dm(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Bw(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function fi(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function rs(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,We&2){var i=n.pending;return i===null?t.next=t:(t.next=i.next,i.next=t),n.pending=t,xi(e,r)}return i=n.interleaved,i===null?(t.next=t,hm(n)):(t.next=i.next,i.next=t),n.interleaved=t,xi(e,r)}function Mu(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,Jp(e,r)}}function fv(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var i=null,s=null;if(r=r.firstBaseUpdate,r!==null){do{var a={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};s===null?i=s=a:s=s.next=a,r=r.next}while(r!==null);s===null?i=s=t:s=s.next=t}else i=s=t;r={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function mf(e,t,r,n){var i=e.updateQueue;Li=!1;var s=i.firstBaseUpdate,a=i.lastBaseUpdate,o=i.shared.pending;if(o!==null){i.shared.pending=null;var l=o,c=l.next;l.next=null,a===null?s=c:a.next=c,a=l;var u=e.alternate;u!==null&&(u=u.updateQueue,o=u.lastBaseUpdate,o!==a&&(o===null?u.firstBaseUpdate=c:o.next=c,u.lastBaseUpdate=l))}if(s!==null){var f=i.baseState;a=0,u=c=l=null,o=s;do{var h=o.lane,d=o.eventTime;if((n&h)===h){u!==null&&(u=u.next={eventTime:d,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var m=e,p=o;switch(h=t,d=r,p.tag){case 1:if(m=p.payload,typeof m=="function"){f=m.call(d,f,h);break e}f=m;break e;case 3:m.flags=m.flags&-65537|128;case 0:if(m=p.payload,h=typeof m=="function"?m.call(d,f,h):m,h==null)break e;f=mt({},f,h);break e;case 2:Li=!0}}o.callback!==null&&o.lane!==0&&(e.flags|=64,h=i.effects,h===null?i.effects=[o]:h.push(o))}else d={eventTime:d,lane:h,tag:o.tag,payload:o.payload,callback:o.callback,next:null},u===null?(c=u=d,l=f):u=u.next=d,a|=h;if(o=o.next,o===null){if(o=i.shared.pending,o===null)break;h=o,o=h.next,h.next=null,i.lastBaseUpdate=h,i.shared.pending=null}}while(!0);if(u===null&&(l=f),i.baseState=l,i.firstBaseUpdate=c,i.lastBaseUpdate=u,t=i.shared.interleaved,t!==null){i=t;do a|=i.lane,i=i.next;while(i!==t)}else s===null&&(i.shared.lanes=0);qs|=a,e.lanes=a,e.memoizedState=f}}function hv(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],i=n.callback;if(i!==null){if(n.callback=null,n=r,typeof i!="function")throw Error(re(191,i));i.call(n)}}}var Fc={},jn=ys(Fc),Kl=ys(Fc),Xl=ys(Fc);function Ms(e){if(e===Fc)throw Error(re(174));return e}function pm(e,t){switch(tt(Xl,t),tt(Kl,e),tt(jn,Fc),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:gd(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=gd(t,e)}st(jn),tt(jn,t)}function ho(){st(jn),st(Kl),st(Xl)}function Uw(e){Ms(Xl.current);var t=Ms(jn.current),r=gd(t,e.type);t!==r&&(tt(Kl,e),tt(jn,r))}function mm(e){Kl.current===e&&(st(jn),st(Kl))}var ft=ys(0);function gf(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Eh=[];function gm(){for(var e=0;e<Eh.length;e++)Eh[e]._workInProgressVersionPrimary=null;Eh.length=0}var Bu=Si.ReactCurrentDispatcher,kh=Si.ReactCurrentBatchConfig,Ys=0,pt=null,Dt=null,Wt=null,vf=!1,xl=!1,Yl=0,C4=0;function rr(){throw Error(re(321))}function vm(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!Fn(e[r],t[r]))return!1;return!0}function xm(e,t,r,n,i,s){if(Ys=s,pt=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Bu.current=e===null||e.memoizedState===null?N4:R4,e=r(n,i),xl){s=0;do{if(xl=!1,Yl=0,25<=s)throw Error(re(301));s+=1,Wt=Dt=null,t.updateQueue=null,Bu.current=P4,e=r(n,i)}while(xl)}if(Bu.current=xf,t=Dt!==null&&Dt.next!==null,Ys=0,Wt=Dt=pt=null,vf=!1,t)throw Error(re(300));return e}function _m(){var e=Yl!==0;return Yl=0,e}function Bn(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Wt===null?pt.memoizedState=Wt=e:Wt=Wt.next=e,Wt}function fn(){if(Dt===null){var e=pt.alternate;e=e!==null?e.memoizedState:null}else e=Dt.next;var t=Wt===null?pt.memoizedState:Wt.next;if(t!==null)Wt=t,Dt=e;else{if(e===null)throw Error(re(310));Dt=e,e={memoizedState:Dt.memoizedState,baseState:Dt.baseState,baseQueue:Dt.baseQueue,queue:Dt.queue,next:null},Wt===null?pt.memoizedState=Wt=e:Wt=Wt.next=e}return Wt}function ql(e,t){return typeof t=="function"?t(e):t}function Th(e){var t=fn(),r=t.queue;if(r===null)throw Error(re(311));r.lastRenderedReducer=e;var n=Dt,i=n.baseQueue,s=r.pending;if(s!==null){if(i!==null){var a=i.next;i.next=s.next,s.next=a}n.baseQueue=i=s,r.pending=null}if(i!==null){s=i.next,n=n.baseState;var o=a=null,l=null,c=s;do{var u=c.lane;if((Ys&u)===u)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),n=c.hasEagerState?c.eagerState:e(n,c.action);else{var f={lane:u,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(o=l=f,a=n):l=l.next=f,pt.lanes|=u,qs|=u}c=c.next}while(c!==null&&c!==s);l===null?a=n:l.next=o,Fn(n,t.memoizedState)||(Ir=!0),t.memoizedState=n,t.baseState=a,t.baseQueue=l,r.lastRenderedState=n}if(e=r.interleaved,e!==null){i=e;do s=i.lane,pt.lanes|=s,qs|=s,i=i.next;while(i!==e)}else i===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function Sh(e){var t=fn(),r=t.queue;if(r===null)throw Error(re(311));r.lastRenderedReducer=e;var n=r.dispatch,i=r.pending,s=t.memoizedState;if(i!==null){r.pending=null;var a=i=i.next;do s=e(s,a.action),a=a.next;while(a!==i);Fn(s,t.memoizedState)||(Ir=!0),t.memoizedState=s,t.baseQueue===null&&(t.baseState=s),r.lastRenderedState=s}return[s,n]}function Ww(){}function Vw(e,t){var r=pt,n=fn(),i=t(),s=!Fn(n.memoizedState,i);if(s&&(n.memoizedState=i,Ir=!0),n=n.queue,ym(zw.bind(null,r,n,e),[e]),n.getSnapshot!==t||s||Wt!==null&&Wt.memoizedState.tag&1){if(r.flags|=2048,Ql(9,Hw.bind(null,r,n,i,t),void 0,null),Gt===null)throw Error(re(349));Ys&30||jw(r,t,i)}return i}function jw(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=pt.updateQueue,t===null?(t={lastEffect:null,stores:null},pt.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function Hw(e,t,r,n){t.value=r,t.getSnapshot=n,$w(t)&&Gw(e)}function zw(e,t,r){return r(function(){$w(t)&&Gw(e)})}function $w(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Fn(e,r)}catch{return!0}}function Gw(e){var t=xi(e,1);t!==null&&Sn(t,e,1,-1)}function dv(e){var t=Bn();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ql,lastRenderedState:e},t.queue=e,e=e.dispatch=F4.bind(null,pt,e),[t.memoizedState,e]}function Ql(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=pt.updateQueue,t===null?(t={lastEffect:null,stores:null},pt.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function Kw(){return fn().memoizedState}function Uu(e,t,r,n){var i=Bn();pt.flags|=e,i.memoizedState=Ql(1|t,r,void 0,n===void 0?null:n)}function v0(e,t,r,n){var i=fn();n=n===void 0?null:n;var s=void 0;if(Dt!==null){var a=Dt.memoizedState;if(s=a.destroy,n!==null&&vm(n,a.deps)){i.memoizedState=Ql(t,r,s,n);return}}pt.flags|=e,i.memoizedState=Ql(1|t,r,s,n)}function pv(e,t){return Uu(8390656,8,e,t)}function ym(e,t){return v0(2048,8,e,t)}function Xw(e,t){return v0(4,2,e,t)}function Yw(e,t){return v0(4,4,e,t)}function qw(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function Qw(e,t,r){return r=r!=null?r.concat([e]):null,v0(4,4,qw.bind(null,t,e),r)}function wm(){}function Jw(e,t){var r=fn();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&vm(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function Zw(e,t){var r=fn();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&vm(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function e2(e,t,r){return Ys&21?(Fn(r,t)||(r=sw(),pt.lanes|=r,qs|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Ir=!0),e.memoizedState=r)}function I4(e,t){var r=Xe;Xe=r!==0&&4>r?r:4,e(!0);var n=kh.transition;kh.transition={};try{e(!1),t()}finally{Xe=r,kh.transition=n}}function t2(){return fn().memoizedState}function A4(e,t,r){var n=is(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},r2(e))n2(t,r);else if(r=Mw(e,t,r,n),r!==null){var i=_r();Sn(r,e,n,i),i2(r,t,n)}}function F4(e,t,r){var n=is(e),i={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(r2(e))n2(t,i);else{var s=e.alternate;if(e.lanes===0&&(s===null||s.lanes===0)&&(s=t.lastRenderedReducer,s!==null))try{var a=t.lastRenderedState,o=s(a,r);if(i.hasEagerState=!0,i.eagerState=o,Fn(o,a)){var l=t.interleaved;l===null?(i.next=i,hm(t)):(i.next=l.next,l.next=i),t.interleaved=i;return}}catch{}finally{}r=Mw(e,t,i,n),r!==null&&(i=_r(),Sn(r,e,n,i),i2(r,t,n))}}function r2(e){var t=e.alternate;return e===pt||t!==null&&t===pt}function n2(e,t){xl=vf=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function i2(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,Jp(e,r)}}var xf={readContext:un,useCallback:rr,useContext:rr,useEffect:rr,useImperativeHandle:rr,useInsertionEffect:rr,useLayoutEffect:rr,useMemo:rr,useReducer:rr,useRef:rr,useState:rr,useDebugValue:rr,useDeferredValue:rr,useTransition:rr,useMutableSource:rr,useSyncExternalStore:rr,useId:rr,unstable_isNewReconciler:!1},N4={readContext:un,useCallback:function(e,t){return Bn().memoizedState=[e,t===void 0?null:t],e},useContext:un,useEffect:pv,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,Uu(4194308,4,qw.bind(null,t,e),r)},useLayoutEffect:function(e,t){return Uu(4194308,4,e,t)},useInsertionEffect:function(e,t){return Uu(4,2,e,t)},useMemo:function(e,t){var r=Bn();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=Bn();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=A4.bind(null,pt,e),[n.memoizedState,e]},useRef:function(e){var t=Bn();return e={current:e},t.memoizedState=e},useState:dv,useDebugValue:wm,useDeferredValue:function(e){return Bn().memoizedState=e},useTransition:function(){var e=dv(!1),t=e[0];return e=I4.bind(null,e[1]),Bn().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=pt,i=Bn();if(lt){if(r===void 0)throw Error(re(407));r=r()}else{if(r=t(),Gt===null)throw Error(re(349));Ys&30||jw(n,t,r)}i.memoizedState=r;var s={value:r,getSnapshot:t};return i.queue=s,pv(zw.bind(null,n,s,e),[e]),n.flags|=2048,Ql(9,Hw.bind(null,n,s,r,t),void 0,null),r},useId:function(){var e=Bn(),t=Gt.identifierPrefix;if(lt){var r=ii,n=ni;r=(n&~(1<<32-Tn(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=Yl++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=C4++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},R4={readContext:un,useCallback:Jw,useContext:un,useEffect:ym,useImperativeHandle:Qw,useInsertionEffect:Xw,useLayoutEffect:Yw,useMemo:Zw,useReducer:Th,useRef:Kw,useState:function(){return Th(ql)},useDebugValue:wm,useDeferredValue:function(e){var t=fn();return e2(t,Dt.memoizedState,e)},useTransition:function(){var e=Th(ql)[0],t=fn().memoizedState;return[e,t]},useMutableSource:Ww,useSyncExternalStore:Vw,useId:t2,unstable_isNewReconciler:!1},P4={readContext:un,useCallback:Jw,useContext:un,useEffect:ym,useImperativeHandle:Qw,useInsertionEffect:Xw,useLayoutEffect:Yw,useMemo:Zw,useReducer:Sh,useRef:Kw,useState:function(){return Sh(ql)},useDebugValue:wm,useDeferredValue:function(e){var t=fn();return Dt===null?t.memoizedState=e:e2(t,Dt.memoizedState,e)},useTransition:function(){var e=Sh(ql)[0],t=fn().memoizedState;return[e,t]},useMutableSource:Ww,useSyncExternalStore:Vw,useId:t2,unstable_isNewReconciler:!1};function gn(e,t){if(e&&e.defaultProps){t=mt({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function Md(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:mt({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var x0={isMounted:function(e){return(e=e._reactInternals)?fa(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=_r(),i=is(e),s=fi(n,i);s.payload=t,r!=null&&(s.callback=r),t=rs(e,s,i),t!==null&&(Sn(t,e,i,n),Mu(t,e,i))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=_r(),i=is(e),s=fi(n,i);s.tag=1,s.payload=t,r!=null&&(s.callback=r),t=rs(e,s,i),t!==null&&(Sn(t,e,i,n),Mu(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=_r(),n=is(e),i=fi(r,n);i.tag=2,t!=null&&(i.callback=t),t=rs(e,i,n),t!==null&&(Sn(t,e,n,r),Mu(t,e,n))}};function mv(e,t,r,n,i,s,a){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,s,a):t.prototype&&t.prototype.isPureReactComponent?!Hl(r,n)||!Hl(i,s):!0}function s2(e,t,r){var n=!1,i=fs,s=t.contextType;return typeof s=="object"&&s!==null?s=un(s):(i=Rr(t)?Ks:fr.current,n=t.contextTypes,s=(n=n!=null)?co(e,i):fs),t=new t(r,s),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=x0,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=s),t}function gv(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&x0.enqueueReplaceState(t,t.state,null)}function Bd(e,t,r,n){var i=e.stateNode;i.props=r,i.state=e.memoizedState,i.refs={},dm(e);var s=t.contextType;typeof s=="object"&&s!==null?i.context=un(s):(s=Rr(t)?Ks:fr.current,i.context=co(e,s)),i.state=e.memoizedState,s=t.getDerivedStateFromProps,typeof s=="function"&&(Md(e,t,s,r),i.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(t=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),t!==i.state&&x0.enqueueReplaceState(i,i.state,null),mf(e,r,i,n),i.state=e.memoizedState),typeof i.componentDidMount=="function"&&(e.flags|=4194308)}function po(e,t){try{var r="",n=t;do r+=aI(n),n=n.return;while(n);var i=r}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:e,source:t,stack:i,digest:null}}function Ch(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function Ud(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var O4=typeof WeakMap=="function"?WeakMap:Map;function a2(e,t,r){r=fi(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){yf||(yf=!0,Yd=n),Ud(e,t)},r}function o2(e,t,r){r=fi(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var i=t.value;r.payload=function(){return n(i)},r.callback=function(){Ud(e,t)}}var s=e.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(r.callback=function(){Ud(e,t),typeof n!="function"&&(ns===null?ns=new Set([this]):ns.add(this));var a=t.stack;this.componentDidCatch(t.value,{componentStack:a!==null?a:""})}),r}function vv(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new O4;var i=new Set;n.set(t,i)}else i=n.get(t),i===void 0&&(i=new Set,n.set(t,i));i.has(r)||(i.add(r),e=K4.bind(null,e,t,r),t.then(e,e))}function xv(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function _v(e,t,r,n,i){return e.mode&1?(e.flags|=65536,e.lanes=i,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=fi(-1,1),t.tag=2,rs(r,t,1))),r.lanes|=1),e)}var D4=Si.ReactCurrentOwner,Ir=!1;function gr(e,t,r,n){t.child=e===null?Lw(t,null,r,n):fo(t,e.child,r,n)}function yv(e,t,r,n,i){r=r.render;var s=t.ref;return qa(t,i),n=xm(e,t,r,n,s,i),r=_m(),e!==null&&!Ir?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,_i(e,t,i)):(lt&&r&&am(t),t.flags|=1,gr(e,t,n,i),t.child)}function wv(e,t,r,n,i){if(e===null){var s=r.type;return typeof s=="function"&&!Fm(s)&&s.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=s,l2(e,t,s,n,i)):(e=Hu(r.type,null,n,t,t.mode,i),e.ref=t.ref,e.return=t,t.child=e)}if(s=e.child,!(e.lanes&i)){var a=s.memoizedProps;if(r=r.compare,r=r!==null?r:Hl,r(a,n)&&e.ref===t.ref)return _i(e,t,i)}return t.flags|=1,e=ss(s,n),e.ref=t.ref,e.return=t,t.child=e}function l2(e,t,r,n,i){if(e!==null){var s=e.memoizedProps;if(Hl(s,n)&&e.ref===t.ref)if(Ir=!1,t.pendingProps=n=s,(e.lanes&i)!==0)e.flags&131072&&(Ir=!0);else return t.lanes=e.lanes,_i(e,t,i)}return Wd(e,t,r,n,i)}function c2(e,t,r){var n=t.pendingProps,i=n.children,s=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},tt(ja,Lr),Lr|=r;else{if(!(r&1073741824))return e=s!==null?s.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,tt(ja,Lr),Lr|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=s!==null?s.baseLanes:r,tt(ja,Lr),Lr|=n}else s!==null?(n=s.baseLanes|r,t.memoizedState=null):n=r,tt(ja,Lr),Lr|=n;return gr(e,t,i,r),t.child}function u2(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function Wd(e,t,r,n,i){var s=Rr(r)?Ks:fr.current;return s=co(t,s),qa(t,i),r=xm(e,t,r,n,s,i),n=_m(),e!==null&&!Ir?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,_i(e,t,i)):(lt&&n&&am(t),t.flags|=1,gr(e,t,r,i),t.child)}function Ev(e,t,r,n,i){if(Rr(r)){var s=!0;uf(t)}else s=!1;if(qa(t,i),t.stateNode===null)Wu(e,t),s2(t,r,n),Bd(t,r,n,i),n=!0;else if(e===null){var a=t.stateNode,o=t.memoizedProps;a.props=o;var l=a.context,c=r.contextType;typeof c=="object"&&c!==null?c=un(c):(c=Rr(r)?Ks:fr.current,c=co(t,c));var u=r.getDerivedStateFromProps,f=typeof u=="function"||typeof a.getSnapshotBeforeUpdate=="function";f||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==n||l!==c)&&gv(t,a,n,c),Li=!1;var h=t.memoizedState;a.state=h,mf(t,n,a,i),l=t.memoizedState,o!==n||h!==l||Nr.current||Li?(typeof u=="function"&&(Md(t,r,u,n),l=t.memoizedState),(o=Li||mv(t,r,o,n,h,l,c))?(f||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(t.flags|=4194308)):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=l),a.props=n,a.state=l,a.context=c,n=o):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{a=t.stateNode,Bw(e,t),o=t.memoizedProps,c=t.type===t.elementType?o:gn(t.type,o),a.props=c,f=t.pendingProps,h=a.context,l=r.contextType,typeof l=="object"&&l!==null?l=un(l):(l=Rr(r)?Ks:fr.current,l=co(t,l));var d=r.getDerivedStateFromProps;(u=typeof d=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==f||h!==l)&&gv(t,a,n,l),Li=!1,h=t.memoizedState,a.state=h,mf(t,n,a,i);var m=t.memoizedState;o!==f||h!==m||Nr.current||Li?(typeof d=="function"&&(Md(t,r,d,n),m=t.memoizedState),(c=Li||mv(t,r,c,n,h,m,l)||!1)?(u||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(n,m,l),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(n,m,l)),typeof a.componentDidUpdate=="function"&&(t.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof a.componentDidUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=m),a.props=n,a.state=m,a.context=l,n=c):(typeof a.componentDidUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),n=!1)}return Vd(e,t,r,n,s,i)}function Vd(e,t,r,n,i,s){u2(e,t);var a=(t.flags&128)!==0;if(!n&&!a)return i&&ov(t,r,!1),_i(e,t,s);n=t.stateNode,D4.current=t;var o=a&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&a?(t.child=fo(t,e.child,null,s),t.child=fo(t,null,o,s)):gr(e,t,o,s),t.memoizedState=n.state,i&&ov(t,r,!0),t.child}function f2(e){var t=e.stateNode;t.pendingContext?av(e,t.pendingContext,t.pendingContext!==t.context):t.context&&av(e,t.context,!1),pm(e,t.containerInfo)}function kv(e,t,r,n,i){return uo(),lm(i),t.flags|=256,gr(e,t,r,n),t.child}var jd={dehydrated:null,treeContext:null,retryLane:0};function Hd(e){return{baseLanes:e,cachePool:null,transitions:null}}function h2(e,t,r){var n=t.pendingProps,i=ft.current,s=!1,a=(t.flags&128)!==0,o;if((o=a)||(o=e!==null&&e.memoizedState===null?!1:(i&2)!==0),o?(s=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(i|=1),tt(ft,i&1),e===null)return bd(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(a=n.children,e=n.fallback,s?(n=t.mode,s=t.child,a={mode:"hidden",children:a},!(n&1)&&s!==null?(s.childLanes=0,s.pendingProps=a):s=w0(a,n,0,null),e=Vs(e,n,r,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=Hd(r),t.memoizedState=jd,e):Em(t,a));if(i=e.memoizedState,i!==null&&(o=i.dehydrated,o!==null))return b4(e,t,a,n,o,i,r);if(s){s=n.fallback,a=t.mode,i=e.child,o=i.sibling;var l={mode:"hidden",children:n.children};return!(a&1)&&t.child!==i?(n=t.child,n.childLanes=0,n.pendingProps=l,t.deletions=null):(n=ss(i,l),n.subtreeFlags=i.subtreeFlags&14680064),o!==null?s=ss(o,s):(s=Vs(s,a,r,null),s.flags|=2),s.return=t,n.return=t,n.sibling=s,t.child=n,n=s,s=t.child,a=e.child.memoizedState,a=a===null?Hd(r):{baseLanes:a.baseLanes|r,cachePool:null,transitions:a.transitions},s.memoizedState=a,s.childLanes=e.childLanes&~r,t.memoizedState=jd,n}return s=e.child,e=s.sibling,n=ss(s,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function Em(e,t){return t=w0({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function uu(e,t,r,n){return n!==null&&lm(n),fo(t,e.child,null,r),e=Em(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function b4(e,t,r,n,i,s,a){if(r)return t.flags&256?(t.flags&=-257,n=Ch(Error(re(422))),uu(e,t,a,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(s=n.fallback,i=t.mode,n=w0({mode:"visible",children:n.children},i,0,null),s=Vs(s,i,a,null),s.flags|=2,n.return=t,s.return=t,n.sibling=s,t.child=n,t.mode&1&&fo(t,e.child,null,a),t.child.memoizedState=Hd(a),t.memoizedState=jd,s);if(!(t.mode&1))return uu(e,t,a,null);if(i.data==="$!"){if(n=i.nextSibling&&i.nextSibling.dataset,n)var o=n.dgst;return n=o,s=Error(re(419)),n=Ch(s,n,void 0),uu(e,t,a,n)}if(o=(a&e.childLanes)!==0,Ir||o){if(n=Gt,n!==null){switch(a&-a){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(n.suspendedLanes|a)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,xi(e,i),Sn(n,e,i,-1))}return Am(),n=Ch(Error(re(421))),uu(e,t,a,n)}return i.data==="$?"?(t.flags|=128,t.child=e.child,t=X4.bind(null,e),i._reactRetry=t,null):(e=s.treeContext,Vr=ts(i.nextSibling),Hr=t,lt=!0,xn=null,e!==null&&(nn[sn++]=ni,nn[sn++]=ii,nn[sn++]=Xs,ni=e.id,ii=e.overflow,Xs=t),t=Em(t,n.children),t.flags|=4096,t)}function Tv(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),Ld(e.return,t,r)}function Ih(e,t,r,n,i){var s=e.memoizedState;s===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:i}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=r,s.tailMode=i)}function d2(e,t,r){var n=t.pendingProps,i=n.revealOrder,s=n.tail;if(gr(e,t,n.children,r),n=ft.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Tv(e,r,t);else if(e.tag===19)Tv(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(tt(ft,n),!(t.mode&1))t.memoizedState=null;else switch(i){case"forwards":for(r=t.child,i=null;r!==null;)e=r.alternate,e!==null&&gf(e)===null&&(i=r),r=r.sibling;r=i,r===null?(i=t.child,t.child=null):(i=r.sibling,r.sibling=null),Ih(t,!1,i,r,s);break;case"backwards":for(r=null,i=t.child,t.child=null;i!==null;){if(e=i.alternate,e!==null&&gf(e)===null){t.child=i;break}e=i.sibling,i.sibling=r,r=i,i=e}Ih(t,!0,r,null,s);break;case"together":Ih(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Wu(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function _i(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),qs|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(re(153));if(t.child!==null){for(e=t.child,r=ss(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=ss(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function L4(e,t,r){switch(t.tag){case 3:f2(t),uo();break;case 5:Uw(t);break;case 1:Rr(t.type)&&uf(t);break;case 4:pm(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,i=t.memoizedProps.value;tt(df,n._currentValue),n._currentValue=i;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(tt(ft,ft.current&1),t.flags|=128,null):r&t.child.childLanes?h2(e,t,r):(tt(ft,ft.current&1),e=_i(e,t,r),e!==null?e.sibling:null);tt(ft,ft.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return d2(e,t,r);t.flags|=128}if(i=t.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),tt(ft,ft.current),n)break;return null;case 22:case 23:return t.lanes=0,c2(e,t,r)}return _i(e,t,r)}var p2,zd,m2,g2;p2=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};zd=function(){};m2=function(e,t,r,n){var i=e.memoizedProps;if(i!==n){e=t.stateNode,Ms(jn.current);var s=null;switch(r){case"input":i=hd(e,i),n=hd(e,n),s=[];break;case"select":i=mt({},i,{value:void 0}),n=mt({},n,{value:void 0}),s=[];break;case"textarea":i=md(e,i),n=md(e,n),s=[];break;default:typeof i.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=lf)}vd(r,n);var a;r=null;for(c in i)if(!n.hasOwnProperty(c)&&i.hasOwnProperty(c)&&i[c]!=null)if(c==="style"){var o=i[c];for(a in o)o.hasOwnProperty(a)&&(r||(r={}),r[a]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(Ll.hasOwnProperty(c)?s||(s=[]):(s=s||[]).push(c,null));for(c in n){var l=n[c];if(o=i!=null?i[c]:void 0,n.hasOwnProperty(c)&&l!==o&&(l!=null||o!=null))if(c==="style")if(o){for(a in o)!o.hasOwnProperty(a)||l&&l.hasOwnProperty(a)||(r||(r={}),r[a]="");for(a in l)l.hasOwnProperty(a)&&o[a]!==l[a]&&(r||(r={}),r[a]=l[a])}else r||(s||(s=[]),s.push(c,r)),r=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(s=s||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(Ll.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&nt("scroll",e),s||o===l||(s=[])):(s=s||[]).push(c,l))}r&&(s=s||[]).push("style",r);var c=s;(t.updateQueue=c)&&(t.flags|=4)}};g2=function(e,t,r,n){r!==n&&(t.flags|=4)};function Qo(e,t){if(!lt)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function nr(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var i=e.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags&14680064,n|=i.flags&14680064,i.return=e,i=i.sibling;else for(i=e.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function M4(e,t,r){var n=t.pendingProps;switch(om(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return nr(t),null;case 1:return Rr(t.type)&&cf(),nr(t),null;case 3:return n=t.stateNode,ho(),st(Nr),st(fr),gm(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(lu(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,xn!==null&&(Jd(xn),xn=null))),zd(e,t),nr(t),null;case 5:mm(t);var i=Ms(Xl.current);if(r=t.type,e!==null&&t.stateNode!=null)m2(e,t,r,n,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(re(166));return nr(t),null}if(e=Ms(jn.current),lu(t)){n=t.stateNode,r=t.type;var s=t.memoizedProps;switch(n[Un]=t,n[Gl]=s,e=(t.mode&1)!==0,r){case"dialog":nt("cancel",n),nt("close",n);break;case"iframe":case"object":case"embed":nt("load",n);break;case"video":case"audio":for(i=0;i<ol.length;i++)nt(ol[i],n);break;case"source":nt("error",n);break;case"img":case"image":case"link":nt("error",n),nt("load",n);break;case"details":nt("toggle",n);break;case"input":Og(n,s),nt("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},nt("invalid",n);break;case"textarea":bg(n,s),nt("invalid",n)}vd(r,s),i=null;for(var a in s)if(s.hasOwnProperty(a)){var o=s[a];a==="children"?typeof o=="string"?n.textContent!==o&&(s.suppressHydrationWarning!==!0&&ou(n.textContent,o,e),i=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(s.suppressHydrationWarning!==!0&&ou(n.textContent,o,e),i=["children",""+o]):Ll.hasOwnProperty(a)&&o!=null&&a==="onScroll"&&nt("scroll",n)}switch(r){case"input":Zc(n),Dg(n,s,!0);break;case"textarea":Zc(n),Lg(n);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(n.onclick=lf)}n=i,t.updateQueue=n,n!==null&&(t.flags|=4)}else{a=i.nodeType===9?i:i.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=zy(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=a.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=a.createElement(r,{is:n.is}):(e=a.createElement(r),r==="select"&&(a=e,n.multiple?a.multiple=!0:n.size&&(a.size=n.size))):e=a.createElementNS(e,r),e[Un]=t,e[Gl]=n,p2(e,t,!1,!1),t.stateNode=e;e:{switch(a=xd(r,n),r){case"dialog":nt("cancel",e),nt("close",e),i=n;break;case"iframe":case"object":case"embed":nt("load",e),i=n;break;case"video":case"audio":for(i=0;i<ol.length;i++)nt(ol[i],e);i=n;break;case"source":nt("error",e),i=n;break;case"img":case"image":case"link":nt("error",e),nt("load",e),i=n;break;case"details":nt("toggle",e),i=n;break;case"input":Og(e,n),i=hd(e,n),nt("invalid",e);break;case"option":i=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},i=mt({},n,{value:void 0}),nt("invalid",e);break;case"textarea":bg(e,n),i=md(e,n),nt("invalid",e);break;default:i=n}vd(r,i),o=i;for(s in o)if(o.hasOwnProperty(s)){var l=o[s];s==="style"?Ky(e,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&$y(e,l)):s==="children"?typeof l=="string"?(r!=="textarea"||l!=="")&&Ml(e,l):typeof l=="number"&&Ml(e,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Ll.hasOwnProperty(s)?l!=null&&s==="onScroll"&&nt("scroll",e):l!=null&&Gp(e,s,l,a))}switch(r){case"input":Zc(e),Dg(e,n,!1);break;case"textarea":Zc(e),Lg(e);break;case"option":n.value!=null&&e.setAttribute("value",""+us(n.value));break;case"select":e.multiple=!!n.multiple,s=n.value,s!=null?Ga(e,!!n.multiple,s,!1):n.defaultValue!=null&&Ga(e,!!n.multiple,n.defaultValue,!0);break;default:typeof i.onClick=="function"&&(e.onclick=lf)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return nr(t),null;case 6:if(e&&t.stateNode!=null)g2(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(re(166));if(r=Ms(Xl.current),Ms(jn.current),lu(t)){if(n=t.stateNode,r=t.memoizedProps,n[Un]=t,(s=n.nodeValue!==r)&&(e=Hr,e!==null))switch(e.tag){case 3:ou(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&ou(n.nodeValue,r,(e.mode&1)!==0)}s&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[Un]=t,t.stateNode=n}return nr(t),null;case 13:if(st(ft),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(lt&&Vr!==null&&t.mode&1&&!(t.flags&128))Dw(),uo(),t.flags|=98560,s=!1;else if(s=lu(t),n!==null&&n.dehydrated!==null){if(e===null){if(!s)throw Error(re(318));if(s=t.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(re(317));s[Un]=t}else uo(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;nr(t),s=!1}else xn!==null&&(Jd(xn),xn=null),s=!0;if(!s)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||ft.current&1?Lt===0&&(Lt=3):Am())),t.updateQueue!==null&&(t.flags|=4),nr(t),null);case 4:return ho(),zd(e,t),e===null&&zl(t.stateNode.containerInfo),nr(t),null;case 10:return fm(t.type._context),nr(t),null;case 17:return Rr(t.type)&&cf(),nr(t),null;case 19:if(st(ft),s=t.memoizedState,s===null)return nr(t),null;if(n=(t.flags&128)!==0,a=s.rendering,a===null)if(n)Qo(s,!1);else{if(Lt!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(a=gf(e),a!==null){for(t.flags|=128,Qo(s,!1),n=a.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)s=r,e=n,s.flags&=14680066,a=s.alternate,a===null?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=a.childLanes,s.lanes=a.lanes,s.child=a.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=a.memoizedProps,s.memoizedState=a.memoizedState,s.updateQueue=a.updateQueue,s.type=a.type,e=a.dependencies,s.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return tt(ft,ft.current&1|2),t.child}e=e.sibling}s.tail!==null&&St()>mo&&(t.flags|=128,n=!0,Qo(s,!1),t.lanes=4194304)}else{if(!n)if(e=gf(a),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),Qo(s,!0),s.tail===null&&s.tailMode==="hidden"&&!a.alternate&&!lt)return nr(t),null}else 2*St()-s.renderingStartTime>mo&&r!==1073741824&&(t.flags|=128,n=!0,Qo(s,!1),t.lanes=4194304);s.isBackwards?(a.sibling=t.child,t.child=a):(r=s.last,r!==null?r.sibling=a:t.child=a,s.last=a)}return s.tail!==null?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=St(),t.sibling=null,r=ft.current,tt(ft,n?r&1|2:r&1),t):(nr(t),null);case 22:case 23:return Im(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?Lr&1073741824&&(nr(t),t.subtreeFlags&6&&(t.flags|=8192)):nr(t),null;case 24:return null;case 25:return null}throw Error(re(156,t.tag))}function B4(e,t){switch(om(t),t.tag){case 1:return Rr(t.type)&&cf(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return ho(),st(Nr),st(fr),gm(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return mm(t),null;case 13:if(st(ft),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(re(340));uo()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return st(ft),null;case 4:return ho(),null;case 10:return fm(t.type._context),null;case 22:case 23:return Im(),null;case 24:return null;default:return null}}var fu=!1,or=!1,U4=typeof WeakSet=="function"?WeakSet:Set,ye=null;function Va(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){gt(e,t,n)}else r.current=null}function $d(e,t,r){try{r()}catch(n){gt(e,t,n)}}var Sv=!1;function W4(e,t){if(Ad=sf,e=ww(),sm(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var i=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{r.nodeType,s.nodeType}catch{r=null;break e}var a=0,o=-1,l=-1,c=0,u=0,f=e,h=null;t:for(;;){for(var d;f!==r||i!==0&&f.nodeType!==3||(o=a+i),f!==s||n!==0&&f.nodeType!==3||(l=a+n),f.nodeType===3&&(a+=f.nodeValue.length),(d=f.firstChild)!==null;)h=f,f=d;for(;;){if(f===e)break t;if(h===r&&++c===i&&(o=a),h===s&&++u===n&&(l=a),(d=f.nextSibling)!==null)break;f=h,h=f.parentNode}f=d}r=o===-1||l===-1?null:{start:o,end:l}}else r=null}r=r||{start:0,end:0}}else r=null;for(Fd={focusedElem:e,selectionRange:r},sf=!1,ye=t;ye!==null;)if(t=ye,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,ye=e;else for(;ye!==null;){t=ye;try{var m=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(m!==null){var p=m.memoizedProps,g=m.memoizedState,x=t.stateNode,_=x.getSnapshotBeforeUpdate(t.elementType===t.type?p:gn(t.type,p),g);x.__reactInternalSnapshotBeforeUpdate=_}break;case 3:var v=t.stateNode.containerInfo;v.nodeType===1?v.textContent="":v.nodeType===9&&v.documentElement&&v.removeChild(v.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(re(163))}}catch(E){gt(t,t.return,E)}if(e=t.sibling,e!==null){e.return=t.return,ye=e;break}ye=t.return}return m=Sv,Sv=!1,m}function _l(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var i=n=n.next;do{if((i.tag&e)===e){var s=i.destroy;i.destroy=void 0,s!==void 0&&$d(t,r,s)}i=i.next}while(i!==n)}}function _0(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function Gd(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function v2(e){var t=e.alternate;t!==null&&(e.alternate=null,v2(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Un],delete t[Gl],delete t[Pd],delete t[E4],delete t[k4])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function x2(e){return e.tag===5||e.tag===3||e.tag===4}function Cv(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||x2(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Kd(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=lf));else if(n!==4&&(e=e.child,e!==null))for(Kd(e,t,r),e=e.sibling;e!==null;)Kd(e,t,r),e=e.sibling}function Xd(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(Xd(e,t,r),e=e.sibling;e!==null;)Xd(e,t,r),e=e.sibling}var Xt=null,vn=!1;function Pi(e,t,r){for(r=r.child;r!==null;)_2(e,t,r),r=r.sibling}function _2(e,t,r){if(Vn&&typeof Vn.onCommitFiberUnmount=="function")try{Vn.onCommitFiberUnmount(f0,r)}catch{}switch(r.tag){case 5:or||Va(r,t);case 6:var n=Xt,i=vn;Xt=null,Pi(e,t,r),Xt=n,vn=i,Xt!==null&&(vn?(e=Xt,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):Xt.removeChild(r.stateNode));break;case 18:Xt!==null&&(vn?(e=Xt,r=r.stateNode,e.nodeType===8?yh(e.parentNode,r):e.nodeType===1&&yh(e,r),Vl(e)):yh(Xt,r.stateNode));break;case 4:n=Xt,i=vn,Xt=r.stateNode.containerInfo,vn=!0,Pi(e,t,r),Xt=n,vn=i;break;case 0:case 11:case 14:case 15:if(!or&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){i=n=n.next;do{var s=i,a=s.destroy;s=s.tag,a!==void 0&&(s&2||s&4)&&$d(r,t,a),i=i.next}while(i!==n)}Pi(e,t,r);break;case 1:if(!or&&(Va(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){gt(r,t,o)}Pi(e,t,r);break;case 21:Pi(e,t,r);break;case 22:r.mode&1?(or=(n=or)||r.memoizedState!==null,Pi(e,t,r),or=n):Pi(e,t,r);break;default:Pi(e,t,r)}}function Iv(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new U4),t.forEach(function(n){var i=Y4.bind(null,e,n);r.has(n)||(r.add(n),n.then(i,i))})}}function pn(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var i=r[n];try{var s=e,a=t,o=a;e:for(;o!==null;){switch(o.tag){case 5:Xt=o.stateNode,vn=!1;break e;case 3:Xt=o.stateNode.containerInfo,vn=!0;break e;case 4:Xt=o.stateNode.containerInfo,vn=!0;break e}o=o.return}if(Xt===null)throw Error(re(160));_2(s,a,i),Xt=null,vn=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(c){gt(i,t,c)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)y2(t,e),t=t.sibling}function y2(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(pn(t,e),Dn(e),n&4){try{_l(3,e,e.return),_0(3,e)}catch(p){gt(e,e.return,p)}try{_l(5,e,e.return)}catch(p){gt(e,e.return,p)}}break;case 1:pn(t,e),Dn(e),n&512&&r!==null&&Va(r,r.return);break;case 5:if(pn(t,e),Dn(e),n&512&&r!==null&&Va(r,r.return),e.flags&32){var i=e.stateNode;try{Ml(i,"")}catch(p){gt(e,e.return,p)}}if(n&4&&(i=e.stateNode,i!=null)){var s=e.memoizedProps,a=r!==null?r.memoizedProps:s,o=e.type,l=e.updateQueue;if(e.updateQueue=null,l!==null)try{o==="input"&&s.type==="radio"&&s.name!=null&&jy(i,s),xd(o,a);var c=xd(o,s);for(a=0;a<l.length;a+=2){var u=l[a],f=l[a+1];u==="style"?Ky(i,f):u==="dangerouslySetInnerHTML"?$y(i,f):u==="children"?Ml(i,f):Gp(i,u,f,c)}switch(o){case"input":dd(i,s);break;case"textarea":Hy(i,s);break;case"select":var h=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var d=s.value;d!=null?Ga(i,!!s.multiple,d,!1):h!==!!s.multiple&&(s.defaultValue!=null?Ga(i,!!s.multiple,s.defaultValue,!0):Ga(i,!!s.multiple,s.multiple?[]:"",!1))}i[Gl]=s}catch(p){gt(e,e.return,p)}}break;case 6:if(pn(t,e),Dn(e),n&4){if(e.stateNode===null)throw Error(re(162));i=e.stateNode,s=e.memoizedProps;try{i.nodeValue=s}catch(p){gt(e,e.return,p)}}break;case 3:if(pn(t,e),Dn(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{Vl(t.containerInfo)}catch(p){gt(e,e.return,p)}break;case 4:pn(t,e),Dn(e);break;case 13:pn(t,e),Dn(e),i=e.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(Sm=St())),n&4&&Iv(e);break;case 22:if(u=r!==null&&r.memoizedState!==null,e.mode&1?(or=(c=or)||u,pn(t,e),or=c):pn(t,e),Dn(e),n&8192){if(c=e.memoizedState!==null,(e.stateNode.isHidden=c)&&!u&&e.mode&1)for(ye=e,u=e.child;u!==null;){for(f=ye=u;ye!==null;){switch(h=ye,d=h.child,h.tag){case 0:case 11:case 14:case 15:_l(4,h,h.return);break;case 1:Va(h,h.return);var m=h.stateNode;if(typeof m.componentWillUnmount=="function"){n=h,r=h.return;try{t=n,m.props=t.memoizedProps,m.state=t.memoizedState,m.componentWillUnmount()}catch(p){gt(n,r,p)}}break;case 5:Va(h,h.return);break;case 22:if(h.memoizedState!==null){Fv(f);continue}}d!==null?(d.return=h,ye=d):Fv(f)}u=u.sibling}e:for(u=null,f=e;;){if(f.tag===5){if(u===null){u=f;try{i=f.stateNode,c?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(o=f.stateNode,l=f.memoizedProps.style,a=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=Gy("display",a))}catch(p){gt(e,e.return,p)}}}else if(f.tag===6){if(u===null)try{f.stateNode.nodeValue=c?"":f.memoizedProps}catch(p){gt(e,e.return,p)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===e)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===e)break e;for(;f.sibling===null;){if(f.return===null||f.return===e)break e;u===f&&(u=null),f=f.return}u===f&&(u=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:pn(t,e),Dn(e),n&4&&Iv(e);break;case 21:break;default:pn(t,e),Dn(e)}}function Dn(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(x2(r)){var n=r;break e}r=r.return}throw Error(re(160))}switch(n.tag){case 5:var i=n.stateNode;n.flags&32&&(Ml(i,""),n.flags&=-33);var s=Cv(e);Xd(e,s,i);break;case 3:case 4:var a=n.stateNode.containerInfo,o=Cv(e);Kd(e,o,a);break;default:throw Error(re(161))}}catch(l){gt(e,e.return,l)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function V4(e,t,r){ye=e,w2(e)}function w2(e,t,r){for(var n=(e.mode&1)!==0;ye!==null;){var i=ye,s=i.child;if(i.tag===22&&n){var a=i.memoizedState!==null||fu;if(!a){var o=i.alternate,l=o!==null&&o.memoizedState!==null||or;o=fu;var c=or;if(fu=a,(or=l)&&!c)for(ye=i;ye!==null;)a=ye,l=a.child,a.tag===22&&a.memoizedState!==null?Nv(i):l!==null?(l.return=a,ye=l):Nv(i);for(;s!==null;)ye=s,w2(s),s=s.sibling;ye=i,fu=o,or=c}Av(e)}else i.subtreeFlags&8772&&s!==null?(s.return=i,ye=s):Av(e)}}function Av(e){for(;ye!==null;){var t=ye;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:or||_0(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!or)if(r===null)n.componentDidMount();else{var i=t.elementType===t.type?r.memoizedProps:gn(t.type,r.memoizedProps);n.componentDidUpdate(i,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;s!==null&&hv(t,s,n);break;case 3:var a=t.updateQueue;if(a!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}hv(t,a,r)}break;case 5:var o=t.stateNode;if(r===null&&t.flags&4){r=o;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&r.focus();break;case"img":l.src&&(r.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var c=t.alternate;if(c!==null){var u=c.memoizedState;if(u!==null){var f=u.dehydrated;f!==null&&Vl(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(re(163))}or||t.flags&512&&Gd(t)}catch(h){gt(t,t.return,h)}}if(t===e){ye=null;break}if(r=t.sibling,r!==null){r.return=t.return,ye=r;break}ye=t.return}}function Fv(e){for(;ye!==null;){var t=ye;if(t===e){ye=null;break}var r=t.sibling;if(r!==null){r.return=t.return,ye=r;break}ye=t.return}}function Nv(e){for(;ye!==null;){var t=ye;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{_0(4,t)}catch(l){gt(t,r,l)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var i=t.return;try{n.componentDidMount()}catch(l){gt(t,i,l)}}var s=t.return;try{Gd(t)}catch(l){gt(t,s,l)}break;case 5:var a=t.return;try{Gd(t)}catch(l){gt(t,a,l)}}}catch(l){gt(t,t.return,l)}if(t===e){ye=null;break}var o=t.sibling;if(o!==null){o.return=t.return,ye=o;break}ye=t.return}}var j4=Math.ceil,_f=Si.ReactCurrentDispatcher,km=Si.ReactCurrentOwner,ln=Si.ReactCurrentBatchConfig,We=0,Gt=null,Rt=null,Jt=0,Lr=0,ja=ys(0),Lt=0,Jl=null,qs=0,y0=0,Tm=0,yl=null,Cr=null,Sm=0,mo=1/0,ti=null,yf=!1,Yd=null,ns=null,hu=!1,Gi=null,wf=0,wl=0,qd=null,Vu=-1,ju=0;function _r(){return We&6?St():Vu!==-1?Vu:Vu=St()}function is(e){return e.mode&1?We&2&&Jt!==0?Jt&-Jt:S4.transition!==null?(ju===0&&(ju=sw()),ju):(e=Xe,e!==0||(e=window.event,e=e===void 0?16:hw(e.type)),e):1}function Sn(e,t,r,n){if(50<wl)throw wl=0,qd=null,Error(re(185));Cc(e,r,n),(!(We&2)||e!==Gt)&&(e===Gt&&(!(We&2)&&(y0|=r),Lt===4&&Bi(e,Jt)),Pr(e,n),r===1&&We===0&&!(t.mode&1)&&(mo=St()+500,g0&&ws()))}function Pr(e,t){var r=e.callbackNode;SI(e,t);var n=nf(e,e===Gt?Jt:0);if(n===0)r!==null&&Ug(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&Ug(r),t===1)e.tag===0?T4(Rv.bind(null,e)):Rw(Rv.bind(null,e)),y4(function(){!(We&6)&&ws()}),r=null;else{switch(aw(n)){case 1:r=Qp;break;case 4:r=nw;break;case 16:r=rf;break;case 536870912:r=iw;break;default:r=rf}r=F2(r,E2.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function E2(e,t){if(Vu=-1,ju=0,We&6)throw Error(re(327));var r=e.callbackNode;if(Qa()&&e.callbackNode!==r)return null;var n=nf(e,e===Gt?Jt:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=Ef(e,n);else{t=n;var i=We;We|=2;var s=T2();(Gt!==e||Jt!==t)&&(ti=null,mo=St()+500,Ws(e,t));do try{$4();break}catch(o){k2(e,o)}while(!0);um(),_f.current=s,We=i,Rt!==null?t=0:(Gt=null,Jt=0,t=Lt)}if(t!==0){if(t===2&&(i=kd(e),i!==0&&(n=i,t=Qd(e,i))),t===1)throw r=Jl,Ws(e,0),Bi(e,n),Pr(e,St()),r;if(t===6)Bi(e,n);else{if(i=e.current.alternate,!(n&30)&&!H4(i)&&(t=Ef(e,n),t===2&&(s=kd(e),s!==0&&(n=s,t=Qd(e,s))),t===1))throw r=Jl,Ws(e,0),Bi(e,n),Pr(e,St()),r;switch(e.finishedWork=i,e.finishedLanes=n,t){case 0:case 1:throw Error(re(345));case 2:Rs(e,Cr,ti);break;case 3:if(Bi(e,n),(n&130023424)===n&&(t=Sm+500-St(),10<t)){if(nf(e,0)!==0)break;if(i=e.suspendedLanes,(i&n)!==n){_r(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=Rd(Rs.bind(null,e,Cr,ti),t);break}Rs(e,Cr,ti);break;case 4:if(Bi(e,n),(n&4194240)===n)break;for(t=e.eventTimes,i=-1;0<n;){var a=31-Tn(n);s=1<<a,a=t[a],a>i&&(i=a),n&=~s}if(n=i,n=St()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*j4(n/1960))-n,10<n){e.timeoutHandle=Rd(Rs.bind(null,e,Cr,ti),n);break}Rs(e,Cr,ti);break;case 5:Rs(e,Cr,ti);break;default:throw Error(re(329))}}}return Pr(e,St()),e.callbackNode===r?E2.bind(null,e):null}function Qd(e,t){var r=yl;return e.current.memoizedState.isDehydrated&&(Ws(e,t).flags|=256),e=Ef(e,t),e!==2&&(t=Cr,Cr=r,t!==null&&Jd(t)),e}function Jd(e){Cr===null?Cr=e:Cr.push.apply(Cr,e)}function H4(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var i=r[n],s=i.getSnapshot;i=i.value;try{if(!Fn(s(),i))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Bi(e,t){for(t&=~Tm,t&=~y0,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-Tn(t),n=1<<r;e[r]=-1,t&=~n}}function Rv(e){if(We&6)throw Error(re(327));Qa();var t=nf(e,0);if(!(t&1))return Pr(e,St()),null;var r=Ef(e,t);if(e.tag!==0&&r===2){var n=kd(e);n!==0&&(t=n,r=Qd(e,n))}if(r===1)throw r=Jl,Ws(e,0),Bi(e,t),Pr(e,St()),r;if(r===6)throw Error(re(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Rs(e,Cr,ti),Pr(e,St()),null}function Cm(e,t){var r=We;We|=1;try{return e(t)}finally{We=r,We===0&&(mo=St()+500,g0&&ws())}}function Qs(e){Gi!==null&&Gi.tag===0&&!(We&6)&&Qa();var t=We;We|=1;var r=ln.transition,n=Xe;try{if(ln.transition=null,Xe=1,e)return e()}finally{Xe=n,ln.transition=r,We=t,!(We&6)&&ws()}}function Im(){Lr=ja.current,st(ja)}function Ws(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,_4(r)),Rt!==null)for(r=Rt.return;r!==null;){var n=r;switch(om(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&cf();break;case 3:ho(),st(Nr),st(fr),gm();break;case 5:mm(n);break;case 4:ho();break;case 13:st(ft);break;case 19:st(ft);break;case 10:fm(n.type._context);break;case 22:case 23:Im()}r=r.return}if(Gt=e,Rt=e=ss(e.current,null),Jt=Lr=t,Lt=0,Jl=null,Tm=y0=qs=0,Cr=yl=null,Ls!==null){for(t=0;t<Ls.length;t++)if(r=Ls[t],n=r.interleaved,n!==null){r.interleaved=null;var i=n.next,s=r.pending;if(s!==null){var a=s.next;s.next=i,n.next=a}r.pending=n}Ls=null}return e}function k2(e,t){do{var r=Rt;try{if(um(),Bu.current=xf,vf){for(var n=pt.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}vf=!1}if(Ys=0,Wt=Dt=pt=null,xl=!1,Yl=0,km.current=null,r===null||r.return===null){Lt=1,Jl=t,Rt=null;break}e:{var s=e,a=r.return,o=r,l=t;if(t=Jt,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,u=o,f=u.tag;if(!(u.mode&1)&&(f===0||f===11||f===15)){var h=u.alternate;h?(u.updateQueue=h.updateQueue,u.memoizedState=h.memoizedState,u.lanes=h.lanes):(u.updateQueue=null,u.memoizedState=null)}var d=xv(a);if(d!==null){d.flags&=-257,_v(d,a,o,s,t),d.mode&1&&vv(s,c,t),t=d,l=c;var m=t.updateQueue;if(m===null){var p=new Set;p.add(l),t.updateQueue=p}else m.add(l);break e}else{if(!(t&1)){vv(s,c,t),Am();break e}l=Error(re(426))}}else if(lt&&o.mode&1){var g=xv(a);if(g!==null){!(g.flags&65536)&&(g.flags|=256),_v(g,a,o,s,t),lm(po(l,o));break e}}s=l=po(l,o),Lt!==4&&(Lt=2),yl===null?yl=[s]:yl.push(s),s=a;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t;var x=a2(s,l,t);fv(s,x);break e;case 1:o=l;var _=s.type,v=s.stateNode;if(!(s.flags&128)&&(typeof _.getDerivedStateFromError=="function"||v!==null&&typeof v.componentDidCatch=="function"&&(ns===null||!ns.has(v)))){s.flags|=65536,t&=-t,s.lanes|=t;var E=o2(s,o,t);fv(s,E);break e}}s=s.return}while(s!==null)}C2(r)}catch(N){t=N,Rt===r&&r!==null&&(Rt=r=r.return);continue}break}while(!0)}function T2(){var e=_f.current;return _f.current=xf,e===null?xf:e}function Am(){(Lt===0||Lt===3||Lt===2)&&(Lt=4),Gt===null||!(qs&268435455)&&!(y0&268435455)||Bi(Gt,Jt)}function Ef(e,t){var r=We;We|=2;var n=T2();(Gt!==e||Jt!==t)&&(ti=null,Ws(e,t));do try{z4();break}catch(i){k2(e,i)}while(!0);if(um(),We=r,_f.current=n,Rt!==null)throw Error(re(261));return Gt=null,Jt=0,Lt}function z4(){for(;Rt!==null;)S2(Rt)}function $4(){for(;Rt!==null&&!gI();)S2(Rt)}function S2(e){var t=A2(e.alternate,e,Lr);e.memoizedProps=e.pendingProps,t===null?C2(e):Rt=t,km.current=null}function C2(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=B4(r,t),r!==null){r.flags&=32767,Rt=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Lt=6,Rt=null;return}}else if(r=M4(r,t,Lr),r!==null){Rt=r;return}if(t=t.sibling,t!==null){Rt=t;return}Rt=t=e}while(t!==null);Lt===0&&(Lt=5)}function Rs(e,t,r){var n=Xe,i=ln.transition;try{ln.transition=null,Xe=1,G4(e,t,r,n)}finally{ln.transition=i,Xe=n}return null}function G4(e,t,r,n){do Qa();while(Gi!==null);if(We&6)throw Error(re(327));r=e.finishedWork;var i=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(re(177));e.callbackNode=null,e.callbackPriority=0;var s=r.lanes|r.childLanes;if(CI(e,s),e===Gt&&(Rt=Gt=null,Jt=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||hu||(hu=!0,F2(rf,function(){return Qa(),null})),s=(r.flags&15990)!==0,r.subtreeFlags&15990||s){s=ln.transition,ln.transition=null;var a=Xe;Xe=1;var o=We;We|=4,km.current=null,W4(e,r),y2(r,e),h4(Fd),sf=!!Ad,Fd=Ad=null,e.current=r,V4(r),vI(),We=o,Xe=a,ln.transition=s}else e.current=r;if(hu&&(hu=!1,Gi=e,wf=i),s=e.pendingLanes,s===0&&(ns=null),yI(r.stateNode),Pr(e,St()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)i=t[r],n(i.value,{componentStack:i.stack,digest:i.digest});if(yf)throw yf=!1,e=Yd,Yd=null,e;return wf&1&&e.tag!==0&&Qa(),s=e.pendingLanes,s&1?e===qd?wl++:(wl=0,qd=e):wl=0,ws(),null}function Qa(){if(Gi!==null){var e=aw(wf),t=ln.transition,r=Xe;try{if(ln.transition=null,Xe=16>e?16:e,Gi===null)var n=!1;else{if(e=Gi,Gi=null,wf=0,We&6)throw Error(re(331));var i=We;for(We|=4,ye=e.current;ye!==null;){var s=ye,a=s.child;if(ye.flags&16){var o=s.deletions;if(o!==null){for(var l=0;l<o.length;l++){var c=o[l];for(ye=c;ye!==null;){var u=ye;switch(u.tag){case 0:case 11:case 15:_l(8,u,s)}var f=u.child;if(f!==null)f.return=u,ye=f;else for(;ye!==null;){u=ye;var h=u.sibling,d=u.return;if(v2(u),u===c){ye=null;break}if(h!==null){h.return=d,ye=h;break}ye=d}}}var m=s.alternate;if(m!==null){var p=m.child;if(p!==null){m.child=null;do{var g=p.sibling;p.sibling=null,p=g}while(p!==null)}}ye=s}}if(s.subtreeFlags&2064&&a!==null)a.return=s,ye=a;else e:for(;ye!==null;){if(s=ye,s.flags&2048)switch(s.tag){case 0:case 11:case 15:_l(9,s,s.return)}var x=s.sibling;if(x!==null){x.return=s.return,ye=x;break e}ye=s.return}}var _=e.current;for(ye=_;ye!==null;){a=ye;var v=a.child;if(a.subtreeFlags&2064&&v!==null)v.return=a,ye=v;else e:for(a=_;ye!==null;){if(o=ye,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:_0(9,o)}}catch(N){gt(o,o.return,N)}if(o===a){ye=null;break e}var E=o.sibling;if(E!==null){E.return=o.return,ye=E;break e}ye=o.return}}if(We=i,ws(),Vn&&typeof Vn.onPostCommitFiberRoot=="function")try{Vn.onPostCommitFiberRoot(f0,e)}catch{}n=!0}return n}finally{Xe=r,ln.transition=t}}return!1}function Pv(e,t,r){t=po(r,t),t=a2(e,t,1),e=rs(e,t,1),t=_r(),e!==null&&(Cc(e,1,t),Pr(e,t))}function gt(e,t,r){if(e.tag===3)Pv(e,e,r);else for(;t!==null;){if(t.tag===3){Pv(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(ns===null||!ns.has(n))){e=po(r,e),e=o2(t,e,1),t=rs(t,e,1),e=_r(),t!==null&&(Cc(t,1,e),Pr(t,e));break}}t=t.return}}function K4(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=_r(),e.pingedLanes|=e.suspendedLanes&r,Gt===e&&(Jt&r)===r&&(Lt===4||Lt===3&&(Jt&130023424)===Jt&&500>St()-Sm?Ws(e,0):Tm|=r),Pr(e,t)}function I2(e,t){t===0&&(e.mode&1?(t=ru,ru<<=1,!(ru&130023424)&&(ru=4194304)):t=1);var r=_r();e=xi(e,t),e!==null&&(Cc(e,t,r),Pr(e,r))}function X4(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),I2(e,r)}function Y4(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,i=e.memoizedState;i!==null&&(r=i.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(re(314))}n!==null&&n.delete(t),I2(e,r)}var A2;A2=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||Nr.current)Ir=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return Ir=!1,L4(e,t,r);Ir=!!(e.flags&131072)}else Ir=!1,lt&&t.flags&1048576&&Pw(t,hf,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;Wu(e,t),e=t.pendingProps;var i=co(t,fr.current);qa(t,r),i=xm(null,t,n,e,i,r);var s=_m();return t.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Rr(n)?(s=!0,uf(t)):s=!1,t.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,dm(t),i.updater=x0,t.stateNode=i,i._reactInternals=t,Bd(t,n,e,r),t=Vd(null,t,n,!0,s,r)):(t.tag=0,lt&&s&&am(t),gr(null,t,i,r),t=t.child),t;case 16:n=t.elementType;e:{switch(Wu(e,t),e=t.pendingProps,i=n._init,n=i(n._payload),t.type=n,i=t.tag=Q4(n),e=gn(n,e),i){case 0:t=Wd(null,t,n,e,r);break e;case 1:t=Ev(null,t,n,e,r);break e;case 11:t=yv(null,t,n,e,r);break e;case 14:t=wv(null,t,n,gn(n.type,e),r);break e}throw Error(re(306,n,""))}return t;case 0:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:gn(n,i),Wd(e,t,n,i,r);case 1:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:gn(n,i),Ev(e,t,n,i,r);case 3:e:{if(f2(t),e===null)throw Error(re(387));n=t.pendingProps,s=t.memoizedState,i=s.element,Bw(e,t),mf(t,n,null,r);var a=t.memoizedState;if(n=a.element,s.isDehydrated)if(s={element:n,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},t.updateQueue.baseState=s,t.memoizedState=s,t.flags&256){i=po(Error(re(423)),t),t=kv(e,t,n,r,i);break e}else if(n!==i){i=po(Error(re(424)),t),t=kv(e,t,n,r,i);break e}else for(Vr=ts(t.stateNode.containerInfo.firstChild),Hr=t,lt=!0,xn=null,r=Lw(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(uo(),n===i){t=_i(e,t,r);break e}gr(e,t,n,r)}t=t.child}return t;case 5:return Uw(t),e===null&&bd(t),n=t.type,i=t.pendingProps,s=e!==null?e.memoizedProps:null,a=i.children,Nd(n,i)?a=null:s!==null&&Nd(n,s)&&(t.flags|=32),u2(e,t),gr(e,t,a,r),t.child;case 6:return e===null&&bd(t),null;case 13:return h2(e,t,r);case 4:return pm(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=fo(t,null,n,r):gr(e,t,n,r),t.child;case 11:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:gn(n,i),yv(e,t,n,i,r);case 7:return gr(e,t,t.pendingProps,r),t.child;case 8:return gr(e,t,t.pendingProps.children,r),t.child;case 12:return gr(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,i=t.pendingProps,s=t.memoizedProps,a=i.value,tt(df,n._currentValue),n._currentValue=a,s!==null)if(Fn(s.value,a)){if(s.children===i.children&&!Nr.current){t=_i(e,t,r);break e}}else for(s=t.child,s!==null&&(s.return=t);s!==null;){var o=s.dependencies;if(o!==null){a=s.child;for(var l=o.firstContext;l!==null;){if(l.context===n){if(s.tag===1){l=fi(-1,r&-r),l.tag=2;var c=s.updateQueue;if(c!==null){c=c.shared;var u=c.pending;u===null?l.next=l:(l.next=u.next,u.next=l),c.pending=l}}s.lanes|=r,l=s.alternate,l!==null&&(l.lanes|=r),Ld(s.return,r,t),o.lanes|=r;break}l=l.next}}else if(s.tag===10)a=s.type===t.type?null:s.child;else if(s.tag===18){if(a=s.return,a===null)throw Error(re(341));a.lanes|=r,o=a.alternate,o!==null&&(o.lanes|=r),Ld(a,r,t),a=s.sibling}else a=s.child;if(a!==null)a.return=s;else for(a=s;a!==null;){if(a===t){a=null;break}if(s=a.sibling,s!==null){s.return=a.return,a=s;break}a=a.return}s=a}gr(e,t,i.children,r),t=t.child}return t;case 9:return i=t.type,n=t.pendingProps.children,qa(t,r),i=un(i),n=n(i),t.flags|=1,gr(e,t,n,r),t.child;case 14:return n=t.type,i=gn(n,t.pendingProps),i=gn(n.type,i),wv(e,t,n,i,r);case 15:return l2(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:gn(n,i),Wu(e,t),t.tag=1,Rr(n)?(e=!0,uf(t)):e=!1,qa(t,r),s2(t,n,i),Bd(t,n,i,r),Vd(null,t,n,!0,e,r);case 19:return d2(e,t,r);case 22:return c2(e,t,r)}throw Error(re(156,t.tag))};function F2(e,t){return rw(e,t)}function q4(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function an(e,t,r,n){return new q4(e,t,r,n)}function Fm(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Q4(e){if(typeof e=="function")return Fm(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Xp)return 11;if(e===Yp)return 14}return 2}function ss(e,t){var r=e.alternate;return r===null?(r=an(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function Hu(e,t,r,n,i,s){var a=2;if(n=e,typeof e=="function")Fm(e)&&(a=1);else if(typeof e=="string")a=5;else e:switch(e){case Pa:return Vs(r.children,i,s,t);case Kp:a=8,i|=8;break;case ld:return e=an(12,r,t,i|2),e.elementType=ld,e.lanes=s,e;case cd:return e=an(13,r,t,i),e.elementType=cd,e.lanes=s,e;case ud:return e=an(19,r,t,i),e.elementType=ud,e.lanes=s,e;case Uy:return w0(r,i,s,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case My:a=10;break e;case By:a=9;break e;case Xp:a=11;break e;case Yp:a=14;break e;case bi:a=16,n=null;break e}throw Error(re(130,e==null?e:typeof e,""))}return t=an(a,r,t,i),t.elementType=e,t.type=n,t.lanes=s,t}function Vs(e,t,r,n){return e=an(7,e,n,t),e.lanes=r,e}function w0(e,t,r,n){return e=an(22,e,n,t),e.elementType=Uy,e.lanes=r,e.stateNode={isHidden:!1},e}function Ah(e,t,r){return e=an(6,e,null,t),e.lanes=r,e}function Fh(e,t,r){return t=an(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function J4(e,t,r,n,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ch(0),this.expirationTimes=ch(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ch(0),this.identifierPrefix=n,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Nm(e,t,r,n,i,s,a,o,l){return e=new J4(e,t,r,o,l),t===1?(t=1,s===!0&&(t|=8)):t=0,s=an(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},dm(s),e}function Z4(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ra,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function N2(e){if(!e)return fs;e=e._reactInternals;e:{if(fa(e)!==e||e.tag!==1)throw Error(re(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Rr(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(re(171))}if(e.tag===1){var r=e.type;if(Rr(r))return Nw(e,r,t)}return t}function R2(e,t,r,n,i,s,a,o,l){return e=Nm(r,n,!0,e,i,s,a,o,l),e.context=N2(null),r=e.current,n=_r(),i=is(r),s=fi(n,i),s.callback=t??null,rs(r,s,i),e.current.lanes=i,Cc(e,i,n),Pr(e,n),e}function E0(e,t,r,n){var i=t.current,s=_r(),a=is(i);return r=N2(r),t.context===null?t.context=r:t.pendingContext=r,t=fi(s,a),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=rs(i,t,a),e!==null&&(Sn(e,i,a,s),Mu(e,i,a)),a}function kf(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Ov(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function Rm(e,t){Ov(e,t),(e=e.alternate)&&Ov(e,t)}function eA(){return null}var P2=typeof reportError=="function"?reportError:function(e){console.error(e)};function Pm(e){this._internalRoot=e}k0.prototype.render=Pm.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(re(409));E0(e,t,null,null)};k0.prototype.unmount=Pm.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Qs(function(){E0(null,e,null,null)}),t[vi]=null}};function k0(e){this._internalRoot=e}k0.prototype.unstable_scheduleHydration=function(e){if(e){var t=cw();e={blockedOn:null,target:e,priority:t};for(var r=0;r<Mi.length&&t!==0&&t<Mi[r].priority;r++);Mi.splice(r,0,e),r===0&&fw(e)}};function Om(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function T0(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Dv(){}function tA(e,t,r,n,i){if(i){if(typeof n=="function"){var s=n;n=function(){var c=kf(a);s.call(c)}}var a=R2(t,n,e,0,null,!1,!1,"",Dv);return e._reactRootContainer=a,e[vi]=a.current,zl(e.nodeType===8?e.parentNode:e),Qs(),a}for(;i=e.lastChild;)e.removeChild(i);if(typeof n=="function"){var o=n;n=function(){var c=kf(l);o.call(c)}}var l=Nm(e,0,!1,null,null,!1,!1,"",Dv);return e._reactRootContainer=l,e[vi]=l.current,zl(e.nodeType===8?e.parentNode:e),Qs(function(){E0(t,l,r,n)}),l}function S0(e,t,r,n,i){var s=r._reactRootContainer;if(s){var a=s;if(typeof i=="function"){var o=i;i=function(){var l=kf(a);o.call(l)}}E0(t,a,e,i)}else a=tA(r,t,e,i,n);return kf(a)}ow=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=al(t.pendingLanes);r!==0&&(Jp(t,r|1),Pr(t,St()),!(We&6)&&(mo=St()+500,ws()))}break;case 13:Qs(function(){var n=xi(e,1);if(n!==null){var i=_r();Sn(n,e,1,i)}}),Rm(e,1)}};Zp=function(e){if(e.tag===13){var t=xi(e,134217728);if(t!==null){var r=_r();Sn(t,e,134217728,r)}Rm(e,134217728)}};lw=function(e){if(e.tag===13){var t=is(e),r=xi(e,t);if(r!==null){var n=_r();Sn(r,e,t,n)}Rm(e,t)}};cw=function(){return Xe};uw=function(e,t){var r=Xe;try{return Xe=e,t()}finally{Xe=r}};yd=function(e,t,r){switch(t){case"input":if(dd(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var i=m0(n);if(!i)throw Error(re(90));Vy(n),dd(n,i)}}}break;case"textarea":Hy(e,r);break;case"select":t=r.value,t!=null&&Ga(e,!!r.multiple,t,!1)}};qy=Cm;Qy=Qs;var rA={usingClientEntryPoint:!1,Events:[Ac,La,m0,Xy,Yy,Cm]},Jo={findFiberByHostInstance:bs,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},nA={bundleType:Jo.bundleType,version:Jo.version,rendererPackageName:Jo.rendererPackageName,rendererConfig:Jo.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Si.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=ew(e),e===null?null:e.stateNode},findFiberByHostInstance:Jo.findFiberByHostInstance||eA,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var du=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!du.isDisabled&&du.supportsFiber)try{f0=du.inject(nA),Vn=du}catch{}}Gr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=rA;Gr.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Om(t))throw Error(re(200));return Z4(e,t,null,r)};Gr.createRoot=function(e,t){if(!Om(e))throw Error(re(299));var r=!1,n="",i=P2;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(i=t.onRecoverableError)),t=Nm(e,1,!1,null,null,r,!1,n,i),e[vi]=t.current,zl(e.nodeType===8?e.parentNode:e),new Pm(t)};Gr.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(re(188)):(e=Object.keys(e).join(","),Error(re(268,e)));return e=ew(t),e=e===null?null:e.stateNode,e};Gr.flushSync=function(e){return Qs(e)};Gr.hydrate=function(e,t,r){if(!T0(t))throw Error(re(200));return S0(null,e,t,!0,r)};Gr.hydrateRoot=function(e,t,r){if(!Om(e))throw Error(re(405));var n=r!=null&&r.hydratedSources||null,i=!1,s="",a=P2;if(r!=null&&(r.unstable_strictMode===!0&&(i=!0),r.identifierPrefix!==void 0&&(s=r.identifierPrefix),r.onRecoverableError!==void 0&&(a=r.onRecoverableError)),t=R2(t,null,e,1,r??null,i,!1,s,a),e[vi]=t.current,zl(e),n)for(e=0;e<n.length;e++)r=n[e],i=r._getVersion,i=i(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,i]:t.mutableSourceEagerHydrationData.push(r,i);return new k0(t)};Gr.render=function(e,t,r){if(!T0(t))throw Error(re(200));return S0(null,e,t,!1,r)};Gr.unmountComponentAtNode=function(e){if(!T0(e))throw Error(re(40));return e._reactRootContainer?(Qs(function(){S0(null,null,e,!1,function(){e._reactRootContainer=null,e[vi]=null})}),!0):!1};Gr.unstable_batchedUpdates=Cm;Gr.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!T0(r))throw Error(re(200));if(e==null||e._reactInternals===void 0)throw Error(re(38));return S0(e,t,r,!1,n)};Gr.version="18.3.1-next-f1338f8080-20240426";function O2(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(O2)}catch(e){console.error(e)}}O2(),Oy.exports=Gr;var iA=Oy.exports,D2,bv=iA;D2=bv.createRoot,bv.hydrateRoot;/**
 * @remix-run/router v1.21.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Zl(){return Zl=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Zl.apply(this,arguments)}var Ki;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(Ki||(Ki={}));const Lv="popstate";function sA(e){e===void 0&&(e={});function t(i,s){let{pathname:a="/",search:o="",hash:l=""}=ha(i.location.hash.substr(1));return!a.startsWith("/")&&!a.startsWith(".")&&(a="/"+a),Zd("",{pathname:a,search:o,hash:l},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function r(i,s){let a=i.document.querySelector("base"),o="";if(a&&a.getAttribute("href")){let l=i.location.href,c=l.indexOf("#");o=c===-1?l:l.slice(0,c)}return o+"#"+(typeof s=="string"?s:b2(s))}function n(i,s){Dm(i.pathname.charAt(0)==="/","relative pathnames are not supported in hash history.push("+JSON.stringify(s)+")")}return oA(t,r,n,e)}function Pt(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function Dm(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function aA(){return Math.random().toString(36).substr(2,8)}function Mv(e,t){return{usr:e.state,key:e.key,idx:t}}function Zd(e,t,r,n){return r===void 0&&(r=null),Zl({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?ha(t):t,{state:r,key:t&&t.key||n||aA()})}function b2(e){let{pathname:t="/",search:r="",hash:n=""}=e;return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function ha(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substr(n),e=e.substr(0,n)),e&&(t.pathname=e)}return t}function oA(e,t,r,n){n===void 0&&(n={});let{window:i=document.defaultView,v5Compat:s=!1}=n,a=i.history,o=Ki.Pop,l=null,c=u();c==null&&(c=0,a.replaceState(Zl({},a.state,{idx:c}),""));function u(){return(a.state||{idx:null}).idx}function f(){o=Ki.Pop;let g=u(),x=g==null?null:g-c;c=g,l&&l({action:o,location:p.location,delta:x})}function h(g,x){o=Ki.Push;let _=Zd(p.location,g,x);r&&r(_,g),c=u()+1;let v=Mv(_,c),E=p.createHref(_);try{a.pushState(v,"",E)}catch(N){if(N instanceof DOMException&&N.name==="DataCloneError")throw N;i.location.assign(E)}s&&l&&l({action:o,location:p.location,delta:1})}function d(g,x){o=Ki.Replace;let _=Zd(p.location,g,x);r&&r(_,g),c=u();let v=Mv(_,c),E=p.createHref(_);a.replaceState(v,"",E),s&&l&&l({action:o,location:p.location,delta:0})}function m(g){let x=i.location.origin!=="null"?i.location.origin:i.location.href,_=typeof g=="string"?g:b2(g);return _=_.replace(/ $/,"%20"),Pt(x,"No window.location.(origin|href) available to create URL for href: "+_),new URL(_,x)}let p={get action(){return o},get location(){return e(i,a)},listen(g){if(l)throw new Error("A history only accepts one active listener");return i.addEventListener(Lv,f),l=g,()=>{i.removeEventListener(Lv,f),l=null}},createHref(g){return t(i,g)},createURL:m,encodeLocation(g){let x=m(g);return{pathname:x.pathname,search:x.search,hash:x.hash}},push:h,replace:d,go(g){return a.go(g)}};return p}var Bv;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(Bv||(Bv={}));function lA(e,t,r){return r===void 0&&(r="/"),cA(e,t,r,!1)}function cA(e,t,r,n){let i=typeof t=="string"?ha(t):t,s=B2(i.pathname||"/",r);if(s==null)return null;let a=L2(e);uA(a);let o=null;for(let l=0;o==null&&l<a.length;++l){let c=wA(s);o=_A(a[l],c,n)}return o}function L2(e,t,r,n){t===void 0&&(t=[]),r===void 0&&(r=[]),n===void 0&&(n="");let i=(s,a,o)=>{let l={relativePath:o===void 0?s.path||"":o,caseSensitive:s.caseSensitive===!0,childrenIndex:a,route:s};l.relativePath.startsWith("/")&&(Pt(l.relativePath.startsWith(n),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(n.length));let c=js([n,l.relativePath]),u=r.concat(l);s.children&&s.children.length>0&&(Pt(s.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+c+'".')),L2(s.children,t,u,c)),!(s.path==null&&!s.index)&&t.push({path:c,score:vA(c,s.index),routesMeta:u})};return e.forEach((s,a)=>{var o;if(s.path===""||!((o=s.path)!=null&&o.includes("?")))i(s,a);else for(let l of M2(s.path))i(s,a,l)}),t}function M2(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,i=r.endsWith("?"),s=r.replace(/\?$/,"");if(n.length===0)return i?[s,""]:[s];let a=M2(n.join("/")),o=[];return o.push(...a.map(l=>l===""?s:[s,l].join("/"))),i&&o.push(...a),o.map(l=>e.startsWith("/")&&l===""?"/":l)}function uA(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:xA(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const fA=/^:[\w-]+$/,hA=3,dA=2,pA=1,mA=10,gA=-2,Uv=e=>e==="*";function vA(e,t){let r=e.split("/"),n=r.length;return r.some(Uv)&&(n+=gA),t&&(n+=dA),r.filter(i=>!Uv(i)).reduce((i,s)=>i+(fA.test(s)?hA:s===""?pA:mA),n)}function xA(e,t){return e.length===t.length&&e.slice(0,-1).every((n,i)=>n===t[i])?e[e.length-1]-t[t.length-1]:0}function _A(e,t,r){let{routesMeta:n}=e,i={},s="/",a=[];for(let o=0;o<n.length;++o){let l=n[o],c=o===n.length-1,u=s==="/"?t:t.slice(s.length)||"/",f=Wv({path:l.relativePath,caseSensitive:l.caseSensitive,end:c},u),h=l.route;if(!f&&c&&r&&!n[n.length-1].route.index&&(f=Wv({path:l.relativePath,caseSensitive:l.caseSensitive,end:!1},u)),!f)return null;Object.assign(i,f.params),a.push({params:i,pathname:js([s,f.pathname]),pathnameBase:SA(js([s,f.pathnameBase])),route:h}),f.pathnameBase!=="/"&&(s=js([s,f.pathnameBase]))}return a}function Wv(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=yA(e.path,e.caseSensitive,e.end),i=t.match(r);if(!i)return null;let s=i[0],a=s.replace(/(.)\/+$/,"$1"),o=i.slice(1);return{params:n.reduce((c,u,f)=>{let{paramName:h,isOptional:d}=u;if(h==="*"){let p=o[f]||"";a=s.slice(0,s.length-p.length).replace(/(.)\/+$/,"$1")}const m=o[f];return d&&!m?c[h]=void 0:c[h]=(m||"").replace(/%2F/g,"/"),c},{}),pathname:s,pathnameBase:a,pattern:e}}function yA(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!0),Dm(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let n=[],i="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(a,o,l)=>(n.push({paramName:o,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(n.push({paramName:"*"}),i+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?i+="\\/*$":e!==""&&e!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,t?void 0:"i"),n]}function wA(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return Dm(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function B2(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}function EA(e,t){t===void 0&&(t="/");let{pathname:r,search:n="",hash:i=""}=typeof e=="string"?ha(e):e;return{pathname:r?r.startsWith("/")?r:kA(r,t):t,search:CA(n),hash:IA(i)}}function kA(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(i=>{i===".."?r.length>1&&r.pop():i!=="."&&r.push(i)}),r.length>1?r.join("/"):"/"}function Nh(e,t,r,n){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function TA(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function U2(e,t){let r=TA(e);return t?r.map((n,i)=>i===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function W2(e,t,r,n){n===void 0&&(n=!1);let i;typeof e=="string"?i=ha(e):(i=Zl({},e),Pt(!i.pathname||!i.pathname.includes("?"),Nh("?","pathname","search",i)),Pt(!i.pathname||!i.pathname.includes("#"),Nh("#","pathname","hash",i)),Pt(!i.search||!i.search.includes("#"),Nh("#","search","hash",i)));let s=e===""||i.pathname==="",a=s?"/":i.pathname,o;if(a==null)o=r;else{let f=t.length-1;if(!n&&a.startsWith("..")){let h=a.split("/");for(;h[0]==="..";)h.shift(),f-=1;i.pathname=h.join("/")}o=f>=0?t[f]:"/"}let l=EA(i,o),c=a&&a!=="/"&&a.endsWith("/"),u=(s||a===".")&&r.endsWith("/");return!l.pathname.endsWith("/")&&(c||u)&&(l.pathname+="/"),l}const js=e=>e.join("/").replace(/\/\/+/g,"/"),SA=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),CA=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,IA=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function AA(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const V2=["post","put","patch","delete"];new Set(V2);const FA=["get",...V2];new Set(FA);/**
 * React Router v6.28.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function ec(){return ec=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ec.apply(this,arguments)}const bm=Q.createContext(null),NA=Q.createContext(null),Nc=Q.createContext(null),C0=Q.createContext(null),da=Q.createContext({outlet:null,matches:[],isDataRoute:!1}),j2=Q.createContext(null);function Rc(){return Q.useContext(C0)!=null}function Lm(){return Rc()||Pt(!1),Q.useContext(C0).location}function H2(e){Q.useContext(Nc).static||Q.useLayoutEffect(e)}function RA(){let{isDataRoute:e}=Q.useContext(da);return e?zA():PA()}function PA(){Rc()||Pt(!1);let e=Q.useContext(bm),{basename:t,future:r,navigator:n}=Q.useContext(Nc),{matches:i}=Q.useContext(da),{pathname:s}=Lm(),a=JSON.stringify(U2(i,r.v7_relativeSplatPath)),o=Q.useRef(!1);return H2(()=>{o.current=!0}),Q.useCallback(function(c,u){if(u===void 0&&(u={}),!o.current)return;if(typeof c=="number"){n.go(c);return}let f=W2(c,JSON.parse(a),s,u.relative==="path");e==null&&t!=="/"&&(f.pathname=f.pathname==="/"?t:js([t,f.pathname])),(u.replace?n.replace:n.push)(f,u.state,u)},[t,n,a,s,e])}function OA(e,t){return DA(e,t)}function DA(e,t,r,n){Rc()||Pt(!1);let{navigator:i}=Q.useContext(Nc),{matches:s}=Q.useContext(da),a=s[s.length-1],o=a?a.params:{};a&&a.pathname;let l=a?a.pathnameBase:"/";a&&a.route;let c=Lm(),u;if(t){var f;let g=typeof t=="string"?ha(t):t;l==="/"||(f=g.pathname)!=null&&f.startsWith(l)||Pt(!1),u=g}else u=c;let h=u.pathname||"/",d=h;if(l!=="/"){let g=l.replace(/^\//,"").split("/");d="/"+h.replace(/^\//,"").split("/").slice(g.length).join("/")}let m=lA(e,{pathname:d}),p=UA(m&&m.map(g=>Object.assign({},g,{params:Object.assign({},o,g.params),pathname:js([l,i.encodeLocation?i.encodeLocation(g.pathname).pathname:g.pathname]),pathnameBase:g.pathnameBase==="/"?l:js([l,i.encodeLocation?i.encodeLocation(g.pathnameBase).pathname:g.pathnameBase])})),s,r,n);return t&&p?Q.createElement(C0.Provider,{value:{location:ec({pathname:"/",search:"",hash:"",state:null,key:"default"},u),navigationType:Ki.Pop}},p):p}function bA(){let e=HA(),t=AA(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return Q.createElement(Q.Fragment,null,Q.createElement("h2",null,"Unexpected Application Error!"),Q.createElement("h3",{style:{fontStyle:"italic"}},t),r?Q.createElement("pre",{style:i},r):null,null)}const LA=Q.createElement(bA,null);class MA extends Q.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,r){return r.location!==t.location||r.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:r.error,location:r.location,revalidation:t.revalidation||r.revalidation}}componentDidCatch(t,r){console.error("React Router caught the following error during render",t,r)}render(){return this.state.error!==void 0?Q.createElement(da.Provider,{value:this.props.routeContext},Q.createElement(j2.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function BA(e){let{routeContext:t,match:r,children:n}=e,i=Q.useContext(bm);return i&&i.static&&i.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=r.route.id),Q.createElement(da.Provider,{value:t},n)}function UA(e,t,r,n){var i;if(t===void 0&&(t=[]),r===void 0&&(r=null),n===void 0&&(n=null),e==null){var s;if(!r)return null;if(r.errors)e=r.matches;else if((s=n)!=null&&s.v7_partialHydration&&t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let a=e,o=(i=r)==null?void 0:i.errors;if(o!=null){let u=a.findIndex(f=>f.route.id&&(o==null?void 0:o[f.route.id])!==void 0);u>=0||Pt(!1),a=a.slice(0,Math.min(a.length,u+1))}let l=!1,c=-1;if(r&&n&&n.v7_partialHydration)for(let u=0;u<a.length;u++){let f=a[u];if((f.route.HydrateFallback||f.route.hydrateFallbackElement)&&(c=u),f.route.id){let{loaderData:h,errors:d}=r,m=f.route.loader&&h[f.route.id]===void 0&&(!d||d[f.route.id]===void 0);if(f.route.lazy||m){l=!0,c>=0?a=a.slice(0,c+1):a=[a[0]];break}}}return a.reduceRight((u,f,h)=>{let d,m=!1,p=null,g=null;r&&(d=o&&f.route.id?o[f.route.id]:void 0,p=f.route.errorElement||LA,l&&(c<0&&h===0?(m=!0,g=null):c===h&&(m=!0,g=f.route.hydrateFallbackElement||null)));let x=t.concat(a.slice(0,h+1)),_=()=>{let v;return d?v=p:m?v=g:f.route.Component?v=Q.createElement(f.route.Component,null):f.route.element?v=f.route.element:v=u,Q.createElement(BA,{match:f,routeContext:{outlet:u,matches:x,isDataRoute:r!=null},children:v})};return r&&(f.route.ErrorBoundary||f.route.errorElement||h===0)?Q.createElement(MA,{location:r.location,revalidation:r.revalidation,component:p,error:d,children:_(),routeContext:{outlet:null,matches:x,isDataRoute:!0}}):_()},null)}var z2=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(z2||{}),Tf=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(Tf||{});function WA(e){let t=Q.useContext(bm);return t||Pt(!1),t}function VA(e){let t=Q.useContext(NA);return t||Pt(!1),t}function jA(e){let t=Q.useContext(da);return t||Pt(!1),t}function $2(e){let t=jA(),r=t.matches[t.matches.length-1];return r.route.id||Pt(!1),r.route.id}function HA(){var e;let t=Q.useContext(j2),r=VA(Tf.UseRouteError),n=$2(Tf.UseRouteError);return t!==void 0?t:(e=r.errors)==null?void 0:e[n]}function zA(){let{router:e}=WA(z2.UseNavigateStable),t=$2(Tf.UseNavigateStable),r=Q.useRef(!1);return H2(()=>{r.current=!0}),Q.useCallback(function(i,s){s===void 0&&(s={}),r.current&&(typeof i=="number"?e.navigate(i):e.navigate(i,ec({fromRouteId:t},s)))},[e,t])}const Vv={};function $A(e,t){Vv[t]||(Vv[t]=!0,console.warn(t))}const jv=(e,t,r)=>$A(e," React Router Future Flag Warning: "+t+". "+("You can use the `"+e+"` future flag to opt-in early. ")+("For more information, see "+r+"."));function GA(e,t){e!=null&&e.v7_startTransition||jv("v7_startTransition","React Router will begin wrapping state updates in `React.startTransition` in v7","https://reactrouter.com/v6/upgrading/future#v7_starttransition"),!(e!=null&&e.v7_relativeSplatPath)&&!t&&jv("v7_relativeSplatPath","Relative route resolution within Splat routes is changing in v7","https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath")}function Hv(e){let{to:t,replace:r,state:n,relative:i}=e;Rc()||Pt(!1);let{future:s,static:a}=Q.useContext(Nc),{matches:o}=Q.useContext(da),{pathname:l}=Lm(),c=RA(),u=W2(t,U2(o,s.v7_relativeSplatPath),l,i==="path"),f=JSON.stringify(u);return Q.useEffect(()=>c(JSON.parse(f),{replace:r,state:n,relative:i}),[c,f,i,r,n]),null}function ep(e){Pt(!1)}function KA(e){let{basename:t="/",children:r=null,location:n,navigationType:i=Ki.Pop,navigator:s,static:a=!1,future:o}=e;Rc()&&Pt(!1);let l=t.replace(/^\/*/,"/"),c=Q.useMemo(()=>({basename:l,navigator:s,static:a,future:ec({v7_relativeSplatPath:!1},o)}),[l,o,s,a]);typeof n=="string"&&(n=ha(n));let{pathname:u="/",search:f="",hash:h="",state:d=null,key:m="default"}=n,p=Q.useMemo(()=>{let g=B2(u,l);return g==null?null:{location:{pathname:g,search:f,hash:h,state:d,key:m},navigationType:i}},[l,u,f,h,d,m,i]);return p==null?null:Q.createElement(Nc.Provider,{value:c},Q.createElement(C0.Provider,{children:r,value:p}))}function XA(e){let{children:t,location:r}=e;return OA(tp(t),r)}new Promise(()=>{});function tp(e,t){t===void 0&&(t=[]);let r=[];return Q.Children.forEach(e,(n,i)=>{if(!Q.isValidElement(n))return;let s=[...t,i];if(n.type===Q.Fragment){r.push.apply(r,tp(n.props.children,s));return}n.type!==ep&&Pt(!1),!n.props.index||!n.props.children||Pt(!1);let a={id:n.props.id||s.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(a.children=tp(n.props.children,s)),r.push(a)}),r}/**
 * React Router DOM v6.28.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */const YA="6";try{window.__reactRouterVersion=YA}catch{}const qA="startTransition",zv=KC[qA];function QA(e){let{basename:t,children:r,future:n,window:i}=e,s=Q.useRef();s.current==null&&(s.current=sA({window:i,v5Compat:!0}));let a=s.current,[o,l]=Q.useState({action:a.action,location:a.location}),{v7_startTransition:c}=n||{},u=Q.useCallback(f=>{c&&zv?zv(()=>l(f)):l(f)},[l,c]);return Q.useLayoutEffect(()=>a.listen(u),[a,u]),Q.useEffect(()=>GA(n),[n]),Q.createElement(KA,{basename:t,children:r,location:o.location,navigationType:o.action,navigator:a,future:n})}var $v;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})($v||($v={}));var Gv;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(Gv||(Gv={}));let JA={data:""},ZA=e=>typeof window=="object"?((e?e.querySelector("#_goober"):window._goober)||Object.assign((e||document.head).appendChild(document.createElement("style")),{innerHTML:" ",id:"_goober"})).firstChild:e||JA,eF=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,tF=/\/\*[^]*?\*\/|  +/g,Kv=/\n+/g,Ui=(e,t)=>{let r="",n="",i="";for(let s in e){let a=e[s];s[0]=="@"?s[1]=="i"?r=s+" "+a+";":n+=s[1]=="f"?Ui(a,s):s+"{"+Ui(a,s[1]=="k"?"":t)+"}":typeof a=="object"?n+=Ui(a,t?t.replace(/([^,])+/g,o=>s.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,l=>/&/.test(l)?l.replace(/&/g,o):o?o+" "+l:l)):s):a!=null&&(s=/^--/.test(s)?s:s.replace(/[A-Z]/g,"-$&").toLowerCase(),i+=Ui.p?Ui.p(s,a):s+":"+a+";")}return r+(t&&i?t+"{"+i+"}":i)+n},ei={},G2=e=>{if(typeof e=="object"){let t="";for(let r in e)t+=r+G2(e[r]);return t}return e},rF=(e,t,r,n,i)=>{let s=G2(e),a=ei[s]||(ei[s]=(l=>{let c=0,u=11;for(;c<l.length;)u=101*u+l.charCodeAt(c++)>>>0;return"go"+u})(s));if(!ei[a]){let l=s!==e?e:(c=>{let u,f,h=[{}];for(;u=eF.exec(c.replace(tF,""));)u[4]?h.shift():u[3]?(f=u[3].replace(Kv," ").trim(),h.unshift(h[0][f]=h[0][f]||{})):h[0][u[1]]=u[2].replace(Kv," ").trim();return h[0]})(e);ei[a]=Ui(i?{["@keyframes "+a]:l}:l,r?"":"."+a)}let o=r&&ei.g?ei.g:null;return r&&(ei.g=ei[a]),((l,c,u,f)=>{f?c.data=c.data.replace(f,l):c.data.indexOf(l)===-1&&(c.data=u?l+c.data:c.data+l)})(ei[a],t,n,o),a},nF=(e,t,r)=>e.reduce((n,i,s)=>{let a=t[s];if(a&&a.call){let o=a(r),l=o&&o.props&&o.props.className||/^go/.test(o)&&o;a=l?"."+l:o&&typeof o=="object"?o.props?"":Ui(o,""):o===!1?"":o}return n+i+(a??"")},"");function I0(e){let t=this||{},r=e.call?e(t.p):e;return rF(r.unshift?r.raw?nF(r,[].slice.call(arguments,1),t.p):r.reduce((n,i)=>Object.assign(n,i&&i.call?i(t.p):i),{}):r,ZA(t.target),t.g,t.o,t.k)}let K2,rp,np;I0.bind({g:1});let yi=I0.bind({k:1});function iF(e,t,r,n){Ui.p=t,K2=e,rp=r,np=n}function Es(e,t){let r=this||{};return function(){let n=arguments;function i(s,a){let o=Object.assign({},s),l=o.className||i.className;r.p=Object.assign({theme:rp&&rp()},o),r.o=/ *go\d+/.test(l),o.className=I0.apply(r,n)+(l?" "+l:"");let c=e;return e[0]&&(c=o.as||e,delete o.as),np&&c[0]&&np(o),K2(c,o)}return i}}var sF=e=>typeof e=="function",Sf=(e,t)=>sF(e)?e(t):e,aF=(()=>{let e=0;return()=>(++e).toString()})(),X2=(()=>{let e;return()=>{if(e===void 0&&typeof window<"u"){let t=matchMedia("(prefers-reduced-motion: reduce)");e=!t||t.matches}return e}})(),oF=20,zu=new Map,lF=1e3,Xv=e=>{if(zu.has(e))return;let t=setTimeout(()=>{zu.delete(e),pa({type:4,toastId:e})},lF);zu.set(e,t)},cF=e=>{let t=zu.get(e);t&&clearTimeout(t)},ip=(e,t)=>{switch(t.type){case 0:return{...e,toasts:[t.toast,...e.toasts].slice(0,oF)};case 1:return t.toast.id&&cF(t.toast.id),{...e,toasts:e.toasts.map(s=>s.id===t.toast.id?{...s,...t.toast}:s)};case 2:let{toast:r}=t;return e.toasts.find(s=>s.id===r.id)?ip(e,{type:1,toast:r}):ip(e,{type:0,toast:r});case 3:let{toastId:n}=t;return n?Xv(n):e.toasts.forEach(s=>{Xv(s.id)}),{...e,toasts:e.toasts.map(s=>s.id===n||n===void 0?{...s,visible:!1}:s)};case 4:return t.toastId===void 0?{...e,toasts:[]}:{...e,toasts:e.toasts.filter(s=>s.id!==t.toastId)};case 5:return{...e,pausedAt:t.time};case 6:let i=t.time-(e.pausedAt||0);return{...e,pausedAt:void 0,toasts:e.toasts.map(s=>({...s,pauseDuration:s.pauseDuration+i}))}}},$u=[],Gu={toasts:[],pausedAt:void 0},pa=e=>{Gu=ip(Gu,e),$u.forEach(t=>{t(Gu)})},uF={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},fF=(e={})=>{let[t,r]=Q.useState(Gu);Q.useEffect(()=>($u.push(r),()=>{let i=$u.indexOf(r);i>-1&&$u.splice(i,1)}),[t]);let n=t.toasts.map(i=>{var s,a;return{...e,...e[i.type],...i,duration:i.duration||((s=e[i.type])==null?void 0:s.duration)||(e==null?void 0:e.duration)||uF[i.type],style:{...e.style,...(a=e[i.type])==null?void 0:a.style,...i.style}}});return{...t,toasts:n}},hF=(e,t="blank",r)=>({createdAt:Date.now(),visible:!0,type:t,ariaProps:{role:"status","aria-live":"polite"},message:e,pauseDuration:0,...r,id:(r==null?void 0:r.id)||aF()}),Pc=e=>(t,r)=>{let n=hF(t,e,r);return pa({type:2,toast:n}),n.id},jr=(e,t)=>Pc("blank")(e,t);jr.error=Pc("error");jr.success=Pc("success");jr.loading=Pc("loading");jr.custom=Pc("custom");jr.dismiss=e=>{pa({type:3,toastId:e})};jr.remove=e=>pa({type:4,toastId:e});jr.promise=(e,t,r)=>{let n=jr.loading(t.loading,{...r,...r==null?void 0:r.loading});return e.then(i=>(jr.success(Sf(t.success,i),{id:n,...r,...r==null?void 0:r.success}),i)).catch(i=>{jr.error(Sf(t.error,i),{id:n,...r,...r==null?void 0:r.error})}),e};var dF=(e,t)=>{pa({type:1,toast:{id:e,height:t}})},pF=()=>{pa({type:5,time:Date.now()})},mF=e=>{let{toasts:t,pausedAt:r}=fF(e);Q.useEffect(()=>{if(r)return;let s=Date.now(),a=t.map(o=>{if(o.duration===1/0)return;let l=(o.duration||0)+o.pauseDuration-(s-o.createdAt);if(l<0){o.visible&&jr.dismiss(o.id);return}return setTimeout(()=>jr.dismiss(o.id),l)});return()=>{a.forEach(o=>o&&clearTimeout(o))}},[t,r]);let n=Q.useCallback(()=>{r&&pa({type:6,time:Date.now()})},[r]),i=Q.useCallback((s,a)=>{let{reverseOrder:o=!1,gutter:l=8,defaultPosition:c}=a||{},u=t.filter(d=>(d.position||c)===(s.position||c)&&d.height),f=u.findIndex(d=>d.id===s.id),h=u.filter((d,m)=>m<f&&d.visible).length;return u.filter(d=>d.visible).slice(...o?[h+1]:[0,h]).reduce((d,m)=>d+(m.height||0)+l,0)},[t]);return{toasts:t,handlers:{updateHeight:dF,startPause:pF,endPause:n,calculateOffset:i}}},gF=yi`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,vF=yi`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,xF=yi`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,_F=Es("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${gF} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${vF} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${e=>e.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${xF} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,yF=yi`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,wF=Es("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${e=>e.secondary||"#e0e0e0"};
  border-right-color: ${e=>e.primary||"#616161"};
  animation: ${yF} 1s linear infinite;
`,EF=yi`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,kF=yi`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,TF=Es("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${EF} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${kF} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${e=>e.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,SF=Es("div")`
  position: absolute;
`,CF=Es("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,IF=yi`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,AF=Es("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${IF} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,FF=({toast:e})=>{let{icon:t,type:r,iconTheme:n}=e;return t!==void 0?typeof t=="string"?Q.createElement(AF,null,t):t:r==="blank"?null:Q.createElement(CF,null,Q.createElement(wF,{...n}),r!=="loading"&&Q.createElement(SF,null,r==="error"?Q.createElement(_F,{...n}):Q.createElement(TF,{...n})))},NF=e=>`
0% {transform: translate3d(0,${e*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,RF=e=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${e*-150}%,-1px) scale(.6); opacity:0;}
`,PF="0%{opacity:0;} 100%{opacity:1;}",OF="0%{opacity:1;} 100%{opacity:0;}",DF=Es("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,bF=Es("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,LF=(e,t)=>{let r=e.includes("top")?1:-1,[n,i]=X2()?[PF,OF]:[NF(r),RF(r)];return{animation:t?`${yi(n)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${yi(i)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},MF=Q.memo(({toast:e,position:t,style:r,children:n})=>{let i=e.height?LF(e.position||t||"top-center",e.visible):{opacity:0},s=Q.createElement(FF,{toast:e}),a=Q.createElement(bF,{...e.ariaProps},Sf(e.message,e));return Q.createElement(DF,{className:e.className,style:{...i,...r,...e.style}},typeof n=="function"?n({icon:s,message:a}):Q.createElement(Q.Fragment,null,s,a))});iF(Q.createElement);var BF=({id:e,className:t,style:r,onHeightUpdate:n,children:i})=>{let s=Q.useCallback(a=>{if(a){let o=()=>{let l=a.getBoundingClientRect().height;n(e,l)};o(),new MutationObserver(o).observe(a,{subtree:!0,childList:!0,characterData:!0})}},[e,n]);return Q.createElement("div",{ref:s,className:t,style:r},i)},UF=(e,t)=>{let r=e.includes("top"),n=r?{top:0}:{bottom:0},i=e.includes("center")?{justifyContent:"center"}:e.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:X2()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${t*(r?1:-1)}px)`,...n,...i}},WF=I0`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,pu=16,VF=({reverseOrder:e,position:t="top-center",toastOptions:r,gutter:n,children:i,containerStyle:s,containerClassName:a})=>{let{toasts:o,handlers:l}=mF(r);return Q.createElement("div",{style:{position:"fixed",zIndex:9999,top:pu,left:pu,right:pu,bottom:pu,pointerEvents:"none",...s},className:a,onMouseEnter:l.startPause,onMouseLeave:l.endPause},o.map(c=>{let u=c.position||t,f=l.calculateOffset(c,{reverseOrder:e,gutter:n,defaultPosition:t}),h=UF(u,f);return Q.createElement(BF,{id:c.id,key:c.id,onHeightUpdate:l.updateHeight,className:c.visible?WF:"",style:h},c.type==="custom"?Sf(c.message,c):i?i(c):Q.createElement(MF,{toast:c,position:u}))}))},Xi=jr,Yv={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Y2={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oe=function(e,t){if(!e)throw Fo(t)},Fo=function(e){return new Error("Firebase Database ("+Y2.SDK_VERSION+") INTERNAL ASSERT FAILED: "+e)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q2=function(e){const t=[];let r=0;for(let n=0;n<e.length;n++){let i=e.charCodeAt(n);i<128?t[r++]=i:i<2048?(t[r++]=i>>6|192,t[r++]=i&63|128):(i&64512)===55296&&n+1<e.length&&(e.charCodeAt(n+1)&64512)===56320?(i=65536+((i&1023)<<10)+(e.charCodeAt(++n)&1023),t[r++]=i>>18|240,t[r++]=i>>12&63|128,t[r++]=i>>6&63|128,t[r++]=i&63|128):(t[r++]=i>>12|224,t[r++]=i>>6&63|128,t[r++]=i&63|128)}return t},jF=function(e){const t=[];let r=0,n=0;for(;r<e.length;){const i=e[r++];if(i<128)t[n++]=String.fromCharCode(i);else if(i>191&&i<224){const s=e[r++];t[n++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=e[r++],a=e[r++],o=e[r++],l=((i&7)<<18|(s&63)<<12|(a&63)<<6|o&63)-65536;t[n++]=String.fromCharCode(55296+(l>>10)),t[n++]=String.fromCharCode(56320+(l&1023))}else{const s=e[r++],a=e[r++];t[n++]=String.fromCharCode((i&15)<<12|(s&63)<<6|a&63)}}return t.join("")},Mm={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let i=0;i<e.length;i+=3){const s=e[i],a=i+1<e.length,o=a?e[i+1]:0,l=i+2<e.length,c=l?e[i+2]:0,u=s>>2,f=(s&3)<<4|o>>4;let h=(o&15)<<2|c>>6,d=c&63;l||(d=64,a||(h=64)),n.push(r[u],r[f],r[h],r[d])}return n.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(q2(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):jF(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const r=t?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let i=0;i<e.length;){const s=r[e.charAt(i++)],o=i<e.length?r[e.charAt(i)]:0;++i;const c=i<e.length?r[e.charAt(i)]:64;++i;const f=i<e.length?r[e.charAt(i)]:64;if(++i,s==null||o==null||c==null||f==null)throw new HF;const h=s<<2|o>>4;if(n.push(h),c!==64){const d=o<<4&240|c>>2;if(n.push(d),f!==64){const m=c<<6&192|f;n.push(m)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class HF extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Q2=function(e){const t=q2(e);return Mm.encodeByteArray(t,!0)},Cf=function(e){return Q2(e).replace(/\./g,"")},If=function(e){try{return Mm.decodeString(e,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zF(e){return J2(void 0,e)}function J2(e,t){if(!(t instanceof Object))return t;switch(t.constructor){case Date:const r=t;return new Date(r.getTime());case Object:e===void 0&&(e={});break;case Array:e=[];break;default:return t}for(const r in t)!t.hasOwnProperty(r)||!$F(r)||(e[r]=J2(e[r],t[r]));return e}function $F(e){return e!=="__proto__"}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GF(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KF=()=>GF().__FIREBASE_DEFAULTS__,XF=()=>{if(typeof process>"u"||typeof Yv>"u")return;const e=Yv.__FIREBASE_DEFAULTS__;if(e)return JSON.parse(e)},YF=()=>{if(typeof document>"u")return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const t=e&&If(e[1]);return t&&JSON.parse(t)},Bm=()=>{try{return KF()||XF()||YF()}catch(e){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${e}`);return}},Z2=e=>{var t,r;return(r=(t=Bm())===null||t===void 0?void 0:t.emulatorHosts)===null||r===void 0?void 0:r[e]},eE=e=>{const t=Z2(e);if(!t)return;const r=t.lastIndexOf(":");if(r<=0||r+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const n=parseInt(t.substring(r+1),10);return t[0]==="["?[t.substring(1,r-1),n]:[t.substring(0,r),n]},tE=()=>{var e;return(e=Bm())===null||e===void 0?void 0:e.config},rE=e=>{var t;return(t=Bm())===null||t===void 0?void 0:t[`_${e}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oc{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((t,r)=>{this.resolve=t,this.reject=r})}wrapCallback(t){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof t=="function"&&(this.promise.catch(()=>{}),t.length===1?t(r):t(r,n))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nE(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=t||"demo-project",i=e.iat||0,s=e.sub||e.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},e);return[Cf(JSON.stringify(r)),Cf(JSON.stringify(a)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Er(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Um(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Er())}function qF(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function QF(){const e=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof e=="object"&&e.id!==void 0}function iE(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function JF(){const e=Er();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}function sE(){return Y2.NODE_ADMIN===!0}function ZF(){try{return typeof indexedDB=="object"}catch{return!1}}function eN(){return new Promise((e,t)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(n);i.onsuccess=()=>{i.result.close(),r||self.indexedDB.deleteDatabase(n),e(!0)},i.onupgradeneeded=()=>{r=!1},i.onerror=()=>{var s;t(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(r){t(r)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tN="FirebaseError";class Ci extends Error{constructor(t,r,n){super(r),this.code=t,this.customData=n,this.name=tN,Object.setPrototypeOf(this,Ci.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Dc.prototype.create)}}class Dc{constructor(t,r,n){this.service=t,this.serviceName=r,this.errors=n}create(t,...r){const n=r[0]||{},i=`${this.service}/${t}`,s=this.errors[t],a=s?rN(s,n):"Error",o=`${this.serviceName}: ${a} (${i}).`;return new Ci(i,o,n)}}function rN(e,t){return e.replace(nN,(r,n)=>{const i=t[n];return i!=null?String(i):`<${n}?>`})}const nN=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tc(e){return JSON.parse(e)}function Ht(e){return JSON.stringify(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aE=function(e){let t={},r={},n={},i="";try{const s=e.split(".");t=tc(If(s[0])||""),r=tc(If(s[1])||""),i=s[2],n=r.d||{},delete r.d}catch{}return{header:t,claims:r,data:n,signature:i}},iN=function(e){const t=aE(e),r=t.claims;return!!r&&typeof r=="object"&&r.hasOwnProperty("iat")},sN=function(e){const t=aE(e).claims;return typeof t=="object"&&t.admin===!0};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kn(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function go(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]}function sp(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}function Af(e,t,r){const n={};for(const i in e)Object.prototype.hasOwnProperty.call(e,i)&&(n[i]=t.call(r,e[i],i,e));return n}function Ff(e,t){if(e===t)return!0;const r=Object.keys(e),n=Object.keys(t);for(const i of r){if(!n.includes(i))return!1;const s=e[i],a=t[i];if(qv(s)&&qv(a)){if(!Ff(s,a))return!1}else if(s!==a)return!1}for(const i of n)if(!r.includes(i))return!1;return!0}function qv(e){return e!==null&&typeof e=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function No(e){const t=[];for(const[r,n]of Object.entries(e))Array.isArray(n)?n.forEach(i=>{t.push(encodeURIComponent(r)+"="+encodeURIComponent(i))}):t.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return t.length?"&"+t.join("&"):""}function ll(e){const t={};return e.replace(/^\?/,"").split("&").forEach(n=>{if(n){const[i,s]=n.split("=");t[decodeURIComponent(i)]=decodeURIComponent(s)}}),t}function cl(e){const t=e.indexOf("?");if(!t)return"";const r=e.indexOf("#",t);return e.substring(t,r>0?r:void 0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aN{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let t=1;t<this.blockSize;++t)this.pad_[t]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(t,r){r||(r=0);const n=this.W_;if(typeof t=="string")for(let f=0;f<16;f++)n[f]=t.charCodeAt(r)<<24|t.charCodeAt(r+1)<<16|t.charCodeAt(r+2)<<8|t.charCodeAt(r+3),r+=4;else for(let f=0;f<16;f++)n[f]=t[r]<<24|t[r+1]<<16|t[r+2]<<8|t[r+3],r+=4;for(let f=16;f<80;f++){const h=n[f-3]^n[f-8]^n[f-14]^n[f-16];n[f]=(h<<1|h>>>31)&4294967295}let i=this.chain_[0],s=this.chain_[1],a=this.chain_[2],o=this.chain_[3],l=this.chain_[4],c,u;for(let f=0;f<80;f++){f<40?f<20?(c=o^s&(a^o),u=1518500249):(c=s^a^o,u=1859775393):f<60?(c=s&a|o&(s|a),u=2400959708):(c=s^a^o,u=3395469782);const h=(i<<5|i>>>27)+c+l+u+n[f]&4294967295;l=o,o=a,a=(s<<30|s>>>2)&4294967295,s=i,i=h}this.chain_[0]=this.chain_[0]+i&4294967295,this.chain_[1]=this.chain_[1]+s&4294967295,this.chain_[2]=this.chain_[2]+a&4294967295,this.chain_[3]=this.chain_[3]+o&4294967295,this.chain_[4]=this.chain_[4]+l&4294967295}update(t,r){if(t==null)return;r===void 0&&(r=t.length);const n=r-this.blockSize;let i=0;const s=this.buf_;let a=this.inbuf_;for(;i<r;){if(a===0)for(;i<=n;)this.compress_(t,i),i+=this.blockSize;if(typeof t=="string"){for(;i<r;)if(s[a]=t.charCodeAt(i),++a,++i,a===this.blockSize){this.compress_(s),a=0;break}}else for(;i<r;)if(s[a]=t[i],++a,++i,a===this.blockSize){this.compress_(s),a=0;break}}this.inbuf_=a,this.total_+=r}digest(){const t=[];let r=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let i=this.blockSize-1;i>=56;i--)this.buf_[i]=r&255,r/=256;this.compress_(this.buf_);let n=0;for(let i=0;i<5;i++)for(let s=24;s>=0;s-=8)t[n]=this.chain_[i]>>s&255,++n;return t}}function oN(e,t){const r=new lN(e,t);return r.subscribe.bind(r)}class lN{constructor(t,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{t(this)}).catch(n=>{this.error(n)})}next(t){this.forEachObserver(r=>{r.next(t)})}error(t){this.forEachObserver(r=>{r.error(t)}),this.close(t)}complete(){this.forEachObserver(t=>{t.complete()}),this.close()}subscribe(t,r,n){let i;if(t===void 0&&r===void 0&&n===void 0)throw new Error("Missing Observer.");cN(t,["next","error","complete"])?i=t:i={next:t,error:r,complete:n},i.next===void 0&&(i.next=Rh),i.error===void 0&&(i.error=Rh),i.complete===void 0&&(i.complete=Rh);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(t){this.observers===void 0||this.observers[t]===void 0||(delete this.observers[t],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(t){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,t)}sendOne(t,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[t]!==void 0)try{r(this.observers[t])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(t){this.finalized||(this.finalized=!0,t!==void 0&&(this.finalError=t),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function cN(e,t){if(typeof e!="object"||e===null)return!1;for(const r of t)if(r in e&&typeof e[r]=="function")return!0;return!1}function Rh(){}function A0(e,t){return`${e} failed: ${t} argument `}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uN=function(e){const t=[];let r=0;for(let n=0;n<e.length;n++){let i=e.charCodeAt(n);if(i>=55296&&i<=56319){const s=i-55296;n++,oe(n<e.length,"Surrogate pair missing trail surrogate.");const a=e.charCodeAt(n)-56320;i=65536+(s<<10)+a}i<128?t[r++]=i:i<2048?(t[r++]=i>>6|192,t[r++]=i&63|128):i<65536?(t[r++]=i>>12|224,t[r++]=i>>6&63|128,t[r++]=i&63|128):(t[r++]=i>>18|240,t[r++]=i>>12&63|128,t[r++]=i>>6&63|128,t[r++]=i&63|128)}return t},F0=function(e){let t=0;for(let r=0;r<e.length;r++){const n=e.charCodeAt(r);n<128?t++:n<2048?t+=2:n>=55296&&n<=56319?(t+=4,r++):t+=3}return t};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dr(e){return e&&e._delegate?e._delegate:e}class hs{constructor(t,r,n){this.name=t,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ps="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fN{constructor(t,r){this.name=t,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const r=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(r)){const n=new Oc;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:r});i&&n.resolve(i)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(t){var r;const n=this.normalizeInstanceIdentifier(t==null?void 0:t.identifier),i=(r=t==null?void 0:t.optional)!==null&&r!==void 0?r:!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,!!this.shouldAutoInitialize()){if(dN(t))try{this.getOrInitializeService({instanceIdentifier:Ps})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(r);try{const s=this.getOrInitializeService({instanceIdentifier:i});n.resolve(s)}catch{}}}}clearInstance(t=Ps){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...t.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(t=Ps){return this.instances.has(t)}getOptions(t=Ps){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:r={}}=t,n=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[s,a]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(s);n===o&&a.resolve(i)}return i}onInit(t,r){var n;const i=this.normalizeInstanceIdentifier(r),s=(n=this.onInitCallbacks.get(i))!==null&&n!==void 0?n:new Set;s.add(t),this.onInitCallbacks.set(i,s);const a=this.instances.get(i);return a&&t(a,i),()=>{s.delete(t)}}invokeOnInitCallbacks(t,r){const n=this.onInitCallbacks.get(r);if(n)for(const i of n)try{i(t,r)}catch{}}getOrInitializeService({instanceIdentifier:t,options:r={}}){let n=this.instances.get(t);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:hN(t),options:r}),this.instances.set(t,n),this.instancesOptions.set(t,r),this.invokeOnInitCallbacks(n,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,n)}catch{}return n||null}normalizeInstanceIdentifier(t=Ps){return this.component?this.component.multipleInstances?t:Ps:t}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function hN(e){return e===Ps?void 0:e}function dN(e){return e.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pN{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const r=this.getProvider(t.name);if(r.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);r.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const r=new fN(t,this);return this.providers.set(t,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ye;(function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"})(Ye||(Ye={}));const mN={debug:Ye.DEBUG,verbose:Ye.VERBOSE,info:Ye.INFO,warn:Ye.WARN,error:Ye.ERROR,silent:Ye.SILENT},gN=Ye.INFO,vN={[Ye.DEBUG]:"log",[Ye.VERBOSE]:"log",[Ye.INFO]:"info",[Ye.WARN]:"warn",[Ye.ERROR]:"error"},xN=(e,t,...r)=>{if(t<e.logLevel)return;const n=new Date().toISOString(),i=vN[t];if(i)console[i](`[${n}]  ${e.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`)};class Wm{constructor(t){this.name=t,this._logLevel=gN,this._logHandler=xN,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in Ye))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel=typeof t=="string"?mN[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if(typeof t!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,Ye.DEBUG,...t),this._logHandler(this,Ye.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,Ye.VERBOSE,...t),this._logHandler(this,Ye.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,Ye.INFO,...t),this._logHandler(this,Ye.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,Ye.WARN,...t),this._logHandler(this,Ye.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,Ye.ERROR,...t),this._logHandler(this,Ye.ERROR,...t)}}const _N=(e,t)=>t.some(r=>e instanceof r);let Qv,Jv;function yN(){return Qv||(Qv=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function wN(){return Jv||(Jv=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const oE=new WeakMap,ap=new WeakMap,lE=new WeakMap,Ph=new WeakMap,Vm=new WeakMap;function EN(e){const t=new Promise((r,n)=>{const i=()=>{e.removeEventListener("success",s),e.removeEventListener("error",a)},s=()=>{r(as(e.result)),i()},a=()=>{n(e.error),i()};e.addEventListener("success",s),e.addEventListener("error",a)});return t.then(r=>{r instanceof IDBCursor&&oE.set(r,e)}).catch(()=>{}),Vm.set(t,e),t}function kN(e){if(ap.has(e))return;const t=new Promise((r,n)=>{const i=()=>{e.removeEventListener("complete",s),e.removeEventListener("error",a),e.removeEventListener("abort",a)},s=()=>{r(),i()},a=()=>{n(e.error||new DOMException("AbortError","AbortError")),i()};e.addEventListener("complete",s),e.addEventListener("error",a),e.addEventListener("abort",a)});ap.set(e,t)}let op={get(e,t,r){if(e instanceof IDBTransaction){if(t==="done")return ap.get(e);if(t==="objectStoreNames")return e.objectStoreNames||lE.get(e);if(t==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return as(e[t])},set(e,t,r){return e[t]=r,!0},has(e,t){return e instanceof IDBTransaction&&(t==="done"||t==="store")?!0:t in e}};function TN(e){op=e(op)}function SN(e){return e===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(t,...r){const n=e.call(Oh(this),t,...r);return lE.set(n,t.sort?t.sort():[t]),as(n)}:wN().includes(e)?function(...t){return e.apply(Oh(this),t),as(oE.get(this))}:function(...t){return as(e.apply(Oh(this),t))}}function CN(e){return typeof e=="function"?SN(e):(e instanceof IDBTransaction&&kN(e),_N(e,yN())?new Proxy(e,op):e)}function as(e){if(e instanceof IDBRequest)return EN(e);if(Ph.has(e))return Ph.get(e);const t=CN(e);return t!==e&&(Ph.set(e,t),Vm.set(t,e)),t}const Oh=e=>Vm.get(e);function IN(e,t,{blocked:r,upgrade:n,blocking:i,terminated:s}={}){const a=indexedDB.open(e,t),o=as(a);return n&&a.addEventListener("upgradeneeded",l=>{n(as(a.result),l.oldVersion,l.newVersion,as(a.transaction),l)}),r&&a.addEventListener("blocked",l=>r(l.oldVersion,l.newVersion,l)),o.then(l=>{s&&l.addEventListener("close",()=>s()),i&&l.addEventListener("versionchange",c=>i(c.oldVersion,c.newVersion,c))}).catch(()=>{}),o}const AN=["get","getKey","getAll","getAllKeys","count"],FN=["put","add","delete","clear"],Dh=new Map;function Zv(e,t){if(!(e instanceof IDBDatabase&&!(t in e)&&typeof t=="string"))return;if(Dh.get(t))return Dh.get(t);const r=t.replace(/FromIndex$/,""),n=t!==r,i=FN.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(i||AN.includes(r)))return;const s=async function(a,...o){const l=this.transaction(a,i?"readwrite":"readonly");let c=l.store;return n&&(c=c.index(o.shift())),(await Promise.all([c[r](...o),i&&l.done]))[0]};return Dh.set(t,s),s}TN(e=>({...e,get:(t,r,n)=>Zv(t,r)||e.get(t,r,n),has:(t,r)=>!!Zv(t,r)||e.has(t,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NN{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(RN(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function RN(e){const t=e.getComponent();return(t==null?void 0:t.type)==="VERSION"}const lp="@firebase/app",ex="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wi=new Wm("@firebase/app"),PN="@firebase/app-compat",ON="@firebase/analytics-compat",DN="@firebase/analytics",bN="@firebase/app-check-compat",LN="@firebase/app-check",MN="@firebase/auth",BN="@firebase/auth-compat",UN="@firebase/database",WN="@firebase/data-connect",VN="@firebase/database-compat",jN="@firebase/functions",HN="@firebase/functions-compat",zN="@firebase/installations",$N="@firebase/installations-compat",GN="@firebase/messaging",KN="@firebase/messaging-compat",XN="@firebase/performance",YN="@firebase/performance-compat",qN="@firebase/remote-config",QN="@firebase/remote-config-compat",JN="@firebase/storage",ZN="@firebase/storage-compat",e3="@firebase/firestore",t3="@firebase/vertexai-preview",r3="@firebase/firestore-compat",n3="firebase",i3="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cp="[DEFAULT]",s3={[lp]:"fire-core",[PN]:"fire-core-compat",[DN]:"fire-analytics",[ON]:"fire-analytics-compat",[LN]:"fire-app-check",[bN]:"fire-app-check-compat",[MN]:"fire-auth",[BN]:"fire-auth-compat",[UN]:"fire-rtdb",[WN]:"fire-data-connect",[VN]:"fire-rtdb-compat",[jN]:"fire-fn",[HN]:"fire-fn-compat",[zN]:"fire-iid",[$N]:"fire-iid-compat",[GN]:"fire-fcm",[KN]:"fire-fcm-compat",[XN]:"fire-perf",[YN]:"fire-perf-compat",[qN]:"fire-rc",[QN]:"fire-rc-compat",[JN]:"fire-gcs",[ZN]:"fire-gcs-compat",[e3]:"fire-fst",[r3]:"fire-fst-compat",[t3]:"fire-vertex","fire-js":"fire-js",[n3]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nf=new Map,a3=new Map,up=new Map;function tx(e,t){try{e.container.addComponent(t)}catch(r){wi.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,r)}}function Js(e){const t=e.name;if(up.has(t))return wi.debug(`There were multiple attempts to register component ${t}.`),!1;up.set(t,e);for(const r of Nf.values())tx(r,e);for(const r of a3.values())tx(r,e);return!0}function N0(e,t){const r=e.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),e.container.getProvider(t)}function si(e){return e.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const o3={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},os=new Dc("app","Firebase",o3);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l3{constructor(t,r,n){this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},r),this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new hs("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw os.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ma=i3;function cE(e,t={}){let r=e;typeof t!="object"&&(t={name:t});const n=Object.assign({name:cp,automaticDataCollectionEnabled:!1},t),i=n.name;if(typeof i!="string"||!i)throw os.create("bad-app-name",{appName:String(i)});if(r||(r=tE()),!r)throw os.create("no-options");const s=Nf.get(i);if(s){if(Ff(r,s.options)&&Ff(n,s.config))return s;throw os.create("duplicate-app",{appName:i})}const a=new pN(i);for(const l of up.values())a.addComponent(l);const o=new l3(r,n,a);return Nf.set(i,o),o}function jm(e=cp){const t=Nf.get(e);if(!t&&e===cp&&tE())return cE();if(!t)throw os.create("no-app",{appName:e});return t}function Hn(e,t,r){var n;let i=(n=s3[e])!==null&&n!==void 0?n:e;r&&(i+=`-${r}`);const s=i.match(/\s|\//),a=t.match(/\s|\//);if(s||a){const o=[`Unable to register library "${i}" with version "${t}":`];s&&o.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&a&&o.push("and"),a&&o.push(`version name "${t}" contains illegal characters (whitespace or "/")`),wi.warn(o.join(" "));return}Js(new hs(`${i}-version`,()=>({library:i,version:t}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const c3="firebase-heartbeat-database",u3=1,rc="firebase-heartbeat-store";let bh=null;function uE(){return bh||(bh=IN(c3,u3,{upgrade:(e,t)=>{switch(t){case 0:try{e.createObjectStore(rc)}catch(r){console.warn(r)}}}}).catch(e=>{throw os.create("idb-open",{originalErrorMessage:e.message})})),bh}async function f3(e){try{const r=(await uE()).transaction(rc),n=await r.objectStore(rc).get(fE(e));return await r.done,n}catch(t){if(t instanceof Ci)wi.warn(t.message);else{const r=os.create("idb-get",{originalErrorMessage:t==null?void 0:t.message});wi.warn(r.message)}}}async function rx(e,t){try{const n=(await uE()).transaction(rc,"readwrite");await n.objectStore(rc).put(t,fE(e)),await n.done}catch(r){if(r instanceof Ci)wi.warn(r.message);else{const n=os.create("idb-set",{originalErrorMessage:r==null?void 0:r.message});wi.warn(n.message)}}}function fE(e){return`${e.name}!${e.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const h3=1024,d3=30*24*60*60*1e3;class p3{constructor(t){this.container=t,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new g3(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var t,r;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=nx();return((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((r=this._heartbeatsCache)===null||r===void 0?void 0:r.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(a=>a.date===s)?void 0:(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(a=>{const o=new Date(a.date).valueOf();return Date.now()-o<=d3}),this._storage.overwrite(this._heartbeatsCache))}catch(n){wi.warn(n)}}async getHeartbeatsHeader(){var t;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const r=nx(),{heartbeatsToSend:n,unsentEntries:i}=m3(this._heartbeatsCache.heartbeats),s=Cf(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=r,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(r){return wi.warn(r),""}}}function nx(){return new Date().toISOString().substring(0,10)}function m3(e,t=h3){const r=[];let n=e.slice();for(const i of e){const s=r.find(a=>a.agent===i.agent);if(s){if(s.dates.push(i.date),ix(r)>t){s.dates.pop();break}}else if(r.push({agent:i.agent,dates:[i.date]}),ix(r)>t){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class g3{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return ZF()?eN().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await f3(this.app);return r!=null&&r.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(t){var r;if(await this._canUseIndexedDBPromise){const i=await this.read();return rx(this.app,{lastSentHeartbeatDate:(r=t.lastSentHeartbeatDate)!==null&&r!==void 0?r:i.lastSentHeartbeatDate,heartbeats:t.heartbeats})}else return}async add(t){var r;if(await this._canUseIndexedDBPromise){const i=await this.read();return rx(this.app,{lastSentHeartbeatDate:(r=t.lastSentHeartbeatDate)!==null&&r!==void 0?r:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...t.heartbeats]})}else return}}function ix(e){return Cf(JSON.stringify({version:2,heartbeats:e})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function v3(e){Js(new hs("platform-logger",t=>new NN(t),"PRIVATE")),Js(new hs("heartbeat",t=>new p3(t),"PRIVATE")),Hn(lp,ex,e),Hn(lp,ex,"esm2017"),Hn("fire-js","")}v3("");function Hm(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r}function hE(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const x3=hE,dE=new Dc("auth","Firebase",hE());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rf=new Wm("@firebase/auth");function _3(e,...t){Rf.logLevel<=Ye.WARN&&Rf.warn(`Auth (${ma}): ${e}`,...t)}function Ku(e,...t){Rf.logLevel<=Ye.ERROR&&Rf.error(`Auth (${ma}): ${e}`,...t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nn(e,...t){throw zm(e,...t)}function zn(e,...t){return zm(e,...t)}function pE(e,t,r){const n=Object.assign(Object.assign({},x3()),{[t]:r});return new Dc("auth","Firebase",n).create(t,{appName:e.name})}function ls(e){return pE(e,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function zm(e,...t){if(typeof e!="string"){const r=t[0],n=[...t.slice(1)];return n[0]&&(n[0].appName=e.name),e._errorFactory.create(r,...n)}return dE.create(e,...t)}function Se(e,t,...r){if(!e)throw zm(t,...r)}function ai(e){const t="INTERNAL ASSERTION FAILED: "+e;throw Ku(t),new Error(t)}function Ei(e,t){e||ai(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fp(){var e;return typeof self<"u"&&((e=self.location)===null||e===void 0?void 0:e.href)||""}function y3(){return sx()==="http:"||sx()==="https:"}function sx(){var e;return typeof self<"u"&&((e=self.location)===null||e===void 0?void 0:e.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function w3(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(y3()||QF()||"connection"in navigator)?navigator.onLine:!0}function E3(){if(typeof navigator>"u")return null;const e=navigator;return e.languages&&e.languages[0]||e.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bc{constructor(t,r){this.shortDelay=t,this.longDelay=r,Ei(r>t,"Short delay should be less than long delay!"),this.isMobile=Um()||iE()}get(){return w3()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $m(e,t){Ei(e.emulator,"Emulator should always be set here");const{url:r}=e.emulator;return t?`${r}${t.startsWith("/")?t.slice(1):t}`:r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mE{static initialize(t,r,n){this.fetchImpl=t,r&&(this.headersImpl=r),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;ai("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;ai("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;ai("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k3={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const T3=new bc(3e4,6e4);function ga(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}async function ks(e,t,r,n,i={}){return gE(e,i,async()=>{let s={},a={};n&&(t==="GET"?a=n:s={body:JSON.stringify(n)});const o=No(Object.assign({key:e.config.apiKey},a)).slice(1),l=await e._getAdditionalHeaders();l["Content-Type"]="application/json",e.languageCode&&(l["X-Firebase-Locale"]=e.languageCode);const c=Object.assign({method:t,headers:l},s);return qF()||(c.referrerPolicy="no-referrer"),mE.fetch()(vE(e,e.config.apiHost,r,o),c)})}async function gE(e,t,r){e._canInitEmulator=!1;const n=Object.assign(Object.assign({},k3),t);try{const i=new C3(e),s=await Promise.race([r(),i.promise]);i.clearNetworkTimeout();const a=await s.json();if("needConfirmation"in a)throw mu(e,"account-exists-with-different-credential",a);if(s.ok&&!("errorMessage"in a))return a;{const o=s.ok?a.errorMessage:a.error.message,[l,c]=o.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw mu(e,"credential-already-in-use",a);if(l==="EMAIL_EXISTS")throw mu(e,"email-already-in-use",a);if(l==="USER_DISABLED")throw mu(e,"user-disabled",a);const u=n[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(c)throw pE(e,u,c);Nn(e,u)}}catch(i){if(i instanceof Ci)throw i;Nn(e,"network-request-failed",{message:String(i)})}}async function R0(e,t,r,n,i={}){const s=await ks(e,t,r,n,i);return"mfaPendingCredential"in s&&Nn(e,"multi-factor-auth-required",{_serverResponse:s}),s}function vE(e,t,r,n){const i=`${t}${r}?${n}`;return e.config.emulator?$m(e.config,i):`${e.config.apiScheme}://${i}`}function S3(e){switch(e){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class C3{constructor(t){this.auth=t,this.timer=null,this.promise=new Promise((r,n)=>{this.timer=setTimeout(()=>n(zn(this.auth,"network-request-failed")),T3.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function mu(e,t,r){const n={appName:e.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);const i=zn(e,t,n);return i.customData._tokenResponse=r,i}function ax(e){return e!==void 0&&e.enterprise!==void 0}class I3{constructor(t){if(this.siteKey="",this.recaptchaEnforcementState=[],t.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=t.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=t.recaptchaEnforcementState}getProviderEnforcementState(t){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const r of this.recaptchaEnforcementState)if(r.provider&&r.provider===t)return S3(r.enforcementState);return null}isProviderEnabled(t){return this.getProviderEnforcementState(t)==="ENFORCE"||this.getProviderEnforcementState(t)==="AUDIT"}}async function A3(e,t){return ks(e,"GET","/v2/recaptchaConfig",ga(e,t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function F3(e,t){return ks(e,"POST","/v1/accounts:delete",t)}async function xE(e,t){return ks(e,"POST","/v1/accounts:lookup",t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function El(e){if(e)try{const t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch{}}async function N3(e,t=!1){const r=dr(e),n=await r.getIdToken(t),i=Gm(n);Se(i&&i.exp&&i.auth_time&&i.iat,r.auth,"internal-error");const s=typeof i.firebase=="object"?i.firebase:void 0,a=s==null?void 0:s.sign_in_provider;return{claims:i,token:n,authTime:El(Lh(i.auth_time)),issuedAtTime:El(Lh(i.iat)),expirationTime:El(Lh(i.exp)),signInProvider:a||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function Lh(e){return Number(e)*1e3}function Gm(e){const[t,r,n]=e.split(".");if(t===void 0||r===void 0||n===void 0)return Ku("JWT malformed, contained fewer than 3 sections"),null;try{const i=If(r);return i?JSON.parse(i):(Ku("Failed to decode base64 JWT payload"),null)}catch(i){return Ku("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function ox(e){const t=Gm(e);return Se(t,"internal-error"),Se(typeof t.exp<"u","internal-error"),Se(typeof t.iat<"u","internal-error"),Number(t.exp)-Number(t.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function nc(e,t,r=!1){if(r)return t;try{return await t}catch(n){throw n instanceof Ci&&R3(n)&&e.auth.currentUser===e&&await e.auth.signOut(),n}}function R3({code:e}){return e==="auth/user-disabled"||e==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P3{constructor(t){this.user=t,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(t){var r;if(t){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const i=((r=this.user.stsTokenManager.expirationTime)!==null&&r!==void 0?r:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(t=!1){if(!this.isRunning)return;const r=this.getInterval(t);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(t){(t==null?void 0:t.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hp{constructor(t,r){this.createdAt=t,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=El(this.lastLoginAt),this.creationTime=El(this.createdAt)}_copy(t){this.createdAt=t.createdAt,this.lastLoginAt=t.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Pf(e){var t;const r=e.auth,n=await e.getIdToken(),i=await nc(e,xE(r,{idToken:n}));Se(i==null?void 0:i.users.length,r,"internal-error");const s=i.users[0];e._notifyReloadListener(s);const a=!((t=s.providerUserInfo)===null||t===void 0)&&t.length?_E(s.providerUserInfo):[],o=D3(e.providerData,a),l=e.isAnonymous,c=!(e.email&&s.passwordHash)&&!(o!=null&&o.length),u=l?c:!1,f={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new hp(s.createdAt,s.lastLoginAt),isAnonymous:u};Object.assign(e,f)}async function O3(e){const t=dr(e);await Pf(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}function D3(e,t){return[...e.filter(n=>!t.some(i=>i.providerId===n.providerId)),...t]}function _E(e){return e.map(t=>{var{providerId:r}=t,n=Hm(t,["providerId"]);return{providerId:r,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function b3(e,t){const r=await gE(e,{},async()=>{const n=No({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:i,apiKey:s}=e.config,a=vE(e,i,"/v1/token",`key=${s}`),o=await e._getAdditionalHeaders();return o["Content-Type"]="application/x-www-form-urlencoded",mE.fetch()(a,{method:"POST",headers:o,body:n})});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function L3(e,t){return ks(e,"POST","/v2/accounts:revokeToken",ga(e,t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ja{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(t){Se(t.idToken,"internal-error"),Se(typeof t.idToken<"u","internal-error"),Se(typeof t.refreshToken<"u","internal-error");const r="expiresIn"in t&&typeof t.expiresIn<"u"?Number(t.expiresIn):ox(t.idToken);this.updateTokensAndExpiration(t.idToken,t.refreshToken,r)}updateFromIdToken(t){Se(t.length!==0,"internal-error");const r=ox(t);this.updateTokensAndExpiration(t,null,r)}async getToken(t,r=!1){return!r&&this.accessToken&&!this.isExpired?this.accessToken:(Se(this.refreshToken,t,"user-token-expired"),this.refreshToken?(await this.refresh(t,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(t,r){const{accessToken:n,refreshToken:i,expiresIn:s}=await b3(t,r);this.updateTokensAndExpiration(n,i,Number(s))}updateTokensAndExpiration(t,r,n){this.refreshToken=r||null,this.accessToken=t||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(t,r){const{refreshToken:n,accessToken:i,expirationTime:s}=r,a=new Ja;return n&&(Se(typeof n=="string","internal-error",{appName:t}),a.refreshToken=n),i&&(Se(typeof i=="string","internal-error",{appName:t}),a.accessToken=i),s&&(Se(typeof s=="number","internal-error",{appName:t}),a.expirationTime=s),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(t){this.accessToken=t.accessToken,this.refreshToken=t.refreshToken,this.expirationTime=t.expirationTime}_clone(){return Object.assign(new Ja,this.toJSON())}_performRefresh(){return ai("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Oi(e,t){Se(typeof e=="string"||typeof e>"u","internal-error",{appName:t})}class oi{constructor(t){var{uid:r,auth:n,stsTokenManager:i}=t,s=Hm(t,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new P3(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=r,this.auth=n,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new hp(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(t){const r=await nc(this,this.stsTokenManager.getToken(this.auth,t));return Se(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(t){return N3(this,t)}reload(){return O3(this)}_assign(t){this!==t&&(Se(this.uid===t.uid,this.auth,"internal-error"),this.displayName=t.displayName,this.photoURL=t.photoURL,this.email=t.email,this.emailVerified=t.emailVerified,this.phoneNumber=t.phoneNumber,this.isAnonymous=t.isAnonymous,this.tenantId=t.tenantId,this.providerData=t.providerData.map(r=>Object.assign({},r)),this.metadata._copy(t.metadata),this.stsTokenManager._assign(t.stsTokenManager))}_clone(t){const r=new oi(Object.assign(Object.assign({},this),{auth:t,stsTokenManager:this.stsTokenManager._clone()}));return r.metadata._copy(this.metadata),r}_onReload(t){Se(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=t,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(t){this.reloadListener?this.reloadListener(t):this.reloadUserInfo=t}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(t,r=!1){let n=!1;t.idToken&&t.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(t),n=!0),r&&await Pf(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(si(this.auth.app))return Promise.reject(ls(this.auth));const t=await this.getIdToken();return await nc(this,F3(this.auth,{idToken:t})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(t=>Object.assign({},t)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(t,r){var n,i,s,a,o,l,c,u;const f=(n=r.displayName)!==null&&n!==void 0?n:void 0,h=(i=r.email)!==null&&i!==void 0?i:void 0,d=(s=r.phoneNumber)!==null&&s!==void 0?s:void 0,m=(a=r.photoURL)!==null&&a!==void 0?a:void 0,p=(o=r.tenantId)!==null&&o!==void 0?o:void 0,g=(l=r._redirectEventId)!==null&&l!==void 0?l:void 0,x=(c=r.createdAt)!==null&&c!==void 0?c:void 0,_=(u=r.lastLoginAt)!==null&&u!==void 0?u:void 0,{uid:v,emailVerified:E,isAnonymous:N,providerData:I,stsTokenManager:w}=r;Se(v&&w,t,"internal-error");const O=Ja.fromJSON(this.name,w);Se(typeof v=="string",t,"internal-error"),Oi(f,t.name),Oi(h,t.name),Se(typeof E=="boolean",t,"internal-error"),Se(typeof N=="boolean",t,"internal-error"),Oi(d,t.name),Oi(m,t.name),Oi(p,t.name),Oi(g,t.name),Oi(x,t.name),Oi(_,t.name);const P=new oi({uid:v,auth:t,email:h,emailVerified:E,displayName:f,isAnonymous:N,photoURL:m,phoneNumber:d,tenantId:p,stsTokenManager:O,createdAt:x,lastLoginAt:_});return I&&Array.isArray(I)&&(P.providerData=I.map(W=>Object.assign({},W))),g&&(P._redirectEventId=g),P}static async _fromIdTokenResponse(t,r,n=!1){const i=new Ja;i.updateFromServerResponse(r);const s=new oi({uid:r.localId,auth:t,stsTokenManager:i,isAnonymous:n});return await Pf(s),s}static async _fromGetAccountInfoResponse(t,r,n){const i=r.users[0];Se(i.localId!==void 0,"internal-error");const s=i.providerUserInfo!==void 0?_E(i.providerUserInfo):[],a=!(i.email&&i.passwordHash)&&!(s!=null&&s.length),o=new Ja;o.updateFromIdToken(n);const l=new oi({uid:i.localId,auth:t,stsTokenManager:o,isAnonymous:a}),c={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new hp(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(s!=null&&s.length)};return Object.assign(l,c),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lx=new Map;function li(e){Ei(e instanceof Function,"Expected a class definition");let t=lx.get(e);return t?(Ei(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,lx.set(e,t),t)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yE{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(t,r){this.storage[t]=r}async _get(t){const r=this.storage[t];return r===void 0?null:r}async _remove(t){delete this.storage[t]}_addListener(t,r){}_removeListener(t,r){}}yE.type="NONE";const cx=yE;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xu(e,t,r){return`firebase:${e}:${t}:${r}`}class Za{constructor(t,r,n){this.persistence=t,this.auth=r,this.userKey=n;const{config:i,name:s}=this.auth;this.fullUserKey=Xu(this.userKey,i.apiKey,s),this.fullPersistenceKey=Xu("persistence",i.apiKey,s),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(t){return this.persistence._set(this.fullUserKey,t.toJSON())}async getCurrentUser(){const t=await this.persistence._get(this.fullUserKey);return t?oi._fromJSON(this.auth,t):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(t){if(this.persistence===t)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=t,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(t,r,n="authUser"){if(!r.length)return new Za(li(cx),t,n);const i=(await Promise.all(r.map(async c=>{if(await c._isAvailable())return c}))).filter(c=>c);let s=i[0]||li(cx);const a=Xu(n,t.config.apiKey,t.name);let o=null;for(const c of r)try{const u=await c._get(a);if(u){const f=oi._fromJSON(t,u);c!==s&&(o=f),s=c;break}}catch{}const l=i.filter(c=>c._shouldAllowMigration);return!s._shouldAllowMigration||!l.length?new Za(s,t,n):(s=l[0],o&&await s._set(a,o.toJSON()),await Promise.all(r.map(async c=>{if(c!==s)try{await c._remove(a)}catch{}})),new Za(s,t,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ux(e){const t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(TE(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(wE(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(CE(t))return"Blackberry";if(IE(t))return"Webos";if(EE(t))return"Safari";if((t.includes("chrome/")||kE(t))&&!t.includes("edge/"))return"Chrome";if(SE(t))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=e.match(r);if((n==null?void 0:n.length)===2)return n[1]}return"Other"}function wE(e=Er()){return/firefox\//i.test(e)}function EE(e=Er()){const t=e.toLowerCase();return t.includes("safari/")&&!t.includes("chrome/")&&!t.includes("crios/")&&!t.includes("android")}function kE(e=Er()){return/crios\//i.test(e)}function TE(e=Er()){return/iemobile/i.test(e)}function SE(e=Er()){return/android/i.test(e)}function CE(e=Er()){return/blackberry/i.test(e)}function IE(e=Er()){return/webos/i.test(e)}function Km(e=Er()){return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function M3(e=Er()){var t;return Km(e)&&!!(!((t=window.navigator)===null||t===void 0)&&t.standalone)}function B3(){return JF()&&document.documentMode===10}function AE(e=Er()){return Km(e)||SE(e)||IE(e)||CE(e)||/windows phone/i.test(e)||TE(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FE(e,t=[]){let r;switch(e){case"Browser":r=ux(Er());break;case"Worker":r=`${ux(Er())}-${e}`;break;default:r=e}const n=t.length?t.join(","):"FirebaseCore-web";return`${r}/JsCore/${ma}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U3{constructor(t){this.auth=t,this.queue=[]}pushCallback(t,r){const n=s=>new Promise((a,o)=>{try{const l=t(s);a(l)}catch(l){o(l)}});n.onAbort=r,this.queue.push(n);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(t){if(this.auth.currentUser===t)return;const r=[];try{for(const n of this.queue)await n(t),n.onAbort&&r.push(n.onAbort)}catch(n){r.reverse();for(const i of r)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n==null?void 0:n.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function W3(e,t={}){return ks(e,"GET","/v2/passwordPolicy",ga(e,t))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const V3=6;class j3{constructor(t){var r,n,i,s;const a=t.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(r=a.minPasswordLength)!==null&&r!==void 0?r:V3,a.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=a.maxPasswordLength),a.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=a.containsLowercaseCharacter),a.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=a.containsUppercaseCharacter),a.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=a.containsNumericCharacter),a.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=a.containsNonAlphanumericCharacter),this.enforcementState=t.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(n=t.allowedNonAlphanumericCharacters)===null||n===void 0?void 0:n.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(s=t.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=t.schemaVersion}validatePassword(t){var r,n,i,s,a,o;const l={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(t,l),this.validatePasswordCharacterOptions(t,l),l.isValid&&(l.isValid=(r=l.meetsMinPasswordLength)!==null&&r!==void 0?r:!0),l.isValid&&(l.isValid=(n=l.meetsMaxPasswordLength)!==null&&n!==void 0?n:!0),l.isValid&&(l.isValid=(i=l.containsLowercaseLetter)!==null&&i!==void 0?i:!0),l.isValid&&(l.isValid=(s=l.containsUppercaseLetter)!==null&&s!==void 0?s:!0),l.isValid&&(l.isValid=(a=l.containsNumericCharacter)!==null&&a!==void 0?a:!0),l.isValid&&(l.isValid=(o=l.containsNonAlphanumericCharacter)!==null&&o!==void 0?o:!0),l}validatePasswordLengthOptions(t,r){const n=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;n&&(r.meetsMinPasswordLength=t.length>=n),i&&(r.meetsMaxPasswordLength=t.length<=i)}validatePasswordCharacterOptions(t,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let n;for(let i=0;i<t.length;i++)n=t.charAt(i),this.updatePasswordCharacterOptionsStatuses(r,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(t,r,n,i,s){this.customStrengthOptions.containsLowercaseLetter&&(t.containsLowercaseLetter||(t.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(t.containsUppercaseLetter||(t.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(t.containsNumericCharacter||(t.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(t.containsNonAlphanumericCharacter||(t.containsNonAlphanumericCharacter=s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H3{constructor(t,r,n,i){this.app=t,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=n,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new fx(this),this.idTokenSubscription=new fx(this),this.beforeStateQueue=new U3(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=dE,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=t.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(t,r){return r&&(this._popupRedirectResolver=li(r)),this._initializationPromise=this.queue(async()=>{var n,i;if(!this._deleted&&(this.persistenceManager=await Za.create(this,t),!this._deleted)){if(!((n=this._popupRedirectResolver)===null||n===void 0)&&n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(r),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const t=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!t)){if(this.currentUser&&t&&this.currentUser.uid===t.uid){this._currentUser._assign(t),await this.currentUser.getIdToken();return}await this._updateCurrentUser(t,!0)}}async initializeCurrentUserFromIdToken(t){try{const r=await xE(this,{idToken:t}),n=await oi._fromGetAccountInfoResponse(this,r,t);await this.directlySetCurrentUser(n)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(t){var r;if(si(this.app)){const a=this.app.settings.authIdToken;return a?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(o,o))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let i=n,s=!1;if(t&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const a=(r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId,o=i==null?void 0:i._redirectEventId,l=await this.tryRedirectSignIn(t);(!a||a===o)&&(l!=null&&l.user)&&(i=l.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(i)}catch(a){i=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return Se(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(t){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,t,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(t){try{await Pf(t)}catch(r){if((r==null?void 0:r.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(t)}useDeviceLanguage(){this.languageCode=E3()}async _delete(){this._deleted=!0}async updateCurrentUser(t){if(si(this.app))return Promise.reject(ls(this));const r=t?dr(t):null;return r&&Se(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(t,r=!1){if(!this._deleted)return t&&Se(this.tenantId===t.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(t),this.queue(async()=>{await this.directlySetCurrentUser(t),this.notifyAuthListeners()})}async signOut(){return si(this.app)?Promise.reject(ls(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(t){return si(this.app)?Promise.reject(ls(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(li(t))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(t){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(t)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const t=await W3(this),r=new j3(t);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(t){this._errorFactory=new Dc("auth","Firebase",t())}onAuthStateChanged(t,r,n){return this.registerStateListener(this.authStateSubscription,t,r,n)}beforeAuthStateChanged(t,r){return this.beforeStateQueue.pushCallback(t,r)}onIdTokenChanged(t,r,n){return this.registerStateListener(this.idTokenSubscription,t,r,n)}authStateReady(){return new Promise((t,r)=>{if(this.currentUser)t();else{const n=this.onAuthStateChanged(()=>{n(),t()},r)}})}async revokeAccessToken(t){if(this.currentUser){const r=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:t,idToken:r};this.tenantId!=null&&(n.tenantId=this.tenantId),await L3(this,n)}}toJSON(){var t;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(t=this._currentUser)===null||t===void 0?void 0:t.toJSON()}}async _setRedirectUser(t,r){const n=await this.getOrInitRedirectPersistenceManager(r);return t===null?n.removeCurrentUser():n.setCurrentUser(t)}async getOrInitRedirectPersistenceManager(t){if(!this.redirectPersistenceManager){const r=t&&li(t)||this._popupRedirectResolver;Se(r,this,"argument-error"),this.redirectPersistenceManager=await Za.create(this,[li(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(t){var r,n;return this._isInitialized&&await this.queue(async()=>{}),((r=this._currentUser)===null||r===void 0?void 0:r._redirectEventId)===t?this._currentUser:((n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId)===t?this.redirectUser:null}async _persistUserIfCurrent(t){if(t===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(t))}_notifyListenersIfCurrent(t){t===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var t,r;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=(r=(t=this.currentUser)===null||t===void 0?void 0:t.uid)!==null&&r!==void 0?r:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(t,r,n,i){if(this._deleted)return()=>{};const s=typeof r=="function"?r:r.next.bind(r);let a=!1;const o=this._isInitialized?Promise.resolve():this._initializationPromise;if(Se(o,this,"internal-error"),o.then(()=>{a||s(this.currentUser)}),typeof r=="function"){const l=t.addObserver(r,n,i);return()=>{a=!0,l()}}else{const l=t.addObserver(r);return()=>{a=!0,l()}}}async directlySetCurrentUser(t){this.currentUser&&this.currentUser!==t&&this._currentUser._stopProactiveRefresh(),t&&this.isProactiveRefreshEnabled&&t._startProactiveRefresh(),this.currentUser=t,t?await this.assertedPersistence.setCurrentUser(t):await this.assertedPersistence.removeCurrentUser()}queue(t){return this.operations=this.operations.then(t,t),this.operations}get assertedPersistence(){return Se(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(t){!t||this.frameworks.includes(t)||(this.frameworks.push(t),this.frameworks.sort(),this.clientVersion=FE(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var t;const r={"X-Client-Version":this.clientVersion};this.app.options.appId&&(r["X-Firebase-gmpid"]=this.app.options.appId);const n=await((t=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||t===void 0?void 0:t.getHeartbeatsHeader());n&&(r["X-Firebase-Client"]=n);const i=await this._getAppCheckToken();return i&&(r["X-Firebase-AppCheck"]=i),r}async _getAppCheckToken(){var t;const r=await((t=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||t===void 0?void 0:t.getToken());return r!=null&&r.error&&_3(`Error while retrieving App Check token: ${r.error}`),r==null?void 0:r.token}}function Ro(e){return dr(e)}class fx{constructor(t){this.auth=t,this.observer=null,this.addObserver=oN(r=>this.observer=r)}get next(){return Se(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let P0={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function z3(e){P0=e}function NE(e){return P0.loadJS(e)}function $3(){return P0.recaptchaEnterpriseScript}function G3(){return P0.gapiScript}function K3(e){return`__${e}${Math.floor(Math.random()*1e6)}`}const X3="recaptcha-enterprise",Y3="NO_RECAPTCHA";class q3{constructor(t){this.type=X3,this.auth=Ro(t)}async verify(t="verify",r=!1){async function n(s){if(!r){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise(async(a,o)=>{A3(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(l=>{if(l.recaptchaKey===void 0)o(new Error("recaptcha Enterprise site key undefined"));else{const c=new I3(l);return s.tenantId==null?s._agentRecaptchaConfig=c:s._tenantRecaptchaConfigs[s.tenantId]=c,a(c.siteKey)}}).catch(l=>{o(l)})})}function i(s,a,o){const l=window.grecaptcha;ax(l)?l.enterprise.ready(()=>{l.enterprise.execute(s,{action:t}).then(c=>{a(c)}).catch(()=>{a(Y3)})}):o(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((s,a)=>{n(this.auth).then(o=>{if(!r&&ax(window.grecaptcha))i(o,s,a);else{if(typeof window>"u"){a(new Error("RecaptchaVerifier is only supported in browser"));return}let l=$3();l.length!==0&&(l+=o),NE(l).then(()=>{i(o,s,a)}).catch(c=>{a(c)})}}).catch(o=>{a(o)})})}}async function hx(e,t,r,n=!1){const i=new q3(e);let s;try{s=await i.verify(r)}catch{s=await i.verify(r,!0)}const a=Object.assign({},t);return n?Object.assign(a,{captchaResp:s}):Object.assign(a,{captchaResponse:s}),Object.assign(a,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(a,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),a}async function dx(e,t,r,n){var i;if(!((i=e._getRecaptchaConfig())===null||i===void 0)&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const s=await hx(e,t,r,r==="getOobCode");return n(e,s)}else return n(e,t).catch(async s=>{if(s.code==="auth/missing-recaptcha-token"){console.log(`${r} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const a=await hx(e,t,r,r==="getOobCode");return n(e,a)}else return Promise.reject(s)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Q3(e,t){const r=N0(e,"auth");if(r.isInitialized()){const i=r.getImmediate(),s=r.getOptions();if(Ff(s,t??{}))return i;Nn(i,"already-initialized")}return r.initialize({options:t})}function J3(e,t){const r=(t==null?void 0:t.persistence)||[],n=(Array.isArray(r)?r:[r]).map(li);t!=null&&t.errorMap&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(n,t==null?void 0:t.popupRedirectResolver)}function Z3(e,t,r){const n=Ro(e);Se(n._canInitEmulator,n,"emulator-config-failed"),Se(/^https?:\/\//.test(t),n,"invalid-emulator-scheme");const i=!1,s=RE(t),{host:a,port:o}=eR(t),l=o===null?"":`:${o}`;n.config.emulator={url:`${s}//${a}${l}/`},n.settings.appVerificationDisabledForTesting=!0,n.emulatorConfig=Object.freeze({host:a,port:o,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})}),tR()}function RE(e){const t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function eR(e){const t=RE(e),r=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!r)return{host:"",port:null};const n=r[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(n);if(i){const s=i[1];return{host:s,port:px(n.substr(s.length+1))}}else{const[s,a]=n.split(":");return{host:s,port:px(a)}}}function px(e){if(!e)return null;const t=Number(e);return isNaN(t)?null:t}function tR(){function e(){const t=document.createElement("p"),r=t.style;t.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",t.classList.add("firebase-emulator-warning"),document.body.appendChild(t)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",e):e())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xm{constructor(t,r){this.providerId=t,this.signInMethod=r}toJSON(){return ai("not implemented")}_getIdTokenResponse(t){return ai("not implemented")}_linkToIdToken(t,r){return ai("not implemented")}_getReauthenticationResolver(t){return ai("not implemented")}}async function rR(e,t){return ks(e,"POST","/v1/accounts:signUp",t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function nR(e,t){return R0(e,"POST","/v1/accounts:signInWithPassword",ga(e,t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function iR(e,t){return R0(e,"POST","/v1/accounts:signInWithEmailLink",ga(e,t))}async function sR(e,t){return R0(e,"POST","/v1/accounts:signInWithEmailLink",ga(e,t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ic extends Xm{constructor(t,r,n,i=null){super("password",n),this._email=t,this._password=r,this._tenantId=i}static _fromEmailAndPassword(t,r){return new ic(t,r,"password")}static _fromEmailAndCode(t,r,n=null){return new ic(t,r,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(t){const r=typeof t=="string"?JSON.parse(t):t;if(r!=null&&r.email&&(r!=null&&r.password)){if(r.signInMethod==="password")return this._fromEmailAndPassword(r.email,r.password);if(r.signInMethod==="emailLink")return this._fromEmailAndCode(r.email,r.password,r.tenantId)}return null}async _getIdTokenResponse(t){switch(this.signInMethod){case"password":const r={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return dx(t,r,"signInWithPassword",nR);case"emailLink":return iR(t,{email:this._email,oobCode:this._password});default:Nn(t,"internal-error")}}async _linkToIdToken(t,r){switch(this.signInMethod){case"password":const n={idToken:r,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return dx(t,n,"signUpPassword",rR);case"emailLink":return sR(t,{idToken:r,email:this._email,oobCode:this._password});default:Nn(t,"internal-error")}}_getReauthenticationResolver(t){return this._getIdTokenResponse(t)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function eo(e,t){return R0(e,"POST","/v1/accounts:signInWithIdp",ga(e,t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aR="http://localhost";class Zs extends Xm{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(t){const r=new Zs(t.providerId,t.signInMethod);return t.idToken||t.accessToken?(t.idToken&&(r.idToken=t.idToken),t.accessToken&&(r.accessToken=t.accessToken),t.nonce&&!t.pendingToken&&(r.nonce=t.nonce),t.pendingToken&&(r.pendingToken=t.pendingToken)):t.oauthToken&&t.oauthTokenSecret?(r.accessToken=t.oauthToken,r.secret=t.oauthTokenSecret):Nn("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(t){const r=typeof t=="string"?JSON.parse(t):t,{providerId:n,signInMethod:i}=r,s=Hm(r,["providerId","signInMethod"]);if(!n||!i)return null;const a=new Zs(n,i);return a.idToken=s.idToken||void 0,a.accessToken=s.accessToken||void 0,a.secret=s.secret,a.nonce=s.nonce,a.pendingToken=s.pendingToken||null,a}_getIdTokenResponse(t){const r=this.buildRequest();return eo(t,r)}_linkToIdToken(t,r){const n=this.buildRequest();return n.idToken=r,eo(t,n)}_getReauthenticationResolver(t){const r=this.buildRequest();return r.autoCreate=!1,eo(t,r)}buildRequest(){const t={requestUri:aR,returnSecureToken:!0};if(this.pendingToken)t.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),t.postBody=No(r)}return t}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oR(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function lR(e){const t=ll(cl(e)).link,r=t?ll(cl(t)).deep_link_id:null,n=ll(cl(e)).deep_link_id;return(n?ll(cl(n)).link:null)||n||r||t||e}class Ym{constructor(t){var r,n,i,s,a,o;const l=ll(cl(t)),c=(r=l.apiKey)!==null&&r!==void 0?r:null,u=(n=l.oobCode)!==null&&n!==void 0?n:null,f=oR((i=l.mode)!==null&&i!==void 0?i:null);Se(c&&u&&f,"argument-error"),this.apiKey=c,this.operation=f,this.code=u,this.continueUrl=(s=l.continueUrl)!==null&&s!==void 0?s:null,this.languageCode=(a=l.languageCode)!==null&&a!==void 0?a:null,this.tenantId=(o=l.tenantId)!==null&&o!==void 0?o:null}static parseLink(t){const r=lR(t);try{return new Ym(r)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Po{constructor(){this.providerId=Po.PROVIDER_ID}static credential(t,r){return ic._fromEmailAndPassword(t,r)}static credentialWithLink(t,r){const n=Ym.parseLink(r);return Se(n,"argument-error"),ic._fromEmailAndCode(t,n.code,n.tenantId)}}Po.PROVIDER_ID="password";Po.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Po.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PE{constructor(t){this.providerId=t,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(t){this.defaultLanguageCode=t}setCustomParameters(t){return this.customParameters=t,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lc extends PE{constructor(){super(...arguments),this.scopes=[]}addScope(t){return this.scopes.includes(t)||this.scopes.push(t),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wi extends Lc{constructor(){super("facebook.com")}static credential(t){return Zs._fromParams({providerId:Wi.PROVIDER_ID,signInMethod:Wi.FACEBOOK_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return Wi.credentialFromTaggedObject(t)}static credentialFromError(t){return Wi.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t)||!t.oauthAccessToken)return null;try{return Wi.credential(t.oauthAccessToken)}catch{return null}}}Wi.FACEBOOK_SIGN_IN_METHOD="facebook.com";Wi.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vi extends Lc{constructor(){super("google.com"),this.addScope("profile")}static credential(t,r){return Zs._fromParams({providerId:Vi.PROVIDER_ID,signInMethod:Vi.GOOGLE_SIGN_IN_METHOD,idToken:t,accessToken:r})}static credentialFromResult(t){return Vi.credentialFromTaggedObject(t)}static credentialFromError(t){return Vi.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthIdToken:r,oauthAccessToken:n}=t;if(!r&&!n)return null;try{return Vi.credential(r,n)}catch{return null}}}Vi.GOOGLE_SIGN_IN_METHOD="google.com";Vi.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ji extends Lc{constructor(){super("github.com")}static credential(t){return Zs._fromParams({providerId:ji.PROVIDER_ID,signInMethod:ji.GITHUB_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return ji.credentialFromTaggedObject(t)}static credentialFromError(t){return ji.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t)||!t.oauthAccessToken)return null;try{return ji.credential(t.oauthAccessToken)}catch{return null}}}ji.GITHUB_SIGN_IN_METHOD="github.com";ji.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hi extends Lc{constructor(){super("twitter.com")}static credential(t,r){return Zs._fromParams({providerId:Hi.PROVIDER_ID,signInMethod:Hi.TWITTER_SIGN_IN_METHOD,oauthToken:t,oauthTokenSecret:r})}static credentialFromResult(t){return Hi.credentialFromTaggedObject(t)}static credentialFromError(t){return Hi.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthAccessToken:r,oauthTokenSecret:n}=t;if(!r||!n)return null;try{return Hi.credential(r,n)}catch{return null}}}Hi.TWITTER_SIGN_IN_METHOD="twitter.com";Hi.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vo{constructor(t){this.user=t.user,this.providerId=t.providerId,this._tokenResponse=t._tokenResponse,this.operationType=t.operationType}static async _fromIdTokenResponse(t,r,n,i=!1){const s=await oi._fromIdTokenResponse(t,n,i),a=mx(n);return new vo({user:s,providerId:a,_tokenResponse:n,operationType:r})}static async _forOperation(t,r,n){await t._updateTokensIfNecessary(n,!0);const i=mx(n);return new vo({user:t,providerId:i,_tokenResponse:n,operationType:r})}}function mx(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Of extends Ci{constructor(t,r,n,i){var s;super(r.code,r.message),this.operationType=n,this.user=i,Object.setPrototypeOf(this,Of.prototype),this.customData={appName:t.name,tenantId:(s=t.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:r.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(t,r,n,i){return new Of(t,r,n,i)}}function OE(e,t,r,n){return(t==="reauthenticate"?r._getReauthenticationResolver(e):r._getIdTokenResponse(e)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?Of._fromErrorAndOperation(e,s,t,n):s})}async function cR(e,t,r=!1){const n=await nc(e,t._linkToIdToken(e.auth,await e.getIdToken()),r);return vo._forOperation(e,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function uR(e,t,r=!1){const{auth:n}=e;if(si(n.app))return Promise.reject(ls(n));const i="reauthenticate";try{const s=await nc(e,OE(n,i,t,e),r);Se(s.idToken,n,"internal-error");const a=Gm(s.idToken);Se(a,n,"internal-error");const{sub:o}=a;return Se(e.uid===o,n,"user-mismatch"),vo._forOperation(e,i,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&Nn(n,"user-mismatch"),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function DE(e,t,r=!1){if(si(e.app))return Promise.reject(ls(e));const n="signIn",i=await OE(e,n,t),s=await vo._fromIdTokenResponse(e,n,i);return r||await e._updateCurrentUser(s.user),s}async function fR(e,t){return DE(Ro(e),t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function hR(e){const t=Ro(e);t._getPasswordPolicyInternal()&&await t._updatePasswordPolicy()}function dR(e,t,r){return si(e.app)?Promise.reject(ls(e)):fR(dr(e),Po.credential(t,r)).catch(async n=>{throw n.code==="auth/password-does-not-meet-requirements"&&hR(e),n})}function pR(e,t,r,n){return dr(e).onIdTokenChanged(t,r,n)}function mR(e,t,r){return dr(e).beforeAuthStateChanged(t,r)}function gR(e,t,r,n){return dr(e).onAuthStateChanged(t,r,n)}function vR(e){return dr(e).signOut()}const Df="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bE{constructor(t,r){this.storageRetriever=t,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem(Df,"1"),this.storage.removeItem(Df),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(t,r){return this.storage.setItem(t,JSON.stringify(r)),Promise.resolve()}_get(t){const r=this.storage.getItem(t);return Promise.resolve(r?JSON.parse(r):null)}_remove(t){return this.storage.removeItem(t),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xR=1e3,_R=10;class LE extends bE{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(t,r)=>this.onStorageEvent(t,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=AE(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(const r of Object.keys(this.listeners)){const n=this.storage.getItem(r),i=this.localCache[r];n!==i&&t(r,i,n)}}onStorageEvent(t,r=!1){if(!t.key){this.forAllChangedKeys((a,o,l)=>{this.notifyListeners(a,l)});return}const n=t.key;r?this.detachListener():this.stopPolling();const i=()=>{const a=this.storage.getItem(n);!r&&this.localCache[n]===a||this.notifyListeners(n,a)},s=this.storage.getItem(n);B3()&&s!==t.newValue&&t.newValue!==t.oldValue?setTimeout(i,_R):i()}notifyListeners(t,r){this.localCache[t]=r;const n=this.listeners[t];if(n)for(const i of Array.from(n))i(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((t,r,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:r,newValue:n}),!0)})},xR)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(r)}_removeListener(t,r){this.listeners[t]&&(this.listeners[t].delete(r),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(t,r){await super._set(t,r),this.localCache[t]=JSON.stringify(r)}async _get(t){const r=await super._get(t);return this.localCache[t]=JSON.stringify(r),r}async _remove(t){await super._remove(t),delete this.localCache[t]}}LE.type="LOCAL";const yR=LE;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ME extends bE{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(t,r){}_removeListener(t,r){}}ME.type="SESSION";const BE=ME;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wR(e){return Promise.all(e.map(async t=>{try{return{fulfilled:!0,value:await t}}catch(r){return{fulfilled:!1,reason:r}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O0{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){const r=this.receivers.find(i=>i.isListeningto(t));if(r)return r;const n=new O0(t);return this.receivers.push(n),n}isListeningto(t){return this.eventTarget===t}async handleEvent(t){const r=t,{eventId:n,eventType:i,data:s}=r.data,a=this.handlersMap[i];if(!(a!=null&&a.size))return;r.ports[0].postMessage({status:"ack",eventId:n,eventType:i});const o=Array.from(a).map(async c=>c(r.origin,s)),l=await wR(o);r.ports[0].postMessage({status:"done",eventId:n,eventType:i,response:l})}_subscribe(t,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(r)}_unsubscribe(t,r){this.handlersMap[t]&&r&&this.handlersMap[t].delete(r),(!r||this.handlersMap[t].size===0)&&delete this.handlersMap[t],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}O0.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qm(e="",t=10){let r="";for(let n=0;n<t;n++)r+=Math.floor(Math.random()*10);return e+r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ER{constructor(t){this.target=t,this.handlers=new Set}removeMessageHandler(t){t.messageChannel&&(t.messageChannel.port1.removeEventListener("message",t.onMessage),t.messageChannel.port1.close()),this.handlers.delete(t)}async _send(t,r,n=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,a;return new Promise((o,l)=>{const c=qm("",20);i.port1.start();const u=setTimeout(()=>{l(new Error("unsupported_event"))},n);a={messageChannel:i,onMessage(f){const h=f;if(h.data.eventId===c)switch(h.data.status){case"ack":clearTimeout(u),s=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),o(h.data.response);break;default:clearTimeout(u),clearTimeout(s),l(new Error("invalid_response"));break}}},this.handlers.add(a),i.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:t,eventId:c,data:r},[i.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $n(){return window}function kR(e){$n().location.href=e}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UE(){return typeof $n().WorkerGlobalScope<"u"&&typeof $n().importScripts=="function"}async function TR(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function SR(){var e;return((e=navigator==null?void 0:navigator.serviceWorker)===null||e===void 0?void 0:e.controller)||null}function CR(){return UE()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WE="firebaseLocalStorageDb",IR=1,bf="firebaseLocalStorage",VE="fbase_key";class Mc{constructor(t){this.request=t}toPromise(){return new Promise((t,r)=>{this.request.addEventListener("success",()=>{t(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function D0(e,t){return e.transaction([bf],t?"readwrite":"readonly").objectStore(bf)}function AR(){const e=indexedDB.deleteDatabase(WE);return new Mc(e).toPromise()}function dp(){const e=indexedDB.open(WE,IR);return new Promise((t,r)=>{e.addEventListener("error",()=>{r(e.error)}),e.addEventListener("upgradeneeded",()=>{const n=e.result;try{n.createObjectStore(bf,{keyPath:VE})}catch(i){r(i)}}),e.addEventListener("success",async()=>{const n=e.result;n.objectStoreNames.contains(bf)?t(n):(n.close(),await AR(),t(await dp()))})})}async function gx(e,t,r){const n=D0(e,!0).put({[VE]:t,value:r});return new Mc(n).toPromise()}async function FR(e,t){const r=D0(e,!1).get(t),n=await new Mc(r).toPromise();return n===void 0?null:n.value}function vx(e,t){const r=D0(e,!0).delete(t);return new Mc(r).toPromise()}const NR=800,RR=3;class jE{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await dp(),this.db)}async _withRetries(t){let r=0;for(;;)try{const n=await this._openDb();return await t(n)}catch(n){if(r++>RR)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return UE()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=O0._getInstance(CR()),this.receiver._subscribe("keyChanged",async(t,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(t,r)=>["keyChanged"])}async initializeSender(){var t,r;if(this.activeServiceWorker=await TR(),!this.activeServiceWorker)return;this.sender=new ER(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&!((t=n[0])===null||t===void 0)&&t.fulfilled&&!((r=n[0])===null||r===void 0)&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(t){if(!(!this.sender||!this.activeServiceWorker||SR()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const t=await dp();return await gx(t,Df,"1"),await vx(t,Df),!0}catch{}return!1}async _withPendingWrite(t){this.pendingWrites++;try{await t()}finally{this.pendingWrites--}}async _set(t,r){return this._withPendingWrite(async()=>(await this._withRetries(n=>gx(n,t,r)),this.localCache[t]=r,this.notifyServiceWorker(t)))}async _get(t){const r=await this._withRetries(n=>FR(n,t));return this.localCache[t]=r,r}async _remove(t){return this._withPendingWrite(async()=>(await this._withRetries(r=>vx(r,t)),delete this.localCache[t],this.notifyServiceWorker(t)))}async _poll(){const t=await this._withRetries(i=>{const s=D0(i,!1).getAll();return new Mc(s).toPromise()});if(!t)return[];if(this.pendingWrites!==0)return[];const r=[],n=new Set;if(t.length!==0)for(const{fbase_key:i,value:s}of t)n.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),r.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!n.has(i)&&(this.notifyListeners(i,null),r.push(i));return r}notifyListeners(t,r){this.localCache[t]=r;const n=this.listeners[t];if(n)for(const i of Array.from(n))i(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),NR)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(r)}_removeListener(t,r){this.listeners[t]&&(this.listeners[t].delete(r),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&this.stopPolling()}}jE.type="LOCAL";const PR=jE;new bc(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OR(e,t){return t?li(t):(Se(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qm extends Xm{constructor(t){super("custom","custom"),this.params=t}_getIdTokenResponse(t){return eo(t,this._buildIdpRequest())}_linkToIdToken(t,r){return eo(t,this._buildIdpRequest(r))}_getReauthenticationResolver(t){return eo(t,this._buildIdpRequest())}_buildIdpRequest(t){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return t&&(r.idToken=t),r}}function DR(e){return DE(e.auth,new Qm(e),e.bypassAuthState)}function bR(e){const{auth:t,user:r}=e;return Se(r,t,"internal-error"),uR(r,new Qm(e),e.bypassAuthState)}async function LR(e){const{auth:t,user:r}=e;return Se(r,t,"internal-error"),cR(r,new Qm(e),e.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HE{constructor(t,r,n,i,s=!1){this.auth=t,this.resolver=n,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(t,r)=>{this.pendingPromise={resolve:t,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(t){const{urlResponse:r,sessionId:n,postBody:i,tenantId:s,error:a,type:o}=t;if(a){this.reject(a);return}const l={auth:this.auth,requestUri:r,sessionId:n,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(l))}catch(c){this.reject(c)}}onError(t){this.reject(t)}getIdpTask(t){switch(t){case"signInViaPopup":case"signInViaRedirect":return DR;case"linkViaPopup":case"linkViaRedirect":return LR;case"reauthViaPopup":case"reauthViaRedirect":return bR;default:Nn(this.auth,"internal-error")}}resolve(t){Ei(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(t),this.unregisterAndCleanUp()}reject(t){Ei(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(t),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MR=new bc(2e3,1e4);class Ha extends HE{constructor(t,r,n,i,s){super(t,r,i,s),this.provider=n,this.authWindow=null,this.pollId=null,Ha.currentPopupAction&&Ha.currentPopupAction.cancel(),Ha.currentPopupAction=this}async executeNotNull(){const t=await this.execute();return Se(t,this.auth,"internal-error"),t}async onExecution(){Ei(this.filter.length===1,"Popup operations only handle one event");const t=qm();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],t),this.authWindow.associatedEvent=t,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(zn(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var t;return((t=this.authWindow)===null||t===void 0?void 0:t.associatedEvent)||null}cancel(){this.reject(zn(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Ha.currentPopupAction=null}pollUserCancellation(){const t=()=>{var r,n;if(!((n=(r=this.authWindow)===null||r===void 0?void 0:r.window)===null||n===void 0)&&n.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(zn(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(t,MR.get())};t()}}Ha.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BR="pendingRedirect",Yu=new Map;class UR extends HE{constructor(t,r,n=!1){super(t,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,n),this.eventId=null}async execute(){let t=Yu.get(this.auth._key());if(!t){try{const n=await WR(this.resolver,this.auth)?await super.execute():null;t=()=>Promise.resolve(n)}catch(r){t=()=>Promise.reject(r)}Yu.set(this.auth._key(),t)}return this.bypassAuthState||Yu.set(this.auth._key(),()=>Promise.resolve(null)),t()}async onAuthEvent(t){if(t.type==="signInViaRedirect")return super.onAuthEvent(t);if(t.type==="unknown"){this.resolve(null);return}if(t.eventId){const r=await this.auth._redirectUserForId(t.eventId);if(r)return this.user=r,super.onAuthEvent(t);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function WR(e,t){const r=HR(t),n=jR(e);if(!await n._isAvailable())return!1;const i=await n._get(r)==="true";return await n._remove(r),i}function VR(e,t){Yu.set(e._key(),t)}function jR(e){return li(e._redirectPersistence)}function HR(e){return Xu(BR,e.config.apiKey,e.name)}async function zR(e,t,r=!1){if(si(e.app))return Promise.reject(ls(e));const n=Ro(e),i=OR(n,t),a=await new UR(n,i,r).execute();return a&&!r&&(delete a.user._redirectEventId,await n._persistUserIfCurrent(a.user),await n._setRedirectUser(null,t)),a}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $R=10*60*1e3;class GR{constructor(t){this.auth=t,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(t){this.consumers.add(t),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,t)&&(this.sendToConsumer(this.queuedRedirectEvent,t),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(t){this.consumers.delete(t)}onEvent(t){if(this.hasEventBeenHandled(t))return!1;let r=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(t,n)&&(r=!0,this.sendToConsumer(t,n),this.saveEventToCache(t))}),this.hasHandledPotentialRedirect||!KR(t)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=t,r=!0)),r}sendToConsumer(t,r){var n;if(t.error&&!zE(t)){const i=((n=t.error.code)===null||n===void 0?void 0:n.split("auth/")[1])||"internal-error";r.onError(zn(this.auth,i))}else r.onAuthEvent(t)}isEventForConsumer(t,r){const n=r.eventId===null||!!t.eventId&&t.eventId===r.eventId;return r.filter.includes(t.type)&&n}hasEventBeenHandled(t){return Date.now()-this.lastProcessedEventTime>=$R&&this.cachedEventUids.clear(),this.cachedEventUids.has(xx(t))}saveEventToCache(t){this.cachedEventUids.add(xx(t)),this.lastProcessedEventTime=Date.now()}}function xx(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter(t=>t).join("-")}function zE({type:e,error:t}){return e==="unknown"&&(t==null?void 0:t.code)==="auth/no-auth-event"}function KR(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return zE(e);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function XR(e,t={}){return ks(e,"GET","/v1/projects",t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YR=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,qR=/^https?/;async function QR(e){if(e.config.emulator)return;const{authorizedDomains:t}=await XR(e);for(const r of t)try{if(JR(r))return}catch{}Nn(e,"unauthorized-domain")}function JR(e){const t=fp(),{protocol:r,hostname:n}=new URL(t);if(e.startsWith("chrome-extension://")){const a=new URL(e);return a.hostname===""&&n===""?r==="chrome-extension:"&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):r==="chrome-extension:"&&a.hostname===n}if(!qR.test(r))return!1;if(YR.test(e))return n===e;const i=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZR=new bc(3e4,6e4);function _x(){const e=$n().___jsl;if(e!=null&&e.H){for(const t of Object.keys(e.H))if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=[...e.H[t].L],e.CP)for(let r=0;r<e.CP.length;r++)e.CP[r]=null}}function eP(e){return new Promise((t,r)=>{var n,i,s;function a(){_x(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{_x(),r(zn(e,"network-request-failed"))},timeout:ZR.get()})}if(!((i=(n=$n().gapi)===null||n===void 0?void 0:n.iframes)===null||i===void 0)&&i.Iframe)t(gapi.iframes.getContext());else if(!((s=$n().gapi)===null||s===void 0)&&s.load)a();else{const o=K3("iframefcb");return $n()[o]=()=>{gapi.load?a():r(zn(e,"network-request-failed"))},NE(`${G3()}?onload=${o}`).catch(l=>r(l))}}).catch(t=>{throw qu=null,t})}let qu=null;function tP(e){return qu=qu||eP(e),qu}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rP=new bc(5e3,15e3),nP="__/auth/iframe",iP="emulator/auth/iframe",sP={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},aP=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function oP(e){const t=e.config;Se(t.authDomain,e,"auth-domain-config-required");const r=t.emulator?$m(t,iP):`https://${e.config.authDomain}/${nP}`,n={apiKey:t.apiKey,appName:e.name,v:ma},i=aP.get(e.config.apiHost);i&&(n.eid=i);const s=e._getFrameworks();return s.length&&(n.fw=s.join(",")),`${r}?${No(n).slice(1)}`}async function lP(e){const t=await tP(e),r=$n().gapi;return Se(r,e,"internal-error"),t.open({where:document.body,url:oP(e),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:sP,dontclear:!0},n=>new Promise(async(i,s)=>{await n.restyle({setHideOnLeave:!1});const a=zn(e,"network-request-failed"),o=$n().setTimeout(()=>{s(a)},rP.get());function l(){$n().clearTimeout(o),i(n)}n.ping(l).then(l,()=>{s(a)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cP={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},uP=500,fP=600,hP="_blank",dP="http://localhost";class yx{constructor(t){this.window=t,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function pP(e,t,r,n=uP,i=fP){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),a=Math.max((window.screen.availWidth-n)/2,0).toString();let o="";const l=Object.assign(Object.assign({},cP),{width:n.toString(),height:i.toString(),top:s,left:a}),c=Er().toLowerCase();r&&(o=kE(c)?hP:r),wE(c)&&(t=t||dP,l.scrollbars="yes");const u=Object.entries(l).reduce((h,[d,m])=>`${h}${d}=${m},`,"");if(M3(c)&&o!=="_self")return mP(t||"",o),new yx(null);const f=window.open(t||"",o,u);Se(f,e,"popup-blocked");try{f.focus()}catch{}return new yx(f)}function mP(e,t){const r=document.createElement("a");r.href=e,r.target=t;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gP="__/auth/handler",vP="emulator/auth/handler",xP=encodeURIComponent("fac");async function wx(e,t,r,n,i,s){Se(e.config.authDomain,e,"auth-domain-config-required"),Se(e.config.apiKey,e,"invalid-api-key");const a={apiKey:e.config.apiKey,appName:e.name,authType:r,redirectUrl:n,v:ma,eventId:i};if(t instanceof PE){t.setDefaultLanguage(e.languageCode),a.providerId=t.providerId||"",sp(t.getCustomParameters())||(a.customParameters=JSON.stringify(t.getCustomParameters()));for(const[u,f]of Object.entries({}))a[u]=f}if(t instanceof Lc){const u=t.getScopes().filter(f=>f!=="");u.length>0&&(a.scopes=u.join(","))}e.tenantId&&(a.tid=e.tenantId);const o=a;for(const u of Object.keys(o))o[u]===void 0&&delete o[u];const l=await e._getAppCheckToken(),c=l?`#${xP}=${encodeURIComponent(l)}`:"";return`${_P(e)}?${No(o).slice(1)}${c}`}function _P({config:e}){return e.emulator?$m(e,vP):`https://${e.authDomain}/${gP}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mh="webStorageSupport";class yP{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=BE,this._completeRedirectFn=zR,this._overrideRedirectResult=VR}async _openPopup(t,r,n,i){var s;Ei((s=this.eventManagers[t._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");const a=await wx(t,r,n,fp(),i);return pP(t,a,qm())}async _openRedirect(t,r,n,i){await this._originValidation(t);const s=await wx(t,r,n,fp(),i);return kR(s),new Promise(()=>{})}_initialize(t){const r=t._key();if(this.eventManagers[r]){const{manager:i,promise:s}=this.eventManagers[r];return i?Promise.resolve(i):(Ei(s,"If manager is not set, promise should be"),s)}const n=this.initAndGetManager(t);return this.eventManagers[r]={promise:n},n.catch(()=>{delete this.eventManagers[r]}),n}async initAndGetManager(t){const r=await lP(t),n=new GR(t);return r.register("authEvent",i=>(Se(i==null?void 0:i.authEvent,t,"invalid-auth-event"),{status:n.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[t._key()]={manager:n},this.iframes[t._key()]=r,n}_isIframeWebStorageSupported(t,r){this.iframes[t._key()].send(Mh,{type:Mh},i=>{var s;const a=(s=i==null?void 0:i[0])===null||s===void 0?void 0:s[Mh];a!==void 0&&r(!!a),Nn(t,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(t){const r=t._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=QR(t)),this.originValidationPromises[r]}get _shouldInitProactively(){return AE()||EE()||Km()}}const wP=yP;var Ex="@firebase/auth",kx="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EP{constructor(t){this.auth=t,this.internalListeners=new Map}getUid(){var t;return this.assertAuthConfigured(),((t=this.auth.currentUser)===null||t===void 0?void 0:t.uid)||null}async getToken(t){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(t)}:null}addAuthTokenListener(t){if(this.assertAuthConfigured(),this.internalListeners.has(t))return;const r=this.auth.onIdTokenChanged(n=>{t((n==null?void 0:n.stsTokenManager.accessToken)||null)});this.internalListeners.set(t,r),this.updateProactiveRefresh()}removeAuthTokenListener(t){this.assertAuthConfigured();const r=this.internalListeners.get(t);r&&(this.internalListeners.delete(t),r(),this.updateProactiveRefresh())}assertAuthConfigured(){Se(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kP(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function TP(e){Js(new hs("auth",(t,{options:r})=>{const n=t.getProvider("app").getImmediate(),i=t.getProvider("heartbeat"),s=t.getProvider("app-check-internal"),{apiKey:a,authDomain:o}=n.options;Se(a&&!a.includes(":"),"invalid-api-key",{appName:n.name});const l={apiKey:a,authDomain:o,clientPlatform:e,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:FE(e)},c=new H3(n,i,s,l);return J3(c,r),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((t,r,n)=>{t.getProvider("auth-internal").initialize()})),Js(new hs("auth-internal",t=>{const r=Ro(t.getProvider("auth").getImmediate());return(n=>new EP(n))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),Hn(Ex,kx,kP(e)),Hn(Ex,kx,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SP=5*60,CP=rE("authIdTokenMaxAge")||SP;let Tx=null;const IP=e=>async t=>{const r=t&&await t.getIdTokenResult(),n=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(n&&n>CP)return;const i=r==null?void 0:r.token;Tx!==i&&(Tx=i,await fetch(e,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function AP(e=jm()){const t=N0(e,"auth");if(t.isInitialized())return t.getImmediate();const r=Q3(e,{popupRedirectResolver:wP,persistence:[PR,yR,BE]}),n=rE("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(n,location.origin);if(location.origin===s.origin){const a=IP(s.toString());mR(r,a,()=>a(r.currentUser)),pR(r,o=>a(o))}}const i=Z2("auth");return i&&Z3(r,`http://${i}`),r}function FP(){var e,t;return(t=(e=document.getElementsByTagName("head"))===null||e===void 0?void 0:e[0])!==null&&t!==void 0?t:document}z3({loadJS(e){return new Promise((t,r)=>{const n=document.createElement("script");n.setAttribute("src",e),n.onload=t,n.onerror=i=>{const s=zn("internal-error");s.customData=i,r(s)},n.type="text/javascript",n.charset="UTF-8",FP().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});TP("Browser");var NP="firebase",RP="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Hn(NP,RP,"app");var Sx={};const Cx="@firebase/database",Ix="1.0.8";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let $E="";function PP(e){$E=e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OP{constructor(t){this.domStorage_=t,this.prefix_="firebase:"}set(t,r){r==null?this.domStorage_.removeItem(this.prefixedName_(t)):this.domStorage_.setItem(this.prefixedName_(t),Ht(r))}get(t){const r=this.domStorage_.getItem(this.prefixedName_(t));return r==null?null:tc(r)}remove(t){this.domStorage_.removeItem(this.prefixedName_(t))}prefixedName_(t){return this.prefix_+t}toString(){return this.domStorage_.toString()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DP{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(t,r){r==null?delete this.cache_[t]:this.cache_[t]=r}get(t){return Kn(this.cache_,t)?this.cache_[t]:null}remove(t){delete this.cache_[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GE=function(e){try{if(typeof window<"u"&&typeof window[e]<"u"){const t=window[e];return t.setItem("firebase:sentinel","cache"),t.removeItem("firebase:sentinel"),new OP(t)}}catch{}return new DP},Bs=GE("localStorage"),bP=GE("sessionStorage");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const to=new Wm("@firebase/database"),LP=function(){let e=1;return function(){return e++}}(),KE=function(e){const t=uN(e),r=new aN;r.update(t);const n=r.digest();return Mm.encodeByteArray(n)},Bc=function(...e){let t="";for(let r=0;r<e.length;r++){const n=e[r];Array.isArray(n)||n&&typeof n=="object"&&typeof n.length=="number"?t+=Bc.apply(null,n):typeof n=="object"?t+=Ht(n):t+=n,t+=" "}return t};let kl=null,Ax=!0;const MP=function(e,t){oe(!t,"Can't turn on custom loggers persistently."),to.logLevel=Ye.VERBOSE,kl=to.log.bind(to)},qt=function(...e){if(Ax===!0&&(Ax=!1,kl===null&&bP.get("logging_enabled")===!0&&MP()),kl){const t=Bc.apply(null,e);kl(t)}},Uc=function(e){return function(...t){qt(e,...t)}},pp=function(...e){const t="FIREBASE INTERNAL ERROR: "+Bc(...e);to.error(t)},ki=function(...e){const t=`FIREBASE FATAL ERROR: ${Bc(...e)}`;throw to.error(t),new Error(t)},yr=function(...e){const t="FIREBASE WARNING: "+Bc(...e);to.warn(t)},BP=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&yr("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},Jm=function(e){return typeof e=="number"&&(e!==e||e===Number.POSITIVE_INFINITY||e===Number.NEGATIVE_INFINITY)},UP=function(e){if(document.readyState==="complete")e();else{let t=!1;const r=function(){if(!document.body){setTimeout(r,Math.floor(10));return}t||(t=!0,e())};document.addEventListener?(document.addEventListener("DOMContentLoaded",r,!1),window.addEventListener("load",r,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&r()}),window.attachEvent("onload",r))}},xo="[MIN_NAME]",ea="[MAX_NAME]",va=function(e,t){if(e===t)return 0;if(e===xo||t===ea)return-1;if(t===xo||e===ea)return 1;{const r=Fx(e),n=Fx(t);return r!==null?n!==null?r-n===0?e.length-t.length:r-n:-1:n!==null?1:e<t?-1:1}},WP=function(e,t){return e===t?0:e<t?-1:1},Zo=function(e,t){if(t&&e in t)return t[e];throw new Error("Missing required key ("+e+") in object: "+Ht(t))},Zm=function(e){if(typeof e!="object"||e===null)return Ht(e);const t=[];for(const n in e)t.push(n);t.sort();let r="{";for(let n=0;n<t.length;n++)n!==0&&(r+=","),r+=Ht(t[n]),r+=":",r+=Zm(e[t[n]]);return r+="}",r},XE=function(e,t){const r=e.length;if(r<=t)return[e];const n=[];for(let i=0;i<r;i+=t)i+t>r?n.push(e.substring(i,r)):n.push(e.substring(i,i+t));return n};function er(e,t){for(const r in e)e.hasOwnProperty(r)&&t(r,e[r])}const YE=function(e){oe(!Jm(e),"Invalid JSON number");const t=11,r=52,n=(1<<t-1)-1;let i,s,a,o,l;e===0?(s=0,a=0,i=1/e===-1/0?1:0):(i=e<0,e=Math.abs(e),e>=Math.pow(2,1-n)?(o=Math.min(Math.floor(Math.log(e)/Math.LN2),n),s=o+n,a=Math.round(e*Math.pow(2,r-o)-Math.pow(2,r))):(s=0,a=Math.round(e/Math.pow(2,1-n-r))));const c=[];for(l=r;l;l-=1)c.push(a%2?1:0),a=Math.floor(a/2);for(l=t;l;l-=1)c.push(s%2?1:0),s=Math.floor(s/2);c.push(i?1:0),c.reverse();const u=c.join("");let f="";for(l=0;l<64;l+=8){let h=parseInt(u.substr(l,8),2).toString(16);h.length===1&&(h="0"+h),f=f+h}return f.toLowerCase()},VP=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},jP=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function HP(e,t){let r="Unknown Error";e==="too_big"?r="The data requested exceeds the maximum size that can be accessed with a single request.":e==="permission_denied"?r="Client doesn't have permission to access the desired data.":e==="unavailable"&&(r="The service is unavailable");const n=new Error(e+" at "+t._path.toString()+": "+r);return n.code=e.toUpperCase(),n}const zP=new RegExp("^-?(0*)\\d{1,10}$"),$P=-2147483648,GP=2147483647,Fx=function(e){if(zP.test(e)){const t=Number(e);if(t>=$P&&t<=GP)return t}return null},Oo=function(e){try{e()}catch(t){setTimeout(()=>{const r=t.stack||"";throw yr("Exception was thrown by user callback.",r),t},Math.floor(0))}},KP=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},Tl=function(e,t){const r=setTimeout(e,t);return typeof r=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(r):typeof r=="object"&&r.unref&&r.unref(),r};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XP{constructor(t,r){this.appName_=t,this.appCheckProvider=r,this.appCheck=r==null?void 0:r.getImmediate({optional:!0}),this.appCheck||r==null||r.get().then(n=>this.appCheck=n)}getToken(t){return this.appCheck?this.appCheck.getToken(t):new Promise((r,n)=>{setTimeout(()=>{this.appCheck?this.getToken(t).then(r,n):r(null)},0)})}addTokenChangeListener(t){var r;(r=this.appCheckProvider)===null||r===void 0||r.get().then(n=>n.addTokenListener(t))}notifyForInvalidToken(){yr(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YP{constructor(t,r,n){this.appName_=t,this.firebaseOptions_=r,this.authProvider_=n,this.auth_=null,this.auth_=n.getImmediate({optional:!0}),this.auth_||n.onInit(i=>this.auth_=i)}getToken(t){return this.auth_?this.auth_.getToken(t).catch(r=>r&&r.code==="auth/token-not-initialized"?(qt("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(r)):new Promise((r,n)=>{setTimeout(()=>{this.auth_?this.getToken(t).then(r,n):r(null)},0)})}addTokenChangeListener(t){this.auth_?this.auth_.addAuthTokenListener(t):this.authProvider_.get().then(r=>r.addAuthTokenListener(t))}removeTokenChangeListener(t){this.authProvider_.get().then(r=>r.removeAuthTokenListener(t))}notifyForInvalidToken(){let t='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?t+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?t+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':t+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',yr(t)}}class Qu{constructor(t){this.accessToken=t}getToken(t){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(t){t(this.accessToken)}removeTokenChangeListener(t){}notifyForInvalidToken(){}}Qu.OWNER="owner";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const e1="5",qE="v",QE="s",JE="r",ZE="f",ek=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,tk="ls",rk="p",mp="ac",nk="websocket",ik="long_polling";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sk{constructor(t,r,n,i,s=!1,a="",o=!1,l=!1){this.secure=r,this.namespace=n,this.webSocketOnly=i,this.nodeAdmin=s,this.persistenceKey=a,this.includeNamespaceInQueryParams=o,this.isUsingEmulator=l,this._host=t.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=Bs.get("host:"+t)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(t){t!==this.internalHost&&(this.internalHost=t,this.isCacheableHost()&&Bs.set("host:"+this._host,this.internalHost))}toString(){let t=this.toURLString();return this.persistenceKey&&(t+="<"+this.persistenceKey+">"),t}toURLString(){const t=this.secure?"https://":"http://",r=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${t}${this.host}/${r}`}}function qP(e){return e.host!==e.internalHost||e.isCustomHost()||e.includeNamespaceInQueryParams}function ak(e,t,r){oe(typeof t=="string","typeof type must == string"),oe(typeof r=="object","typeof params must == object");let n;if(t===nk)n=(e.secure?"wss://":"ws://")+e.internalHost+"/.ws?";else if(t===ik)n=(e.secure?"https://":"http://")+e.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+t);qP(e)&&(r.ns=e.namespace);const i=[];return er(r,(s,a)=>{i.push(s+"="+a)}),n+i.join("&")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QP{constructor(){this.counters_={}}incrementCounter(t,r=1){Kn(this.counters_,t)||(this.counters_[t]=0),this.counters_[t]+=r}get(){return zF(this.counters_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bh={},Uh={};function t1(e){const t=e.toString();return Bh[t]||(Bh[t]=new QP),Bh[t]}function JP(e,t){const r=e.toString();return Uh[r]||(Uh[r]=t()),Uh[r]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZP{constructor(t){this.onMessage_=t,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(t,r){this.closeAfterResponse=t,this.onClose=r,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(t,r){for(this.pendingResponses[t]=r;this.pendingResponses[this.currentResponseNum];){const n=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let i=0;i<n.length;++i)n[i]&&Oo(()=>{this.onMessage_(n[i])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nx="start",eO="close",tO="pLPCommand",rO="pRTLPCB",ok="id",lk="pw",ck="ser",nO="cb",iO="seg",sO="ts",aO="d",oO="dframe",uk=1870,fk=30,lO=uk-fk,cO=25e3,uO=3e4;class za{constructor(t,r,n,i,s,a,o){this.connId=t,this.repoInfo=r,this.applicationId=n,this.appCheckToken=i,this.authToken=s,this.transportSessionId=a,this.lastSessionId=o,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=Uc(t),this.stats_=t1(r),this.urlFn=l=>(this.appCheckToken&&(l[mp]=this.appCheckToken),ak(r,ik,l))}open(t,r){this.curSegmentNum=0,this.onDisconnect_=r,this.myPacketOrderer=new ZP(t),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(uO)),UP(()=>{if(this.isClosed_)return;this.scriptTagHolder=new r1((...s)=>{const[a,o,l,c,u]=s;if(this.incrementIncomingBytes_(s),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,a===Nx)this.id=o,this.password=l;else if(a===eO)o?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(o,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+a)},(...s)=>{const[a,o]=s;this.incrementIncomingBytes_(s),this.myPacketOrderer.handleResponse(a,o)},()=>{this.onClosed_()},this.urlFn);const n={};n[Nx]="t",n[ck]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(n[nO]=this.scriptTagHolder.uniqueCallbackIdentifier),n[qE]=e1,this.transportSessionId&&(n[QE]=this.transportSessionId),this.lastSessionId&&(n[tk]=this.lastSessionId),this.applicationId&&(n[rk]=this.applicationId),this.appCheckToken&&(n[mp]=this.appCheckToken),typeof location<"u"&&location.hostname&&ek.test(location.hostname)&&(n[JE]=ZE);const i=this.urlFn(n);this.log_("Connecting via long-poll to "+i),this.scriptTagHolder.addTag(i,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){za.forceAllow_=!0}static forceDisallow(){za.forceDisallow_=!0}static isAvailable(){return za.forceAllow_?!0:!za.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!VP()&&!jP()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(t){const r=Ht(t);this.bytesSent+=r.length,this.stats_.incrementCounter("bytes_sent",r.length);const n=Q2(r),i=XE(n,lO);for(let s=0;s<i.length;s++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[s]),this.curSegmentNum++}addDisconnectPingFrame(t,r){this.myDisconnFrame=document.createElement("iframe");const n={};n[oO]="t",n[ok]=t,n[lk]=r,this.myDisconnFrame.src=this.urlFn(n),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(t){const r=Ht(t).length;this.bytesReceived+=r,this.stats_.incrementCounter("bytes_received",r)}}class r1{constructor(t,r,n,i){this.onDisconnect=n,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=LP(),window[tO+this.uniqueCallbackIdentifier]=t,window[rO+this.uniqueCallbackIdentifier]=r,this.myIFrame=r1.createIFrame_();let s="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(s='<script>document.domain="'+document.domain+'";<\/script>');const a="<html><body>"+s+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(a),this.myIFrame.doc.close()}catch(o){qt("frame writing exception"),o.stack&&qt(o.stack),qt(o)}}}static createIFrame_(){const t=document.createElement("iframe");if(t.style.display="none",document.body){document.body.appendChild(t);try{t.contentWindow.document||qt("No IE domain setting required")}catch{const n=document.domain;t.src="javascript:void((function(){document.open();document.domain='"+n+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return t.contentDocument?t.doc=t.contentDocument:t.contentWindow?t.doc=t.contentWindow.document:t.document&&(t.doc=t.document),t}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const t=this.onDisconnect;t&&(this.onDisconnect=null,t())}startLongPoll(t,r){for(this.myID=t,this.myPW=r,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const t={};t[ok]=this.myID,t[lk]=this.myPW,t[ck]=this.currentSerial;let r=this.urlFn(t),n="",i=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+fk+n.length<=uk;){const a=this.pendingSegs.shift();n=n+"&"+iO+i+"="+a.seg+"&"+sO+i+"="+a.ts+"&"+aO+i+"="+a.d,i++}return r=r+n,this.addLongPollTag_(r,this.currentSerial),!0}else return!1}enqueueSegment(t,r,n){this.pendingSegs.push({seg:t,ts:r,d:n}),this.alive&&this.newRequest_()}addLongPollTag_(t,r){this.outstandingRequests.add(r);const n=()=>{this.outstandingRequests.delete(r),this.newRequest_()},i=setTimeout(n,Math.floor(cO)),s=()=>{clearTimeout(i),n()};this.addTag(t,s)}addTag(t,r){setTimeout(()=>{try{if(!this.sendNewPolls)return;const n=this.myIFrame.doc.createElement("script");n.type="text/javascript",n.async=!0,n.src=t,n.onload=n.onreadystatechange=function(){const i=n.readyState;(!i||i==="loaded"||i==="complete")&&(n.onload=n.onreadystatechange=null,n.parentNode&&n.parentNode.removeChild(n),r())},n.onerror=()=>{qt("Long-poll script failed to load: "+t),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(n)}catch{}},Math.floor(1))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fO=16384,hO=45e3;let Lf=null;typeof MozWebSocket<"u"?Lf=MozWebSocket:typeof WebSocket<"u"&&(Lf=WebSocket);class _n{constructor(t,r,n,i,s,a,o){this.connId=t,this.applicationId=n,this.appCheckToken=i,this.authToken=s,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=Uc(this.connId),this.stats_=t1(r),this.connURL=_n.connectionURL_(r,a,o,i,n),this.nodeAdmin=r.nodeAdmin}static connectionURL_(t,r,n,i,s){const a={};return a[qE]=e1,typeof location<"u"&&location.hostname&&ek.test(location.hostname)&&(a[JE]=ZE),r&&(a[QE]=r),n&&(a[tk]=n),i&&(a[mp]=i),s&&(a[rk]=s),ak(t,nk,a)}open(t,r){this.onDisconnect=r,this.onMessage=t,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,Bs.set("previous_websocket_failure",!0);try{let n;sE(),this.mySock=new Lf(this.connURL,[],n)}catch(n){this.log_("Error instantiating WebSocket.");const i=n.message||n.data;i&&this.log_(i),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=n=>{this.handleIncomingFrame(n)},this.mySock.onerror=n=>{this.log_("WebSocket error.  Closing connection.");const i=n.message||n.data;i&&this.log_(i),this.onClosed_()}}start(){}static forceDisallow(){_n.forceDisallow_=!0}static isAvailable(){let t=!1;if(typeof navigator<"u"&&navigator.userAgent){const r=/Android ([0-9]{0,}\.[0-9]{0,})/,n=navigator.userAgent.match(r);n&&n.length>1&&parseFloat(n[1])<4.4&&(t=!0)}return!t&&Lf!==null&&!_n.forceDisallow_}static previouslyFailed(){return Bs.isInMemoryStorage||Bs.get("previous_websocket_failure")===!0}markConnectionHealthy(){Bs.remove("previous_websocket_failure")}appendFrame_(t){if(this.frames.push(t),this.frames.length===this.totalFrames){const r=this.frames.join("");this.frames=null;const n=tc(r);this.onMessage(n)}}handleNewFrameCount_(t){this.totalFrames=t,this.frames=[]}extractFrameCount_(t){if(oe(this.frames===null,"We already have a frame buffer"),t.length<=6){const r=Number(t);if(!isNaN(r))return this.handleNewFrameCount_(r),null}return this.handleNewFrameCount_(1),t}handleIncomingFrame(t){if(this.mySock===null)return;const r=t.data;if(this.bytesReceived+=r.length,this.stats_.incrementCounter("bytes_received",r.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(r);else{const n=this.extractFrameCount_(r);n!==null&&this.appendFrame_(n)}}send(t){this.resetKeepAlive();const r=Ht(t);this.bytesSent+=r.length,this.stats_.incrementCounter("bytes_sent",r.length);const n=XE(r,fO);n.length>1&&this.sendString_(String(n.length));for(let i=0;i<n.length;i++)this.sendString_(n[i])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(hO))}sendString_(t){try{this.mySock.send(t)}catch(r){this.log_("Exception thrown from WebSocket.send():",r.message||r.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}_n.responsesRequiredToBeHealthy=2;_n.healthyTimeout=3e4;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sc{constructor(t){this.initTransports_(t)}static get ALL_TRANSPORTS(){return[za,_n]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(t){const r=_n&&_n.isAvailable();let n=r&&!_n.previouslyFailed();if(t.webSocketOnly&&(r||yr("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),n=!0),n)this.transports_=[_n];else{const i=this.transports_=[];for(const s of sc.ALL_TRANSPORTS)s&&s.isAvailable()&&i.push(s);sc.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}sc.globalTransportInitialized_=!1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dO=6e4,pO=5e3,mO=10*1024,gO=100*1024,Wh="t",Rx="d",vO="s",Px="r",xO="e",Ox="o",Dx="a",bx="n",Lx="p",_O="h";class yO{constructor(t,r,n,i,s,a,o,l,c,u){this.id=t,this.repoInfo_=r,this.applicationId_=n,this.appCheckToken_=i,this.authToken_=s,this.onMessage_=a,this.onReady_=o,this.onDisconnect_=l,this.onKill_=c,this.lastSessionId=u,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=Uc("c:"+this.id+":"),this.transportManager_=new sc(r),this.log_("Connection created"),this.start_()}start_(){const t=this.transportManager_.initialTransport();this.conn_=new t(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=t.responsesRequiredToBeHealthy||0;const r=this.connReceiver_(this.conn_),n=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(r,n)},Math.floor(0));const i=t.healthyTimeout||0;i>0&&(this.healthyTimeout_=Tl(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>gO?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>mO?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(t){return r=>{t===this.conn_?this.onConnectionLost_(r):t===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(t){return r=>{this.state_!==2&&(t===this.rx_?this.onPrimaryMessageReceived_(r):t===this.secondaryConn_?this.onSecondaryMessageReceived_(r):this.log_("message on old connection"))}}sendRequest(t){const r={t:"d",d:t};this.sendData_(r)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(t){if(Wh in t){const r=t[Wh];r===Dx?this.upgradeIfSecondaryHealthy_():r===Px?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):r===Ox&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(t){const r=Zo("t",t),n=Zo("d",t);if(r==="c")this.onSecondaryControl_(n);else if(r==="d")this.pendingDataMessages.push(n);else throw new Error("Unknown protocol layer: "+r)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:Lx,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:Dx,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:bx,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(t){const r=Zo("t",t),n=Zo("d",t);r==="c"?this.onControl_(n):r==="d"&&this.onDataMessage_(n)}onDataMessage_(t){this.onPrimaryResponse_(),this.onMessage_(t)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(t){const r=Zo(Wh,t);if(Rx in t){const n=t[Rx];if(r===_O){const i=Object.assign({},n);this.repoInfo_.isUsingEmulator&&(i.h=this.repoInfo_.host),this.onHandshake_(i)}else if(r===bx){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else r===vO?this.onConnectionShutdown_(n):r===Px?this.onReset_(n):r===xO?pp("Server Error: "+n):r===Ox?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):pp("Unknown control packet command: "+r)}}onHandshake_(t){const r=t.ts,n=t.v,i=t.h;this.sessionId=t.s,this.repoInfo_.host=i,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,r),e1!==n&&yr("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const t=this.transportManager_.upgradeTransport();t&&this.startUpgrade_(t)}startUpgrade_(t){this.secondaryConn_=new t(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=t.responsesRequiredToBeHealthy||0;const r=this.connReceiver_(this.secondaryConn_),n=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(r,n),Tl(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(dO))}onReset_(t){this.log_("Reset packet received.  New host: "+t),this.repoInfo_.host=t,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(t,r){this.log_("Realtime connection established."),this.conn_=t,this.state_=1,this.onReady_&&(this.onReady_(r,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):Tl(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(pO))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:Lx,d:{}}}))}onSecondaryConnectionLost_(){const t=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===t||this.rx_===t)&&this.close()}onConnectionLost_(t){this.conn_=null,!t&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(Bs.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(t){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(t),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(t){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(t)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hk{put(t,r,n,i){}merge(t,r,n,i){}refreshAuthToken(t){}refreshAppCheckToken(t){}onDisconnectPut(t,r,n){}onDisconnectMerge(t,r,n){}onDisconnectCancel(t,r){}reportStats(t){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dk{constructor(t){this.allowedEvents_=t,this.listeners_={},oe(Array.isArray(t)&&t.length>0,"Requires a non-empty array")}trigger(t,...r){if(Array.isArray(this.listeners_[t])){const n=[...this.listeners_[t]];for(let i=0;i<n.length;i++)n[i].callback.apply(n[i].context,r)}}on(t,r,n){this.validateEventType_(t),this.listeners_[t]=this.listeners_[t]||[],this.listeners_[t].push({callback:r,context:n});const i=this.getInitialEvent(t);i&&r.apply(n,i)}off(t,r,n){this.validateEventType_(t);const i=this.listeners_[t]||[];for(let s=0;s<i.length;s++)if(i[s].callback===r&&(!n||n===i[s].context)){i.splice(s,1);return}}validateEventType_(t){oe(this.allowedEvents_.find(r=>r===t),"Unknown event: "+t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mf extends dk{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!Um()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new Mf}getInitialEvent(t){return oe(t==="online","Unknown event type: "+t),[this.online_]}currentlyOnline(){return this.online_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mx=32,Bx=768;class Qe{constructor(t,r){if(r===void 0){this.pieces_=t.split("/");let n=0;for(let i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[n]=this.pieces_[i],n++);this.pieces_.length=n,this.pieceNum_=0}else this.pieces_=t,this.pieceNum_=r}toString(){let t="";for(let r=this.pieceNum_;r<this.pieces_.length;r++)this.pieces_[r]!==""&&(t+="/"+this.pieces_[r]);return t||"/"}}function ze(){return new Qe("")}function De(e){return e.pieceNum_>=e.pieces_.length?null:e.pieces_[e.pieceNum_]}function ds(e){return e.pieces_.length-e.pieceNum_}function et(e){let t=e.pieceNum_;return t<e.pieces_.length&&t++,new Qe(e.pieces_,t)}function n1(e){return e.pieceNum_<e.pieces_.length?e.pieces_[e.pieces_.length-1]:null}function wO(e){let t="";for(let r=e.pieceNum_;r<e.pieces_.length;r++)e.pieces_[r]!==""&&(t+="/"+encodeURIComponent(String(e.pieces_[r])));return t||"/"}function ac(e,t=0){return e.pieces_.slice(e.pieceNum_+t)}function pk(e){if(e.pieceNum_>=e.pieces_.length)return null;const t=[];for(let r=e.pieceNum_;r<e.pieces_.length-1;r++)t.push(e.pieces_[r]);return new Qe(t,0)}function xt(e,t){const r=[];for(let n=e.pieceNum_;n<e.pieces_.length;n++)r.push(e.pieces_[n]);if(t instanceof Qe)for(let n=t.pieceNum_;n<t.pieces_.length;n++)r.push(t.pieces_[n]);else{const n=t.split("/");for(let i=0;i<n.length;i++)n[i].length>0&&r.push(n[i])}return new Qe(r,0)}function Me(e){return e.pieceNum_>=e.pieces_.length}function Ar(e,t){const r=De(e),n=De(t);if(r===null)return t;if(r===n)return Ar(et(e),et(t));throw new Error("INTERNAL ERROR: innerPath ("+t+") is not within outerPath ("+e+")")}function EO(e,t){const r=ac(e,0),n=ac(t,0);for(let i=0;i<r.length&&i<n.length;i++){const s=va(r[i],n[i]);if(s!==0)return s}return r.length===n.length?0:r.length<n.length?-1:1}function i1(e,t){if(ds(e)!==ds(t))return!1;for(let r=e.pieceNum_,n=t.pieceNum_;r<=e.pieces_.length;r++,n++)if(e.pieces_[r]!==t.pieces_[n])return!1;return!0}function on(e,t){let r=e.pieceNum_,n=t.pieceNum_;if(ds(e)>ds(t))return!1;for(;r<e.pieces_.length;){if(e.pieces_[r]!==t.pieces_[n])return!1;++r,++n}return!0}class kO{constructor(t,r){this.errorPrefix_=r,this.parts_=ac(t,0),this.byteLength_=Math.max(1,this.parts_.length);for(let n=0;n<this.parts_.length;n++)this.byteLength_+=F0(this.parts_[n]);mk(this)}}function TO(e,t){e.parts_.length>0&&(e.byteLength_+=1),e.parts_.push(t),e.byteLength_+=F0(t),mk(e)}function SO(e){const t=e.parts_.pop();e.byteLength_-=F0(t),e.parts_.length>0&&(e.byteLength_-=1)}function mk(e){if(e.byteLength_>Bx)throw new Error(e.errorPrefix_+"has a key path longer than "+Bx+" bytes ("+e.byteLength_+").");if(e.parts_.length>Mx)throw new Error(e.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+Mx+") or object contains a cycle "+Os(e))}function Os(e){return e.parts_.length===0?"":"in property '"+e.parts_.join(".")+"'"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s1 extends dk{constructor(){super(["visible"]);let t,r;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(r="visibilitychange",t="hidden"):typeof document.mozHidden<"u"?(r="mozvisibilitychange",t="mozHidden"):typeof document.msHidden<"u"?(r="msvisibilitychange",t="msHidden"):typeof document.webkitHidden<"u"&&(r="webkitvisibilitychange",t="webkitHidden")),this.visible_=!0,r&&document.addEventListener(r,()=>{const n=!document[t];n!==this.visible_&&(this.visible_=n,this.trigger("visible",n))},!1)}static getInstance(){return new s1}getInitialEvent(t){return oe(t==="visible","Unknown event type: "+t),[this.visible_]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const el=1e3,CO=60*5*1e3,Ux=30*1e3,IO=1.3,AO=3e4,FO="server_kill",Wx=3;class hi extends hk{constructor(t,r,n,i,s,a,o,l){if(super(),this.repoInfo_=t,this.applicationId_=r,this.onDataUpdate_=n,this.onConnectStatus_=i,this.onServerInfoUpdate_=s,this.authTokenProvider_=a,this.appCheckTokenProvider_=o,this.authOverride_=l,this.id=hi.nextPersistentConnectionId_++,this.log_=Uc("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=el,this.maxReconnectDelay_=CO,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,l&&!sE())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");s1.getInstance().on("visible",this.onVisible_,this),t.host.indexOf("fblocal")===-1&&Mf.getInstance().on("online",this.onOnline_,this)}sendRequest(t,r,n){const i=++this.requestNumber_,s={r:i,a:t,b:r};this.log_(Ht(s)),oe(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(s),n&&(this.requestCBHash_[i]=n)}get(t){this.initConnection_();const r=new Oc,i={action:"g",request:{p:t._path.toString(),q:t._queryObject},onComplete:a=>{const o=a.d;a.s==="ok"?r.resolve(o):r.reject(o)}};this.outstandingGets_.push(i),this.outstandingGetCount_++;const s=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(s),r.promise}listen(t,r,n,i){this.initConnection_();const s=t._queryIdentifier,a=t._path.toString();this.log_("Listen called for "+a+" "+s),this.listens.has(a)||this.listens.set(a,new Map),oe(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"listen() called for non-default but complete query"),oe(!this.listens.get(a).has(s),"listen() called twice for same path/queryId.");const o={onComplete:i,hashFn:r,query:t,tag:n};this.listens.get(a).set(s,o),this.connected_&&this.sendListen_(o)}sendGet_(t){const r=this.outstandingGets_[t];this.sendRequest("g",r.request,n=>{delete this.outstandingGets_[t],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),r.onComplete&&r.onComplete(n)})}sendListen_(t){const r=t.query,n=r._path.toString(),i=r._queryIdentifier;this.log_("Listen on "+n+" for "+i);const s={p:n},a="q";t.tag&&(s.q=r._queryObject,s.t=t.tag),s.h=t.hashFn(),this.sendRequest(a,s,o=>{const l=o.d,c=o.s;hi.warnOnListenWarnings_(l,r),(this.listens.get(n)&&this.listens.get(n).get(i))===t&&(this.log_("listen response",o),c!=="ok"&&this.removeListen_(n,i),t.onComplete&&t.onComplete(c,l))})}static warnOnListenWarnings_(t,r){if(t&&typeof t=="object"&&Kn(t,"w")){const n=go(t,"w");if(Array.isArray(n)&&~n.indexOf("no_index")){const i='".indexOn": "'+r._queryParams.getIndex().toString()+'"',s=r._path.toString();yr(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${i} at ${s} to your security rules for better performance.`)}}}refreshAuthToken(t){this.authToken_=t,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(t)}reduceReconnectDelayIfAdminCredential_(t){(t&&t.length===40||sN(t))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=Ux)}refreshAppCheckToken(t){this.appCheckToken_=t,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const t=this.authToken_,r=iN(t)?"auth":"gauth",n={cred:t};this.authOverride_===null?n.noauth=!0:typeof this.authOverride_=="object"&&(n.authvar=this.authOverride_),this.sendRequest(r,n,i=>{const s=i.s,a=i.d||"error";this.authToken_===t&&(s==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(s,a))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},t=>{const r=t.s,n=t.d||"error";r==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(r,n)})}unlisten(t,r){const n=t._path.toString(),i=t._queryIdentifier;this.log_("Unlisten called for "+n+" "+i),oe(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(n,i)&&this.connected_&&this.sendUnlisten_(n,i,t._queryObject,r)}sendUnlisten_(t,r,n,i){this.log_("Unlisten on "+t+" for "+r);const s={p:t},a="n";i&&(s.q=n,s.t=i),this.sendRequest(a,s)}onDisconnectPut(t,r,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",t,r,n):this.onDisconnectRequestQueue_.push({pathString:t,action:"o",data:r,onComplete:n})}onDisconnectMerge(t,r,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",t,r,n):this.onDisconnectRequestQueue_.push({pathString:t,action:"om",data:r,onComplete:n})}onDisconnectCancel(t,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",t,null,r):this.onDisconnectRequestQueue_.push({pathString:t,action:"oc",data:null,onComplete:r})}sendOnDisconnect_(t,r,n,i){const s={p:r,d:n};this.log_("onDisconnect "+t,s),this.sendRequest(t,s,a=>{i&&setTimeout(()=>{i(a.s,a.d)},Math.floor(0))})}put(t,r,n,i){this.putInternal("p",t,r,n,i)}merge(t,r,n,i){this.putInternal("m",t,r,n,i)}putInternal(t,r,n,i,s){this.initConnection_();const a={p:r,d:n};s!==void 0&&(a.h=s),this.outstandingPuts_.push({action:t,request:a,onComplete:i}),this.outstandingPutCount_++;const o=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(o):this.log_("Buffering put: "+r)}sendPut_(t){const r=this.outstandingPuts_[t].action,n=this.outstandingPuts_[t].request,i=this.outstandingPuts_[t].onComplete;this.outstandingPuts_[t].queued=this.connected_,this.sendRequest(r,n,s=>{this.log_(r+" response",s),delete this.outstandingPuts_[t],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),i&&i(s.s,s.d)})}reportStats(t){if(this.connected_){const r={c:t};this.log_("reportStats",r),this.sendRequest("s",r,n=>{if(n.s!=="ok"){const s=n.d;this.log_("reportStats","Error sending stats: "+s)}})}}onDataMessage_(t){if("r"in t){this.log_("from server: "+Ht(t));const r=t.r,n=this.requestCBHash_[r];n&&(delete this.requestCBHash_[r],n(t.b))}else{if("error"in t)throw"A server-side error has occurred: "+t.error;"a"in t&&this.onDataPush_(t.a,t.b)}}onDataPush_(t,r){this.log_("handleServerMessage",t,r),t==="d"?this.onDataUpdate_(r.p,r.d,!1,r.t):t==="m"?this.onDataUpdate_(r.p,r.d,!0,r.t):t==="c"?this.onListenRevoked_(r.p,r.q):t==="ac"?this.onAuthRevoked_(r.s,r.d):t==="apc"?this.onAppCheckRevoked_(r.s,r.d):t==="sd"?this.onSecurityDebugPacket_(r):pp("Unrecognized action received from server: "+Ht(t)+`
Are you using the latest client?`)}onReady_(t,r){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(t),this.lastSessionId=r,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(t){oe(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(t))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(t){t&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=el,this.realtime_||this.scheduleConnect_(0)),this.visible_=t}onOnline_(t){t?(this.log_("Browser went online."),this.reconnectDelay_=el,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>AO&&(this.reconnectDelay_=el),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());const t=new Date().getTime()-this.lastConnectionAttemptTime_;let r=Math.max(0,this.reconnectDelay_-t);r=Math.random()*r,this.log_("Trying to reconnect in "+r+"ms"),this.scheduleConnect_(r),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*IO)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;const t=this.onDataMessage_.bind(this),r=this.onReady_.bind(this),n=this.onRealtimeDisconnect_.bind(this),i=this.id+":"+hi.nextConnectionId_++,s=this.lastSessionId;let a=!1,o=null;const l=function(){o?o.close():(a=!0,n())},c=function(f){oe(o,"sendRequest call when we're not connected not allowed."),o.sendRequest(f)};this.realtime_={close:l,sendRequest:c};const u=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[f,h]=await Promise.all([this.authTokenProvider_.getToken(u),this.appCheckTokenProvider_.getToken(u)]);a?qt("getToken() completed but was canceled"):(qt("getToken() completed. Creating connection."),this.authToken_=f&&f.accessToken,this.appCheckToken_=h&&h.token,o=new yO(i,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,t,r,n,d=>{yr(d+" ("+this.repoInfo_.toString()+")"),this.interrupt(FO)},s))}catch(f){this.log_("Failed to get token: "+f),a||(this.repoInfo_.nodeAdmin&&yr(f),l())}}}interrupt(t){qt("Interrupting connection for reason: "+t),this.interruptReasons_[t]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(t){qt("Resuming connection for reason: "+t),delete this.interruptReasons_[t],sp(this.interruptReasons_)&&(this.reconnectDelay_=el,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(t){const r=t-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:r})}cancelSentTransactions_(){for(let t=0;t<this.outstandingPuts_.length;t++){const r=this.outstandingPuts_[t];r&&"h"in r.request&&r.queued&&(r.onComplete&&r.onComplete("disconnect"),delete this.outstandingPuts_[t],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(t,r){let n;r?n=r.map(s=>Zm(s)).join("$"):n="default";const i=this.removeListen_(t,n);i&&i.onComplete&&i.onComplete("permission_denied")}removeListen_(t,r){const n=new Qe(t).toString();let i;if(this.listens.has(n)){const s=this.listens.get(n);i=s.get(r),s.delete(r),s.size===0&&this.listens.delete(n)}else i=void 0;return i}onAuthRevoked_(t,r){qt("Auth token revoked: "+t+"/"+r),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(t==="invalid_token"||t==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=Wx&&(this.reconnectDelay_=Ux,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(t,r){qt("App check token revoked: "+t+"/"+r),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(t==="invalid_token"||t==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=Wx&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(t){this.securityDebugCallback_?this.securityDebugCallback_(t):"msg"in t&&console.log("FIREBASE: "+t.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const t of this.listens.values())for(const r of t.values())this.sendListen_(r);for(let t=0;t<this.outstandingPuts_.length;t++)this.outstandingPuts_[t]&&this.sendPut_(t);for(;this.onDisconnectRequestQueue_.length;){const t=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(t.action,t.pathString,t.data,t.onComplete)}for(let t=0;t<this.outstandingGets_.length;t++)this.outstandingGets_[t]&&this.sendGet_(t)}sendConnectStats_(){const t={};let r="js";t["sdk."+r+"."+$E.replace(/\./g,"-")]=1,Um()?t["framework.cordova"]=1:iE()&&(t["framework.reactnative"]=1),this.reportStats(t)}shouldReconnect_(){const t=Mf.getInstance().currentlyOnline();return sp(this.interruptReasons_)&&t}}hi.nextPersistentConnectionId_=0;hi.nextConnectionId_=0;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class be{constructor(t,r){this.name=t,this.node=r}static Wrap(t,r){return new be(t,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b0{getCompare(){return this.compare.bind(this)}indexedValueChanged(t,r){const n=new be(xo,t),i=new be(xo,r);return this.compare(n,i)!==0}minPost(){return be.MIN}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let gu;class gk extends b0{static get __EMPTY_NODE(){return gu}static set __EMPTY_NODE(t){gu=t}compare(t,r){return va(t.name,r.name)}isDefinedOn(t){throw Fo("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(t,r){return!1}minPost(){return be.MIN}maxPost(){return new be(ea,gu)}makePost(t,r){return oe(typeof t=="string","KeyIndex indexValue must always be a string."),new be(t,gu)}toString(){return".key"}}const ro=new gk;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vu{constructor(t,r,n,i,s=null){this.isReverse_=i,this.resultGenerator_=s,this.nodeStack_=[];let a=1;for(;!t.isEmpty();)if(t=t,a=r?n(t.key,r):1,i&&(a*=-1),a<0)this.isReverse_?t=t.left:t=t.right;else if(a===0){this.nodeStack_.push(t);break}else this.nodeStack_.push(t),this.isReverse_?t=t.right:t=t.left}getNext(){if(this.nodeStack_.length===0)return null;let t=this.nodeStack_.pop(),r;if(this.resultGenerator_?r=this.resultGenerator_(t.key,t.value):r={key:t.key,value:t.value},this.isReverse_)for(t=t.left;!t.isEmpty();)this.nodeStack_.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack_.push(t),t=t.left;return r}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;const t=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value}}}class Vt{constructor(t,r,n,i,s){this.key=t,this.value=r,this.color=n??Vt.RED,this.left=i??Fr.EMPTY_NODE,this.right=s??Fr.EMPTY_NODE}copy(t,r,n,i,s){return new Vt(t??this.key,r??this.value,n??this.color,i??this.left,s??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||!!t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,r,n){let i=this;const s=n(t,i.key);return s<0?i=i.copy(null,null,null,i.left.insert(t,r,n),null):s===0?i=i.copy(null,r,null,null,null):i=i.copy(null,null,null,null,i.right.insert(t,r,n)),i.fixUp_()}removeMin_(){if(this.left.isEmpty())return Fr.EMPTY_NODE;let t=this;return!t.left.isRed_()&&!t.left.left.isRed_()&&(t=t.moveRedLeft_()),t=t.copy(null,null,null,t.left.removeMin_(),null),t.fixUp_()}remove(t,r){let n,i;if(n=this,r(t,n.key)<0)!n.left.isEmpty()&&!n.left.isRed_()&&!n.left.left.isRed_()&&(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.remove(t,r),null);else{if(n.left.isRed_()&&(n=n.rotateRight_()),!n.right.isEmpty()&&!n.right.isRed_()&&!n.right.left.isRed_()&&(n=n.moveRedRight_()),r(t,n.key)===0){if(n.right.isEmpty())return Fr.EMPTY_NODE;i=n.right.min_(),n=n.copy(i.key,i.value,null,null,n.right.removeMin_())}n=n.copy(null,null,null,null,n.right.remove(t,r))}return n.fixUp_()}isRed_(){return this.color}fixUp_(){let t=this;return t.right.isRed_()&&!t.left.isRed_()&&(t=t.rotateLeft_()),t.left.isRed_()&&t.left.left.isRed_()&&(t=t.rotateRight_()),t.left.isRed_()&&t.right.isRed_()&&(t=t.colorFlip_()),t}moveRedLeft_(){let t=this.colorFlip_();return t.right.left.isRed_()&&(t=t.copy(null,null,null,null,t.right.rotateRight_()),t=t.rotateLeft_(),t=t.colorFlip_()),t}moveRedRight_(){let t=this.colorFlip_();return t.left.left.isRed_()&&(t=t.rotateRight_(),t=t.colorFlip_()),t}rotateLeft_(){const t=this.copy(null,null,Vt.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight_(){const t=this.copy(null,null,Vt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip_(){const t=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,r)}checkMaxDepth_(){const t=this.check_();return Math.pow(2,t)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const t=this.left.check_();if(t!==this.right.check_())throw new Error("Black depths differ");return t+(this.isRed_()?0:1)}}Vt.RED=!0;Vt.BLACK=!1;class NO{copy(t,r,n,i,s){return this}insert(t,r,n){return new Vt(t,r,null)}remove(t,r){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}}class Fr{constructor(t,r=Fr.EMPTY_NODE){this.comparator_=t,this.root_=r}insert(t,r){return new Fr(this.comparator_,this.root_.insert(t,r,this.comparator_).copy(null,null,Vt.BLACK,null,null))}remove(t){return new Fr(this.comparator_,this.root_.remove(t,this.comparator_).copy(null,null,Vt.BLACK,null,null))}get(t){let r,n=this.root_;for(;!n.isEmpty();){if(r=this.comparator_(t,n.key),r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}getPredecessorKey(t){let r,n=this.root_,i=null;for(;!n.isEmpty();)if(r=this.comparator_(t,n.key),r===0){if(n.left.isEmpty())return i?i.key:null;for(n=n.left;!n.right.isEmpty();)n=n.right;return n.key}else r<0?n=n.left:r>0&&(i=n,n=n.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(t){return this.root_.inorderTraversal(t)}reverseTraversal(t){return this.root_.reverseTraversal(t)}getIterator(t){return new vu(this.root_,null,this.comparator_,!1,t)}getIteratorFrom(t,r){return new vu(this.root_,t,this.comparator_,!1,r)}getReverseIteratorFrom(t,r){return new vu(this.root_,t,this.comparator_,!0,r)}getReverseIterator(t){return new vu(this.root_,null,this.comparator_,!0,t)}}Fr.EMPTY_NODE=new NO;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RO(e,t){return va(e.name,t.name)}function a1(e,t){return va(e,t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let gp;function PO(e){gp=e}const vk=function(e){return typeof e=="number"?"number:"+YE(e):"string:"+e},xk=function(e){if(e.isLeafNode()){const t=e.val();oe(typeof t=="string"||typeof t=="number"||typeof t=="object"&&Kn(t,".sv"),"Priority must be a string or number.")}else oe(e===gp||e.isEmpty(),"priority of unexpected type.");oe(e===gp||e.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Vx;class Bt{constructor(t,r=Bt.__childrenNodeConstructor.EMPTY_NODE){this.value_=t,this.priorityNode_=r,this.lazyHash_=null,oe(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),xk(this.priorityNode_)}static set __childrenNodeConstructor(t){Vx=t}static get __childrenNodeConstructor(){return Vx}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(t){return new Bt(this.value_,t)}getImmediateChild(t){return t===".priority"?this.priorityNode_:Bt.__childrenNodeConstructor.EMPTY_NODE}getChild(t){return Me(t)?this:De(t)===".priority"?this.priorityNode_:Bt.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(t,r){return null}updateImmediateChild(t,r){return t===".priority"?this.updatePriority(r):r.isEmpty()&&t!==".priority"?this:Bt.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(t,r).updatePriority(this.priorityNode_)}updateChild(t,r){const n=De(t);return n===null?r:r.isEmpty()&&n!==".priority"?this:(oe(n!==".priority"||ds(t)===1,".priority must be the last token in a path"),this.updateImmediateChild(n,Bt.__childrenNodeConstructor.EMPTY_NODE.updateChild(et(t),r)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(t,r){return!1}val(t){return t&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let t="";this.priorityNode_.isEmpty()||(t+="priority:"+vk(this.priorityNode_.val())+":");const r=typeof this.value_;t+=r+":",r==="number"?t+=YE(this.value_):t+=this.value_,this.lazyHash_=KE(t)}return this.lazyHash_}getValue(){return this.value_}compareTo(t){return t===Bt.__childrenNodeConstructor.EMPTY_NODE?1:t instanceof Bt.__childrenNodeConstructor?-1:(oe(t.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(t))}compareToLeafNode_(t){const r=typeof t.value_,n=typeof this.value_,i=Bt.VALUE_TYPE_ORDER.indexOf(r),s=Bt.VALUE_TYPE_ORDER.indexOf(n);return oe(i>=0,"Unknown leaf type: "+r),oe(s>=0,"Unknown leaf type: "+n),i===s?n==="object"?0:this.value_<t.value_?-1:this.value_===t.value_?0:1:s-i}withIndex(){return this}isIndexed(){return!0}equals(t){if(t===this)return!0;if(t.isLeafNode()){const r=t;return this.value_===r.value_&&this.priorityNode_.equals(r.priorityNode_)}else return!1}}Bt.VALUE_TYPE_ORDER=["object","boolean","number","string"];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let _k,yk;function OO(e){_k=e}function DO(e){yk=e}class bO extends b0{compare(t,r){const n=t.node.getPriority(),i=r.node.getPriority(),s=n.compareTo(i);return s===0?va(t.name,r.name):s}isDefinedOn(t){return!t.getPriority().isEmpty()}indexedValueChanged(t,r){return!t.getPriority().equals(r.getPriority())}minPost(){return be.MIN}maxPost(){return new be(ea,new Bt("[PRIORITY-POST]",yk))}makePost(t,r){const n=_k(t);return new be(r,new Bt("[PRIORITY-POST]",n))}toString(){return".priority"}}const _t=new bO;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LO=Math.log(2);class MO{constructor(t){const r=s=>parseInt(Math.log(s)/LO,10),n=s=>parseInt(Array(s+1).join("1"),2);this.count=r(t+1),this.current_=this.count-1;const i=n(this.count);this.bits_=t+1&i}nextBitIsOne(){const t=!(this.bits_&1<<this.current_);return this.current_--,t}}const Bf=function(e,t,r,n){e.sort(t);const i=function(l,c){const u=c-l;let f,h;if(u===0)return null;if(u===1)return f=e[l],h=r?r(f):f,new Vt(h,f.node,Vt.BLACK,null,null);{const d=parseInt(u/2,10)+l,m=i(l,d),p=i(d+1,c);return f=e[d],h=r?r(f):f,new Vt(h,f.node,Vt.BLACK,m,p)}},s=function(l){let c=null,u=null,f=e.length;const h=function(m,p){const g=f-m,x=f;f-=m;const _=i(g+1,x),v=e[g],E=r?r(v):v;d(new Vt(E,v.node,p,null,_))},d=function(m){c?(c.left=m,c=m):(u=m,c=m)};for(let m=0;m<l.count;++m){const p=l.nextBitIsOne(),g=Math.pow(2,l.count-(m+1));p?h(g,Vt.BLACK):(h(g,Vt.BLACK),h(g,Vt.RED))}return u},a=new MO(e.length),o=s(a);return new Fr(n||t,o)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Vh;const Ca={};class ci{constructor(t,r){this.indexes_=t,this.indexSet_=r}static get Default(){return oe(Ca&&_t,"ChildrenNode.ts has not been loaded"),Vh=Vh||new ci({".priority":Ca},{".priority":_t}),Vh}get(t){const r=go(this.indexes_,t);if(!r)throw new Error("No index defined for "+t);return r instanceof Fr?r:null}hasIndex(t){return Kn(this.indexSet_,t.toString())}addIndex(t,r){oe(t!==ro,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const n=[];let i=!1;const s=r.getIterator(be.Wrap);let a=s.getNext();for(;a;)i=i||t.isDefinedOn(a.node),n.push(a),a=s.getNext();let o;i?o=Bf(n,t.getCompare()):o=Ca;const l=t.toString(),c=Object.assign({},this.indexSet_);c[l]=t;const u=Object.assign({},this.indexes_);return u[l]=o,new ci(u,c)}addToIndexes(t,r){const n=Af(this.indexes_,(i,s)=>{const a=go(this.indexSet_,s);if(oe(a,"Missing index implementation for "+s),i===Ca)if(a.isDefinedOn(t.node)){const o=[],l=r.getIterator(be.Wrap);let c=l.getNext();for(;c;)c.name!==t.name&&o.push(c),c=l.getNext();return o.push(t),Bf(o,a.getCompare())}else return Ca;else{const o=r.get(t.name);let l=i;return o&&(l=l.remove(new be(t.name,o))),l.insert(t,t.node)}});return new ci(n,this.indexSet_)}removeFromIndexes(t,r){const n=Af(this.indexes_,i=>{if(i===Ca)return i;{const s=r.get(t.name);return s?i.remove(new be(t.name,s)):i}});return new ci(n,this.indexSet_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let tl;class Ce{constructor(t,r,n){this.children_=t,this.priorityNode_=r,this.indexMap_=n,this.lazyHash_=null,this.priorityNode_&&xk(this.priorityNode_),this.children_.isEmpty()&&oe(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return tl||(tl=new Ce(new Fr(a1),null,ci.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||tl}updatePriority(t){return this.children_.isEmpty()?this:new Ce(this.children_,t,this.indexMap_)}getImmediateChild(t){if(t===".priority")return this.getPriority();{const r=this.children_.get(t);return r===null?tl:r}}getChild(t){const r=De(t);return r===null?this:this.getImmediateChild(r).getChild(et(t))}hasChild(t){return this.children_.get(t)!==null}updateImmediateChild(t,r){if(oe(r,"We should always be passing snapshot nodes"),t===".priority")return this.updatePriority(r);{const n=new be(t,r);let i,s;r.isEmpty()?(i=this.children_.remove(t),s=this.indexMap_.removeFromIndexes(n,this.children_)):(i=this.children_.insert(t,r),s=this.indexMap_.addToIndexes(n,this.children_));const a=i.isEmpty()?tl:this.priorityNode_;return new Ce(i,a,s)}}updateChild(t,r){const n=De(t);if(n===null)return r;{oe(De(t)!==".priority"||ds(t)===1,".priority must be the last token in a path");const i=this.getImmediateChild(n).updateChild(et(t),r);return this.updateImmediateChild(n,i)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(t){if(this.isEmpty())return null;const r={};let n=0,i=0,s=!0;if(this.forEachChild(_t,(a,o)=>{r[a]=o.val(t),n++,s&&Ce.INTEGER_REGEXP_.test(a)?i=Math.max(i,Number(a)):s=!1}),!t&&s&&i<2*n){const a=[];for(const o in r)a[o]=r[o];return a}else return t&&!this.getPriority().isEmpty()&&(r[".priority"]=this.getPriority().val()),r}hash(){if(this.lazyHash_===null){let t="";this.getPriority().isEmpty()||(t+="priority:"+vk(this.getPriority().val())+":"),this.forEachChild(_t,(r,n)=>{const i=n.hash();i!==""&&(t+=":"+r+":"+i)}),this.lazyHash_=t===""?"":KE(t)}return this.lazyHash_}getPredecessorChildName(t,r,n){const i=this.resolveIndex_(n);if(i){const s=i.getPredecessorKey(new be(t,r));return s?s.name:null}else return this.children_.getPredecessorKey(t)}getFirstChildName(t){const r=this.resolveIndex_(t);if(r){const n=r.minKey();return n&&n.name}else return this.children_.minKey()}getFirstChild(t){const r=this.getFirstChildName(t);return r?new be(r,this.children_.get(r)):null}getLastChildName(t){const r=this.resolveIndex_(t);if(r){const n=r.maxKey();return n&&n.name}else return this.children_.maxKey()}getLastChild(t){const r=this.getLastChildName(t);return r?new be(r,this.children_.get(r)):null}forEachChild(t,r){const n=this.resolveIndex_(t);return n?n.inorderTraversal(i=>r(i.name,i.node)):this.children_.inorderTraversal(r)}getIterator(t){return this.getIteratorFrom(t.minPost(),t)}getIteratorFrom(t,r){const n=this.resolveIndex_(r);if(n)return n.getIteratorFrom(t,i=>i);{const i=this.children_.getIteratorFrom(t.name,be.Wrap);let s=i.peek();for(;s!=null&&r.compare(s,t)<0;)i.getNext(),s=i.peek();return i}}getReverseIterator(t){return this.getReverseIteratorFrom(t.maxPost(),t)}getReverseIteratorFrom(t,r){const n=this.resolveIndex_(r);if(n)return n.getReverseIteratorFrom(t,i=>i);{const i=this.children_.getReverseIteratorFrom(t.name,be.Wrap);let s=i.peek();for(;s!=null&&r.compare(s,t)>0;)i.getNext(),s=i.peek();return i}}compareTo(t){return this.isEmpty()?t.isEmpty()?0:-1:t.isLeafNode()||t.isEmpty()?1:t===Wc?-1:0}withIndex(t){if(t===ro||this.indexMap_.hasIndex(t))return this;{const r=this.indexMap_.addIndex(t,this.children_);return new Ce(this.children_,this.priorityNode_,r)}}isIndexed(t){return t===ro||this.indexMap_.hasIndex(t)}equals(t){if(t===this)return!0;if(t.isLeafNode())return!1;{const r=t;if(this.getPriority().equals(r.getPriority()))if(this.children_.count()===r.children_.count()){const n=this.getIterator(_t),i=r.getIterator(_t);let s=n.getNext(),a=i.getNext();for(;s&&a;){if(s.name!==a.name||!s.node.equals(a.node))return!1;s=n.getNext(),a=i.getNext()}return s===null&&a===null}else return!1;else return!1}}resolveIndex_(t){return t===ro?null:this.indexMap_.get(t.toString())}}Ce.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;class BO extends Ce{constructor(){super(new Fr(a1),Ce.EMPTY_NODE,ci.Default)}compareTo(t){return t===this?0:1}equals(t){return t===this}getPriority(){return this}getImmediateChild(t){return Ce.EMPTY_NODE}isEmpty(){return!1}}const Wc=new BO;Object.defineProperties(be,{MIN:{value:new be(xo,Ce.EMPTY_NODE)},MAX:{value:new be(ea,Wc)}});gk.__EMPTY_NODE=Ce.EMPTY_NODE;Bt.__childrenNodeConstructor=Ce;PO(Wc);DO(Wc);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UO=!0;function jt(e,t=null){if(e===null)return Ce.EMPTY_NODE;if(typeof e=="object"&&".priority"in e&&(t=e[".priority"]),oe(t===null||typeof t=="string"||typeof t=="number"||typeof t=="object"&&".sv"in t,"Invalid priority type found: "+typeof t),typeof e=="object"&&".value"in e&&e[".value"]!==null&&(e=e[".value"]),typeof e!="object"||".sv"in e){const r=e;return new Bt(r,jt(t))}if(!(e instanceof Array)&&UO){const r=[];let n=!1;if(er(e,(a,o)=>{if(a.substring(0,1)!=="."){const l=jt(o);l.isEmpty()||(n=n||!l.getPriority().isEmpty(),r.push(new be(a,l)))}}),r.length===0)return Ce.EMPTY_NODE;const s=Bf(r,RO,a=>a.name,a1);if(n){const a=Bf(r,_t.getCompare());return new Ce(s,jt(t),new ci({".priority":a},{".priority":_t}))}else return new Ce(s,jt(t),ci.Default)}else{let r=Ce.EMPTY_NODE;return er(e,(n,i)=>{if(Kn(e,n)&&n.substring(0,1)!=="."){const s=jt(i);(s.isLeafNode()||!s.isEmpty())&&(r=r.updateImmediateChild(n,s))}}),r.updatePriority(jt(t))}}OO(jt);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WO extends b0{constructor(t){super(),this.indexPath_=t,oe(!Me(t)&&De(t)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(t){return t.getChild(this.indexPath_)}isDefinedOn(t){return!t.getChild(this.indexPath_).isEmpty()}compare(t,r){const n=this.extractChild(t.node),i=this.extractChild(r.node),s=n.compareTo(i);return s===0?va(t.name,r.name):s}makePost(t,r){const n=jt(t),i=Ce.EMPTY_NODE.updateChild(this.indexPath_,n);return new be(r,i)}maxPost(){const t=Ce.EMPTY_NODE.updateChild(this.indexPath_,Wc);return new be(ea,t)}toString(){return ac(this.indexPath_,0).join("/")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VO extends b0{compare(t,r){const n=t.node.compareTo(r.node);return n===0?va(t.name,r.name):n}isDefinedOn(t){return!0}indexedValueChanged(t,r){return!t.equals(r)}minPost(){return be.MIN}maxPost(){return be.MAX}makePost(t,r){const n=jt(t);return new be(r,n)}toString(){return".value"}}const jO=new VO;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wk(e){return{type:"value",snapshotNode:e}}function _o(e,t){return{type:"child_added",snapshotNode:t,childName:e}}function oc(e,t){return{type:"child_removed",snapshotNode:t,childName:e}}function lc(e,t,r){return{type:"child_changed",snapshotNode:t,childName:e,oldSnap:r}}function HO(e,t){return{type:"child_moved",snapshotNode:t,childName:e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o1{constructor(t){this.index_=t}updateChild(t,r,n,i,s,a){oe(t.isIndexed(this.index_),"A node must be indexed if only a child is updated");const o=t.getImmediateChild(r);return o.getChild(i).equals(n.getChild(i))&&o.isEmpty()===n.isEmpty()||(a!=null&&(n.isEmpty()?t.hasChild(r)?a.trackChildChange(oc(r,o)):oe(t.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):o.isEmpty()?a.trackChildChange(_o(r,n)):a.trackChildChange(lc(r,n,o))),t.isLeafNode()&&n.isEmpty())?t:t.updateImmediateChild(r,n).withIndex(this.index_)}updateFullNode(t,r,n){return n!=null&&(t.isLeafNode()||t.forEachChild(_t,(i,s)=>{r.hasChild(i)||n.trackChildChange(oc(i,s))}),r.isLeafNode()||r.forEachChild(_t,(i,s)=>{if(t.hasChild(i)){const a=t.getImmediateChild(i);a.equals(s)||n.trackChildChange(lc(i,s,a))}else n.trackChildChange(_o(i,s))})),r.withIndex(this.index_)}updatePriority(t,r){return t.isEmpty()?Ce.EMPTY_NODE:t.updatePriority(r)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cc{constructor(t){this.indexedFilter_=new o1(t.getIndex()),this.index_=t.getIndex(),this.startPost_=cc.getStartPost_(t),this.endPost_=cc.getEndPost_(t),this.startIsInclusive_=!t.startAfterSet_,this.endIsInclusive_=!t.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(t){const r=this.startIsInclusive_?this.index_.compare(this.getStartPost(),t)<=0:this.index_.compare(this.getStartPost(),t)<0,n=this.endIsInclusive_?this.index_.compare(t,this.getEndPost())<=0:this.index_.compare(t,this.getEndPost())<0;return r&&n}updateChild(t,r,n,i,s,a){return this.matches(new be(r,n))||(n=Ce.EMPTY_NODE),this.indexedFilter_.updateChild(t,r,n,i,s,a)}updateFullNode(t,r,n){r.isLeafNode()&&(r=Ce.EMPTY_NODE);let i=r.withIndex(this.index_);i=i.updatePriority(Ce.EMPTY_NODE);const s=this;return r.forEachChild(_t,(a,o)=>{s.matches(new be(a,o))||(i=i.updateImmediateChild(a,Ce.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(t,i,n)}updatePriority(t,r){return t}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(t){if(t.hasStart()){const r=t.getIndexStartName();return t.getIndex().makePost(t.getIndexStartValue(),r)}else return t.getIndex().minPost()}static getEndPost_(t){if(t.hasEnd()){const r=t.getIndexEndName();return t.getIndex().makePost(t.getIndexEndValue(),r)}else return t.getIndex().maxPost()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zO{constructor(t){this.withinDirectionalStart=r=>this.reverse_?this.withinEndPost(r):this.withinStartPost(r),this.withinDirectionalEnd=r=>this.reverse_?this.withinStartPost(r):this.withinEndPost(r),this.withinStartPost=r=>{const n=this.index_.compare(this.rangedFilter_.getStartPost(),r);return this.startIsInclusive_?n<=0:n<0},this.withinEndPost=r=>{const n=this.index_.compare(r,this.rangedFilter_.getEndPost());return this.endIsInclusive_?n<=0:n<0},this.rangedFilter_=new cc(t),this.index_=t.getIndex(),this.limit_=t.getLimit(),this.reverse_=!t.isViewFromLeft(),this.startIsInclusive_=!t.startAfterSet_,this.endIsInclusive_=!t.endBeforeSet_}updateChild(t,r,n,i,s,a){return this.rangedFilter_.matches(new be(r,n))||(n=Ce.EMPTY_NODE),t.getImmediateChild(r).equals(n)?t:t.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(t,r,n,i,s,a):this.fullLimitUpdateChild_(t,r,n,s,a)}updateFullNode(t,r,n){let i;if(r.isLeafNode()||r.isEmpty())i=Ce.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<r.numChildren()&&r.isIndexed(this.index_)){i=Ce.EMPTY_NODE.withIndex(this.index_);let s;this.reverse_?s=r.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):s=r.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let a=0;for(;s.hasNext()&&a<this.limit_;){const o=s.getNext();if(this.withinDirectionalStart(o))if(this.withinDirectionalEnd(o))i=i.updateImmediateChild(o.name,o.node),a++;else break;else continue}}else{i=r.withIndex(this.index_),i=i.updatePriority(Ce.EMPTY_NODE);let s;this.reverse_?s=i.getReverseIterator(this.index_):s=i.getIterator(this.index_);let a=0;for(;s.hasNext();){const o=s.getNext();a<this.limit_&&this.withinDirectionalStart(o)&&this.withinDirectionalEnd(o)?a++:i=i.updateImmediateChild(o.name,Ce.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(t,i,n)}updatePriority(t,r){return t}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(t,r,n,i,s){let a;if(this.reverse_){const f=this.index_.getCompare();a=(h,d)=>f(d,h)}else a=this.index_.getCompare();const o=t;oe(o.numChildren()===this.limit_,"");const l=new be(r,n),c=this.reverse_?o.getFirstChild(this.index_):o.getLastChild(this.index_),u=this.rangedFilter_.matches(l);if(o.hasChild(r)){const f=o.getImmediateChild(r);let h=i.getChildAfterChild(this.index_,c,this.reverse_);for(;h!=null&&(h.name===r||o.hasChild(h.name));)h=i.getChildAfterChild(this.index_,h,this.reverse_);const d=h==null?1:a(h,l);if(u&&!n.isEmpty()&&d>=0)return s!=null&&s.trackChildChange(lc(r,n,f)),o.updateImmediateChild(r,n);{s!=null&&s.trackChildChange(oc(r,f));const p=o.updateImmediateChild(r,Ce.EMPTY_NODE);return h!=null&&this.rangedFilter_.matches(h)?(s!=null&&s.trackChildChange(_o(h.name,h.node)),p.updateImmediateChild(h.name,h.node)):p}}else return n.isEmpty()?t:u&&a(c,l)>=0?(s!=null&&(s.trackChildChange(oc(c.name,c.node)),s.trackChildChange(_o(r,n))),o.updateImmediateChild(r,n).updateImmediateChild(c.name,Ce.EMPTY_NODE)):t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l1{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=_t}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return oe(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return oe(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:xo}hasEnd(){return this.endSet_}getIndexEndValue(){return oe(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return oe(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:ea}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return oe(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===_t}copy(){const t=new l1;return t.limitSet_=this.limitSet_,t.limit_=this.limit_,t.startSet_=this.startSet_,t.startAfterSet_=this.startAfterSet_,t.indexStartValue_=this.indexStartValue_,t.startNameSet_=this.startNameSet_,t.indexStartName_=this.indexStartName_,t.endSet_=this.endSet_,t.endBeforeSet_=this.endBeforeSet_,t.indexEndValue_=this.indexEndValue_,t.endNameSet_=this.endNameSet_,t.indexEndName_=this.indexEndName_,t.index_=this.index_,t.viewFrom_=this.viewFrom_,t}}function $O(e){return e.loadsAllData()?new o1(e.getIndex()):e.hasLimit()?new zO(e):new cc(e)}function jx(e){const t={};if(e.isDefault())return t;let r;if(e.index_===_t?r="$priority":e.index_===jO?r="$value":e.index_===ro?r="$key":(oe(e.index_ instanceof WO,"Unrecognized index type!"),r=e.index_.toString()),t.orderBy=Ht(r),e.startSet_){const n=e.startAfterSet_?"startAfter":"startAt";t[n]=Ht(e.indexStartValue_),e.startNameSet_&&(t[n]+=","+Ht(e.indexStartName_))}if(e.endSet_){const n=e.endBeforeSet_?"endBefore":"endAt";t[n]=Ht(e.indexEndValue_),e.endNameSet_&&(t[n]+=","+Ht(e.indexEndName_))}return e.limitSet_&&(e.isViewFromLeft()?t.limitToFirst=e.limit_:t.limitToLast=e.limit_),t}function Hx(e){const t={};if(e.startSet_&&(t.sp=e.indexStartValue_,e.startNameSet_&&(t.sn=e.indexStartName_),t.sin=!e.startAfterSet_),e.endSet_&&(t.ep=e.indexEndValue_,e.endNameSet_&&(t.en=e.indexEndName_),t.ein=!e.endBeforeSet_),e.limitSet_){t.l=e.limit_;let r=e.viewFrom_;r===""&&(e.isViewFromLeft()?r="l":r="r"),t.vf=r}return e.index_!==_t&&(t.i=e.index_.toString()),t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uf extends hk{constructor(t,r,n,i){super(),this.repoInfo_=t,this.onDataUpdate_=r,this.authTokenProvider_=n,this.appCheckTokenProvider_=i,this.log_=Uc("p:rest:"),this.listens_={}}reportStats(t){throw new Error("Method not implemented.")}static getListenId_(t,r){return r!==void 0?"tag$"+r:(oe(t._queryParams.isDefault(),"should have a tag if it's not a default query."),t._path.toString())}listen(t,r,n,i){const s=t._path.toString();this.log_("Listen called for "+s+" "+t._queryIdentifier);const a=Uf.getListenId_(t,n),o={};this.listens_[a]=o;const l=jx(t._queryParams);this.restRequest_(s+".json",l,(c,u)=>{let f=u;if(c===404&&(f=null,c=null),c===null&&this.onDataUpdate_(s,f,!1,n),go(this.listens_,a)===o){let h;c?c===401?h="permission_denied":h="rest_error:"+c:h="ok",i(h,null)}})}unlisten(t,r){const n=Uf.getListenId_(t,r);delete this.listens_[n]}get(t){const r=jx(t._queryParams),n=t._path.toString(),i=new Oc;return this.restRequest_(n+".json",r,(s,a)=>{let o=a;s===404&&(o=null,s=null),s===null?(this.onDataUpdate_(n,o,!1,null),i.resolve(o)):i.reject(new Error(o))}),i.promise}refreshAuthToken(t){}restRequest_(t,r={},n){return r.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([i,s])=>{i&&i.accessToken&&(r.auth=i.accessToken),s&&s.token&&(r.ac=s.token);const a=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+t+"?ns="+this.repoInfo_.namespace+No(r);this.log_("Sending REST request for "+a);const o=new XMLHttpRequest;o.onreadystatechange=()=>{if(n&&o.readyState===4){this.log_("REST Response for "+a+" received. status:",o.status,"response:",o.responseText);let l=null;if(o.status>=200&&o.status<300){try{l=tc(o.responseText)}catch{yr("Failed to parse JSON response for "+a+": "+o.responseText)}n(null,l)}else o.status!==401&&o.status!==404&&yr("Got unsuccessful REST response for "+a+" Status: "+o.status),n(o.status);n=null}},o.open("GET",a,!0),o.send()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GO{constructor(){this.rootNode_=Ce.EMPTY_NODE}getNode(t){return this.rootNode_.getChild(t)}updateSnapshot(t,r){this.rootNode_=this.rootNode_.updateChild(t,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wf(){return{value:null,children:new Map}}function Ek(e,t,r){if(Me(t))e.value=r,e.children.clear();else if(e.value!==null)e.value=e.value.updateChild(t,r);else{const n=De(t);e.children.has(n)||e.children.set(n,Wf());const i=e.children.get(n);t=et(t),Ek(i,t,r)}}function vp(e,t,r){e.value!==null?r(t,e.value):KO(e,(n,i)=>{const s=new Qe(t.toString()+"/"+n);vp(i,s,r)})}function KO(e,t){e.children.forEach((r,n)=>{t(n,r)})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XO{constructor(t){this.collection_=t,this.last_=null}get(){const t=this.collection_.get(),r=Object.assign({},t);return this.last_&&er(this.last_,(n,i)=>{r[n]=r[n]-i}),this.last_=t,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zx=10*1e3,YO=30*1e3,qO=5*60*1e3;class QO{constructor(t,r){this.server_=r,this.statsToReport_={},this.statsListener_=new XO(t);const n=zx+(YO-zx)*Math.random();Tl(this.reportStats_.bind(this),Math.floor(n))}reportStats_(){const t=this.statsListener_.get(),r={};let n=!1;er(t,(i,s)=>{s>0&&Kn(this.statsToReport_,i)&&(r[i]=s,n=!0)}),n&&this.server_.reportStats(r),Tl(this.reportStats_.bind(this),Math.floor(Math.random()*2*qO))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var yn;(function(e){e[e.OVERWRITE=0]="OVERWRITE",e[e.MERGE=1]="MERGE",e[e.ACK_USER_WRITE=2]="ACK_USER_WRITE",e[e.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"})(yn||(yn={}));function c1(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function u1(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function f1(e){return{fromUser:!1,fromServer:!0,queryId:e,tagged:!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vf{constructor(t,r,n){this.path=t,this.affectedTree=r,this.revert=n,this.type=yn.ACK_USER_WRITE,this.source=c1()}operationForChild(t){if(Me(this.path)){if(this.affectedTree.value!=null)return oe(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const r=this.affectedTree.subtree(new Qe(t));return new Vf(ze(),r,this.revert)}}else return oe(De(this.path)===t,"operationForChild called for unrelated child."),new Vf(et(this.path),this.affectedTree,this.revert)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uc{constructor(t,r){this.source=t,this.path=r,this.type=yn.LISTEN_COMPLETE}operationForChild(t){return Me(this.path)?new uc(this.source,ze()):new uc(this.source,et(this.path))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ta{constructor(t,r,n){this.source=t,this.path=r,this.snap=n,this.type=yn.OVERWRITE}operationForChild(t){return Me(this.path)?new ta(this.source,ze(),this.snap.getImmediateChild(t)):new ta(this.source,et(this.path),this.snap)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yo{constructor(t,r,n){this.source=t,this.path=r,this.children=n,this.type=yn.MERGE}operationForChild(t){if(Me(this.path)){const r=this.children.subtree(new Qe(t));return r.isEmpty()?null:r.value?new ta(this.source,ze(),r.value):new yo(this.source,ze(),r)}else return oe(De(this.path)===t,"Can't get a merge for a child not on the path of the operation"),new yo(this.source,et(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ra{constructor(t,r,n){this.node_=t,this.fullyInitialized_=r,this.filtered_=n}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(t){if(Me(t))return this.isFullyInitialized()&&!this.filtered_;const r=De(t);return this.isCompleteForChild(r)}isCompleteForChild(t){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(t)}getNode(){return this.node_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JO{constructor(t){this.query_=t,this.index_=this.query_._queryParams.getIndex()}}function ZO(e,t,r,n){const i=[],s=[];return t.forEach(a=>{a.type==="child_changed"&&e.index_.indexedValueChanged(a.oldSnap,a.snapshotNode)&&s.push(HO(a.childName,a.snapshotNode))}),rl(e,i,"child_removed",t,n,r),rl(e,i,"child_added",t,n,r),rl(e,i,"child_moved",s,n,r),rl(e,i,"child_changed",t,n,r),rl(e,i,"value",t,n,r),i}function rl(e,t,r,n,i,s){const a=n.filter(o=>o.type===r);a.sort((o,l)=>tD(e,o,l)),a.forEach(o=>{const l=eD(e,o,s);i.forEach(c=>{c.respondsTo(o.type)&&t.push(c.createEvent(l,e.query_))})})}function eD(e,t,r){return t.type==="value"||t.type==="child_removed"||(t.prevName=r.getPredecessorChildName(t.childName,t.snapshotNode,e.index_)),t}function tD(e,t,r){if(t.childName==null||r.childName==null)throw Fo("Should only compare child_ events.");const n=new be(t.childName,t.snapshotNode),i=new be(r.childName,r.snapshotNode);return e.index_.compare(n,i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function L0(e,t){return{eventCache:e,serverCache:t}}function Sl(e,t,r,n){return L0(new ra(t,r,n),e.serverCache)}function kk(e,t,r,n){return L0(e.eventCache,new ra(t,r,n))}function xp(e){return e.eventCache.isFullyInitialized()?e.eventCache.getNode():null}function na(e){return e.serverCache.isFullyInitialized()?e.serverCache.getNode():null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let jh;const rD=()=>(jh||(jh=new Fr(WP)),jh);class Ze{constructor(t,r=rD()){this.value=t,this.children=r}static fromObject(t){let r=new Ze(null);return er(t,(n,i)=>{r=r.set(new Qe(n),i)}),r}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(t,r){if(this.value!=null&&r(this.value))return{path:ze(),value:this.value};if(Me(t))return null;{const n=De(t),i=this.children.get(n);if(i!==null){const s=i.findRootMostMatchingPathAndValue(et(t),r);return s!=null?{path:xt(new Qe(n),s.path),value:s.value}:null}else return null}}findRootMostValueAndPath(t){return this.findRootMostMatchingPathAndValue(t,()=>!0)}subtree(t){if(Me(t))return this;{const r=De(t),n=this.children.get(r);return n!==null?n.subtree(et(t)):new Ze(null)}}set(t,r){if(Me(t))return new Ze(r,this.children);{const n=De(t),s=(this.children.get(n)||new Ze(null)).set(et(t),r),a=this.children.insert(n,s);return new Ze(this.value,a)}}remove(t){if(Me(t))return this.children.isEmpty()?new Ze(null):new Ze(null,this.children);{const r=De(t),n=this.children.get(r);if(n){const i=n.remove(et(t));let s;return i.isEmpty()?s=this.children.remove(r):s=this.children.insert(r,i),this.value===null&&s.isEmpty()?new Ze(null):new Ze(this.value,s)}else return this}}get(t){if(Me(t))return this.value;{const r=De(t),n=this.children.get(r);return n?n.get(et(t)):null}}setTree(t,r){if(Me(t))return r;{const n=De(t),s=(this.children.get(n)||new Ze(null)).setTree(et(t),r);let a;return s.isEmpty()?a=this.children.remove(n):a=this.children.insert(n,s),new Ze(this.value,a)}}fold(t){return this.fold_(ze(),t)}fold_(t,r){const n={};return this.children.inorderTraversal((i,s)=>{n[i]=s.fold_(xt(t,i),r)}),r(t,this.value,n)}findOnPath(t,r){return this.findOnPath_(t,ze(),r)}findOnPath_(t,r,n){const i=this.value?n(r,this.value):!1;if(i)return i;if(Me(t))return null;{const s=De(t),a=this.children.get(s);return a?a.findOnPath_(et(t),xt(r,s),n):null}}foreachOnPath(t,r){return this.foreachOnPath_(t,ze(),r)}foreachOnPath_(t,r,n){if(Me(t))return this;{this.value&&n(r,this.value);const i=De(t),s=this.children.get(i);return s?s.foreachOnPath_(et(t),xt(r,i),n):new Ze(null)}}foreach(t){this.foreach_(ze(),t)}foreach_(t,r){this.children.inorderTraversal((n,i)=>{i.foreach_(xt(t,n),r)}),this.value&&r(t,this.value)}foreachChild(t){this.children.inorderTraversal((r,n)=>{n.value&&t(r,n.value)})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cn{constructor(t){this.writeTree_=t}static empty(){return new Cn(new Ze(null))}}function Cl(e,t,r){if(Me(t))return new Cn(new Ze(r));{const n=e.writeTree_.findRootMostValueAndPath(t);if(n!=null){const i=n.path;let s=n.value;const a=Ar(i,t);return s=s.updateChild(a,r),new Cn(e.writeTree_.set(i,s))}else{const i=new Ze(r),s=e.writeTree_.setTree(t,i);return new Cn(s)}}}function _p(e,t,r){let n=e;return er(r,(i,s)=>{n=Cl(n,xt(t,i),s)}),n}function $x(e,t){if(Me(t))return Cn.empty();{const r=e.writeTree_.setTree(t,new Ze(null));return new Cn(r)}}function yp(e,t){return xa(e,t)!=null}function xa(e,t){const r=e.writeTree_.findRootMostValueAndPath(t);return r!=null?e.writeTree_.get(r.path).getChild(Ar(r.path,t)):null}function Gx(e){const t=[],r=e.writeTree_.value;return r!=null?r.isLeafNode()||r.forEachChild(_t,(n,i)=>{t.push(new be(n,i))}):e.writeTree_.children.inorderTraversal((n,i)=>{i.value!=null&&t.push(new be(n,i.value))}),t}function cs(e,t){if(Me(t))return e;{const r=xa(e,t);return r!=null?new Cn(new Ze(r)):new Cn(e.writeTree_.subtree(t))}}function wp(e){return e.writeTree_.isEmpty()}function wo(e,t){return Tk(ze(),e.writeTree_,t)}function Tk(e,t,r){if(t.value!=null)return r.updateChild(e,t.value);{let n=null;return t.children.inorderTraversal((i,s)=>{i===".priority"?(oe(s.value!==null,"Priority writes must always be leaf nodes"),n=s.value):r=Tk(xt(e,i),s,r)}),!r.getChild(e).isEmpty()&&n!==null&&(r=r.updateChild(xt(e,".priority"),n)),r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function h1(e,t){return Ak(t,e)}function nD(e,t,r,n,i){oe(n>e.lastWriteId,"Stacking an older write on top of newer ones"),i===void 0&&(i=!0),e.allWrites.push({path:t,snap:r,writeId:n,visible:i}),i&&(e.visibleWrites=Cl(e.visibleWrites,t,r)),e.lastWriteId=n}function iD(e,t,r,n){oe(n>e.lastWriteId,"Stacking an older merge on top of newer ones"),e.allWrites.push({path:t,children:r,writeId:n,visible:!0}),e.visibleWrites=_p(e.visibleWrites,t,r),e.lastWriteId=n}function sD(e,t){for(let r=0;r<e.allWrites.length;r++){const n=e.allWrites[r];if(n.writeId===t)return n}return null}function aD(e,t){const r=e.allWrites.findIndex(o=>o.writeId===t);oe(r>=0,"removeWrite called with nonexistent writeId.");const n=e.allWrites[r];e.allWrites.splice(r,1);let i=n.visible,s=!1,a=e.allWrites.length-1;for(;i&&a>=0;){const o=e.allWrites[a];o.visible&&(a>=r&&oD(o,n.path)?i=!1:on(n.path,o.path)&&(s=!0)),a--}if(i){if(s)return lD(e),!0;if(n.snap)e.visibleWrites=$x(e.visibleWrites,n.path);else{const o=n.children;er(o,l=>{e.visibleWrites=$x(e.visibleWrites,xt(n.path,l))})}return!0}else return!1}function oD(e,t){if(e.snap)return on(e.path,t);for(const r in e.children)if(e.children.hasOwnProperty(r)&&on(xt(e.path,r),t))return!0;return!1}function lD(e){e.visibleWrites=Sk(e.allWrites,cD,ze()),e.allWrites.length>0?e.lastWriteId=e.allWrites[e.allWrites.length-1].writeId:e.lastWriteId=-1}function cD(e){return e.visible}function Sk(e,t,r){let n=Cn.empty();for(let i=0;i<e.length;++i){const s=e[i];if(t(s)){const a=s.path;let o;if(s.snap)on(r,a)?(o=Ar(r,a),n=Cl(n,o,s.snap)):on(a,r)&&(o=Ar(a,r),n=Cl(n,ze(),s.snap.getChild(o)));else if(s.children){if(on(r,a))o=Ar(r,a),n=_p(n,o,s.children);else if(on(a,r))if(o=Ar(a,r),Me(o))n=_p(n,ze(),s.children);else{const l=go(s.children,De(o));if(l){const c=l.getChild(et(o));n=Cl(n,ze(),c)}}}else throw Fo("WriteRecord should have .snap or .children")}}return n}function Ck(e,t,r,n,i){if(!n&&!i){const s=xa(e.visibleWrites,t);if(s!=null)return s;{const a=cs(e.visibleWrites,t);if(wp(a))return r;if(r==null&&!yp(a,ze()))return null;{const o=r||Ce.EMPTY_NODE;return wo(a,o)}}}else{const s=cs(e.visibleWrites,t);if(!i&&wp(s))return r;if(!i&&r==null&&!yp(s,ze()))return null;{const a=function(c){return(c.visible||i)&&(!n||!~n.indexOf(c.writeId))&&(on(c.path,t)||on(t,c.path))},o=Sk(e.allWrites,a,t),l=r||Ce.EMPTY_NODE;return wo(o,l)}}}function uD(e,t,r){let n=Ce.EMPTY_NODE;const i=xa(e.visibleWrites,t);if(i)return i.isLeafNode()||i.forEachChild(_t,(s,a)=>{n=n.updateImmediateChild(s,a)}),n;if(r){const s=cs(e.visibleWrites,t);return r.forEachChild(_t,(a,o)=>{const l=wo(cs(s,new Qe(a)),o);n=n.updateImmediateChild(a,l)}),Gx(s).forEach(a=>{n=n.updateImmediateChild(a.name,a.node)}),n}else{const s=cs(e.visibleWrites,t);return Gx(s).forEach(a=>{n=n.updateImmediateChild(a.name,a.node)}),n}}function fD(e,t,r,n,i){oe(n||i,"Either existingEventSnap or existingServerSnap must exist");const s=xt(t,r);if(yp(e.visibleWrites,s))return null;{const a=cs(e.visibleWrites,s);return wp(a)?i.getChild(r):wo(a,i.getChild(r))}}function hD(e,t,r,n){const i=xt(t,r),s=xa(e.visibleWrites,i);if(s!=null)return s;if(n.isCompleteForChild(r)){const a=cs(e.visibleWrites,i);return wo(a,n.getNode().getImmediateChild(r))}else return null}function dD(e,t){return xa(e.visibleWrites,t)}function pD(e,t,r,n,i,s,a){let o;const l=cs(e.visibleWrites,t),c=xa(l,ze());if(c!=null)o=c;else if(r!=null)o=wo(l,r);else return[];if(o=o.withIndex(a),!o.isEmpty()&&!o.isLeafNode()){const u=[],f=a.getCompare(),h=s?o.getReverseIteratorFrom(n,a):o.getIteratorFrom(n,a);let d=h.getNext();for(;d&&u.length<i;)f(d,n)!==0&&u.push(d),d=h.getNext();return u}else return[]}function mD(){return{visibleWrites:Cn.empty(),allWrites:[],lastWriteId:-1}}function jf(e,t,r,n){return Ck(e.writeTree,e.treePath,t,r,n)}function d1(e,t){return uD(e.writeTree,e.treePath,t)}function Kx(e,t,r,n){return fD(e.writeTree,e.treePath,t,r,n)}function Hf(e,t){return dD(e.writeTree,xt(e.treePath,t))}function gD(e,t,r,n,i,s){return pD(e.writeTree,e.treePath,t,r,n,i,s)}function p1(e,t,r){return hD(e.writeTree,e.treePath,t,r)}function Ik(e,t){return Ak(xt(e.treePath,t),e.writeTree)}function Ak(e,t){return{treePath:e,writeTree:t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vD{constructor(){this.changeMap=new Map}trackChildChange(t){const r=t.type,n=t.childName;oe(r==="child_added"||r==="child_changed"||r==="child_removed","Only child changes supported for tracking"),oe(n!==".priority","Only non-priority child changes can be tracked.");const i=this.changeMap.get(n);if(i){const s=i.type;if(r==="child_added"&&s==="child_removed")this.changeMap.set(n,lc(n,t.snapshotNode,i.snapshotNode));else if(r==="child_removed"&&s==="child_added")this.changeMap.delete(n);else if(r==="child_removed"&&s==="child_changed")this.changeMap.set(n,oc(n,i.oldSnap));else if(r==="child_changed"&&s==="child_added")this.changeMap.set(n,_o(n,t.snapshotNode));else if(r==="child_changed"&&s==="child_changed")this.changeMap.set(n,lc(n,t.snapshotNode,i.oldSnap));else throw Fo("Illegal combination of changes: "+t+" occurred after "+i)}else this.changeMap.set(n,t)}getChanges(){return Array.from(this.changeMap.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xD{getCompleteChild(t){return null}getChildAfterChild(t,r,n){return null}}const Fk=new xD;class m1{constructor(t,r,n=null){this.writes_=t,this.viewCache_=r,this.optCompleteServerCache_=n}getCompleteChild(t){const r=this.viewCache_.eventCache;if(r.isCompleteForChild(t))return r.getNode().getImmediateChild(t);{const n=this.optCompleteServerCache_!=null?new ra(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return p1(this.writes_,t,n)}}getChildAfterChild(t,r,n){const i=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:na(this.viewCache_),s=gD(this.writes_,i,r,1,n,t);return s.length===0?null:s[0]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _D(e){return{filter:e}}function yD(e,t){oe(t.eventCache.getNode().isIndexed(e.filter.getIndex()),"Event snap not indexed"),oe(t.serverCache.getNode().isIndexed(e.filter.getIndex()),"Server snap not indexed")}function wD(e,t,r,n,i){const s=new vD;let a,o;if(r.type===yn.OVERWRITE){const c=r;c.source.fromUser?a=Ep(e,t,c.path,c.snap,n,i,s):(oe(c.source.fromServer,"Unknown source."),o=c.source.tagged||t.serverCache.isFiltered()&&!Me(c.path),a=zf(e,t,c.path,c.snap,n,i,o,s))}else if(r.type===yn.MERGE){const c=r;c.source.fromUser?a=kD(e,t,c.path,c.children,n,i,s):(oe(c.source.fromServer,"Unknown source."),o=c.source.tagged||t.serverCache.isFiltered(),a=kp(e,t,c.path,c.children,n,i,o,s))}else if(r.type===yn.ACK_USER_WRITE){const c=r;c.revert?a=CD(e,t,c.path,n,i,s):a=TD(e,t,c.path,c.affectedTree,n,i,s)}else if(r.type===yn.LISTEN_COMPLETE)a=SD(e,t,r.path,n,s);else throw Fo("Unknown operation type: "+r.type);const l=s.getChanges();return ED(t,a,l),{viewCache:a,changes:l}}function ED(e,t,r){const n=t.eventCache;if(n.isFullyInitialized()){const i=n.getNode().isLeafNode()||n.getNode().isEmpty(),s=xp(e);(r.length>0||!e.eventCache.isFullyInitialized()||i&&!n.getNode().equals(s)||!n.getNode().getPriority().equals(s.getPriority()))&&r.push(wk(xp(t)))}}function Nk(e,t,r,n,i,s){const a=t.eventCache;if(Hf(n,r)!=null)return t;{let o,l;if(Me(r))if(oe(t.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),t.serverCache.isFiltered()){const c=na(t),u=c instanceof Ce?c:Ce.EMPTY_NODE,f=d1(n,u);o=e.filter.updateFullNode(t.eventCache.getNode(),f,s)}else{const c=jf(n,na(t));o=e.filter.updateFullNode(t.eventCache.getNode(),c,s)}else{const c=De(r);if(c===".priority"){oe(ds(r)===1,"Can't have a priority with additional path components");const u=a.getNode();l=t.serverCache.getNode();const f=Kx(n,r,u,l);f!=null?o=e.filter.updatePriority(u,f):o=a.getNode()}else{const u=et(r);let f;if(a.isCompleteForChild(c)){l=t.serverCache.getNode();const h=Kx(n,r,a.getNode(),l);h!=null?f=a.getNode().getImmediateChild(c).updateChild(u,h):f=a.getNode().getImmediateChild(c)}else f=p1(n,c,t.serverCache);f!=null?o=e.filter.updateChild(a.getNode(),c,f,u,i,s):o=a.getNode()}}return Sl(t,o,a.isFullyInitialized()||Me(r),e.filter.filtersNodes())}}function zf(e,t,r,n,i,s,a,o){const l=t.serverCache;let c;const u=a?e.filter:e.filter.getIndexedFilter();if(Me(r))c=u.updateFullNode(l.getNode(),n,null);else if(u.filtersNodes()&&!l.isFiltered()){const d=l.getNode().updateChild(r,n);c=u.updateFullNode(l.getNode(),d,null)}else{const d=De(r);if(!l.isCompleteForPath(r)&&ds(r)>1)return t;const m=et(r),g=l.getNode().getImmediateChild(d).updateChild(m,n);d===".priority"?c=u.updatePriority(l.getNode(),g):c=u.updateChild(l.getNode(),d,g,m,Fk,null)}const f=kk(t,c,l.isFullyInitialized()||Me(r),u.filtersNodes()),h=new m1(i,f,s);return Nk(e,f,r,i,h,o)}function Ep(e,t,r,n,i,s,a){const o=t.eventCache;let l,c;const u=new m1(i,t,s);if(Me(r))c=e.filter.updateFullNode(t.eventCache.getNode(),n,a),l=Sl(t,c,!0,e.filter.filtersNodes());else{const f=De(r);if(f===".priority")c=e.filter.updatePriority(t.eventCache.getNode(),n),l=Sl(t,c,o.isFullyInitialized(),o.isFiltered());else{const h=et(r),d=o.getNode().getImmediateChild(f);let m;if(Me(h))m=n;else{const p=u.getCompleteChild(f);p!=null?n1(h)===".priority"&&p.getChild(pk(h)).isEmpty()?m=p:m=p.updateChild(h,n):m=Ce.EMPTY_NODE}if(d.equals(m))l=t;else{const p=e.filter.updateChild(o.getNode(),f,m,h,u,a);l=Sl(t,p,o.isFullyInitialized(),e.filter.filtersNodes())}}}return l}function Xx(e,t){return e.eventCache.isCompleteForChild(t)}function kD(e,t,r,n,i,s,a){let o=t;return n.foreach((l,c)=>{const u=xt(r,l);Xx(t,De(u))&&(o=Ep(e,o,u,c,i,s,a))}),n.foreach((l,c)=>{const u=xt(r,l);Xx(t,De(u))||(o=Ep(e,o,u,c,i,s,a))}),o}function Yx(e,t,r){return r.foreach((n,i)=>{t=t.updateChild(n,i)}),t}function kp(e,t,r,n,i,s,a,o){if(t.serverCache.getNode().isEmpty()&&!t.serverCache.isFullyInitialized())return t;let l=t,c;Me(r)?c=n:c=new Ze(null).setTree(r,n);const u=t.serverCache.getNode();return c.children.inorderTraversal((f,h)=>{if(u.hasChild(f)){const d=t.serverCache.getNode().getImmediateChild(f),m=Yx(e,d,h);l=zf(e,l,new Qe(f),m,i,s,a,o)}}),c.children.inorderTraversal((f,h)=>{const d=!t.serverCache.isCompleteForChild(f)&&h.value===null;if(!u.hasChild(f)&&!d){const m=t.serverCache.getNode().getImmediateChild(f),p=Yx(e,m,h);l=zf(e,l,new Qe(f),p,i,s,a,o)}}),l}function TD(e,t,r,n,i,s,a){if(Hf(i,r)!=null)return t;const o=t.serverCache.isFiltered(),l=t.serverCache;if(n.value!=null){if(Me(r)&&l.isFullyInitialized()||l.isCompleteForPath(r))return zf(e,t,r,l.getNode().getChild(r),i,s,o,a);if(Me(r)){let c=new Ze(null);return l.getNode().forEachChild(ro,(u,f)=>{c=c.set(new Qe(u),f)}),kp(e,t,r,c,i,s,o,a)}else return t}else{let c=new Ze(null);return n.foreach((u,f)=>{const h=xt(r,u);l.isCompleteForPath(h)&&(c=c.set(u,l.getNode().getChild(h)))}),kp(e,t,r,c,i,s,o,a)}}function SD(e,t,r,n,i){const s=t.serverCache,a=kk(t,s.getNode(),s.isFullyInitialized()||Me(r),s.isFiltered());return Nk(e,a,r,n,Fk,i)}function CD(e,t,r,n,i,s){let a;if(Hf(n,r)!=null)return t;{const o=new m1(n,t,i),l=t.eventCache.getNode();let c;if(Me(r)||De(r)===".priority"){let u;if(t.serverCache.isFullyInitialized())u=jf(n,na(t));else{const f=t.serverCache.getNode();oe(f instanceof Ce,"serverChildren would be complete if leaf node"),u=d1(n,f)}u=u,c=e.filter.updateFullNode(l,u,s)}else{const u=De(r);let f=p1(n,u,t.serverCache);f==null&&t.serverCache.isCompleteForChild(u)&&(f=l.getImmediateChild(u)),f!=null?c=e.filter.updateChild(l,u,f,et(r),o,s):t.eventCache.getNode().hasChild(u)?c=e.filter.updateChild(l,u,Ce.EMPTY_NODE,et(r),o,s):c=l,c.isEmpty()&&t.serverCache.isFullyInitialized()&&(a=jf(n,na(t)),a.isLeafNode()&&(c=e.filter.updateFullNode(c,a,s)))}return a=t.serverCache.isFullyInitialized()||Hf(n,ze())!=null,Sl(t,c,a,e.filter.filtersNodes())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ID{constructor(t,r){this.query_=t,this.eventRegistrations_=[];const n=this.query_._queryParams,i=new o1(n.getIndex()),s=$O(n);this.processor_=_D(s);const a=r.serverCache,o=r.eventCache,l=i.updateFullNode(Ce.EMPTY_NODE,a.getNode(),null),c=s.updateFullNode(Ce.EMPTY_NODE,o.getNode(),null),u=new ra(l,a.isFullyInitialized(),i.filtersNodes()),f=new ra(c,o.isFullyInitialized(),s.filtersNodes());this.viewCache_=L0(f,u),this.eventGenerator_=new JO(this.query_)}get query(){return this.query_}}function AD(e){return e.viewCache_.serverCache.getNode()}function FD(e,t){const r=na(e.viewCache_);return r&&(e.query._queryParams.loadsAllData()||!Me(t)&&!r.getImmediateChild(De(t)).isEmpty())?r.getChild(t):null}function qx(e){return e.eventRegistrations_.length===0}function ND(e,t){e.eventRegistrations_.push(t)}function Qx(e,t,r){const n=[];if(r){oe(t==null,"A cancel should cancel all event registrations.");const i=e.query._path;e.eventRegistrations_.forEach(s=>{const a=s.createCancelEvent(r,i);a&&n.push(a)})}if(t){let i=[];for(let s=0;s<e.eventRegistrations_.length;++s){const a=e.eventRegistrations_[s];if(!a.matches(t))i.push(a);else if(t.hasAnyCallback()){i=i.concat(e.eventRegistrations_.slice(s+1));break}}e.eventRegistrations_=i}else e.eventRegistrations_=[];return n}function Jx(e,t,r,n){t.type===yn.MERGE&&t.source.queryId!==null&&(oe(na(e.viewCache_),"We should always have a full cache before handling merges"),oe(xp(e.viewCache_),"Missing event cache, even though we have a server cache"));const i=e.viewCache_,s=wD(e.processor_,i,t,r,n);return yD(e.processor_,s.viewCache),oe(s.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),e.viewCache_=s.viewCache,Rk(e,s.changes,s.viewCache.eventCache.getNode(),null)}function RD(e,t){const r=e.viewCache_.eventCache,n=[];return r.getNode().isLeafNode()||r.getNode().forEachChild(_t,(s,a)=>{n.push(_o(s,a))}),r.isFullyInitialized()&&n.push(wk(r.getNode())),Rk(e,n,r.getNode(),t)}function Rk(e,t,r,n){const i=n?[n]:e.eventRegistrations_;return ZO(e.eventGenerator_,t,r,i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let $f;class PD{constructor(){this.views=new Map}}function OD(e){oe(!$f,"__referenceConstructor has already been defined"),$f=e}function DD(){return oe($f,"Reference.ts has not been loaded"),$f}function bD(e){return e.views.size===0}function g1(e,t,r,n){const i=t.source.queryId;if(i!==null){const s=e.views.get(i);return oe(s!=null,"SyncTree gave us an op for an invalid query."),Jx(s,t,r,n)}else{let s=[];for(const a of e.views.values())s=s.concat(Jx(a,t,r,n));return s}}function LD(e,t,r,n,i){const s=t._queryIdentifier,a=e.views.get(s);if(!a){let o=jf(r,i?n:null),l=!1;o?l=!0:n instanceof Ce?(o=d1(r,n),l=!1):(o=Ce.EMPTY_NODE,l=!1);const c=L0(new ra(o,l,!1),new ra(n,i,!1));return new ID(t,c)}return a}function MD(e,t,r,n,i,s){const a=LD(e,t,n,i,s);return e.views.has(t._queryIdentifier)||e.views.set(t._queryIdentifier,a),ND(a,r),RD(a,r)}function BD(e,t,r,n){const i=t._queryIdentifier,s=[];let a=[];const o=ps(e);if(i==="default")for(const[l,c]of e.views.entries())a=a.concat(Qx(c,r,n)),qx(c)&&(e.views.delete(l),c.query._queryParams.loadsAllData()||s.push(c.query));else{const l=e.views.get(i);l&&(a=a.concat(Qx(l,r,n)),qx(l)&&(e.views.delete(i),l.query._queryParams.loadsAllData()||s.push(l.query)))}return o&&!ps(e)&&s.push(new(DD())(t._repo,t._path)),{removed:s,events:a}}function Pk(e){const t=[];for(const r of e.views.values())r.query._queryParams.loadsAllData()||t.push(r);return t}function no(e,t){let r=null;for(const n of e.views.values())r=r||FD(n,t);return r}function Ok(e,t){if(t._queryParams.loadsAllData())return M0(e);{const n=t._queryIdentifier;return e.views.get(n)}}function Dk(e,t){return Ok(e,t)!=null}function ps(e){return M0(e)!=null}function M0(e){for(const t of e.views.values())if(t.query._queryParams.loadsAllData())return t;return null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Gf;function UD(e){oe(!Gf,"__referenceConstructor has already been defined"),Gf=e}function WD(){return oe(Gf,"Reference.ts has not been loaded"),Gf}let VD=1;class Zx{constructor(t){this.listenProvider_=t,this.syncPointTree_=new Ze(null),this.pendingWriteTree_=mD(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function bk(e,t,r,n,i){return nD(e.pendingWriteTree_,t,r,n,i),i?Do(e,new ta(c1(),t,r)):[]}function jD(e,t,r,n){iD(e.pendingWriteTree_,t,r,n);const i=Ze.fromObject(r);return Do(e,new yo(c1(),t,i))}function Yi(e,t,r=!1){const n=sD(e.pendingWriteTree_,t);if(aD(e.pendingWriteTree_,t)){let s=new Ze(null);return n.snap!=null?s=s.set(ze(),!0):er(n.children,a=>{s=s.set(new Qe(a),!0)}),Do(e,new Vf(n.path,s,r))}else return[]}function B0(e,t,r){return Do(e,new ta(u1(),t,r))}function HD(e,t,r){const n=Ze.fromObject(r);return Do(e,new yo(u1(),t,n))}function zD(e,t){return Do(e,new uc(u1(),t))}function $D(e,t,r){const n=x1(e,r);if(n){const i=_1(n),s=i.path,a=i.queryId,o=Ar(s,t),l=new uc(f1(a),o);return y1(e,s,l)}else return[]}function Tp(e,t,r,n,i=!1){const s=t._path,a=e.syncPointTree_.get(s);let o=[];if(a&&(t._queryIdentifier==="default"||Dk(a,t))){const l=BD(a,t,r,n);bD(a)&&(e.syncPointTree_=e.syncPointTree_.remove(s));const c=l.removed;if(o=l.events,!i){const u=c.findIndex(h=>h._queryParams.loadsAllData())!==-1,f=e.syncPointTree_.findOnPath(s,(h,d)=>ps(d));if(u&&!f){const h=e.syncPointTree_.subtree(s);if(!h.isEmpty()){const d=XD(h);for(let m=0;m<d.length;++m){const p=d[m],g=p.query,x=Bk(e,p);e.listenProvider_.startListening(Il(g),Kf(e,g),x.hashFn,x.onComplete)}}}!f&&c.length>0&&!n&&(u?e.listenProvider_.stopListening(Il(t),null):c.forEach(h=>{const d=e.queryToTagMap.get(U0(h));e.listenProvider_.stopListening(Il(h),d)}))}YD(e,c)}return o}function GD(e,t,r,n){const i=x1(e,n);if(i!=null){const s=_1(i),a=s.path,o=s.queryId,l=Ar(a,t),c=new ta(f1(o),l,r);return y1(e,a,c)}else return[]}function KD(e,t,r,n){const i=x1(e,n);if(i){const s=_1(i),a=s.path,o=s.queryId,l=Ar(a,t),c=Ze.fromObject(r),u=new yo(f1(o),l,c);return y1(e,a,u)}else return[]}function e_(e,t,r,n=!1){const i=t._path;let s=null,a=!1;e.syncPointTree_.foreachOnPath(i,(h,d)=>{const m=Ar(h,i);s=s||no(d,m),a=a||ps(d)});let o=e.syncPointTree_.get(i);o?(a=a||ps(o),s=s||no(o,ze())):(o=new PD,e.syncPointTree_=e.syncPointTree_.set(i,o));let l;s!=null?l=!0:(l=!1,s=Ce.EMPTY_NODE,e.syncPointTree_.subtree(i).foreachChild((d,m)=>{const p=no(m,ze());p&&(s=s.updateImmediateChild(d,p))}));const c=Dk(o,t);if(!c&&!t._queryParams.loadsAllData()){const h=U0(t);oe(!e.queryToTagMap.has(h),"View does not exist, but we have a tag");const d=qD();e.queryToTagMap.set(h,d),e.tagToQueryMap.set(d,h)}const u=h1(e.pendingWriteTree_,i);let f=MD(o,t,r,u,s,l);if(!c&&!a&&!n){const h=Ok(o,t);f=f.concat(QD(e,t,h))}return f}function v1(e,t,r){const i=e.pendingWriteTree_,s=e.syncPointTree_.findOnPath(t,(a,o)=>{const l=Ar(a,t),c=no(o,l);if(c)return c});return Ck(i,t,s,r,!0)}function Do(e,t){return Lk(t,e.syncPointTree_,null,h1(e.pendingWriteTree_,ze()))}function Lk(e,t,r,n){if(Me(e.path))return Mk(e,t,r,n);{const i=t.get(ze());r==null&&i!=null&&(r=no(i,ze()));let s=[];const a=De(e.path),o=e.operationForChild(a),l=t.children.get(a);if(l&&o){const c=r?r.getImmediateChild(a):null,u=Ik(n,a);s=s.concat(Lk(o,l,c,u))}return i&&(s=s.concat(g1(i,e,n,r))),s}}function Mk(e,t,r,n){const i=t.get(ze());r==null&&i!=null&&(r=no(i,ze()));let s=[];return t.children.inorderTraversal((a,o)=>{const l=r?r.getImmediateChild(a):null,c=Ik(n,a),u=e.operationForChild(a);u&&(s=s.concat(Mk(u,o,l,c)))}),i&&(s=s.concat(g1(i,e,n,r))),s}function Bk(e,t){const r=t.query,n=Kf(e,r);return{hashFn:()=>(AD(t)||Ce.EMPTY_NODE).hash(),onComplete:i=>{if(i==="ok")return n?$D(e,r._path,n):zD(e,r._path);{const s=HP(i,r);return Tp(e,r,null,s)}}}}function Kf(e,t){const r=U0(t);return e.queryToTagMap.get(r)}function U0(e){return e._path.toString()+"$"+e._queryIdentifier}function x1(e,t){return e.tagToQueryMap.get(t)}function _1(e){const t=e.indexOf("$");return oe(t!==-1&&t<e.length-1,"Bad queryKey."),{queryId:e.substr(t+1),path:new Qe(e.substr(0,t))}}function y1(e,t,r){const n=e.syncPointTree_.get(t);oe(n,"Missing sync point for query tag that we're tracking");const i=h1(e.pendingWriteTree_,t);return g1(n,r,i,null)}function XD(e){return e.fold((t,r,n)=>{if(r&&ps(r))return[M0(r)];{let i=[];return r&&(i=Pk(r)),er(n,(s,a)=>{i=i.concat(a)}),i}})}function Il(e){return e._queryParams.loadsAllData()&&!e._queryParams.isDefault()?new(WD())(e._repo,e._path):e}function YD(e,t){for(let r=0;r<t.length;++r){const n=t[r];if(!n._queryParams.loadsAllData()){const i=U0(n),s=e.queryToTagMap.get(i);e.queryToTagMap.delete(i),e.tagToQueryMap.delete(s)}}}function qD(){return VD++}function QD(e,t,r){const n=t._path,i=Kf(e,t),s=Bk(e,r),a=e.listenProvider_.startListening(Il(t),i,s.hashFn,s.onComplete),o=e.syncPointTree_.subtree(n);if(i)oe(!ps(o.value),"If we're adding a query, it shouldn't be shadowed");else{const l=o.fold((c,u,f)=>{if(!Me(c)&&u&&ps(u))return[M0(u).query];{let h=[];return u&&(h=h.concat(Pk(u).map(d=>d.query))),er(f,(d,m)=>{h=h.concat(m)}),h}});for(let c=0;c<l.length;++c){const u=l[c];e.listenProvider_.stopListening(Il(u),Kf(e,u))}}return a}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w1{constructor(t){this.node_=t}getImmediateChild(t){const r=this.node_.getImmediateChild(t);return new w1(r)}node(){return this.node_}}class E1{constructor(t,r){this.syncTree_=t,this.path_=r}getImmediateChild(t){const r=xt(this.path_,t);return new E1(this.syncTree_,r)}node(){return v1(this.syncTree_,this.path_)}}const JD=function(e){return e=e||{},e.timestamp=e.timestamp||new Date().getTime(),e},t_=function(e,t,r){if(!e||typeof e!="object")return e;if(oe(".sv"in e,"Unexpected leaf node or priority contents"),typeof e[".sv"]=="string")return ZD(e[".sv"],t,r);if(typeof e[".sv"]=="object")return eb(e[".sv"],t);oe(!1,"Unexpected server value: "+JSON.stringify(e,null,2))},ZD=function(e,t,r){switch(e){case"timestamp":return r.timestamp;default:oe(!1,"Unexpected server value: "+e)}},eb=function(e,t,r){e.hasOwnProperty("increment")||oe(!1,"Unexpected server value: "+JSON.stringify(e,null,2));const n=e.increment;typeof n!="number"&&oe(!1,"Unexpected increment value: "+n);const i=t.node();if(oe(i!==null&&typeof i<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return n;const a=i.getValue();return typeof a!="number"?n:a+n},Uk=function(e,t,r,n){return k1(t,new E1(r,e),n)},Wk=function(e,t,r){return k1(e,new w1(t),r)};function k1(e,t,r){const n=e.getPriority().val(),i=t_(n,t.getImmediateChild(".priority"),r);let s;if(e.isLeafNode()){const a=e,o=t_(a.getValue(),t,r);return o!==a.getValue()||i!==a.getPriority().val()?new Bt(o,jt(i)):e}else{const a=e;return s=a,i!==a.getPriority().val()&&(s=s.updatePriority(new Bt(i))),a.forEachChild(_t,(o,l)=>{const c=k1(l,t.getImmediateChild(o),r);c!==l&&(s=s.updateImmediateChild(o,c))}),s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T1{constructor(t="",r=null,n={children:{},childCount:0}){this.name=t,this.parent=r,this.node=n}}function S1(e,t){let r=t instanceof Qe?t:new Qe(t),n=e,i=De(r);for(;i!==null;){const s=go(n.node.children,i)||{children:{},childCount:0};n=new T1(i,n,s),r=et(r),i=De(r)}return n}function bo(e){return e.node.value}function Vk(e,t){e.node.value=t,Sp(e)}function jk(e){return e.node.childCount>0}function tb(e){return bo(e)===void 0&&!jk(e)}function W0(e,t){er(e.node.children,(r,n)=>{t(new T1(r,e,n))})}function Hk(e,t,r,n){r&&!n&&t(e),W0(e,i=>{Hk(i,t,!0,n)}),r&&n&&t(e)}function rb(e,t,r){let n=e.parent;for(;n!==null;){if(t(n))return!0;n=n.parent}return!1}function Vc(e){return new Qe(e.parent===null?e.name:Vc(e.parent)+"/"+e.name)}function Sp(e){e.parent!==null&&nb(e.parent,e.name,e)}function nb(e,t,r){const n=tb(r),i=Kn(e.node.children,t);n&&i?(delete e.node.children[t],e.node.childCount--,Sp(e)):!n&&!i&&(e.node.children[t]=r.node,e.node.childCount++,Sp(e))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ib=/[\[\].#$\/\u0000-\u001F\u007F]/,sb=/[\[\].#$\u0000-\u001F\u007F]/,Hh=10*1024*1024,C1=function(e){return typeof e=="string"&&e.length!==0&&!ib.test(e)},zk=function(e){return typeof e=="string"&&e.length!==0&&!sb.test(e)},ab=function(e){return e&&(e=e.replace(/^\/*\.info(\/|$)/,"/")),zk(e)},ob=function(e){return e===null||typeof e=="string"||typeof e=="number"&&!Jm(e)||e&&typeof e=="object"&&Kn(e,".sv")},$k=function(e,t,r,n){n&&t===void 0||V0(A0(e,"value"),t,r)},V0=function(e,t,r){const n=r instanceof Qe?new kO(r,e):r;if(t===void 0)throw new Error(e+"contains undefined "+Os(n));if(typeof t=="function")throw new Error(e+"contains a function "+Os(n)+" with contents = "+t.toString());if(Jm(t))throw new Error(e+"contains "+t.toString()+" "+Os(n));if(typeof t=="string"&&t.length>Hh/3&&F0(t)>Hh)throw new Error(e+"contains a string greater than "+Hh+" utf8 bytes "+Os(n)+" ('"+t.substring(0,50)+"...')");if(t&&typeof t=="object"){let i=!1,s=!1;if(er(t,(a,o)=>{if(a===".value")i=!0;else if(a!==".priority"&&a!==".sv"&&(s=!0,!C1(a)))throw new Error(e+" contains an invalid key ("+a+") "+Os(n)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);TO(n,a),V0(e,o,n),SO(n)}),i&&s)throw new Error(e+' contains ".value" child '+Os(n)+" in addition to actual children.")}},lb=function(e,t){let r,n;for(r=0;r<t.length;r++){n=t[r];const s=ac(n);for(let a=0;a<s.length;a++)if(!(s[a]===".priority"&&a===s.length-1)){if(!C1(s[a]))throw new Error(e+"contains an invalid key ("+s[a]+") in path "+n.toString()+`. Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`)}}t.sort(EO);let i=null;for(r=0;r<t.length;r++){if(n=t[r],i!==null&&on(i,n))throw new Error(e+"contains a path "+i.toString()+" that is ancestor of another path "+n.toString());i=n}},cb=function(e,t,r,n){const i=A0(e,"values");if(!(t&&typeof t=="object")||Array.isArray(t))throw new Error(i+" must be an object containing the children to replace.");const s=[];er(t,(a,o)=>{const l=new Qe(a);if(V0(i,o,xt(r,l)),n1(l)===".priority"&&!ob(o))throw new Error(i+"contains an invalid value for '"+l.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");s.push(l)}),lb(i,s)},Gk=function(e,t,r,n){if(!zk(r))throw new Error(A0(e,t)+'was an invalid path = "'+r+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},ub=function(e,t,r,n){r&&(r=r.replace(/^\/*\.info(\/|$)/,"/")),Gk(e,t,r)},I1=function(e,t){if(De(t)===".info")throw new Error(e+" failed = Can't modify data under /.info/")},fb=function(e,t){const r=t.path.toString();if(typeof t.repoInfo.host!="string"||t.repoInfo.host.length===0||!C1(t.repoInfo.namespace)&&t.repoInfo.host.split(":")[0]!=="localhost"||r.length!==0&&!ab(r))throw new Error(A0(e,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hb{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function j0(e,t){let r=null;for(let n=0;n<t.length;n++){const i=t[n],s=i.getPath();r!==null&&!i1(s,r.path)&&(e.eventLists_.push(r),r=null),r===null&&(r={events:[],path:s}),r.events.push(i)}r&&e.eventLists_.push(r)}function Kk(e,t,r){j0(e,r),Xk(e,n=>i1(n,t))}function Rn(e,t,r){j0(e,r),Xk(e,n=>on(n,t)||on(t,n))}function Xk(e,t){e.recursionDepth_++;let r=!0;for(let n=0;n<e.eventLists_.length;n++){const i=e.eventLists_[n];if(i){const s=i.path;t(s)?(db(e.eventLists_[n]),e.eventLists_[n]=null):r=!1}}r&&(e.eventLists_=[]),e.recursionDepth_--}function db(e){for(let t=0;t<e.events.length;t++){const r=e.events[t];if(r!==null){e.events[t]=null;const n=r.getEventRunner();kl&&qt("event: "+r.toString()),Oo(n)}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pb="repo_interrupt",mb=25;class gb{constructor(t,r,n,i){this.repoInfo_=t,this.forceRestClient_=r,this.authTokenProvider_=n,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new hb,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=Wf(),this.transactionQueueTree_=new T1,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function vb(e,t,r){if(e.stats_=t1(e.repoInfo_),e.forceRestClient_||KP())e.server_=new Uf(e.repoInfo_,(n,i,s,a)=>{r_(e,n,i,s,a)},e.authTokenProvider_,e.appCheckProvider_),setTimeout(()=>n_(e,!0),0);else{if(typeof r<"u"&&r!==null){if(typeof r!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{Ht(r)}catch(n){throw new Error("Invalid authOverride provided: "+n)}}e.persistentConnection_=new hi(e.repoInfo_,t,(n,i,s,a)=>{r_(e,n,i,s,a)},n=>{n_(e,n)},n=>{xb(e,n)},e.authTokenProvider_,e.appCheckProvider_,r),e.server_=e.persistentConnection_}e.authTokenProvider_.addTokenChangeListener(n=>{e.server_.refreshAuthToken(n)}),e.appCheckProvider_.addTokenChangeListener(n=>{e.server_.refreshAppCheckToken(n.token)}),e.statsReporter_=JP(e.repoInfo_,()=>new QO(e.stats_,e.server_)),e.infoData_=new GO,e.infoSyncTree_=new Zx({startListening:(n,i,s,a)=>{let o=[];const l=e.infoData_.getNode(n._path);return l.isEmpty()||(o=B0(e.infoSyncTree_,n._path,l),setTimeout(()=>{a("ok")},0)),o},stopListening:()=>{}}),A1(e,"connected",!1),e.serverSyncTree_=new Zx({startListening:(n,i,s,a)=>(e.server_.listen(n,s,i,(o,l)=>{const c=a(o,l);Rn(e.eventQueue_,n._path,c)}),[]),stopListening:(n,i)=>{e.server_.unlisten(n,i)}})}function Yk(e){const r=e.infoData_.getNode(new Qe(".info/serverTimeOffset")).val()||0;return new Date().getTime()+r}function H0(e){return JD({timestamp:Yk(e)})}function r_(e,t,r,n,i){e.dataUpdateCount++;const s=new Qe(t);r=e.interceptServerDataCallback_?e.interceptServerDataCallback_(t,r):r;let a=[];if(i)if(n){const l=Af(r,c=>jt(c));a=KD(e.serverSyncTree_,s,l,i)}else{const l=jt(r);a=GD(e.serverSyncTree_,s,l,i)}else if(n){const l=Af(r,c=>jt(c));a=HD(e.serverSyncTree_,s,l)}else{const l=jt(r);a=B0(e.serverSyncTree_,s,l)}let o=s;a.length>0&&(o=Eo(e,s)),Rn(e.eventQueue_,o,a)}function n_(e,t){A1(e,"connected",t),t===!1&&wb(e)}function xb(e,t){er(t,(r,n)=>{A1(e,r,n)})}function A1(e,t,r){const n=new Qe("/.info/"+t),i=jt(r);e.infoData_.updateSnapshot(n,i);const s=B0(e.infoSyncTree_,n,i);Rn(e.eventQueue_,n,s)}function F1(e){return e.nextWriteId_++}function _b(e,t,r,n,i){z0(e,"set",{path:t.toString(),value:r,priority:n});const s=H0(e),a=jt(r,n),o=v1(e.serverSyncTree_,t),l=Wk(a,o,s),c=F1(e),u=bk(e.serverSyncTree_,t,l,c,!0);j0(e.eventQueue_,u),e.server_.put(t.toString(),a.val(!0),(h,d)=>{const m=h==="ok";m||yr("set at "+t+" failed: "+h);const p=Yi(e.serverSyncTree_,c,!m);Rn(e.eventQueue_,t,p),Cp(e,i,h,d)});const f=R1(e,t);Eo(e,f),Rn(e.eventQueue_,f,[])}function yb(e,t,r,n){z0(e,"update",{path:t.toString(),value:r});let i=!0;const s=H0(e),a={};if(er(r,(o,l)=>{i=!1,a[o]=Uk(xt(t,o),jt(l),e.serverSyncTree_,s)}),i)qt("update() called with empty data.  Don't do anything."),Cp(e,n,"ok",void 0);else{const o=F1(e),l=jD(e.serverSyncTree_,t,a,o);j0(e.eventQueue_,l),e.server_.merge(t.toString(),r,(c,u)=>{const f=c==="ok";f||yr("update at "+t+" failed: "+c);const h=Yi(e.serverSyncTree_,o,!f),d=h.length>0?Eo(e,t):t;Rn(e.eventQueue_,d,h),Cp(e,n,c,u)}),er(r,c=>{const u=R1(e,xt(t,c));Eo(e,u)}),Rn(e.eventQueue_,t,[])}}function wb(e){z0(e,"onDisconnectEvents");const t=H0(e),r=Wf();vp(e.onDisconnect_,ze(),(i,s)=>{const a=Uk(i,s,e.serverSyncTree_,t);Ek(r,i,a)});let n=[];vp(r,ze(),(i,s)=>{n=n.concat(B0(e.serverSyncTree_,i,s));const a=R1(e,i);Eo(e,a)}),e.onDisconnect_=Wf(),Rn(e.eventQueue_,ze(),n)}function Eb(e,t,r){let n;De(t._path)===".info"?n=e_(e.infoSyncTree_,t,r):n=e_(e.serverSyncTree_,t,r),Kk(e.eventQueue_,t._path,n)}function kb(e,t,r){let n;De(t._path)===".info"?n=Tp(e.infoSyncTree_,t,r):n=Tp(e.serverSyncTree_,t,r),Kk(e.eventQueue_,t._path,n)}function Tb(e){e.persistentConnection_&&e.persistentConnection_.interrupt(pb)}function z0(e,...t){let r="";e.persistentConnection_&&(r=e.persistentConnection_.id+":"),qt(r,...t)}function Cp(e,t,r,n){t&&Oo(()=>{if(r==="ok")t(null);else{const i=(r||"error").toUpperCase();let s=i;n&&(s+=": "+n);const a=new Error(s);a.code=i,t(a)}})}function qk(e,t,r){return v1(e.serverSyncTree_,t,r)||Ce.EMPTY_NODE}function N1(e,t=e.transactionQueueTree_){if(t||$0(e,t),bo(t)){const r=Jk(e,t);oe(r.length>0,"Sending zero length transaction queue"),r.every(i=>i.status===0)&&Sb(e,Vc(t),r)}else jk(t)&&W0(t,r=>{N1(e,r)})}function Sb(e,t,r){const n=r.map(c=>c.currentWriteId),i=qk(e,t,n);let s=i;const a=i.hash();for(let c=0;c<r.length;c++){const u=r[c];oe(u.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),u.status=1,u.retryCount++;const f=Ar(t,u.path);s=s.updateChild(f,u.currentOutputSnapshotRaw)}const o=s.val(!0),l=t;e.server_.put(l.toString(),o,c=>{z0(e,"transaction put response",{path:l.toString(),status:c});let u=[];if(c==="ok"){const f=[];for(let h=0;h<r.length;h++)r[h].status=2,u=u.concat(Yi(e.serverSyncTree_,r[h].currentWriteId)),r[h].onComplete&&f.push(()=>r[h].onComplete(null,!0,r[h].currentOutputSnapshotResolved)),r[h].unwatcher();$0(e,S1(e.transactionQueueTree_,t)),N1(e,e.transactionQueueTree_),Rn(e.eventQueue_,t,u);for(let h=0;h<f.length;h++)Oo(f[h])}else{if(c==="datastale")for(let f=0;f<r.length;f++)r[f].status===3?r[f].status=4:r[f].status=0;else{yr("transaction at "+l.toString()+" failed: "+c);for(let f=0;f<r.length;f++)r[f].status=4,r[f].abortReason=c}Eo(e,t)}},a)}function Eo(e,t){const r=Qk(e,t),n=Vc(r),i=Jk(e,r);return Cb(e,i,n),n}function Cb(e,t,r){if(t.length===0)return;const n=[];let i=[];const a=t.filter(o=>o.status===0).map(o=>o.currentWriteId);for(let o=0;o<t.length;o++){const l=t[o],c=Ar(r,l.path);let u=!1,f;if(oe(c!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),l.status===4)u=!0,f=l.abortReason,i=i.concat(Yi(e.serverSyncTree_,l.currentWriteId,!0));else if(l.status===0)if(l.retryCount>=mb)u=!0,f="maxretry",i=i.concat(Yi(e.serverSyncTree_,l.currentWriteId,!0));else{const h=qk(e,l.path,a);l.currentInputSnapshot=h;const d=t[o].update(h.val());if(d!==void 0){V0("transaction failed: Data returned ",d,l.path);let m=jt(d);typeof d=="object"&&d!=null&&Kn(d,".priority")||(m=m.updatePriority(h.getPriority()));const g=l.currentWriteId,x=H0(e),_=Wk(m,h,x);l.currentOutputSnapshotRaw=m,l.currentOutputSnapshotResolved=_,l.currentWriteId=F1(e),a.splice(a.indexOf(g),1),i=i.concat(bk(e.serverSyncTree_,l.path,_,l.currentWriteId,l.applyLocally)),i=i.concat(Yi(e.serverSyncTree_,g,!0))}else u=!0,f="nodata",i=i.concat(Yi(e.serverSyncTree_,l.currentWriteId,!0))}Rn(e.eventQueue_,r,i),i=[],u&&(t[o].status=2,function(h){setTimeout(h,Math.floor(0))}(t[o].unwatcher),t[o].onComplete&&(f==="nodata"?n.push(()=>t[o].onComplete(null,!1,t[o].currentInputSnapshot)):n.push(()=>t[o].onComplete(new Error(f),!1,null))))}$0(e,e.transactionQueueTree_);for(let o=0;o<n.length;o++)Oo(n[o]);N1(e,e.transactionQueueTree_)}function Qk(e,t){let r,n=e.transactionQueueTree_;for(r=De(t);r!==null&&bo(n)===void 0;)n=S1(n,r),t=et(t),r=De(t);return n}function Jk(e,t){const r=[];return Zk(e,t,r),r.sort((n,i)=>n.order-i.order),r}function Zk(e,t,r){const n=bo(t);if(n)for(let i=0;i<n.length;i++)r.push(n[i]);W0(t,i=>{Zk(e,i,r)})}function $0(e,t){const r=bo(t);if(r){let n=0;for(let i=0;i<r.length;i++)r[i].status!==2&&(r[n]=r[i],n++);r.length=n,Vk(t,r.length>0?r:void 0)}W0(t,n=>{$0(e,n)})}function R1(e,t){const r=Vc(Qk(e,t)),n=S1(e.transactionQueueTree_,t);return rb(n,i=>{zh(e,i)}),zh(e,n),Hk(n,i=>{zh(e,i)}),r}function zh(e,t){const r=bo(t);if(r){const n=[];let i=[],s=-1;for(let a=0;a<r.length;a++)r[a].status===3||(r[a].status===1?(oe(s===a-1,"All SENT items should be at beginning of queue."),s=a,r[a].status=3,r[a].abortReason="set"):(oe(r[a].status===0,"Unexpected transaction status in abort"),r[a].unwatcher(),i=i.concat(Yi(e.serverSyncTree_,r[a].currentWriteId,!0)),r[a].onComplete&&n.push(r[a].onComplete.bind(null,new Error("set"),!1,null))));s===-1?Vk(t,void 0):r.length=s+1,Rn(e.eventQueue_,Vc(t),i);for(let a=0;a<n.length;a++)Oo(n[a])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ib(e){let t="";const r=e.split("/");for(let n=0;n<r.length;n++)if(r[n].length>0){let i=r[n];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch{}t+="/"+i}return t}function Ab(e){const t={};e.charAt(0)==="?"&&(e=e.substring(1));for(const r of e.split("&")){if(r.length===0)continue;const n=r.split("=");n.length===2?t[decodeURIComponent(n[0])]=decodeURIComponent(n[1]):yr(`Invalid query segment '${r}' in query '${e}'`)}return t}const i_=function(e,t){const r=Fb(e),n=r.namespace;r.domain==="firebase.com"&&ki(r.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!n||n==="undefined")&&r.domain!=="localhost"&&ki("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),r.secure||BP();const i=r.scheme==="ws"||r.scheme==="wss";return{repoInfo:new sk(r.host,r.secure,n,i,t,"",n!==r.subdomain),path:new Qe(r.pathString)}},Fb=function(e){let t="",r="",n="",i="",s="",a=!0,o="https",l=443;if(typeof e=="string"){let c=e.indexOf("//");c>=0&&(o=e.substring(0,c-1),e=e.substring(c+2));let u=e.indexOf("/");u===-1&&(u=e.length);let f=e.indexOf("?");f===-1&&(f=e.length),t=e.substring(0,Math.min(u,f)),u<f&&(i=Ib(e.substring(u,f)));const h=Ab(e.substring(Math.min(e.length,f)));c=t.indexOf(":"),c>=0?(a=o==="https"||o==="wss",l=parseInt(t.substring(c+1),10)):c=t.length;const d=t.slice(0,c);if(d.toLowerCase()==="localhost")r="localhost";else if(d.split(".").length<=2)r=d;else{const m=t.indexOf(".");n=t.substring(0,m).toLowerCase(),r=t.substring(m+1),s=n}"ns"in h&&(s=h.ns)}return{host:t,port:l,domain:r,subdomain:n,secure:a,scheme:o,pathString:i,namespace:s}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const s_="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",Nb=function(){let e=0;const t=[];return function(r){const n=r===e;e=r;let i;const s=new Array(8);for(i=7;i>=0;i--)s[i]=s_.charAt(r%64),r=Math.floor(r/64);oe(r===0,"Cannot push at time == 0");let a=s.join("");if(n){for(i=11;i>=0&&t[i]===63;i--)t[i]=0;t[i]++}else for(i=0;i<12;i++)t[i]=Math.floor(Math.random()*64);for(i=0;i<12;i++)a+=s_.charAt(t[i]);return oe(a.length===20,"nextPushId: Length should be 20."),a}}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rb{constructor(t,r,n,i){this.eventType=t,this.eventRegistration=r,this.snapshot=n,this.prevName=i}getPath(){const t=this.snapshot.ref;return this.eventType==="value"?t._path:t.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+Ht(this.snapshot.exportVal())}}class Pb{constructor(t,r,n){this.eventRegistration=t,this.error=r,this.path=n}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ob{constructor(t,r){this.snapshotCallback=t,this.cancelCallback=r}onValue(t,r){this.snapshotCallback.call(null,t,r)}onCancel(t){return oe(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,t)}get hasCancelCallback(){return!!this.cancelCallback}matches(t){return this.snapshotCallback===t.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===t.snapshotCallback.userCallback&&this.snapshotCallback.context===t.snapshotCallback.context}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P1{constructor(t,r,n,i){this._repo=t,this._path=r,this._queryParams=n,this._orderByCalled=i}get key(){return Me(this._path)?null:n1(this._path)}get ref(){return new Ts(this._repo,this._path)}get _queryIdentifier(){const t=Hx(this._queryParams),r=Zm(t);return r==="{}"?"default":r}get _queryObject(){return Hx(this._queryParams)}isEqual(t){if(t=dr(t),!(t instanceof P1))return!1;const r=this._repo===t._repo,n=i1(this._path,t._path),i=this._queryIdentifier===t._queryIdentifier;return r&&n&&i}toJSON(){return this.toString()}toString(){return this._repo.toString()+wO(this._path)}}class Ts extends P1{constructor(t,r){super(t,r,new l1,!1)}get parent(){const t=pk(this._path);return t===null?null:new Ts(this._repo,t)}get root(){let t=this;for(;t.parent!==null;)t=t.parent;return t}}class Xf{constructor(t,r,n){this._node=t,this.ref=r,this._index=n}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(t){const r=new Qe(t),n=fc(this.ref,t);return new Xf(this._node.getChild(r),n,_t)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(t){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(n,i)=>t(new Xf(i,fc(this.ref,n),_t)))}hasChild(t){const r=new Qe(t);return!this._node.getChild(r).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function xu(e,t){return e=dr(e),e._checkNotDeleted("ref"),t!==void 0?fc(e._root,t):e._root}function fc(e,t){return e=dr(e),De(e._path)===null?ub("child","path",t):Gk("child","path",t),new Ts(e._repo,xt(e._path,t))}function Db(e,t){e=dr(e),I1("push",e._path),$k("push",t,e._path,!0);const r=Yk(e._repo),n=Nb(r),i=fc(e,n),s=fc(e,n);let a;return t!=null?a=eT(s,t).then(()=>s):a=Promise.resolve(s),i.then=a.then.bind(a),i.catch=a.then.bind(a,void 0),i}function bb(e){return I1("remove",e._path),eT(e,null)}function eT(e,t){e=dr(e),I1("set",e._path),$k("set",t,e._path,!1);const r=new Oc;return _b(e._repo,e._path,t,null,r.wrapCallback(()=>{})),r.promise}function Lb(e,t){cb("update",t,e._path);const r=new Oc;return yb(e._repo,e._path,t,r.wrapCallback(()=>{})),r.promise}class O1{constructor(t){this.callbackContext=t}respondsTo(t){return t==="value"}createEvent(t,r){const n=r._queryParams.getIndex();return new Rb("value",this,new Xf(t.snapshotNode,new Ts(r._repo,r._path),n))}getEventRunner(t){return t.getEventType()==="cancel"?()=>this.callbackContext.onCancel(t.error):()=>this.callbackContext.onValue(t.snapshot,null)}createCancelEvent(t,r){return this.callbackContext.hasCancelCallback?new Pb(this,t,r):null}matches(t){return t instanceof O1?!t.callbackContext||!this.callbackContext?!0:t.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}}function Mb(e,t,r,n,i){const s=new Ob(r,void 0),a=new O1(s);return Eb(e._repo,e,a),()=>kb(e._repo,e,a)}function Bb(e,t,r,n){return Mb(e,"value",t)}OD(Ts);UD(Ts);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ub="FIREBASE_DATABASE_EMULATOR_HOST",Ip={};let Wb=!1;function Vb(e,t,r,n){e.repoInfo_=new sk(`${t}:${r}`,!1,e.repoInfo_.namespace,e.repoInfo_.webSocketOnly,e.repoInfo_.nodeAdmin,e.repoInfo_.persistenceKey,e.repoInfo_.includeNamespaceInQueryParams,!0),n&&(e.authTokenProvider_=n)}function jb(e,t,r,n,i){let s=n||e.options.databaseURL;s===void 0&&(e.options.projectId||ki("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),qt("Using default host for project ",e.options.projectId),s=`${e.options.projectId}-default-rtdb.firebaseio.com`);let a=i_(s,i),o=a.repoInfo,l;typeof process<"u"&&Sx&&(l=Sx[Ub]),l?(s=`http://${l}?ns=${o.namespace}`,a=i_(s,i),o=a.repoInfo):a.repoInfo.secure;const c=new YP(e.name,e.options,t);fb("Invalid Firebase Database URL",a),Me(a.path)||ki("Database URL must point to the root of a Firebase Database (not including a child path).");const u=zb(o,e,c,new XP(e.name,r));return new $b(u,e)}function Hb(e,t){const r=Ip[t];(!r||r[e.key]!==e)&&ki(`Database ${t}(${e.repoInfo_}) has already been deleted.`),Tb(e),delete r[e.key]}function zb(e,t,r,n){let i=Ip[t.name];i||(i={},Ip[t.name]=i);let s=i[e.toURLString()];return s&&ki("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),s=new gb(e,Wb,r,n),i[e.toURLString()]=s,s}let $b=class{constructor(t,r){this._repoInternal=t,this.app=r,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(vb(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new Ts(this._repo,ze())),this._rootInternal}_delete(){return this._rootInternal!==null&&(Hb(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(t){this._rootInternal===null&&ki("Cannot call "+t+" on a deleted database.")}};function Gb(e=jm(),t){const r=N0(e,"database").getImmediate({identifier:t});if(!r._instanceStarted){const n=eE("database");n&&Kb(r,...n)}return r}function Kb(e,t,r,n={}){e=dr(e),e._checkNotDeleted("useEmulator"),e._instanceStarted&&ki("Cannot call useEmulator() after instance has already been initialized.");const i=e._repoInternal;let s;if(i.repoInfo_.nodeAdmin)n.mockUserToken&&ki('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),s=new Qu(Qu.OWNER);else if(n.mockUserToken){const a=typeof n.mockUserToken=="string"?n.mockUserToken:nE(n.mockUserToken,e.app.options.projectId);s=new Qu(a)}Vb(i,t,r,s)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xb(e){PP(ma),Js(new hs("database",(t,{instanceIdentifier:r})=>{const n=t.getProvider("app").getImmediate(),i=t.getProvider("auth-internal"),s=t.getProvider("app-check-internal");return jb(n,i,s,r)},"PUBLIC").setMultipleInstances(!0)),Hn(Cx,Ix,e),Hn(Cx,Ix,"esm2017")}hi.prototype.simpleListen=function(e,t){this.sendRequest("q",{p:e},t)};hi.prototype.echo=function(e,t){this.sendRequest("echo",{d:e},t)};Xb();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tT="firebasestorage.googleapis.com",Yb="storageBucket",qb=2*60*1e3,Qb=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xn extends Ci{constructor(t,r,n=0){super($h(t),`Firebase Storage: ${r} (${$h(t)})`),this.status_=n,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Xn.prototype)}get status(){return this.status_}set status(t){this.status_=t}_codeEquals(t){return $h(t)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(t){this.customData.serverResponse=t,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Gn;(function(e){e.UNKNOWN="unknown",e.OBJECT_NOT_FOUND="object-not-found",e.BUCKET_NOT_FOUND="bucket-not-found",e.PROJECT_NOT_FOUND="project-not-found",e.QUOTA_EXCEEDED="quota-exceeded",e.UNAUTHENTICATED="unauthenticated",e.UNAUTHORIZED="unauthorized",e.UNAUTHORIZED_APP="unauthorized-app",e.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",e.INVALID_CHECKSUM="invalid-checksum",e.CANCELED="canceled",e.INVALID_EVENT_NAME="invalid-event-name",e.INVALID_URL="invalid-url",e.INVALID_DEFAULT_BUCKET="invalid-default-bucket",e.NO_DEFAULT_BUCKET="no-default-bucket",e.CANNOT_SLICE_BLOB="cannot-slice-blob",e.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",e.NO_DOWNLOAD_URL="no-download-url",e.INVALID_ARGUMENT="invalid-argument",e.INVALID_ARGUMENT_COUNT="invalid-argument-count",e.APP_DELETED="app-deleted",e.INVALID_ROOT_OPERATION="invalid-root-operation",e.INVALID_FORMAT="invalid-format",e.INTERNAL_ERROR="internal-error",e.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Gn||(Gn={}));function $h(e){return"storage/"+e}function Jb(){const e="An unknown error occurred, please check the error payload for server response.";return new Xn(Gn.UNKNOWN,e)}function Zb(){return new Xn(Gn.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function e8(){return new Xn(Gn.CANCELED,"User canceled the upload/download.")}function t8(e){return new Xn(Gn.INVALID_URL,"Invalid URL '"+e+"'.")}function r8(e){return new Xn(Gn.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+e+"'.")}function a_(e){return new Xn(Gn.INVALID_ARGUMENT,e)}function rT(){return new Xn(Gn.APP_DELETED,"The Firebase app was deleted.")}function n8(e){return new Xn(Gn.INVALID_ROOT_OPERATION,"The operation '"+e+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wn{constructor(t,r){this.bucket=t,this.path_=r}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const t=encodeURIComponent;return"/b/"+t(this.bucket)+"/o/"+t(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(t,r){let n;try{n=wn.makeFromUrl(t,r)}catch{return new wn(t,"")}if(n.path==="")return n;throw r8(t)}static makeFromUrl(t,r){let n=null;const i="([A-Za-z0-9.\\-_]+)";function s(E){E.path.charAt(E.path.length-1)==="/"&&(E.path_=E.path_.slice(0,-1))}const a="(/(.*))?$",o=new RegExp("^gs://"+i+a,"i"),l={bucket:1,path:3};function c(E){E.path_=decodeURIComponent(E.path)}const u="v[A-Za-z0-9_]+",f=r.replace(/[.]/g,"\\."),h="(/([^?#]*).*)?$",d=new RegExp(`^https?://${f}/${u}/b/${i}/o${h}`,"i"),m={bucket:1,path:3},p=r===tT?"(?:storage.googleapis.com|storage.cloud.google.com)":r,g="([^?#]*)",x=new RegExp(`^https?://${p}/${i}/${g}`,"i"),v=[{regex:o,indices:l,postModify:s},{regex:d,indices:m,postModify:c},{regex:x,indices:{bucket:1,path:2},postModify:c}];for(let E=0;E<v.length;E++){const N=v[E],I=N.regex.exec(t);if(I){const w=I[N.indices.bucket];let O=I[N.indices.path];O||(O=""),n=new wn(w,O),N.postModify(n);break}}if(n==null)throw t8(t);return n}}class i8{constructor(t){this.promise_=Promise.reject(t)}getPromise(){return this.promise_}cancel(t=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function s8(e,t,r){let n=1,i=null,s=null,a=!1,o=0;function l(){return o===2}let c=!1;function u(...g){c||(c=!0,t.apply(null,g))}function f(g){i=setTimeout(()=>{i=null,e(d,l())},g)}function h(){s&&clearTimeout(s)}function d(g,...x){if(c){h();return}if(g){h(),u.call(null,g,...x);return}if(l()||a){h(),u.call(null,g,...x);return}n<64&&(n*=2);let v;o===1?(o=2,v=0):v=(n+Math.random())*1e3,f(v)}let m=!1;function p(g){m||(m=!0,h(),!c&&(i!==null?(g||(o=2),clearTimeout(i),f(0)):g||(o=1)))}return f(0),s=setTimeout(()=>{a=!0,p(!0)},r),p}function a8(e){e(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function o8(e){return e!==void 0}function o_(e,t,r,n){if(n<t)throw a_(`Invalid value for '${e}'. Expected ${t} or greater.`);if(n>r)throw a_(`Invalid value for '${e}'. Expected ${r} or less.`)}function l8(e){const t=encodeURIComponent;let r="?";for(const n in e)if(e.hasOwnProperty(n)){const i=t(n)+"="+t(e[n]);r=r+i+"&"}return r=r.slice(0,-1),r}var Yf;(function(e){e[e.NO_ERROR=0]="NO_ERROR",e[e.NETWORK_ERROR=1]="NETWORK_ERROR",e[e.ABORT=2]="ABORT"})(Yf||(Yf={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function c8(e,t){const r=e>=500&&e<600,i=[408,429].indexOf(e)!==-1,s=t.indexOf(e)!==-1;return r||i||s}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u8{constructor(t,r,n,i,s,a,o,l,c,u,f,h=!0){this.url_=t,this.method_=r,this.headers_=n,this.body_=i,this.successCodes_=s,this.additionalRetryCodes_=a,this.callback_=o,this.errorCallback_=l,this.timeout_=c,this.progressCallback_=u,this.connectionFactory_=f,this.retry=h,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((d,m)=>{this.resolve_=d,this.reject_=m,this.start_()})}start_(){const t=(n,i)=>{if(i){n(!1,new _u(!1,null,!0));return}const s=this.connectionFactory_();this.pendingConnection_=s;const a=o=>{const l=o.loaded,c=o.lengthComputable?o.total:-1;this.progressCallback_!==null&&this.progressCallback_(l,c)};this.progressCallback_!==null&&s.addUploadProgressListener(a),s.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&s.removeUploadProgressListener(a),this.pendingConnection_=null;const o=s.getErrorCode()===Yf.NO_ERROR,l=s.getStatus();if(!o||c8(l,this.additionalRetryCodes_)&&this.retry){const u=s.getErrorCode()===Yf.ABORT;n(!1,new _u(!1,null,u));return}const c=this.successCodes_.indexOf(l)!==-1;n(!0,new _u(c,s))})},r=(n,i)=>{const s=this.resolve_,a=this.reject_,o=i.connection;if(i.wasSuccessCode)try{const l=this.callback_(o,o.getResponse());o8(l)?s(l):s()}catch(l){a(l)}else if(o!==null){const l=Jb();l.serverResponse=o.getErrorText(),this.errorCallback_?a(this.errorCallback_(o,l)):a(l)}else if(i.canceled){const l=this.appDelete_?rT():e8();a(l)}else{const l=Zb();a(l)}};this.canceled_?r(!1,new _u(!1,null,!0)):this.backoffId_=s8(t,r,this.timeout_)}getPromise(){return this.promise_}cancel(t){this.canceled_=!0,this.appDelete_=t||!1,this.backoffId_!==null&&a8(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class _u{constructor(t,r,n){this.wasSuccessCode=t,this.connection=r,this.canceled=!!n}}function f8(e,t){t!==null&&t.length>0&&(e.Authorization="Firebase "+t)}function h8(e,t){e["X-Firebase-Storage-Version"]="webjs/"+(t??"AppManager")}function d8(e,t){t&&(e["X-Firebase-GMPID"]=t)}function p8(e,t){t!==null&&(e["X-Firebase-AppCheck"]=t)}function m8(e,t,r,n,i,s,a=!0){const o=l8(e.urlParams),l=e.url+o,c=Object.assign({},e.headers);return d8(c,t),f8(c,r),h8(c,s),p8(c,n),new u8(l,e.method,c,e.body,e.successCodes,e.additionalRetryCodes,e.handler,e.errorHandler,e.timeout,e.progressCallback,i,a)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function g8(e){if(e.length===0)return null;const t=e.lastIndexOf("/");return t===-1?"":e.slice(0,t)}function v8(e){const t=e.lastIndexOf("/",e.length-2);return t===-1?e:e.slice(t+1)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qf{constructor(t,r){this._service=t,r instanceof wn?this._location=r:this._location=wn.makeFromUrl(r,t.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(t,r){return new qf(t,r)}get root(){const t=new wn(this._location.bucket,"");return this._newRef(this._service,t)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return v8(this._location.path)}get storage(){return this._service}get parent(){const t=g8(this._location.path);if(t===null)return null;const r=new wn(this._location.bucket,t);return new qf(this._service,r)}_throwIfRoot(t){if(this._location.path==="")throw n8(t)}}function l_(e,t){const r=t==null?void 0:t[Yb];return r==null?null:wn.makeFromBucketSpec(r,e)}function x8(e,t,r,n={}){e.host=`${t}:${r}`,e._protocol="http";const{mockUserToken:i}=n;i&&(e._overrideAuthToken=typeof i=="string"?i:nE(i,e.app.options.projectId))}class _8{constructor(t,r,n,i,s){this.app=t,this._authProvider=r,this._appCheckProvider=n,this._url=i,this._firebaseVersion=s,this._bucket=null,this._host=tT,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=qb,this._maxUploadRetryTime=Qb,this._requests=new Set,i!=null?this._bucket=wn.makeFromBucketSpec(i,this._host):this._bucket=l_(this._host,this.app.options)}get host(){return this._host}set host(t){this._host=t,this._url!=null?this._bucket=wn.makeFromBucketSpec(this._url,t):this._bucket=l_(t,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(t){o_("time",0,Number.POSITIVE_INFINITY,t),this._maxUploadRetryTime=t}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(t){o_("time",0,Number.POSITIVE_INFINITY,t),this._maxOperationRetryTime=t}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const t=this._authProvider.getImmediate({optional:!0});if(t){const r=await t.getToken();if(r!==null)return r.accessToken}return null}async _getAppCheckToken(){const t=this._appCheckProvider.getImmediate({optional:!0});return t?(await t.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(t=>t.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(t){return new qf(this,t)}_makeRequest(t,r,n,i,s=!0){if(this._deleted)return new i8(rT());{const a=m8(t,this._appId,n,i,r,this._firebaseVersion,s);return this._requests.add(a),a.getPromise().then(()=>this._requests.delete(a),()=>this._requests.delete(a)),a}}async makeRequestWithTokens(t,r){const[n,i]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(t,r,n,i).getPromise()}}const c_="@firebase/storage",u_="0.13.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nT="storage";function y8(e=jm(),t){e=dr(e);const n=N0(e,nT).getImmediate({identifier:t}),i=eE("storage");return i&&w8(n,...i),n}function w8(e,t,r,n={}){x8(e,t,r,n)}function E8(e,{instanceIdentifier:t}){const r=e.getProvider("app").getImmediate(),n=e.getProvider("auth-internal"),i=e.getProvider("app-check-internal");return new _8(r,n,i,t,ma)}function k8(){Js(new hs(nT,E8,"PUBLIC").setMultipleInstances(!0)),Hn(c_,u_,""),Hn(c_,u_,"esm2017")}k8();const T8={BASE_URL:"/catalogo/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_FIREBASE_API_KEY:"AIzaSyDcYMJvtyvFkWQjQ2eIrmWxH8DKMB0vpTw",VITE_FIREBASE_APP_ID:"1:501721428291:web:068fdf2fe0fddf5c24fff6",VITE_FIREBASE_AUTH_DOMAIN:"nrd-catalogo-prod.firebaseapp.com",VITE_FIREBASE_DATABASE_URL:"https://nrd-catalogo-prod-default-rtdb.firebaseio.com",VITE_FIREBASE_MESSAGING_SENDER_ID:"501721428291",VITE_FIREBASE_PROJECT_ID:"nrd-catalogo-prod",VITE_FIREBASE_STORAGE_BUCKET:"nrd-catalogo-prod.firebasestorage.app"},S8=["VITE_FIREBASE_API_KEY","VITE_FIREBASE_AUTH_DOMAIN","VITE_FIREBASE_DATABASE_URL","VITE_FIREBASE_PROJECT_ID","VITE_FIREBASE_STORAGE_BUCKET","VITE_FIREBASE_MESSAGING_SENDER_ID","VITE_FIREBASE_APP_ID"];for(const e of S8)if(!T8[e])throw new Error(`Missing required environment variable: ${e}`);const C8={apiKey:"AIzaSyDcYMJvtyvFkWQjQ2eIrmWxH8DKMB0vpTw",authDomain:"nrd-catalogo-prod.firebaseapp.com",databaseURL:"https://nrd-catalogo-prod-default-rtdb.firebaseio.com",projectId:"nrd-catalogo-prod",storageBucket:"nrd-catalogo-prod.firebasestorage.app",messagingSenderId:"501721428291",appId:"1:501721428291:web:068fdf2fe0fddf5c24fff6"},D1=cE(C8),Gh=AP(D1),yu=Gb(D1);y8(D1);const b1=()=>{const[e,t]=Q.useState(null),[r,n]=Q.useState(!0);return Q.useEffect(()=>{const a=gR(Gh,o=>{t(o?{email:o.email,id:o.uid}:null),n(!1)});return()=>a()},[]),{user:e,loading:r,signIn:async(a,o)=>{try{await dR(Gh,a,o)}catch(l){throw l}},signOut:async()=>{try{await vR(Gh)}catch(a){throw a}}}};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var I8={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A8=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),Xr=(e,t)=>{const r=Q.forwardRef(({color:n="currentColor",size:i=24,strokeWidth:s=2,absoluteStrokeWidth:a,className:o="",children:l,...c},u)=>Q.createElement("svg",{ref:u,...I8,width:i,height:i,stroke:n,strokeWidth:a?Number(s)*24/Number(i):s,className:["lucide",`lucide-${A8(e)}`,o].join(" "),...c},[...t.map(([f,h])=>Q.createElement(f,h)),...Array.isArray(l)?l:[l]]));return r.displayName=`${e}`,r};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F8=Xr("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const N8=Xr("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R8=Xr("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P8=Xr("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O8=Xr("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f_=Xr("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D8=Xr("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b8=Xr("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L8=Xr("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M8=Xr("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a2.121 2.121 0 1 1 3 3L12 15l-4 1 1-4Z",key:"1lpok0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B8=Xr("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U8=Xr("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iT=Xr("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),W8=()=>{const[e,t]=Q.useState(""),[r,n]=Q.useState(""),{signIn:i}=b1(),s=async a=>{a.preventDefault();try{await i(e,r)}catch{Xi.error("Error al iniciar sesin. Verifica tus credenciales.")}};return L.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-100 px-4",children:L.jsxs("div",{className:"max-w-md w-full space-y-8 bg-white p-8 rounded-lg shadow-md",children:[L.jsxs("div",{className:"text-center",children:[L.jsx(R8,{className:"mx-auto h-12 w-12 text-indigo-600"}),L.jsx("h2",{className:"mt-6 text-3xl font-extrabold text-gray-900",children:"Catlogo de Productos"}),L.jsx("p",{className:"mt-2 text-sm text-gray-600",children:"Inicia sesin para gestionar tu catlogo"})]}),L.jsxs("form",{className:"mt-8 space-y-6",onSubmit:s,children:[L.jsxs("div",{className:"rounded-md shadow-sm space-y-4",children:[L.jsxs("div",{children:[L.jsx("label",{htmlFor:"email",className:"sr-only",children:"Correo electrnico"}),L.jsx("input",{id:"email",name:"email",type:"email",required:!0,className:"appearance-none rounded-lg relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 focus:z-10 sm:text-sm",placeholder:"Correo electrnico",value:e,onChange:a=>t(a.target.value)})]}),L.jsxs("div",{children:[L.jsx("label",{htmlFor:"password",className:"sr-only",children:"Contrasea"}),L.jsx("input",{id:"password",name:"password",type:"password",required:!0,className:"appearance-none rounded-lg relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 focus:z-10 sm:text-sm",placeholder:"Contrasea",value:r,onChange:a=>n(a.target.value)})]})]}),L.jsx("button",{type:"submit",className:"group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:"Iniciar sesin"})]})]})})},G0=()=>{const[e,t]=Q.useState([]),[r,n]=Q.useState(!0);return Q.useEffect(()=>{const o=xu(yu,"products"),l=Bb(o,c=>{const u=c.val();if(u){const f=Object.entries(u).map(([h,d])=>({id:h,...d}));t(f)}else t([]);n(!1)});return()=>l()},[]),{products:e,loading:r,addProduct:async o=>{try{const l=xu(yu,"products");await Db(l,o)}catch(l){throw l}},updateProduct:async(o,l)=>{try{const c=xu(yu,`products/${o}`);await Lb(c,l)}catch(c){throw c}},deleteProduct:async o=>{try{const l=xu(yu,`products/${o}`);await bb(l)}catch(l){throw l}}}},V8=({search:e,setSearch:t,section:r,setSection:n,status:i,setStatus:s,sections:a})=>L.jsxs("div",{className:"space-y-4 mb-6",children:[L.jsxs("div",{className:"relative",children:[L.jsx(L8,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-5 w-5"}),L.jsx("input",{type:"text",placeholder:"Buscar por nombre, SKU o cdigo de barras",className:"w-full pl-10 pr-4 py-2 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",value:e,onChange:o=>t(o.target.value)})]}),L.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[L.jsxs("select",{className:"flex-1 border rounded-lg px-3 py-2",value:r,onChange:o=>n(o.target.value),children:[L.jsx("option",{value:"",children:"Todas las secciones"}),a.map(o=>L.jsx("option",{value:o,children:o},o))]}),L.jsxs("select",{className:"flex-1 border rounded-lg px-3 py-2",value:i,onChange:o=>s(o.target.value),children:[L.jsx("option",{value:"",children:"Todos los estados"}),L.jsx("option",{value:"1",children:"Activo"}),L.jsx("option",{value:"0",children:"Inactivo"})]})]})]}),sT=e=>{if(!e)return"";try{const t=e.match(/\/d\/([a-zA-Z0-9_-]+)/);return!t||!t[1]?"":`https://drive.google.com/thumbnail?id=${t[1]}&sz=w1000`}catch{return""}},j8=({product:e,onEdit:t})=>{const{deleteProduct:r}=G0(),n=sT(e.imageUrl);return L.jsxs("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:[n&&L.jsx("div",{className:"w-full h-48 bg-gray-100",children:L.jsx("img",{src:n,alt:e.name,className:"w-full h-full object-cover",onError:i=>{i.currentTarget.style.display="none"},loading:"lazy"})}),L.jsxs("div",{className:"p-4",children:[L.jsxs("div",{className:"flex justify-between items-start",children:[L.jsx("h3",{className:"text-lg font-semibold",children:e.name}),L.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${e.status?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:e.status?"Activo":"Inactivo"})]}),L.jsxs("div",{className:"mt-2 space-y-1 text-sm text-gray-600",children:[L.jsxs("p",{children:["Precio: $",e.price.toFixed(2)]}),L.jsxs("p",{children:["SKU: ",e.sku]}),L.jsxs("p",{children:["Cdigo: ",e.barcode]}),L.jsxs("p",{children:["Cantidad mx: ",e.maxQuantity]}),L.jsxs("p",{children:["Seccin: ",e.section]})]}),L.jsxs("div",{className:"mt-4 flex justify-end space-x-2",children:[L.jsx("button",{className:"p-2 text-blue-600 hover:bg-blue-50 rounded-full transition-colors",onClick:()=>t(e),children:L.jsx(M8,{className:"h-5 w-5"})}),L.jsx("button",{className:"p-2 text-red-600 hover:bg-red-50 rounded-full transition-colors",onClick:()=>r(e.id),children:L.jsx(B8,{className:"h-5 w-5"})})]})]})]})},H8=({size:e="md"})=>{const t={sm:"h-6 w-6",md:"h-12 w-12",lg:"h-16 w-16"};return L.jsx("div",{className:"flex justify-center items-center",children:L.jsx("div",{className:`animate-spin rounded-full border-b-2 border-indigo-600 ${t[e]}`})})},z8=({products:e,loading:t,onEdit:r})=>t?L.jsx("div",{className:"flex justify-center items-center h-64",children:L.jsx(H8,{size:"lg"})}):e.length===0?L.jsx("div",{className:"text-center py-12",children:L.jsx("p",{className:"text-gray-500",children:"No se encontraron productos"})}):L.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:e.map(n=>L.jsx(j8,{product:n,onEdit:r},n.id))}),$8=e=>/^[0-9]{13}$/.test(e),G8=e=>e?e.includes("drive.google.com/file/d/")||e.includes("drive.google.com/open?id="):!0,K8=e=>{const t=parseFloat(e);return!isNaN(t)&&t>=0},X8=e=>{const t=parseInt(e);return!isNaN(t)&&t>0},Y8=({product:e,onClose:t})=>{const{addProduct:r,updateProduct:n}=G0(),[i,s]=Q.useState({name:"",price:"",barcode:"",sku:"",maxQuantity:"",status:"1",section:"",imageUrl:""}),[a,o]=Q.useState(!1),[l,c]=Q.useState(!1);Q.useEffect(()=>{e&&s({name:e.name,price:e.price.toString(),barcode:e.barcode,sku:e.sku,maxQuantity:e.maxQuantity.toString(),status:e.status.toString(),section:e.section,imageUrl:e.imageUrl||""})},[e]);const u=async h=>{h.preventDefault(),o(!0);try{if(i.imageUrl&&!G8(i.imageUrl))throw new Error("La URL debe ser de Google Drive");const d={name:i.name,price:parseFloat(i.price),barcode:i.barcode,sku:i.sku,maxQuantity:parseInt(i.maxQuantity),status:parseInt(i.status),section:i.section,imageUrl:i.imageUrl};e?(await n(e.id,d),Xi.success("Producto actualizado correctamente")):(await r(d),Xi.success("Producto agregado correctamente")),t()}catch(d){Xi.error(d instanceof Error?d.message:"Error al guardar el producto")}finally{o(!1)}},f=i.imageUrl?sT(i.imageUrl):"";return L.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:L.jsxs("div",{className:"bg-white rounded-lg max-w-md w-full max-h-[90vh] overflow-y-auto",children:[L.jsxs("div",{className:"sticky top-0 bg-white px-6 py-4 border-b flex justify-between items-center",children:[L.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:e?"Editar Producto":"Nuevo Producto"}),L.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-500 focus:outline-none",children:L.jsx(iT,{className:"h-6 w-6"})})]}),L.jsxs("form",{onSubmit:u,className:"p-6 space-y-4",children:[L.jsxs("div",{className:"space-y-4",children:[L.jsxs("div",{children:[L.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Nombre"}),L.jsx("input",{type:"text",required:!0,value:i.name,onChange:h=>s({...i,name:h.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"})]}),L.jsxs("div",{children:[L.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Precio"}),L.jsx("input",{type:"number",step:"0.01",required:!0,value:i.price,onChange:h=>s({...i,price:h.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"})]}),L.jsxs("div",{children:[L.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Cdigo de Barras"}),L.jsx("input",{type:"text",required:!0,pattern:"[0-9]{13}",title:"Debe contener 13 dgitos",value:i.barcode,onChange:h=>s({...i,barcode:h.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"})]}),L.jsxs("div",{children:[L.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"SKU"}),L.jsx("input",{type:"text",required:!0,value:i.sku,onChange:h=>s({...i,sku:h.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"})]}),L.jsxs("div",{children:[L.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Cantidad Mxima"}),L.jsx("input",{type:"number",required:!0,value:i.maxQuantity,onChange:h=>s({...i,maxQuantity:h.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"})]}),L.jsxs("div",{children:[L.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Seccin"}),L.jsx("input",{type:"text",required:!0,value:i.section,onChange:h=>s({...i,section:h.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"})]}),L.jsxs("div",{children:[L.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Estado"}),L.jsxs("select",{value:i.status,onChange:h=>s({...i,status:h.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",children:[L.jsx("option",{value:"1",children:"Activo"}),L.jsx("option",{value:"0",children:"Inactivo"})]})]}),L.jsxs("div",{children:[L.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"URL de la imagen (Google Drive)"}),L.jsxs("div",{className:"mt-1 flex items-center space-x-2",children:[L.jsx("input",{type:"text",value:i.imageUrl,onChange:h=>s({...i,imageUrl:h.target.value}),placeholder:"https://drive.google.com/...",className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"}),i.imageUrl&&L.jsx("button",{type:"button",onClick:()=>c(!l),className:"p-2 text-gray-600 hover:text-indigo-600 hover:bg-gray-100 rounded-full transition-colors",title:"Previsualizar imagen",children:L.jsx(O8,{className:"h-5 w-5"})})]})]}),l&&f&&L.jsx("div",{className:"mt-4",children:L.jsx("div",{className:"relative aspect-video rounded-lg overflow-hidden border border-gray-200",children:L.jsx("img",{src:f,alt:"Vista previa",className:"w-full h-48 object-cover",onError:h=>{h.currentTarget.style.display="none",Xi.error("No se pudo cargar la imagen")}})})})]}),L.jsxs("div",{className:"mt-6 flex justify-end space-x-3",children:[L.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:"Cancelar"}),L.jsx("button",{type:"submit",disabled:a,className:"px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed",children:a?"Guardando...":e?"Actualizar":"Crear"})]})]})]})})};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Qf={};Qf.version="0.18.5";var aT=1252,q8=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],L1={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},M1=function(e){q8.indexOf(e)!=-1&&(aT=L1[0]=e)};function Q8(){M1(1252)}var En=function(e){M1(e)};function B1(){En(1200),Q8()}function h_(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function J8(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function oT(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var ul=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?J8(e.slice(2)):t==254&&r==255?oT(e.slice(2)):t==65279?e.slice(1):e},wu=function(t){return String.fromCharCode(t)},d_=function(t){return String.fromCharCode(t)},zi,qi="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function hc(e){for(var t="",r=0,n=0,i=0,s=0,a=0,o=0,l=0,c=0;c<e.length;)r=e.charCodeAt(c++),s=r>>2,n=e.charCodeAt(c++),a=(r&3)<<4|n>>4,i=e.charCodeAt(c++),o=(n&15)<<2|i>>6,l=i&63,isNaN(n)?o=l=64:isNaN(i)&&(l=64),t+=qi.charAt(s)+qi.charAt(a)+qi.charAt(o)+qi.charAt(l);return t}function $r(e){var t="",r=0,n=0,i=0,s=0,a=0,o=0,l=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var c=0;c<e.length;)s=qi.indexOf(e.charAt(c++)),a=qi.indexOf(e.charAt(c++)),r=s<<2|a>>4,t+=String.fromCharCode(r),o=qi.indexOf(e.charAt(c++)),n=(a&15)<<4|o>>2,o!==64&&(t+=String.fromCharCode(n)),l=qi.indexOf(e.charAt(c++)),i=(o&3)<<6|l,l!==64&&(t+=String.fromCharCode(i));return t}var Re=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Ii=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function ms(e){return Re?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function p_(e){return Re?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Ur=function(t){return Re?Ii(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function K0(e){if(typeof ArrayBuffer>"u")return Ur(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function Ss(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function Z8(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function U1(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return U1(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var zt=Re?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:Ii(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),i=0;for(t=0,r=0;t<e.length;r+=i,++t)if(i=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function e6(e){for(var t=[],r=0,n=e.length+250,i=ms(e.length+255),s=0;s<e.length;++s){var a=e.charCodeAt(s);if(a<128)i[r++]=a;else if(a<2048)i[r++]=192|a>>6&31,i[r++]=128|a&63;else if(a>=55296&&a<57344){a=(a&1023)+64;var o=e.charCodeAt(++s)&1023;i[r++]=240|a>>8&7,i[r++]=128|a>>2&63,i[r++]=128|o>>6&15|(a&3)<<4,i[r++]=128|o&63}else i[r++]=224|a>>12&15,i[r++]=128|a>>6&63,i[r++]=128|a&63;r>n&&(t.push(i.slice(0,r)),r=0,i=ms(65535),n=65530)}return t.push(i.slice(0,r)),zt(t)}var wr=/\u0000/g,fl=/[\u0001-\u0006]/g;function io(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function kn(e,t){var r=""+e;return r.length>=t?r:vt("0",t-r.length)+r}function W1(e,t){var r=""+e;return r.length>=t?r:vt(" ",t-r.length)+r}function Jf(e,t){var r=""+e;return r.length>=t?r:r+vt(" ",t-r.length)}function t6(e,t){var r=""+Math.round(e);return r.length>=t?r:vt("0",t-r.length)+r}function r6(e,t){var r=""+e;return r.length>=t?r:vt("0",t-r.length)+r}var m_=Math.pow(2,32);function Ia(e,t){if(e>m_||e<-m_)return t6(e,t);var r=Math.round(e);return r6(r,t)}function Zf(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var g_=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Kh=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function n6(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var Ee={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},v_={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},i6={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function e0(e,t,r){for(var n=e<0?-1:1,i=e*n,s=0,a=1,o=0,l=1,c=0,u=0,f=Math.floor(i);c<t&&(f=Math.floor(i),o=f*a+s,u=f*c+l,!(i-f<5e-8));)i=1/(i-f),s=a,a=o,l=c,c=u;if(u>t&&(c>t?(u=l,o=s):(u=c,o=a)),!r)return[0,n*o,u];var h=Math.floor(n*o/u);return[h,n*o-h*u,u]}function Us(e,t,r){if(e>2958465||e<0)return null;var n=e|0,i=Math.floor(86400*(e-n)),s=0,a=[],o={D:n,T:i,u:86400*(e-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++i==86400&&(o.T=i=0,++n,++o.D)),n===60)a=r?[1317,10,29]:[1900,2,29],s=3;else if(n===0)a=r?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),a=[l.getFullYear(),l.getMonth()+1,l.getDate()],s=l.getDay(),n<60&&(s=(s+6)%7),r&&(s=u6(l,a))}return o.y=a[0],o.m=a[1],o.d=a[2],o.S=i%60,i=Math.floor(i/60),o.M=i%60,i=Math.floor(i/60),o.H=i,o.q=s,o}var lT=new Date(1899,11,31,0,0,0),s6=lT.getTime(),a6=new Date(1900,2,1,0,0,0);function cT(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=a6&&(r+=24*60*60*1e3),(r-(s6+(e.getTimezoneOffset()-lT.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function V1(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function o6(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function l6(e){var t=e<0?12:11,r=V1(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function c6(e){var t=V1(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function dc(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=l6(e):t===10?r=e.toFixed(10).substr(0,12):r=c6(e),V1(o6(r.toUpperCase()))}function ia(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):dc(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return hn(14,cT(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function u6(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function f6(e,t,r,n){var i="",s=0,a=0,o=r.y,l,c=0;switch(e){case 98:o=r.y+543;case 121:switch(t.length){case 1:case 2:l=o%100,c=2;break;default:l=o%1e4,c=4;break}break;case 109:switch(t.length){case 1:case 2:l=r.m,c=t.length;break;case 3:return Kh[r.m-1][1];case 5:return Kh[r.m-1][0];default:return Kh[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:l=r.d,c=t.length;break;case 3:return g_[r.q][0];default:return g_[r.q][1]}break;case 104:switch(t.length){case 1:case 2:l=1+(r.H+11)%12,c=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:l=r.H,c=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:l=r.M,c=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?kn(r.S,t.length):(n>=2?a=n===3?1e3:100:a=n===1?10:1,s=Math.round(a*(r.S+r.u)),s>=60*a&&(s=0),t==="s"?s===0?"0":""+s/a:(i=kn(s,2+n),t==="ss"?i.substr(0,2):"."+i.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":l=r.D*24+r.H;break;case"[m]":case"[mm]":l=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":l=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}c=t.length===3?1:2;break;case 101:l=o,c=1;break}var u=c>0?kn(l,c):"";return u}function Qi(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var uT=/%/g;function h6(e,t,r){var n=t.replace(uT,""),i=t.length-n.length;return di(e,n,r*Math.pow(10,2*i))+vt("%",i)}function d6(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return di(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function fT(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+fT(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(t/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),r.indexOf("e")===-1){var a=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+s):r+="E+"+(a-s);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,i)+"."+r.substr(2+i),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,u){return l+c+u.substr(0,(i+s)%i)+"."+u.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var hT=/# (\?+)( ?)\/( ?)(\d+)/;function p6(e,t,r){var n=parseInt(e[4],10),i=Math.round(t*n),s=Math.floor(i/n),a=i-s*n,o=n;return r+(s===0?"":""+s)+" "+(a===0?vt(" ",e[1].length+1+e[4].length):W1(a,e[1].length)+e[2]+"/"+e[3]+kn(o,e[4].length))}function m6(e,t,r){return r+(t===0?"":""+t)+vt(" ",e[1].length+2+e[4].length)}var dT=/^#*0*\.([0#]+)/,pT=/\).*[0#]/,mT=/\(###\) ###\\?-####/;function vr(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function x_(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function __(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function g6(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function v6(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Jr(e,t,r){if(e.charCodeAt(0)===40&&!t.match(pT)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Jr("n",n,r):"("+Jr("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return d6(e,t,r);if(t.indexOf("%")!==-1)return h6(e,t,r);if(t.indexOf("E")!==-1)return fT(t,r);if(t.charCodeAt(0)===36)return"$"+Jr(e,t.substr(t.charAt(1)==" "?2:1),r);var i,s,a,o,l=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+Ia(l,t.length);if(t.match(/^[#?]+$/))return i=Ia(r,0),i==="0"&&(i=""),i.length>t.length?i:vr(t.substr(0,t.length-i.length))+i;if(s=t.match(hT))return p6(s,l,c);if(t.match(/^#+0+$/))return c+Ia(l,t.length-t.indexOf("0"));if(s=t.match(dT))return i=x_(r,s[1].length).replace(/^([^\.]+)$/,"$1."+vr(s[1])).replace(/\.$/,"."+vr(s[1])).replace(/\.(\d*)$/,function(m,p){return"."+p+vt("0",vr(s[1]).length-p.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return c+x_(l,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return c+Qi(Ia(l,0));if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Jr(e,t,-r):Qi(""+(Math.floor(r)+g6(r,s[1].length)))+"."+kn(__(r,s[1].length),s[1].length);if(s=t.match(/^#,#*,#0/))return Jr(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=io(Jr(e,t.replace(/[\\-]/g,""),r)),a=0,io(io(t.replace(/\\/g,"")).replace(/[0#]/g,function(m){return a<i.length?i.charAt(a++):m==="0"?"0":""}));if(t.match(mT))return i=Jr(e,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var u="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=e0(l,Math.pow(10,a)-1,!1),i=""+c,u=di("n",s[1],o[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),i+=u+s[2]+"/"+s[3],u=Jf(o[2],a),u.length<s[4].length&&(u=vr(s[4].substr(s[4].length-u.length))+u),i+=u,i;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=e0(l,Math.pow(10,a)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?W1(o[1],a)+s[2]+"/"+s[3]+Jf(o[2],a):vt(" ",2*a+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return i=Ia(r,0),t.length<=i.length?i:vr(t.substr(0,t.length-i.length))+i;if(s=t.match(/^([#0?]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var f=t.indexOf(".")-a,h=t.length-i.length-f;return vr(t.substr(0,f)+i+t.substr(t.length-h))}if(s=t.match(/^00,000\.([#0]*0)$/))return a=__(r,s[1].length),r<0?"-"+Jr(e,t,-r):Qi(v6(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(m){return"00,"+(m.length<3?kn(0,3-m.length):"")+m})+"."+kn(a,s[1].length);switch(t){case"###,##0.00":return Jr(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var d=Qi(Ia(l,0));return d!=="0"?c+d:"";case"###,###.00":return Jr(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Jr(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function x6(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return di(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function _6(e,t,r){var n=t.replace(uT,""),i=t.length-n.length;return di(e,n,r*Math.pow(10,2*i))+vt("%",i)}function gT(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+gT(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(t/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),!r.match(/[Ee]/)){var a=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+s):r+="E+"+(a-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,u){return l+c+u.substr(0,(i+s)%i)+"."+u.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Ln(e,t,r){if(e.charCodeAt(0)===40&&!t.match(pT)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Ln("n",n,r):"("+Ln("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return x6(e,t,r);if(t.indexOf("%")!==-1)return _6(e,t,r);if(t.indexOf("E")!==-1)return gT(t,r);if(t.charCodeAt(0)===36)return"$"+Ln(e,t.substr(t.charAt(1)==" "?2:1),r);var i,s,a,o,l=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+kn(l,t.length);if(t.match(/^[#?]+$/))return i=""+r,r===0&&(i=""),i.length>t.length?i:vr(t.substr(0,t.length-i.length))+i;if(s=t.match(hT))return m6(s,l,c);if(t.match(/^#+0+$/))return c+kn(l,t.length-t.indexOf("0"));if(s=t.match(dT))return i=(""+r).replace(/^([^\.]+)$/,"$1."+vr(s[1])).replace(/\.$/,"."+vr(s[1])),i=i.replace(/\.(\d*)$/,function(m,p){return"."+p+vt("0",vr(s[1]).length-p.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return c+Qi(""+l);if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Ln(e,t,-r):Qi(""+r)+"."+vt("0",s[1].length);if(s=t.match(/^#,#*,#0/))return Ln(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=io(Ln(e,t.replace(/[\\-]/g,""),r)),a=0,io(io(t.replace(/\\/g,"")).replace(/[0#]/g,function(m){return a<i.length?i.charAt(a++):m==="0"?"0":""}));if(t.match(mT))return i=Ln(e,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var u="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=e0(l,Math.pow(10,a)-1,!1),i=""+c,u=di("n",s[1],o[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),i+=u+s[2]+"/"+s[3],u=Jf(o[2],a),u.length<s[4].length&&(u=vr(s[4].substr(s[4].length-u.length))+u),i+=u,i;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=e0(l,Math.pow(10,a)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?W1(o[1],a)+s[2]+"/"+s[3]+Jf(o[2],a):vt(" ",2*a+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return i=""+r,t.length<=i.length?i:vr(t.substr(0,t.length-i.length))+i;if(s=t.match(/^([#0]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var f=t.indexOf(".")-a,h=t.length-i.length-f;return vr(t.substr(0,f)+i+t.substr(t.length-h))}if(s=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Ln(e,t,-r):Qi(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(m){return"00,"+(m.length<3?kn(0,3-m.length):"")+m})+"."+kn(0,s[1].length);switch(t){case"###,###":case"##,###":case"#,###":var d=Qi(""+l);return d!=="0"?c+d:"";default:if(t.match(/\.[0#?]*$/))return Ln(e,t.slice(0,t.lastIndexOf(".")),r)+vr(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function di(e,t,r){return(r|0)===r?Ln(e,t,r):Jr(e,t,r)}function y6(e){for(var t=[],r=!1,n=0,i=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(i,n-i),i=n+1}if(t[t.length]=e.substr(i),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var vT=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Lo(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":Zf(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(vT))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function w6(e,t,r,n){for(var i=[],s="",a=0,o="",l="t",c,u,f,h="H";a<e.length;)switch(o=e.charAt(a)){case"G":if(!Zf(e,a))throw new Error("unrecognized character "+o+" in "+e);i[i.length]={t:"G",v:"General"},a+=7;break;case'"':for(s="";(f=e.charCodeAt(++a))!==34&&a<e.length;)s+=String.fromCharCode(f);i[i.length]={t:"t",v:s},++a;break;case"\\":var d=e.charAt(++a),m=d==="("||d===")"?d:"t";i[i.length]={t:m,v:d},++a;break;case"_":i[i.length]={t:"t",v:" "},a+=2;break;case"@":i[i.length]={t:"T",v:t},++a;break;case"B":case"b":if(e.charAt(a+1)==="1"||e.charAt(a+1)==="2"){if(c==null&&(c=Us(t,r,e.charAt(a+1)==="2"),c==null))return"";i[i.length]={t:"X",v:e.substr(a,2)},l=o,a+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||c==null&&(c=Us(t,r),c==null))return"";for(s=o;++a<e.length&&e.charAt(a).toLowerCase()===o;)s+=o;o==="m"&&l.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=h),i[i.length]={t:o,v:s},l=o;break;case"A":case"a":case"":var p={t:o,v:o};if(c==null&&(c=Us(t,r)),e.substr(a,3).toUpperCase()==="A/P"?(c!=null&&(p.v=c.H>=12?"P":"A"),p.t="T",h="h",a+=3):e.substr(a,5).toUpperCase()==="AM/PM"?(c!=null&&(p.v=c.H>=12?"PM":"AM"),p.t="T",a+=5,h="h"):e.substr(a,5).toUpperCase()==="/"?(c!=null&&(p.v=c.H>=12?"":""),p.t="T",a+=5,h="h"):(p.t="t",++a),c==null&&p.t==="T")return"";i[i.length]=p,l=o;break;case"[":for(s=o;e.charAt(a++)!=="]"&&a<e.length;)s+=e.charAt(a);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(vT)){if(c==null&&(c=Us(t,r),c==null))return"";i[i.length]={t:"Z",v:s.toLowerCase()},l=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",Lo(e)||(i[i.length]={t:"t",v:s}));break;case".":if(c!=null){for(s=o;++a<e.length&&(o=e.charAt(a))==="0";)s+=o;i[i.length]={t:"s",v:s};break}case"0":case"#":for(s=o;++a<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(a))>-1;)s+=o;i[i.length]={t:"n",v:s};break;case"?":for(s=o;e.charAt(++a)===o;)s+=o;i[i.length]={t:o,v:s},l=o;break;case"*":++a,(e.charAt(a)==" "||e.charAt(a)=="*")&&++a;break;case"(":case")":i[i.length]={t:n===1?"t":o,v:o},++a;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=o;a<e.length&&"0123456789".indexOf(e.charAt(++a))>-1;)s+=e.charAt(a);i[i.length]={t:"D",v:s};break;case" ":i[i.length]={t:o,v:o},++a;break;case"$":i[i.length]={t:"t",v:"$"},++a;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);i[i.length]={t:"t",v:o},++a;break}var g=0,x=0,_;for(a=i.length-1,l="t";a>=0;--a)switch(i[a].t){case"h":case"H":i[a].t=h,l="h",g<1&&(g=1);break;case"s":(_=i[a].v.match(/\.0+$/))&&(x=Math.max(x,_[0].length-1)),g<3&&(g=3);case"d":case"y":case"M":case"e":l=i[a].t;break;case"m":l==="s"&&(i[a].t="M",g<2&&(g=2));break;case"X":break;case"Z":g<1&&i[a].v.match(/[Hh]/)&&(g=1),g<2&&i[a].v.match(/[Mm]/)&&(g=2),g<3&&i[a].v.match(/[Ss]/)&&(g=3)}switch(g){case 0:break;case 1:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M),c.M>=60&&(c.M=0,++c.H);break;case 2:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M);break}var v="",E;for(a=0;a<i.length;++a)switch(i[a].t){case"t":case"T":case" ":case"D":break;case"X":i[a].v="",i[a].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[a].v=f6(i[a].t.charCodeAt(0),i[a].v,c,x),i[a].t="t";break;case"n":case"?":for(E=a+1;i[E]!=null&&((o=i[E].t)==="?"||o==="D"||(o===" "||o==="t")&&i[E+1]!=null&&(i[E+1].t==="?"||i[E+1].t==="t"&&i[E+1].v==="/")||i[a].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(i[E].v==="/"||i[E].v===" "&&i[E+1]!=null&&i[E+1].t=="?"));)i[a].v+=i[E].v,i[E]={v:"",t:";"},++E;v+=i[a].v,a=E-1;break;case"G":i[a].t="t",i[a].v=ia(t,r);break}var N="",I,w;if(v.length>0){v.charCodeAt(0)==40?(I=t<0&&v.charCodeAt(0)===45?-t:t,w=di("n",v,I)):(I=t<0&&n>1?-t:t,w=di("n",v,I),I<0&&i[0]&&i[0].t=="t"&&(w=w.substr(1),i[0].v="-"+i[0].v)),E=w.length-1;var O=i.length;for(a=0;a<i.length;++a)if(i[a]!=null&&i[a].t!="t"&&i[a].v.indexOf(".")>-1){O=a;break}var P=i.length;if(O===i.length&&w.indexOf("E")===-1){for(a=i.length-1;a>=0;--a)i[a]==null||"n?".indexOf(i[a].t)===-1||(E>=i[a].v.length-1?(E-=i[a].v.length,i[a].v=w.substr(E+1,i[a].v.length)):E<0?i[a].v="":(i[a].v=w.substr(0,E+1),E=-1),i[a].t="t",P=a);E>=0&&P<i.length&&(i[P].v=w.substr(0,E+1)+i[P].v)}else if(O!==i.length&&w.indexOf("E")===-1){for(E=w.indexOf(".")-1,a=O;a>=0;--a)if(!(i[a]==null||"n?".indexOf(i[a].t)===-1)){for(u=i[a].v.indexOf(".")>-1&&a===O?i[a].v.indexOf(".")-1:i[a].v.length-1,N=i[a].v.substr(u+1);u>=0;--u)E>=0&&(i[a].v.charAt(u)==="0"||i[a].v.charAt(u)==="#")&&(N=w.charAt(E--)+N);i[a].v=N,i[a].t="t",P=a}for(E>=0&&P<i.length&&(i[P].v=w.substr(0,E+1)+i[P].v),E=w.indexOf(".")+1,a=O;a<i.length;++a)if(!(i[a]==null||"n?(".indexOf(i[a].t)===-1&&a!==O)){for(u=i[a].v.indexOf(".")>-1&&a===O?i[a].v.indexOf(".")+1:0,N=i[a].v.substr(0,u);u<i[a].v.length;++u)E<w.length&&(N+=w.charAt(E++));i[a].v=N,i[a].t="t",P=a}}}for(a=0;a<i.length;++a)i[a]!=null&&"n?".indexOf(i[a].t)>-1&&(I=n>1&&t<0&&a>0&&i[a-1].v==="-"?-t:t,i[a].v=di(i[a].t,i[a].v,I),i[a].t="t");var W="";for(a=0;a!==i.length;++a)i[a]!=null&&(W+=i[a].v);return W}var y_=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function w_(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function E6(e,t){var r=y6(e),n=r.length,i=r[n-1].indexOf("@");if(n<4&&i>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||i>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=i>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=i>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=i>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var s=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,s];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var a=r[0].match(y_),o=r[1].match(y_);return w_(t,a)?[n,r[0]]:w_(t,o)?[n,r[1]]:[n,r[a!=null&&o!=null?2:1]]}return[n,s]}function hn(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:Ee)[e],n==null&&(n=r.table&&r.table[v_[e]]||Ee[v_[e]]),n==null&&(n=i6[e]||"General");break}if(Zf(n,0))return ia(t,r);t instanceof Date&&(t=cT(t,r.date1904));var i=E6(n,t);if(Zf(i[1]))return ia(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return w6(i[1],t,r,i[0])}function pi(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(Ee[r]==null){t<0&&(t=r);continue}if(Ee[r]==e){t=r;break}}t<0&&(t=391)}return Ee[t]=e,t}function X0(e){for(var t=0;t!=392;++t)e[t]!==void 0&&pi(e[t],t)}function Mo(){Ee=n6()}var k6={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},xT=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function T6(e){var t=typeof e=="number"?Ee[e]:e;return t=t.replace(xT,"(\\d+)"),new RegExp("^"+t+"$")}function S6(e,t,r){var n=-1,i=-1,s=-1,a=-1,o=-1,l=-1;(t.match(xT)||[]).forEach(function(f,h){var d=parseInt(r[h+1],10);switch(f.toLowerCase().charAt(0)){case"y":n=d;break;case"d":s=d;break;case"h":a=d;break;case"s":l=d;break;case"m":a>=0?o=d:i=d;break}}),l>=0&&o==-1&&i>=0&&(o=i,i=-1);var c=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);c.length==7&&(c="0"+c),c.length==8&&(c="20"+c);var u=("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return a==-1&&o==-1&&l==-1?c:n==-1&&i==-1&&s==-1?u:c+"T"+u}var C6=function(){var e={};e.version="1.2.0";function t(){for(var w=0,O=new Array(256),P=0;P!=256;++P)w=P,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,O[P]=w;return typeof Int32Array<"u"?new Int32Array(O):O}var r=t();function n(w){var O=0,P=0,W=0,j=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(W=0;W!=256;++W)j[W]=w[W];for(W=0;W!=256;++W)for(P=w[W],O=256+W;O<4096;O+=256)P=j[O]=P>>>8^w[P&255];var U=[];for(W=1;W!=16;++W)U[W-1]=typeof Int32Array<"u"?j.subarray(W*256,W*256+256):j.slice(W*256,W*256+256);return U}var i=n(r),s=i[0],a=i[1],o=i[2],l=i[3],c=i[4],u=i[5],f=i[6],h=i[7],d=i[8],m=i[9],p=i[10],g=i[11],x=i[12],_=i[13],v=i[14];function E(w,O){for(var P=O^-1,W=0,j=w.length;W<j;)P=P>>>8^r[(P^w.charCodeAt(W++))&255];return~P}function N(w,O){for(var P=O^-1,W=w.length-15,j=0;j<W;)P=v[w[j++]^P&255]^_[w[j++]^P>>8&255]^x[w[j++]^P>>16&255]^g[w[j++]^P>>>24]^p[w[j++]]^m[w[j++]]^d[w[j++]]^h[w[j++]]^f[w[j++]]^u[w[j++]]^c[w[j++]]^l[w[j++]]^o[w[j++]]^a[w[j++]]^s[w[j++]]^r[w[j++]];for(W+=15;j<W;)P=P>>>8^r[(P^w[j++])&255];return~P}function I(w,O){for(var P=O^-1,W=0,j=w.length,U=0,J=0;W<j;)U=w.charCodeAt(W++),U<128?P=P>>>8^r[(P^U)&255]:U<2048?(P=P>>>8^r[(P^(192|U>>6&31))&255],P=P>>>8^r[(P^(128|U&63))&255]):U>=55296&&U<57344?(U=(U&1023)+64,J=w.charCodeAt(W++)&1023,P=P>>>8^r[(P^(240|U>>8&7))&255],P=P>>>8^r[(P^(128|U>>2&63))&255],P=P>>>8^r[(P^(128|J>>6&15|(U&3)<<4))&255],P=P>>>8^r[(P^(128|J&63))&255]):(P=P>>>8^r[(P^(224|U>>12&15))&255],P=P>>>8^r[(P^(128|U>>6&63))&255],P=P>>>8^r[(P^(128|U&63))&255]);return~P}return e.table=r,e.bstr=E,e.buf=N,e.str=I,e}(),we=function(){var t={};t.version="1.2.1";function r(y,S){for(var k=y.split("/"),T=S.split("/"),C=0,F=0,H=Math.min(k.length,T.length);C<H;++C){if(F=k[C].length-T[C].length)return F;if(k[C]!=T[C])return k[C]<T[C]?-1:1}return k.length-T.length}function n(y){if(y.charAt(y.length-1)=="/")return y.slice(0,-1).indexOf("/")===-1?y:n(y.slice(0,-1));var S=y.lastIndexOf("/");return S===-1?y:y.slice(0,S+1)}function i(y){if(y.charAt(y.length-1)=="/")return i(y.slice(0,-1));var S=y.lastIndexOf("/");return S===-1?y:y.slice(S+1)}function s(y,S){typeof S=="string"&&(S=new Date(S));var k=S.getHours();k=k<<6|S.getMinutes(),k=k<<5|S.getSeconds()>>>1,y.write_shift(2,k);var T=S.getFullYear()-1980;T=T<<4|S.getMonth()+1,T=T<<5|S.getDate(),y.write_shift(2,T)}function a(y){var S=y.read_shift(2)&65535,k=y.read_shift(2)&65535,T=new Date,C=k&31;k>>>=5;var F=k&15;k>>>=4,T.setMilliseconds(0),T.setFullYear(k+1980),T.setMonth(F-1),T.setDate(C);var H=S&31;S>>>=5;var Y=S&63;return S>>>=6,T.setHours(S),T.setMinutes(Y),T.setSeconds(H<<1),T}function o(y){Yt(y,0);for(var S={},k=0;y.l<=y.length-4;){var T=y.read_shift(2),C=y.read_shift(2),F=y.l+C,H={};switch(T){case 21589:k=y.read_shift(1),k&1&&(H.mtime=y.read_shift(4)),C>5&&(k&2&&(H.atime=y.read_shift(4)),k&4&&(H.ctime=y.read_shift(4))),H.mtime&&(H.mt=new Date(H.mtime*1e3));break}y.l=F,S[T]=H}return S}var l;function c(){return l||(l={})}function u(y,S){if(y[0]==80&&y[1]==75)return Cg(y,S);if((y[0]|32)==109&&(y[1]|32)==105)return TC(y,S);if(y.length<512)throw new Error("CFB file size "+y.length+" < 512");var k=3,T=512,C=0,F=0,H=0,Y=0,V=0,z=[],G=y.slice(0,512);Yt(G,0);var te=f(G);switch(k=te[0],k){case 3:T=512;break;case 4:T=4096;break;case 0:if(te[1]==0)return Cg(y,S);default:throw new Error("Major Version: Expected 3 or 4 saw "+k)}T!==512&&(G=y.slice(0,T),Yt(G,28));var he=y.slice(0,T);h(G,k);var _e=G.read_shift(4,"i");if(k===3&&_e!==0)throw new Error("# Directory Sectors: Expected 0 saw "+_e);G.l+=4,H=G.read_shift(4,"i"),G.l+=4,G.chk("00100000","Mini Stream Cutoff Size: "),Y=G.read_shift(4,"i"),C=G.read_shift(4,"i"),V=G.read_shift(4,"i"),F=G.read_shift(4,"i");for(var ae=-1,me=0;me<109&&(ae=G.read_shift(4,"i"),!(ae<0));++me)z[me]=ae;var Ie=d(y,T);g(V,F,Ie,T,z);var ct=_(Ie,H,z,T);ct[H].name="!Directory",C>0&&Y!==J&&(ct[Y].name="!MiniFAT"),ct[z[0]].name="!FAT",ct.fat_addrs=z,ct.ssz=T;var ut={},tr=[],jo=[],Ho=[];v(H,ct,Ie,tr,C,ut,jo,Y),m(jo,Ho,tr),tr.shift();var zo={FileIndex:jo,FullPaths:Ho};return S&&S.raw&&(zo.raw={header:he,sectors:Ie}),zo}function f(y){if(y[y.l]==80&&y[y.l+1]==75)return[0,0];y.chk(ge,"Header Signature: "),y.l+=16;var S=y.read_shift(2,"u");return[y.read_shift(2,"u"),S]}function h(y,S){var k=9;switch(y.l+=2,k=y.read_shift(2)){case 9:if(S!=3)throw new Error("Sector Shift: Expected 9 saw "+k);break;case 12:if(S!=4)throw new Error("Sector Shift: Expected 12 saw "+k);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+k)}y.chk("0600","Mini Sector Shift: "),y.chk("000000000000","Reserved: ")}function d(y,S){for(var k=Math.ceil(y.length/S)-1,T=[],C=1;C<k;++C)T[C-1]=y.slice(C*S,(C+1)*S);return T[k-1]=y.slice(k*S),T}function m(y,S,k){for(var T=0,C=0,F=0,H=0,Y=0,V=k.length,z=[],G=[];T<V;++T)z[T]=G[T]=T,S[T]=k[T];for(;Y<G.length;++Y)T=G[Y],C=y[T].L,F=y[T].R,H=y[T].C,z[T]===T&&(C!==-1&&z[C]!==C&&(z[T]=z[C]),F!==-1&&z[F]!==F&&(z[T]=z[F])),H!==-1&&(z[H]=T),C!==-1&&T!=z[T]&&(z[C]=z[T],G.lastIndexOf(C)<Y&&G.push(C)),F!==-1&&T!=z[T]&&(z[F]=z[T],G.lastIndexOf(F)<Y&&G.push(F));for(T=1;T<V;++T)z[T]===T&&(F!==-1&&z[F]!==F?z[T]=z[F]:C!==-1&&z[C]!==C&&(z[T]=z[C]));for(T=1;T<V;++T)if(y[T].type!==0){if(Y=T,Y!=z[Y])do Y=z[Y],S[T]=S[Y]+"/"+S[T];while(Y!==0&&z[Y]!==-1&&Y!=z[Y]);z[T]=-1}for(S[0]+="/",T=1;T<V;++T)y[T].type!==2&&(S[T]+="/")}function p(y,S,k){for(var T=y.start,C=y.size,F=[],H=T;k&&C>0&&H>=0;)F.push(S.slice(H*U,H*U+U)),C-=U,H=Ds(k,H*4);return F.length===0?X(0):zt(F).slice(0,y.size)}function g(y,S,k,T,C){var F=J;if(y===J){if(S!==0)throw new Error("DIFAT chain shorter than expected")}else if(y!==-1){var H=k[y],Y=(T>>>2)-1;if(!H)return;for(var V=0;V<Y&&(F=Ds(H,V*4))!==J;++V)C.push(F);g(Ds(H,T-4),S-1,k,T,C)}}function x(y,S,k,T,C){var F=[],H=[];C||(C=[]);var Y=T-1,V=0,z=0;for(V=S;V>=0;){C[V]=!0,F[F.length]=V,H.push(y[V]);var G=k[Math.floor(V*4/T)];if(z=V*4&Y,T<4+z)throw new Error("FAT boundary crossed: "+V+" 4 "+T);if(!y[G])break;V=Ds(y[G],z)}return{nodes:F,data:O_([H])}}function _(y,S,k,T){var C=y.length,F=[],H=[],Y=[],V=[],z=T-1,G=0,te=0,he=0,_e=0;for(G=0;G<C;++G)if(Y=[],he=G+S,he>=C&&(he-=C),!H[he]){V=[];var ae=[];for(te=he;te>=0;){ae[te]=!0,H[te]=!0,Y[Y.length]=te,V.push(y[te]);var me=k[Math.floor(te*4/T)];if(_e=te*4&z,T<4+_e)throw new Error("FAT boundary crossed: "+te+" 4 "+T);if(!y[me]||(te=Ds(y[me],_e),ae[te]))break}F[he]={nodes:Y,data:O_([V])}}return F}function v(y,S,k,T,C,F,H,Y){for(var V=0,z=T.length?2:0,G=S[y].data,te=0,he=0,_e;te<G.length;te+=128){var ae=G.slice(te,te+128);Yt(ae,64),he=ae.read_shift(2),_e=X1(ae,0,he-z),T.push(_e);var me={name:_e,type:ae.read_shift(1),color:ae.read_shift(1),L:ae.read_shift(4,"i"),R:ae.read_shift(4,"i"),C:ae.read_shift(4,"i"),clsid:ae.read_shift(16),state:ae.read_shift(4,"i"),start:0,size:0},Ie=ae.read_shift(2)+ae.read_shift(2)+ae.read_shift(2)+ae.read_shift(2);Ie!==0&&(me.ct=E(ae,ae.l-8));var ct=ae.read_shift(2)+ae.read_shift(2)+ae.read_shift(2)+ae.read_shift(2);ct!==0&&(me.mt=E(ae,ae.l-8)),me.start=ae.read_shift(4,"i"),me.size=ae.read_shift(4,"i"),me.size<0&&me.start<0&&(me.size=me.type=0,me.start=J,me.name=""),me.type===5?(V=me.start,C>0&&V!==J&&(S[V].name="!StreamData")):me.size>=4096?(me.storage="fat",S[me.start]===void 0&&(S[me.start]=x(k,me.start,S.fat_addrs,S.ssz)),S[me.start].name=me.name,me.content=S[me.start].data.slice(0,me.size)):(me.storage="minifat",me.size<0?me.size=0:V!==J&&me.start!==J&&S[V]&&(me.content=p(me,S[V].data,(S[Y]||{}).data))),me.content&&Yt(me.content,0),F[_e]=me,H.push(me)}}function E(y,S){return new Date((Br(y,S+4)/1e7*Math.pow(2,32)+Br(y,S)/1e7-11644473600)*1e3)}function N(y,S){return c(),u(l.readFileSync(y),S)}function I(y,S){var k=S&&S.type;switch(k||Re&&Buffer.isBuffer(y)&&(k="buffer"),k||"base64"){case"file":return N(y,S);case"base64":return u(Ur($r(y)),S);case"binary":return u(Ur(y),S)}return u(y,S)}function w(y,S){var k=S||{},T=k.root||"Root Entry";if(y.FullPaths||(y.FullPaths=[]),y.FileIndex||(y.FileIndex=[]),y.FullPaths.length!==y.FileIndex.length)throw new Error("inconsistent CFB structure");y.FullPaths.length===0&&(y.FullPaths[0]=T+"/",y.FileIndex[0]={name:T,type:5}),k.CLSID&&(y.FileIndex[0].clsid=k.CLSID),O(y)}function O(y){var S="Sh33tJ5";if(!we.find(y,"/"+S)){var k=X(4);k[0]=55,k[1]=k[3]=50,k[2]=54,y.FileIndex.push({name:S,type:2,content:k,size:4,L:69,R:69,C:69}),y.FullPaths.push(y.FullPaths[0]+S),P(y)}}function P(y,S){w(y);for(var k=!1,T=!1,C=y.FullPaths.length-1;C>=0;--C){var F=y.FileIndex[C];switch(F.type){case 0:T?k=!0:(y.FileIndex.pop(),y.FullPaths.pop());break;case 1:case 2:case 5:T=!0,isNaN(F.R*F.L*F.C)&&(k=!0),F.R>-1&&F.L>-1&&F.R==F.L&&(k=!0);break;default:k=!0;break}}if(!(!k&&!S)){var H=new Date(1987,1,19),Y=0,V=Object.create?Object.create(null):{},z=[];for(C=0;C<y.FullPaths.length;++C)V[y.FullPaths[C]]=!0,y.FileIndex[C].type!==0&&z.push([y.FullPaths[C],y.FileIndex[C]]);for(C=0;C<z.length;++C){var G=n(z[C][0]);T=V[G],T||(z.push([G,{name:i(G).replace("/",""),type:1,clsid:ve,ct:H,mt:H,content:null}]),V[G]=!0)}for(z.sort(function(_e,ae){return r(_e[0],ae[0])}),y.FullPaths=[],y.FileIndex=[],C=0;C<z.length;++C)y.FullPaths[C]=z[C][0],y.FileIndex[C]=z[C][1];for(C=0;C<z.length;++C){var te=y.FileIndex[C],he=y.FullPaths[C];if(te.name=i(he).replace("/",""),te.L=te.R=te.C=-(te.color=1),te.size=te.content?te.content.length:0,te.start=0,te.clsid=te.clsid||ve,C===0)te.C=z.length>1?1:-1,te.size=0,te.type=5;else if(he.slice(-1)=="/"){for(Y=C+1;Y<z.length&&n(y.FullPaths[Y])!=he;++Y);for(te.C=Y>=z.length?-1:Y,Y=C+1;Y<z.length&&n(y.FullPaths[Y])!=n(he);++Y);te.R=Y>=z.length?-1:Y,te.type=1}else n(y.FullPaths[C+1]||"")==n(he)&&(te.R=C+1),te.type=2}}}function W(y,S){var k=S||{};if(k.fileType=="mad")return SC(y,k);switch(P(y),k.fileType){case"zip":return xC(y,k)}var T=function(_e){for(var ae=0,me=0,Ie=0;Ie<_e.FileIndex.length;++Ie){var ct=_e.FileIndex[Ie];if(ct.content){var ut=ct.content.length;ut>0&&(ut<4096?ae+=ut+63>>6:me+=ut+511>>9)}}for(var tr=_e.FullPaths.length+3>>2,jo=ae+7>>3,Ho=ae+127>>7,zo=jo+me+tr+Ho,Fs=zo+127>>7,nh=Fs<=109?0:Math.ceil((Fs-109)/127);zo+Fs+nh+127>>7>Fs;)nh=++Fs<=109?0:Math.ceil((Fs-109)/127);var Zn=[1,nh,Fs,Ho,tr,me,ae,0];return _e.FileIndex[0].size=ae<<6,Zn[7]=(_e.FileIndex[0].start=Zn[0]+Zn[1]+Zn[2]+Zn[3]+Zn[4]+Zn[5])+(Zn[6]+7>>3),Zn}(y),C=X(T[7]<<9),F=0,H=0;{for(F=0;F<8;++F)C.write_shift(1,fe[F]);for(F=0;F<8;++F)C.write_shift(2,0);for(C.write_shift(2,62),C.write_shift(2,3),C.write_shift(2,65534),C.write_shift(2,9),C.write_shift(2,6),F=0;F<3;++F)C.write_shift(2,0);for(C.write_shift(4,0),C.write_shift(4,T[2]),C.write_shift(4,T[0]+T[1]+T[2]+T[3]-1),C.write_shift(4,0),C.write_shift(4,4096),C.write_shift(4,T[3]?T[0]+T[1]+T[2]-1:J),C.write_shift(4,T[3]),C.write_shift(-4,T[1]?T[0]-1:J),C.write_shift(4,T[1]),F=0;F<109;++F)C.write_shift(-4,F<T[2]?T[1]+F:-1)}if(T[1])for(H=0;H<T[1];++H){for(;F<236+H*127;++F)C.write_shift(-4,F<T[2]?T[1]+F:-1);C.write_shift(-4,H===T[1]-1?J:H+1)}var Y=function(_e){for(H+=_e;F<H-1;++F)C.write_shift(-4,F+1);_e&&(++F,C.write_shift(-4,J))};for(H=F=0,H+=T[1];F<H;++F)C.write_shift(-4,de.DIFSECT);for(H+=T[2];F<H;++F)C.write_shift(-4,de.FATSECT);Y(T[3]),Y(T[4]);for(var V=0,z=0,G=y.FileIndex[0];V<y.FileIndex.length;++V)G=y.FileIndex[V],G.content&&(z=G.content.length,!(z<4096)&&(G.start=H,Y(z+511>>9)));for(Y(T[6]+7>>3);C.l&511;)C.write_shift(-4,de.ENDOFCHAIN);for(H=F=0,V=0;V<y.FileIndex.length;++V)G=y.FileIndex[V],G.content&&(z=G.content.length,!(!z||z>=4096)&&(G.start=H,Y(z+63>>6)));for(;C.l&511;)C.write_shift(-4,de.ENDOFCHAIN);for(F=0;F<T[4]<<2;++F){var te=y.FullPaths[F];if(!te||te.length===0){for(V=0;V<17;++V)C.write_shift(4,0);for(V=0;V<3;++V)C.write_shift(4,-1);for(V=0;V<12;++V)C.write_shift(4,0);continue}G=y.FileIndex[F],F===0&&(G.start=G.size?G.start-1:J);var he=F===0&&k.root||G.name;if(z=2*(he.length+1),C.write_shift(64,he,"utf16le"),C.write_shift(2,z),C.write_shift(1,G.type),C.write_shift(1,G.color),C.write_shift(-4,G.L),C.write_shift(-4,G.R),C.write_shift(-4,G.C),G.clsid)C.write_shift(16,G.clsid,"hex");else for(V=0;V<4;++V)C.write_shift(4,0);C.write_shift(4,G.state||0),C.write_shift(4,0),C.write_shift(4,0),C.write_shift(4,0),C.write_shift(4,0),C.write_shift(4,G.start),C.write_shift(4,G.size),C.write_shift(4,0)}for(F=1;F<y.FileIndex.length;++F)if(G=y.FileIndex[F],G.size>=4096)if(C.l=G.start+1<<9,Re&&Buffer.isBuffer(G.content))G.content.copy(C,C.l,0,G.size),C.l+=G.size+511&-512;else{for(V=0;V<G.size;++V)C.write_shift(1,G.content[V]);for(;V&511;++V)C.write_shift(1,0)}for(F=1;F<y.FileIndex.length;++F)if(G=y.FileIndex[F],G.size>0&&G.size<4096)if(Re&&Buffer.isBuffer(G.content))G.content.copy(C,C.l,0,G.size),C.l+=G.size+63&-64;else{for(V=0;V<G.size;++V)C.write_shift(1,G.content[V]);for(;V&63;++V)C.write_shift(1,0)}if(Re)C.l=C.length;else for(;C.l<C.length;)C.write_shift(1,0);return C}function j(y,S){var k=y.FullPaths.map(function(V){return V.toUpperCase()}),T=k.map(function(V){var z=V.split("/");return z[z.length-(V.slice(-1)=="/"?2:1)]}),C=!1;S.charCodeAt(0)===47?(C=!0,S=k[0].slice(0,-1)+S):C=S.indexOf("/")!==-1;var F=S.toUpperCase(),H=C===!0?k.indexOf(F):T.indexOf(F);if(H!==-1)return y.FileIndex[H];var Y=!F.match(fl);for(F=F.replace(wr,""),Y&&(F=F.replace(fl,"!")),H=0;H<k.length;++H)if((Y?k[H].replace(fl,"!"):k[H]).replace(wr,"")==F||(Y?T[H].replace(fl,"!"):T[H]).replace(wr,"")==F)return y.FileIndex[H];return null}var U=64,J=-2,ge="d0cf11e0a1b11ae1",fe=[208,207,17,224,161,177,26,225],ve="00000000000000000000000000000000",de={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:J,FREESECT:-1,HEADER_SIGNATURE:ge,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:ve,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function ee(y,S,k){c();var T=W(y,k);l.writeFileSync(S,T)}function M(y){for(var S=new Array(y.length),k=0;k<y.length;++k)S[k]=String.fromCharCode(y[k]);return S.join("")}function se(y,S){var k=W(y,S);switch(S&&S.type||"buffer"){case"file":return c(),l.writeFileSync(S.filename,k),k;case"binary":return typeof k=="string"?k:M(k);case"base64":return hc(typeof k=="string"?k:M(k));case"buffer":if(Re)return Buffer.isBuffer(k)?k:Ii(k);case"array":return typeof k=="string"?Ur(k):k}return k}var xe;function A(y){try{var S=y.InflateRaw,k=new S;if(k._processChunk(new Uint8Array([3,0]),k._finishFlushFlag),k.bytesRead)xe=y;else throw new Error("zlib does not expose bytesRead")}catch(T){console.error("cannot use native zlib: "+(T.message||T))}}function B(y,S){if(!xe)return Tg(y,S);var k=xe.InflateRaw,T=new k,C=T._processChunk(y.slice(y.l),T._finishFlushFlag);return y.l+=T.bytesRead,C}function D(y){return xe?xe.deflateRawSync(y):Pe(y)}var b=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],K=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],ie=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function le(y){var S=(y<<1|y<<11)&139536|(y<<5|y<<15)&558144;return(S>>16|S>>8|S)&255}for(var ne=typeof Uint8Array<"u",Z=ne?new Uint8Array(256):[],Ne=0;Ne<256;++Ne)Z[Ne]=le(Ne);function R(y,S){var k=Z[y&255];return S<=8?k>>>8-S:(k=k<<8|Z[y>>8&255],S<=16?k>>>16-S:(k=k<<8|Z[y>>16&255],k>>>24-S))}function rt(y,S){var k=S&7,T=S>>>3;return(y[T]|(k<=6?0:y[T+1]<<8))>>>k&3}function Ue(y,S){var k=S&7,T=S>>>3;return(y[T]|(k<=5?0:y[T+1]<<8))>>>k&7}function Je(y,S){var k=S&7,T=S>>>3;return(y[T]|(k<=4?0:y[T+1]<<8))>>>k&15}function Le(y,S){var k=S&7,T=S>>>3;return(y[T]|(k<=3?0:y[T+1]<<8))>>>k&31}function pe(y,S){var k=S&7,T=S>>>3;return(y[T]|(k<=1?0:y[T+1]<<8))>>>k&127}function Et(y,S,k){var T=S&7,C=S>>>3,F=(1<<k)-1,H=y[C]>>>T;return k<8-T||(H|=y[C+1]<<8-T,k<16-T)||(H|=y[C+2]<<16-T,k<24-T)||(H|=y[C+3]<<24-T),H&F}function Yr(y,S,k){var T=S&7,C=S>>>3;return T<=5?y[C]|=(k&7)<<T:(y[C]|=k<<T&255,y[C+1]=(k&7)>>8-T),S+3}function Pn(y,S,k){var T=S&7,C=S>>>3;return k=(k&1)<<T,y[C]|=k,S+1}function Qn(y,S,k){var T=S&7,C=S>>>3;return k<<=T,y[C]|=k&255,k>>>=8,y[C+1]=k,S+8}function Wo(y,S,k){var T=S&7,C=S>>>3;return k<<=T,y[C]|=k&255,k>>>=8,y[C+1]=k&255,y[C+2]=k>>>8,S+16}function Ni(y,S){var k=y.length,T=2*k>S?2*k:S+5,C=0;if(k>=S)return y;if(Re){var F=p_(T);if(y.copy)y.copy(F);else for(;C<y.length;++C)F[C]=y[C];return F}else if(ne){var H=new Uint8Array(T);if(H.set)H.set(y);else for(;C<k;++C)H[C]=y[C];return H}return y.length=T,y}function br(y){for(var S=new Array(y),k=0;k<y;++k)S[k]=0;return S}function Jn(y,S,k){var T=1,C=0,F=0,H=0,Y=0,V=y.length,z=ne?new Uint16Array(32):br(32);for(F=0;F<32;++F)z[F]=0;for(F=V;F<k;++F)y[F]=0;V=y.length;var G=ne?new Uint16Array(V):br(V);for(F=0;F<V;++F)z[C=y[F]]++,T<C&&(T=C),G[F]=0;for(z[0]=0,F=1;F<=T;++F)z[F+16]=Y=Y+z[F-1]<<1;for(F=0;F<V;++F)Y=y[F],Y!=0&&(G[F]=z[Y+16]++);var te=0;for(F=0;F<V;++F)if(te=y[F],te!=0)for(Y=R(G[F],T)>>T-te,H=(1<<T+4-te)-1;H>=0;--H)S[Y|H<<te]=te&15|F<<4;return T}var Ri=ne?new Uint16Array(512):br(512),Vo=ne?new Uint16Array(32):br(32);if(!ne){for(var mr=0;mr<512;++mr)Ri[mr]=0;for(mr=0;mr<32;++mr)Vo[mr]=0}(function(){for(var y=[],S=0;S<32;S++)y.push(5);Jn(y,Vo,32);var k=[];for(S=0;S<=143;S++)k.push(8);for(;S<=255;S++)k.push(9);for(;S<=279;S++)k.push(7);for(;S<=287;S++)k.push(8);Jn(k,Ri,288)})();var On=function(){for(var S=ne?new Uint8Array(32768):[],k=0,T=0;k<ie.length-1;++k)for(;T<ie[k+1];++T)S[T]=k;for(;T<32768;++T)S[T]=29;var C=ne?new Uint8Array(259):[];for(k=0,T=0;k<K.length-1;++k)for(;T<K[k+1];++T)C[T]=k;function F(Y,V){for(var z=0;z<Y.length;){var G=Math.min(65535,Y.length-z),te=z+G==Y.length;for(V.write_shift(1,+te),V.write_shift(2,G),V.write_shift(2,~G&65535);G-- >0;)V[V.l++]=Y[z++]}return V.l}function H(Y,V){for(var z=0,G=0,te=ne?new Uint16Array(32768):[];G<Y.length;){var he=Math.min(65535,Y.length-G);if(he<10){for(z=Yr(V,z,+(G+he==Y.length)),z&7&&(z+=8-(z&7)),V.l=z/8|0,V.write_shift(2,he),V.write_shift(2,~he&65535);he-- >0;)V[V.l++]=Y[G++];z=V.l*8;continue}z=Yr(V,z,+(G+he==Y.length)+2);for(var _e=0;he-- >0;){var ae=Y[G];_e=(_e<<5^ae)&32767;var me=-1,Ie=0;if((me=te[_e])&&(me|=G&-32768,me>G&&(me-=32768),me<G))for(;Y[me+Ie]==Y[G+Ie]&&Ie<250;)++Ie;if(Ie>2){ae=C[Ie],ae<=22?z=Qn(V,z,Z[ae+1]>>1)-1:(Qn(V,z,3),z+=5,Qn(V,z,Z[ae-23]>>5),z+=3);var ct=ae<8?0:ae-4>>2;ct>0&&(Wo(V,z,Ie-K[ae]),z+=ct),ae=S[G-me],z=Qn(V,z,Z[ae]>>3),z-=3;var ut=ae<4?0:ae-2>>1;ut>0&&(Wo(V,z,G-me-ie[ae]),z+=ut);for(var tr=0;tr<Ie;++tr)te[_e]=G&32767,_e=(_e<<5^Y[G])&32767,++G;he-=Ie-1}else ae<=143?ae=ae+48:z=Pn(V,z,1),z=Qn(V,z,Z[ae]),te[_e]=G&32767,++G}z=Qn(V,z,0)-1}return V.l=(z+7)/8|0,V.l}return function(V,z){return V.length<8?F(V,z):H(V,z)}}();function Pe(y){var S=X(50+Math.floor(y.length*1.1)),k=On(y,S);return S.slice(0,k)}var kt=ne?new Uint16Array(32768):br(32768),qr=ne?new Uint16Array(32768):br(32768),Ot=ne?new Uint16Array(128):br(128),As=1,kg=1;function mC(y,S){var k=Le(y,S)+257;S+=5;var T=Le(y,S)+1;S+=5;var C=Je(y,S)+4;S+=4;for(var F=0,H=ne?new Uint8Array(19):br(19),Y=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],V=1,z=ne?new Uint8Array(8):br(8),G=ne?new Uint8Array(8):br(8),te=H.length,he=0;he<C;++he)H[b[he]]=F=Ue(y,S),V<F&&(V=F),z[F]++,S+=3;var _e=0;for(z[0]=0,he=1;he<=V;++he)G[he]=_e=_e+z[he-1]<<1;for(he=0;he<te;++he)(_e=H[he])!=0&&(Y[he]=G[_e]++);var ae=0;for(he=0;he<te;++he)if(ae=H[he],ae!=0){_e=Z[Y[he]]>>8-ae;for(var me=(1<<7-ae)-1;me>=0;--me)Ot[_e|me<<ae]=ae&7|he<<3}var Ie=[];for(V=1;Ie.length<k+T;)switch(_e=Ot[pe(y,S)],S+=_e&7,_e>>>=3){case 16:for(F=3+rt(y,S),S+=2,_e=Ie[Ie.length-1];F-- >0;)Ie.push(_e);break;case 17:for(F=3+Ue(y,S),S+=3;F-- >0;)Ie.push(0);break;case 18:for(F=11+pe(y,S),S+=7;F-- >0;)Ie.push(0);break;default:Ie.push(_e),V<_e&&(V=_e);break}var ct=Ie.slice(0,k),ut=Ie.slice(k);for(he=k;he<286;++he)ct[he]=0;for(he=T;he<30;++he)ut[he]=0;return As=Jn(ct,kt,286),kg=Jn(ut,qr,30),S}function gC(y,S){if(y[0]==3&&!(y[1]&3))return[ms(S),2];for(var k=0,T=0,C=p_(S||1<<18),F=0,H=C.length>>>0,Y=0,V=0;!(T&1);){if(T=Ue(y,k),k+=3,T>>>1)T>>1==1?(Y=9,V=5):(k=mC(y,k),Y=As,V=kg);else{k&7&&(k+=8-(k&7));var z=y[k>>>3]|y[(k>>>3)+1]<<8;if(k+=32,z>0)for(!S&&H<F+z&&(C=Ni(C,F+z),H=C.length);z-- >0;)C[F++]=y[k>>>3],k+=8;continue}for(;;){!S&&H<F+32767&&(C=Ni(C,F+32767),H=C.length);var G=Et(y,k,Y),te=T>>>1==1?Ri[G]:kt[G];if(k+=te&15,te>>>=4,!(te>>>8&255))C[F++]=te;else{if(te==256)break;te-=257;var he=te<8?0:te-4>>2;he>5&&(he=0);var _e=F+K[te];he>0&&(_e+=Et(y,k,he),k+=he),G=Et(y,k,V),te=T>>>1==1?Vo[G]:qr[G],k+=te&15,te>>>=4;var ae=te<4?0:te-2>>1,me=ie[te];for(ae>0&&(me+=Et(y,k,ae),k+=ae),!S&&H<_e&&(C=Ni(C,_e+100),H=C.length);F<_e;)C[F]=C[F-me],++F}}}return S?[C,k+7>>>3]:[C.slice(0,F),k+7>>>3]}function Tg(y,S){var k=y.slice(y.l||0),T=gC(k,S);return y.l+=T[1],T[0]}function Sg(y,S){if(y)typeof console<"u"&&console.error(S);else throw new Error(S)}function Cg(y,S){var k=y;Yt(k,0);var T=[],C=[],F={FileIndex:T,FullPaths:C};w(F,{root:S.root});for(var H=k.length-4;(k[H]!=80||k[H+1]!=75||k[H+2]!=5||k[H+3]!=6)&&H>=0;)--H;k.l=H+4,k.l+=4;var Y=k.read_shift(2);k.l+=6;var V=k.read_shift(4);for(k.l=V,H=0;H<Y;++H){k.l+=20;var z=k.read_shift(4),G=k.read_shift(4),te=k.read_shift(2),he=k.read_shift(2),_e=k.read_shift(2);k.l+=8;var ae=k.read_shift(4),me=o(k.slice(k.l+te,k.l+te+he));k.l+=te+he+_e;var Ie=k.l;k.l=ae+4,vC(k,z,G,F,me),k.l=Ie}return F}function vC(y,S,k,T,C){y.l+=2;var F=y.read_shift(2),H=y.read_shift(2),Y=a(y);if(F&8257)throw new Error("Unsupported ZIP encryption");for(var V=y.read_shift(4),z=y.read_shift(4),G=y.read_shift(4),te=y.read_shift(2),he=y.read_shift(2),_e="",ae=0;ae<te;++ae)_e+=String.fromCharCode(y[y.l++]);if(he){var me=o(y.slice(y.l,y.l+he));(me[21589]||{}).mt&&(Y=me[21589].mt),((C||{})[21589]||{}).mt&&(Y=C[21589].mt)}y.l+=he;var Ie=y.slice(y.l,y.l+z);switch(H){case 8:Ie=B(y,G);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+H)}var ct=!1;F&8&&(V=y.read_shift(4),V==134695760&&(V=y.read_shift(4),ct=!0),z=y.read_shift(4),G=y.read_shift(4)),z!=S&&Sg(ct,"Bad compressed size: "+S+" != "+z),G!=k&&Sg(ct,"Bad uncompressed size: "+k+" != "+G),rh(T,_e,Ie,{unsafe:!0,mt:Y})}function xC(y,S){var k=S||{},T=[],C=[],F=X(1),H=k.compression?8:0,Y=0,V=0,z=0,G=0,te=0,he=y.FullPaths[0],_e=he,ae=y.FileIndex[0],me=[],Ie=0;for(V=1;V<y.FullPaths.length;++V)if(_e=y.FullPaths[V].slice(he.length),ae=y.FileIndex[V],!(!ae.size||!ae.content||_e=="Sh33tJ5")){var ct=G,ut=X(_e.length);for(z=0;z<_e.length;++z)ut.write_shift(1,_e.charCodeAt(z)&127);ut=ut.slice(0,ut.l),me[te]=C6.buf(ae.content,0);var tr=ae.content;H==8&&(tr=D(tr)),F=X(30),F.write_shift(4,67324752),F.write_shift(2,20),F.write_shift(2,Y),F.write_shift(2,H),ae.mt?s(F,ae.mt):F.write_shift(4,0),F.write_shift(-4,me[te]),F.write_shift(4,tr.length),F.write_shift(4,ae.content.length),F.write_shift(2,ut.length),F.write_shift(2,0),G+=F.length,T.push(F),G+=ut.length,T.push(ut),G+=tr.length,T.push(tr),F=X(46),F.write_shift(4,33639248),F.write_shift(2,0),F.write_shift(2,20),F.write_shift(2,Y),F.write_shift(2,H),F.write_shift(4,0),F.write_shift(-4,me[te]),F.write_shift(4,tr.length),F.write_shift(4,ae.content.length),F.write_shift(2,ut.length),F.write_shift(2,0),F.write_shift(2,0),F.write_shift(2,0),F.write_shift(2,0),F.write_shift(4,0),F.write_shift(4,ct),Ie+=F.l,C.push(F),Ie+=ut.length,C.push(ut),++te}return F=X(22),F.write_shift(4,101010256),F.write_shift(2,0),F.write_shift(2,0),F.write_shift(2,te),F.write_shift(2,te),F.write_shift(4,Ie),F.write_shift(4,G),F.write_shift(2,0),zt([zt(T),zt(C),F])}var qc={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function _C(y,S){if(y.ctype)return y.ctype;var k=y.name||"",T=k.match(/\.([^\.]+)$/);return T&&qc[T[1]]||S&&(T=(k=S).match(/[\.\\]([^\.\\])+$/),T&&qc[T[1]])?qc[T[1]]:"application/octet-stream"}function yC(y){for(var S=hc(y),k=[],T=0;T<S.length;T+=76)k.push(S.slice(T,T+76));return k.join(`\r
`)+`\r
`}function wC(y){var S=y.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(z){var G=z.charCodeAt(0).toString(16).toUpperCase();return"="+(G.length==1?"0"+G:G)});S=S.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),S.charAt(0)==`
`&&(S="=0D"+S.slice(1)),S=S.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var k=[],T=S.split(`\r
`),C=0;C<T.length;++C){var F=T[C];if(F.length==0){k.push("");continue}for(var H=0;H<F.length;){var Y=76,V=F.slice(H,H+Y);V.charAt(Y-1)=="="?Y--:V.charAt(Y-2)=="="?Y-=2:V.charAt(Y-3)=="="&&(Y-=3),V=F.slice(H,H+Y),H+=Y,H<F.length&&(V+="="),k.push(V)}}return k.join(`\r
`)}function EC(y){for(var S=[],k=0;k<y.length;++k){for(var T=y[k];k<=y.length&&T.charAt(T.length-1)=="=";)T=T.slice(0,T.length-1)+y[++k];S.push(T)}for(var C=0;C<S.length;++C)S[C]=S[C].replace(/[=][0-9A-Fa-f]{2}/g,function(F){return String.fromCharCode(parseInt(F.slice(1),16))});return Ur(S.join(`\r
`))}function kC(y,S,k){for(var T="",C="",F="",H,Y=0;Y<10;++Y){var V=S[Y];if(!V||V.match(/^\s*$/))break;var z=V.match(/^(.*?):\s*([^\s].*)$/);if(z)switch(z[1].toLowerCase()){case"content-location":T=z[2].trim();break;case"content-type":F=z[2].trim();break;case"content-transfer-encoding":C=z[2].trim();break}}switch(++Y,C.toLowerCase()){case"base64":H=Ur($r(S.slice(Y).join("")));break;case"quoted-printable":H=EC(S.slice(Y));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+C)}var G=rh(y,T.slice(k.length),H,{unsafe:!0});F&&(G.ctype=F)}function TC(y,S){if(M(y.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var k=S&&S.root||"",T=(Re&&Buffer.isBuffer(y)?y.toString("binary"):M(y)).split(`\r
`),C=0,F="";for(C=0;C<T.length;++C)if(F=T[C],!!/^Content-Location:/i.test(F)&&(F=F.slice(F.indexOf("file")),k||(k=F.slice(0,F.lastIndexOf("/")+1)),F.slice(0,k.length)!=k))for(;k.length>0&&(k=k.slice(0,k.length-1),k=k.slice(0,k.lastIndexOf("/")+1),F.slice(0,k.length)!=k););var H=(T[1]||"").match(/boundary="(.*?)"/);if(!H)throw new Error("MAD cannot find boundary");var Y="--"+(H[1]||""),V=[],z=[],G={FileIndex:V,FullPaths:z};w(G);var te,he=0;for(C=0;C<T.length;++C){var _e=T[C];_e!==Y&&_e!==Y+"--"||(he++&&kC(G,T.slice(te,C),k),te=C)}return G}function SC(y,S){var k=S||{},T=k.boundary||"SheetJS";T="------="+T;for(var C=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+T.slice(2)+'"',"","",""],F=y.FullPaths[0],H=F,Y=y.FileIndex[0],V=1;V<y.FullPaths.length;++V)if(H=y.FullPaths[V].slice(F.length),Y=y.FileIndex[V],!(!Y.size||!Y.content||H=="Sh33tJ5")){H=H.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Ie){return"_x"+Ie.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Ie){return"_u"+Ie.charCodeAt(0).toString(16)+"_"});for(var z=Y.content,G=Re&&Buffer.isBuffer(z)?z.toString("binary"):M(z),te=0,he=Math.min(1024,G.length),_e=0,ae=0;ae<=he;++ae)(_e=G.charCodeAt(ae))>=32&&_e<128&&++te;var me=te>=he*4/5;C.push(T),C.push("Content-Location: "+(k.root||"file:///C:/SheetJS/")+H),C.push("Content-Transfer-Encoding: "+(me?"quoted-printable":"base64")),C.push("Content-Type: "+_C(Y,H)),C.push(""),C.push(me?wC(G):yC(G))}return C.push(T+`--\r
`),C.join(`\r
`)}function CC(y){var S={};return w(S,y),S}function rh(y,S,k,T){var C=T&&T.unsafe;C||w(y);var F=!C&&we.find(y,S);if(!F){var H=y.FullPaths[0];S.slice(0,H.length)==H?H=S:(H.slice(-1)!="/"&&(H+="/"),H=(H+S).replace("//","/")),F={name:i(S),type:2},y.FileIndex.push(F),y.FullPaths.push(H),C||we.utils.cfb_gc(y)}return F.content=k,F.size=k?k.length:0,T&&(T.CLSID&&(F.clsid=T.CLSID),T.mt&&(F.mt=T.mt),T.ct&&(F.ct=T.ct)),F}function IC(y,S){w(y);var k=we.find(y,S);if(k){for(var T=0;T<y.FileIndex.length;++T)if(y.FileIndex[T]==k)return y.FileIndex.splice(T,1),y.FullPaths.splice(T,1),!0}return!1}function AC(y,S,k){w(y);var T=we.find(y,S);if(T){for(var C=0;C<y.FileIndex.length;++C)if(y.FileIndex[C]==T)return y.FileIndex[C].name=i(k),y.FullPaths[C]=k,!0}return!1}function FC(y){P(y,!0)}return t.find=j,t.read=I,t.parse=u,t.write=se,t.writeFile=ee,t.utils={cfb_new:CC,cfb_add:rh,cfb_del:IC,cfb_mov:AC,cfb_gc:FC,ReadShift:Al,CheckField:WT,prep_blob:Yt,bconcat:zt,use_zlib:A,_deflateRaw:Pe,_inflateRaw:Tg,consts:de},t}();function I6(e){return typeof e=="string"?K0(e):Array.isArray(e)?Z8(e):e}function jc(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=K0(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n=r=="utf8"?Wn(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var i=new Blob([I6(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,e);if(typeof saveAs<"u")return saveAs(i,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(i);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:e,saveAs:!0});var a=document.createElement("a");if(a.download!=null)return a.download=e,a.href=s,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(e);return o.open("w"),o.encoding="binary",Array.isArray(t)&&(t=Ss(t)),o.write(t),o.close(),t}catch(l){if(!l.message||!l.message.match(/onstruct/))throw l}throw new Error("cannot save file "+e)}function A6(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function wt(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function E_(e,t){for(var r=[],n=wt(e),i=0;i!==n.length;++i)r[e[n[i]][t]]==null&&(r[e[n[i]][t]]=n[i]);return r}function Y0(e){for(var t=[],r=wt(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function q0(e){for(var t=[],r=wt(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function F6(e){for(var t=[],r=wt(e),n=0;n!==r.length;++n)t[e[r[n]]]==null&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var t0=new Date(1899,11,30,0,0,0);function Mt(e,t){var r=e.getTime(),n=t0.getTime()+(e.getTimezoneOffset()-t0.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var _T=new Date,N6=t0.getTime()+(_T.getTimezoneOffset()-t0.getTimezoneOffset())*6e4,k_=_T.getTimezoneOffset();function Q0(e){var t=new Date;return t.setTime(e*24*60*60*1e3+N6),t.getTimezoneOffset()!==k_&&t.setTime(t.getTime()+(t.getTimezoneOffset()-k_)*6e4),t}function R6(e){var t=0,r=0,n=!1,i=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!i)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var s=1;s!=i.length;++s)if(i[s]){switch(r=1,s>3&&(n=!0),i[s].slice(i[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+i[s].slice(i[s].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(i[s],10)}return t}var T_=new Date("2017-02-19T19:06:09.000Z"),yT=isNaN(T_.getFullYear())?new Date("2/19/17"):T_,P6=yT.getFullYear()==2017;function at(e,t){var r=new Date(e);if(P6)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(yT.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var i=e.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return e.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function sa(e,t){if(Re&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return Wn(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return Wn(oT(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return Wn(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return Wn(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(s){return r[s]||s})}catch{}for(var n=[],i=0;i!=e.length;++i)n.push(String.fromCharCode(e[i]));return n.join("")}function ot(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=ot(e[r]));return t}function vt(e,t){for(var r="";r.length<t;)r+=e;return r}function In(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(i,s){return r=-r,s}),!isNaN(t=Number(n)))?t/r:t}var O6=["january","february","march","april","may","june","july","august","september","october","november","december"];function ko(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),i=t.getMonth(),s=t.getDate();if(isNaN(s))return r;var a=e.toLowerCase();if(a.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(a=a.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),a.length>3&&O6.indexOf(a)==-1)return r}else if(a.match(/[a-z]/))return r;return n<0||n>8099?r:(i>0||s>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var D6=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,i){if(e||typeof n=="string")return r.split(n);for(var s=r.split(n),a=[s[0]],o=1;o<s.length;++o)a.push(i),a.push(s[o]);return a}}();function wT(e){return e?e.content&&e.type?sa(e.content,!0):e.data?ul(e.data):e.asNodeBuffer&&Re?ul(e.asNodeBuffer().toString("binary")):e.asBinary?ul(e.asBinary()):e._data&&e._data.getContent?ul(sa(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function ET(e){if(!e)return null;if(e.data)return h_(e.data);if(e.asNodeBuffer&&Re)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?h_(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function b6(e){return e&&e.name.slice(-4)===".bin"?ET(e):wT(e)}function tn(e,t){for(var r=e.FullPaths||wt(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),i=n.replace(/\\/g,"/"),s=0;s<r.length;++s){var a=r[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==a||i==a)return e.files?e.files[r[s]]:e.FileIndex[s]}return null}function j1(e,t){var r=tn(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function Ft(e,t,r){if(!r)return b6(j1(e,t));if(!t)return null;try{return Ft(e,t)}catch{return null}}function Wr(e,t,r){if(!r)return wT(j1(e,t));if(!t)return null;try{return Wr(e,t)}catch{return null}}function L6(e,t,r){return ET(j1(e,t))}function S_(e){for(var t=e.FullPaths||wt(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function Fe(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return Re?n=Ii(r):n=e6(r),we.utils.cfb_add(e,t,n)}we.utils.cfb_add(e,t,r)}else e.file(t,r)}function H1(){return we.utils.cfb_new()}function kT(e,t){switch(t.type){case"base64":return we.read(e,{type:"base64"});case"binary":return we.read(e,{type:"binary"});case"buffer":case"array":return we.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function hl(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var i=n.shift();i===".."?r.pop():i!=="."&&r.push(i)}return r.join("/")}var It=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,M6=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,C_=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,B6=/<[^>]*>/g,pr=It.match(C_)?C_:B6,U6=/<\w*:/,W6=/<(\/?)\w+:/;function Te(e,t,r){for(var n={},i=0,s=0;i!==e.length&&!((s=e.charCodeAt(i))===32||s===10||s===13);++i);if(t||(n[0]=e.slice(0,i)),i===e.length)return n;var a=e.match(M6),o=0,l="",c=0,u="",f="",h=1;if(a)for(c=0;c!=a.length;++c){for(f=a[c],s=0;s!=f.length&&f.charCodeAt(s)!==61;++s);for(u=f.slice(0,s).trim();f.charCodeAt(s+1)==32;)++s;for(h=(i=f.charCodeAt(s+1))==34||i==39?1:0,l=f.slice(s+1+h,f.length-h),o=0;o!=u.length&&u.charCodeAt(o)!==58;++o);if(o===u.length)u.indexOf("_")>0&&(u=u.slice(0,u.indexOf("_"))),n[u]=l,n[u.toLowerCase()]=l;else{var d=(o===5&&u.slice(0,5)==="xmlns"?"xmlns":"")+u.slice(o+1);if(n[d]&&u.slice(o-3,o)=="ext")continue;n[d]=l,n[d.toLowerCase()]=l}}return n}function Yn(e){return e.replace(W6,"<$1")}var TT={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},z1=Y0(TT),Ve=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var i=n+"",s=i.indexOf("<![CDATA[");if(s==-1)return i.replace(e,function(o,l){return TT[o]||String.fromCharCode(parseInt(l,o.indexOf("x")>-1?16:10))||o}).replace(t,function(o,l){return String.fromCharCode(parseInt(l,16))});var a=i.indexOf("]]>");return r(i.slice(0,s))+i.slice(s+9,a)+r(i.slice(a+3))}}(),$1=/[&<>'"]/g,V6=/[\u0000-\u0008\u000b-\u001f]/g;function Ke(e){var t=e+"";return t.replace($1,function(r){return z1[r]}).replace(V6,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function I_(e){return Ke(e).replace(/ /g,"_x0020_")}var ST=/[\u0000-\u001f]/g;function G1(e){var t=e+"";return t.replace($1,function(r){return z1[r]}).replace(/\n/g,"<br/>").replace(ST,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function j6(e){var t=e+"";return t.replace($1,function(r){return z1[r]}).replace(ST,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var A_=function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}}();function H6(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function it(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Xh(e){for(var t="",r=0,n=0,i=0,s=0,a=0,o=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(i=e.charCodeAt(r++),n>191&&n<224){a=(n&31)<<6,a|=i&63,t+=String.fromCharCode(a);continue}if(s=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(i&63)<<6|s&63);continue}a=e.charCodeAt(r++),o=((n&7)<<18|(i&63)<<12|(s&63)<<6|a&63)-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(o&1023))}return t}function F_(e){var t=ms(2*e.length),r,n,i=1,s=0,a=0,o;for(n=0;n<e.length;n+=i)i=1,(o=e.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(e.charCodeAt(n+1)&63),i=2):o<240?(r=(o&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),i=3):(i=4,r=(o&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,a=55296+(r>>>10&1023),r=56320+(r&1023)),a!==0&&(t[s++]=a&255,t[s++]=a>>>8,a=0),t[s++]=r%256,t[s++]=r>>>8;return t.slice(0,s).toString("ucs2")}function N_(e){return Ii(e,"binary").toString("utf8")}var Eu="foo bar baz",qe=Re&&(N_(Eu)==Xh(Eu)&&N_||F_(Eu)==Xh(Eu)&&F_)||Xh,Wn=Re?function(e){return Ii(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,i=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,i=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(i>>18&7))),t.push(String.fromCharCode(144+(i>>12&63))),t.push(String.fromCharCode(128+(i>>6&63))),t.push(String.fromCharCode(128+(i&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},pc=function(){var e={};return function(r,n){var i=r+"|"+(n||"");return e[i]?e[i]:e[i]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),CT=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<e.length;++i)n=n.replace(e[i][0],e[i][1]);return n}}(),z6=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),$6=/<\/?(?:vt:)?variant>/g,G6=/<(?:vt:)([^>]*)>([\s\S]*)</;function R_(e,t){var r=Te(e),n=e.match(z6(r.baseType))||[],i=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return i}return n.forEach(function(s){var a=s.replace($6,"").match(G6);a&&i.push({v:qe(a[2]),t:a[1]})}),i}var IT=/(^\s|\s$|\n)/;function Qt(e,t){return"<"+e+(t.match(IT)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function mc(e){return wt(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function ce(e,t,r){return"<"+e+(r!=null?mc(r):"")+(t!=null?(t.match(IT)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function Ap(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function K6(e,t){switch(typeof e){case"string":var r=ce("vt:lpwstr",Ke(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return ce((e|0)==e?"vt:i4":"vt:r8",Ke(String(e)));case"boolean":return ce("vt:bool",e?"true":"false")}if(e instanceof Date)return ce("vt:filetime",Ap(e));throw new Error("Unable to serialize "+e)}function K1(e){if(Re&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return qe(Ss(U1(e)));throw new Error("Bad input format: expected Buffer or string")}var gc=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,bt={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},_a=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Mr={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function X6(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),i=e[t+6]&15,s=5;s>=0;--s)i=i*256+e[t+s];return n==2047?i==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,i+=Math.pow(2,52)),r*Math.pow(2,n-52)*i)}function Y6(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,i=0,s=0,a=n?-t:t;isFinite(a)?a==0?i=s=0:(i=Math.floor(Math.log(a)/Math.LN2),s=a*Math.pow(2,52-i),i<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?i=-1022:(s-=Math.pow(2,52),i+=1023)):(i=2047,s=isNaN(t)?26985:0);for(var o=0;o<=5;++o,s/=256)e[r+o]=s&255;e[r+6]=(i&15)<<4|s&15,e[r+7]=i>>4|n}var P_=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var i=0,s=e[0][n].length;i<s;i+=r)t.push.apply(t,e[0][n].slice(i,i+r));return t},O_=Re?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:Ii(t)})):P_(e)}:P_,D_=function(e,t,r){for(var n=[],i=t;i<r;i+=2)n.push(String.fromCharCode(ui(e,i)));return n.join("").replace(wr,"")},X1=Re?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(wr,""):D_(e,t,r)}:D_,b_=function(e,t,r){for(var n=[],i=t;i<t+r;++i)n.push(("0"+e[i].toString(16)).slice(-2));return n.join("")},AT=Re?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):b_(e,t,r)}:b_,L_=function(e,t,r){for(var n=[],i=t;i<r;i++)n.push(String.fromCharCode(Na(e,i)));return n.join("")},Hc=Re?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):L_(t,r,n)}:L_,FT=function(e,t){var r=Br(e,t);return r>0?Hc(e,t+4,t+4+r-1):""},NT=FT,RT=function(e,t){var r=Br(e,t);return r>0?Hc(e,t+4,t+4+r-1):""},PT=RT,OT=function(e,t){var r=2*Br(e,t);return r>0?Hc(e,t+4,t+4+r-1):""},DT=OT,bT=function(t,r){var n=Br(t,r);return n>0?X1(t,r+4,r+4+n):""},LT=bT,MT=function(e,t){var r=Br(e,t);return r>0?Hc(e,t+4,t+4+r):""},BT=MT,UT=function(e,t){return X6(e,t)},r0=UT,Y1=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};Re&&(NT=function(t,r){if(!Buffer.isBuffer(t))return FT(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},PT=function(t,r){if(!Buffer.isBuffer(t))return RT(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},DT=function(t,r){if(!Buffer.isBuffer(t))return OT(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},LT=function(t,r){if(!Buffer.isBuffer(t))return bT(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},BT=function(t,r){if(!Buffer.isBuffer(t))return MT(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},r0=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):UT(t,r)},Y1=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Na=function(e,t){return e[t]},ui=function(e,t){return e[t+1]*256+e[t]},q6=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},Br=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Ds=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},Q6=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Al(e,t){var r="",n,i,s=[],a,o,l,c;switch(t){case"dbcs":if(c=this.l,Re&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(l=0;l<e;++l)r+=String.fromCharCode(ui(this,c)),c+=2;e*=2;break;case"utf8":r=Hc(this,this.l,this.l+e);break;case"utf16le":e*=2,r=X1(this,this.l,this.l+e);break;case"wstr":return Al.call(this,e,"dbcs");case"lpstr-ansi":r=NT(this,this.l),e=4+Br(this,this.l);break;case"lpstr-cp":r=PT(this,this.l),e=4+Br(this,this.l);break;case"lpwstr":r=DT(this,this.l),e=4+2*Br(this,this.l);break;case"lpp4":e=4+Br(this,this.l),r=LT(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Br(this,this.l),r=BT(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(a=Na(this,this.l+e++))!==0;)s.push(wu(a));r=s.join("");break;case"_wstr":for(e=0,r="";(a=ui(this,this.l+e))!==0;)s.push(wu(a)),e+=2;e+=2,r=s.join("");break;case"dbcs-cont":for(r="",c=this.l,l=0;l<e;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return a=Na(this,c),this.l=c+1,o=Al.call(this,e-l,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(wu(ui(this,c))),c+=2}r=s.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",c=this.l,l=0;l!=e;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return a=Na(this,c),this.l=c+1,o=Al.call(this,e-l,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(wu(Na(this,c))),c+=1}r=s.join("");break;default:switch(e){case 1:return n=Na(this,this.l),this.l++,n;case 2:return n=(t==="i"?q6:ui)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(n=(e>0?Ds:Q6)(this,this.l),this.l+=4,n):(i=Br(this,this.l),this.l+=4,i);case 8:case-8:if(t==="f")return e==8?i=r0(this,this.l):i=r0([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;e=8;case 16:r=AT(this,this.l,e);break}}return this.l+=e,r}var J6=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},Z6=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},eL=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function tL(e,t,r){var n=0,i=0;if(r==="dbcs"){for(i=0;i!=t.length;++i)eL(this,t.charCodeAt(i),this.l+2*i);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=t.length;++i)this[this.l+i]=t.charCodeAt(i)&255;n=t.length}else if(r==="hex"){for(;i<e;++i)this[this.l++]=parseInt(t.slice(2*i,2*i+2),16)||0;return this}else if(r==="utf16le"){var s=Math.min(this.l+e,this.length);for(i=0;i<Math.min(t.length,e);++i){var a=t.charCodeAt(i);this[this.l++]=a&255,this[this.l++]=a>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,J6(this,t,this.l);break;case 8:if(n=8,r==="f"){Y6(this,t,this.l);break}case 16:break;case-4:n=4,Z6(this,t,this.l);break}return this.l+=n,this}function WT(e,t){var r=AT(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function Yt(e,t){e.l=t,e.read_shift=Al,e.chk=WT,e.write_shift=tL}function hr(e,t){e.l+=t}function X(e){var t=ms(e);return Yt(t,0),t}function Ai(e,t,r){if(e){var n,i,s;Yt(e,e.l||0);for(var a=e.length,o=0,l=0;e.l<a;){o=e.read_shift(1),o&128&&(o=(o&127)+((e.read_shift(1)&127)<<7));var c=Ec[o]||Ec[65535];for(n=e.read_shift(1),s=n&127,i=1;i<4&&n&128;++i)s+=((n=e.read_shift(1))&127)<<7*i;l=e.l+s;var u=c.f&&c.f(e,s,r);if(e.l=l,t(u,c,o))return}}}function Or(){var e=[],t=Re?256:2048,r=function(c){var u=X(c);return Yt(u,0),u},n=r(t),i=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},s=function(c){return n&&c<n.length-n.l?n:(i(),n=r(Math.max(c+1,t)))},a=function(){return i(),zt(e)},o=function(c){i(),n=c,n.l==null&&(n.l=n.length),s(t)};return{next:s,push:o,end:a,_bufs:e}}function q(e,t,r,n){var i=+t,s;if(!isNaN(i)){n||(n=Ec[i].p||(r||[]).length||0),s=1+(i>=128?1:0)+1,n>=128&&++s,n>=16384&&++s,n>=2097152&&++s;var a=e.next(s);i<=127?a.write_shift(1,i):(a.write_shift(1,(i&127)+128),a.write_shift(1,i>>7));for(var o=0;o!=4;++o)if(n>=128)a.write_shift(1,(n&127)+128),n>>=7;else{a.write_shift(1,n);break}n>0&&Y1(r)&&e.push(r)}}function Fl(e,t,r){var n=ot(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function M_(e,t,r){var n=ot(e);return n.s=Fl(n.s,t.s,r),n.e=Fl(n.e,t.s,r),n}function Nl(e,t){if(e.cRel&&e.c<0)for(e=ot(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=ot(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=ke(e);return!e.cRel&&e.cRel!=null&&(r=iL(r)),!e.rRel&&e.rRel!=null&&(r=rL(r)),r}function Yh(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+ht(e.s.c)+":"+(e.e.cRel?"":"$")+ht(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Ct(e.s.r)+":"+(e.e.rRel?"":"$")+Ct(e.e.r):Nl(e.s,t.biff)+":"+Nl(e.e,t.biff)}function q1(e){return parseInt(nL(e),10)-1}function Ct(e){return""+(e+1)}function rL(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function nL(e){return e.replace(/\$(\d+)$/,"$1")}function Q1(e){for(var t=sL(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function ht(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function iL(e){return e.replace(/^([A-Z])/,"$$$1")}function sL(e){return e.replace(/^\$([A-Z])/,"$1")}function aL(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function dt(e){for(var t=0,r=0,n=0;n<e.length;++n){var i=e.charCodeAt(n);i>=48&&i<=57?t=10*t+(i-48):i>=65&&i<=90&&(r=26*r+(i-64))}return{c:r-1,r:t-1}}function ke(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function Dr(e){var t=e.indexOf(":");return t==-1?{s:dt(e),e:dt(e)}:{s:dt(e.slice(0,t)),e:dt(e.slice(t+1))}}function Ae(e,t){return typeof t>"u"||typeof t=="number"?Ae(e.s,e.e):(typeof e!="string"&&(e=ke(e)),typeof t!="string"&&(t=ke(t)),e==t?e:e+":"+t)}function je(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,i=0,s=e.length;for(r=0;n<s&&!((i=e.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(t.s.c=--r,r=0;n<s&&!((i=e.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;if(t.s.r=--r,n===s||i!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=s&&!((i=e.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(t.e.c=--r,r=0;n!=s&&!((i=e.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;return t.e.r=--r,t}function B_(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=hn(e.z,r?Mt(t):t)}catch{}try{return e.w=hn((e.XF||{}).numFmtId||(r?14:0),r?Mt(t):t)}catch{return""+t}}function Ti(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?Fi[e.v]||e.v:t==null?B_(e,e.v):B_(e,t))}function Cs(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function VT(e,t,r){var n=r||{},i=e?Array.isArray(e):n.dense,s=e||(i?[]:{}),a=0,o=0;if(s&&n.origin!=null){if(typeof n.origin=="number")a=n.origin;else{var l=typeof n.origin=="string"?dt(n.origin):n.origin;a=l.r,o=l.c}s["!ref"]||(s["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var u=je(s["!ref"]);c.s.c=u.s.c,c.s.r=u.s.r,c.e.c=Math.max(c.e.c,u.e.c),c.e.r=Math.max(c.e.r,u.e.r),a==-1&&(c.e.r=a=u.e.r+1)}for(var f=0;f!=t.length;++f)if(t[f]){if(!Array.isArray(t[f]))throw new Error("aoa_to_sheet expects an array of arrays");for(var h=0;h!=t[f].length;++h)if(!(typeof t[f][h]>"u")){var d={v:t[f][h]},m=a+f,p=o+h;if(c.s.r>m&&(c.s.r=m),c.s.c>p&&(c.s.c=p),c.e.r<m&&(c.e.r=m),c.e.c<p&&(c.e.c=p),t[f][h]&&typeof t[f][h]=="object"&&!Array.isArray(t[f][h])&&!(t[f][h]instanceof Date))d=t[f][h];else if(Array.isArray(d.v)&&(d.f=t[f][h][1],d.v=d.v[0]),d.v===null)if(d.f)d.t="n";else if(n.nullError)d.t="e",d.v=0;else if(n.sheetStubs)d.t="z";else continue;else typeof d.v=="number"?d.t="n":typeof d.v=="boolean"?d.t="b":d.v instanceof Date?(d.z=n.dateNF||Ee[14],n.cellDates?(d.t="d",d.w=hn(d.z,Mt(d.v))):(d.t="n",d.v=Mt(d.v),d.w=hn(d.z,d.v))):d.t="s";if(i)s[m]||(s[m]=[]),s[m][p]&&s[m][p].z&&(d.z=s[m][p].z),s[m][p]=d;else{var g=ke({c:p,r:m});s[g]&&s[g].z&&(d.z=s[g].z),s[g]=d}}}return c.s.c<1e7&&(s["!ref"]=Ae(c)),s}function Bo(e,t){return VT(null,e,t)}function oL(e){return e.read_shift(4,"i")}function An(e,t){return t||(t=X(4)),t.write_shift(4,e),t}function ur(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function $t(e,t){var r=!1;return t==null&&(r=!0,t=X(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function lL(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function cL(e,t){return t||(t=X(4)),t.write_shift(2,0),t.write_shift(2,0),t}function J1(e,t){var r=e.l,n=e.read_shift(1),i=ur(e),s=[],a={t:i,h:i};if(n&1){for(var o=e.read_shift(4),l=0;l!=o;++l)s.push(lL(e));a.r=s}else a.r=[{ich:0,ifnt:0}];return e.l=r+t,a}function uL(e,t){var r=!1;return t==null&&(r=!0,t=X(15+4*e.t.length)),t.write_shift(1,0),$t(e.t,t),r?t.slice(0,t.l):t}var fL=J1;function hL(e,t){var r=!1;return t==null&&(r=!0,t=X(23+4*e.t.length)),t.write_shift(1,1),$t(e.t,t),t.write_shift(4,1),cL({ich:0,ifnt:0},t),r?t.slice(0,t.l):t}function dn(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function ya(e,t){return t==null&&(t=X(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function wa(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function Ea(e,t){return t==null&&(t=X(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var dL=ur,jT=$t;function Z1(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function n0(e,t){var r=!1;return t==null&&(r=!0,t=X(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var pL=ur,Fp=Z1,eg=n0;function tg(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var i=n===0?r0([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Ds(t,0)>>2;return r?i/100:i}function HT(e,t){t==null&&(t=X(4));var r=0,n=0,i=e*100;if(e==(e|0)&&e>=-(1<<29)&&e<1<<29?n=1:i==(i|0)&&i>=-(1<<29)&&i<1<<29&&(n=1,r=1),n)t.write_shift(-4,((r?i:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function zT(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function mL(e,t){return t||(t=X(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var ka=zT,Uo=mL;function cr(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function aa(e,t){return(t||X(8)).write_shift(8,e,"f")}function gL(e){var t={},r=e.read_shift(1),n=r>>>1,i=e.read_shift(1),s=e.read_shift(2,"i"),a=e.read_shift(1),o=e.read_shift(1),l=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=i;var c=Hs[i];c&&(t.rgb=xc(c));break;case 2:t.rgb=xc([a,o,l]);break;case 3:t.theme=i;break}return s!=0&&(t.tint=s>0?s/32767:s/32768),t}function i0(e,t){if(t||(t=X(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function vL(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function xL(e,t){t||(t=X(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function $T(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function _L(e){return $T(e,1)}function yL(e){return $T(e,2)}var rg=2,Sr=3,ku=11,U_=12,s0=19,Tu=64,wL=65,EL=71,kL=4108,TL=4126,Ut=80,GT=81,SL=[Ut,GT],Np={1:{n:"CodePage",t:rg},2:{n:"Category",t:Ut},3:{n:"PresentationFormat",t:Ut},4:{n:"ByteCount",t:Sr},5:{n:"LineCount",t:Sr},6:{n:"ParagraphCount",t:Sr},7:{n:"SlideCount",t:Sr},8:{n:"NoteCount",t:Sr},9:{n:"HiddenCount",t:Sr},10:{n:"MultimediaClipCount",t:Sr},11:{n:"ScaleCrop",t:ku},12:{n:"HeadingPairs",t:kL},13:{n:"TitlesOfParts",t:TL},14:{n:"Manager",t:Ut},15:{n:"Company",t:Ut},16:{n:"LinksUpToDate",t:ku},17:{n:"CharacterCount",t:Sr},19:{n:"SharedDoc",t:ku},22:{n:"HyperlinksChanged",t:ku},23:{n:"AppVersion",t:Sr,p:"version"},24:{n:"DigSig",t:wL},26:{n:"ContentType",t:Ut},27:{n:"ContentStatus",t:Ut},28:{n:"Language",t:Ut},29:{n:"Version",t:Ut},255:{},2147483648:{n:"Locale",t:s0},2147483651:{n:"Behavior",t:s0},1919054434:{}},Rp={1:{n:"CodePage",t:rg},2:{n:"Title",t:Ut},3:{n:"Subject",t:Ut},4:{n:"Author",t:Ut},5:{n:"Keywords",t:Ut},6:{n:"Comments",t:Ut},7:{n:"Template",t:Ut},8:{n:"LastAuthor",t:Ut},9:{n:"RevNumber",t:Ut},10:{n:"EditTime",t:Tu},11:{n:"LastPrinted",t:Tu},12:{n:"CreatedDate",t:Tu},13:{n:"ModifiedDate",t:Tu},14:{n:"PageCount",t:Sr},15:{n:"WordCount",t:Sr},16:{n:"CharCount",t:Sr},17:{n:"Thumbnail",t:EL},18:{n:"Application",t:Ut},19:{n:"DocSecurity",t:Sr},255:{},2147483648:{n:"Locale",t:s0},2147483651:{n:"Behavior",t:s0},1919054434:{}},W_={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},CL=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function IL(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var AL=IL([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Hs=ot(AL),Fi={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},KT={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Pp={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Su={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function ng(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function FL(e){var t=ng();if(!e||!e.match)return t;var r={};if((e.match(pr)||[]).forEach(function(n){var i=Te(n);switch(i[0].replace(U6,"<")){case"<?xml":break;case"<Types":t.xmlns=i["xmlns"+(i[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[i.Extension]=i.ContentType;break;case"<Override":t[Pp[i.ContentType]]!==void 0&&t[Pp[i.ContentType]].push(i.PartName);break}}),t.xmlns!==bt.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function XT(e,t){var r=F6(Pp),n=[],i;n[n.length]=It,n[n.length]=ce("Types",null,{xmlns:bt.CT,"xmlns:xsd":bt.xsd,"xmlns:xsi":bt.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(l){return ce("Default",null,{Extension:l[0],ContentType:l[1]})}));var s=function(l){e[l]&&e[l].length>0&&(i=e[l][0],n[n.length]=ce("Override",null,{PartName:(i[0]=="/"?"":"/")+i,ContentType:Su[l][t.bookType]||Su[l].xlsx}))},a=function(l){(e[l]||[]).forEach(function(c){n[n.length]=ce("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:Su[l][t.bookType]||Su[l].xlsx})})},o=function(l){(e[l]||[]).forEach(function(c){n[n.length]=ce("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:r[l][0]})})};return s("workbooks"),a("sheets"),a("charts"),o("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),a("metadata"),o("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var Oe={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function vc(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Rl(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(pr)||[]).forEach(function(i){var s=Te(i);if(s[0]==="<Relationship"){var a={};a.Type=s.Type,a.Target=s.Target,a.Id=s.Id,s.TargetMode&&(a.TargetMode=s.TargetMode);var o=s.TargetMode==="External"?s.Target:hl(s.Target,t);r[o]=a,n[s.Id]=a}}),r["!id"]=n,r}function so(e){var t=[It,ce("Relationships",null,{xmlns:bt.RELS})];return wt(e["!id"]).forEach(function(r){t[t.length]=ce("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function Ge(e,t,r,n,i,s){if(i||(i={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,i.Id="rId"+t,i.Type=n,i.Target=r,[Oe.HLINK,Oe.XPATH,Oe.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),e["!id"][i.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][i.Id]=i,e[("/"+i.Target).replace("//","/")]=i,t}var NL="application/vnd.oasis.opendocument.spreadsheet";function RL(e,t){for(var r=K1(e),n,i;n=gc.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(i=Te(n[0],!1),i.path=="/"&&i.type!==NL)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}function PL(e){var t=[It];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function V_(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function OL(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function DL(e){var t=[It];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(V_(e[r][0],e[r][1])),t.push(OL("",e[r][0]));return t.push(V_("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function YT(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Qf.version+"</meta:generator></office:meta></office:document-meta>"}var cn=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],bL=function(){for(var e=new Array(cn.length),t=0;t<cn.length;++t){var r=cn[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function qT(e){var t={};e=qe(e);for(var r=0;r<cn.length;++r){var n=cn[r],i=e.match(bL[r]);i!=null&&i.length>0&&(t[n[1]]=Ve(i[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=at(t[n[1]]))}return t}function qh(e,t,r,n,i){i[e]!=null||t==null||t===""||(i[e]=t,t=Ke(t),n[n.length]=r?ce(e,t,r):Qt(e,t))}function QT(e,t){var r=t||{},n=[It,ce("cp:coreProperties",null,{"xmlns:cp":bt.CORE_PROPS,"xmlns:dc":bt.dc,"xmlns:dcterms":bt.dcterms,"xmlns:dcmitype":bt.dcmitype,"xmlns:xsi":bt.xsi})],i={};if(!e&&!r.Props)return n.join("");e&&(e.CreatedDate!=null&&qh("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:Ap(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i),e.ModifiedDate!=null&&qh("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:Ap(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i));for(var s=0;s!=cn.length;++s){var a=cn[s],o=r.Props&&r.Props[a[1]]!=null?r.Props[a[1]]:e?e[a[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&qh(a[0],o,null,n,i)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var zs=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],JT=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function ZT(e,t,r,n){var i=[];if(typeof e=="string")i=R_(e,n);else for(var s=0;s<e.length;++s)i=i.concat(e[s].map(function(u){return{v:u}}));var a=typeof t=="string"?R_(t,n).map(function(u){return u.v}):t,o=0,l=0;if(a.length>0)for(var c=0;c!==i.length;c+=2){switch(l=+i[c+1].v,i[c].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=l,r.SheetNames=a.slice(o,o+l);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=l,r.DefinedNames=a.slice(o,o+l);break;case"Charts":case"Diagramme":r.Chartsheets=l,r.ChartNames=a.slice(o,o+l);break}o+=l}}function LL(e,t,r){var n={};return t||(t={}),e=qe(e),zs.forEach(function(i){var s=(e.match(pc(i[0]))||[])[1];switch(i[2]){case"string":s&&(t[i[1]]=Ve(s));break;case"bool":t[i[1]]=s==="true";break;case"raw":var a=e.match(new RegExp("<"+i[0]+"[^>]*>([\\s\\S]*?)</"+i[0]+">"));a&&a.length>0&&(n[i[1]]=a[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&ZT(n.HeadingPairs,n.TitlesOfParts,t,r),t}function eS(e){var t=[],r=ce;return e||(e={}),e.Application="SheetJS",t[t.length]=It,t[t.length]=ce("Properties",null,{xmlns:bt.EXT_PROPS,"xmlns:vt":bt.vt}),zs.forEach(function(n){if(e[n[1]]!==void 0){var i;switch(n[2]){case"string":i=Ke(String(e[n[1]]));break;case"bool":i=e[n[1]]?"true":"false";break}i!==void 0&&(t[t.length]=r(n[0],i))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+Ke(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var ML=/<[^>]+>[^<]*/g;function BL(e,t){var r={},n="",i=e.match(ML);if(i)for(var s=0;s!=i.length;++s){var a=i[s],o=Te(a);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=Ve(o.name);break;case"</property>":n=null;break;default:if(a.indexOf("<vt:")===0){var l=a.split(">"),c=l[0].slice(4),u=l[1];switch(c){case"lpstr":case"bstr":case"lpwstr":r[n]=Ve(u);break;case"bool":r[n]=it(u);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(u,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(u);break;case"filetime":case"date":r[n]=at(u);break;case"cy":case"error":r[n]=Ve(u);break;default:if(c.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",a,c,l)}}else if(a.slice(0,2)!=="</"){if(t.WTF)throw new Error(a)}}}return r}function tS(e){var t=[It,ce("Properties",null,{xmlns:bt.CUST_PROPS,"xmlns:vt":bt.vt})];if(!e)return t.join("");var r=1;return wt(e).forEach(function(i){++r,t[t.length]=ce("property",K6(e[i]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:Ke(i)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var Op={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Qh;function UL(e,t,r){Qh||(Qh=Y0(Op)),t=Qh[t]||t,e[t]=r}function WL(e,t){var r=[];return wt(Op).map(function(n){for(var i=0;i<cn.length;++i)if(cn[i][1]==n)return cn[i];for(i=0;i<zs.length;++i)if(zs[i][1]==n)return zs[i];throw n}).forEach(function(n){if(e[n[1]]!=null){var i=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:e[n[1]];switch(n[2]){case"date":i=new Date(i).toISOString().replace(/\.\d*Z/,"Z");break}typeof i=="number"?i=String(i):i===!0||i===!1?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),r.push(Qt(Op[n[1]]||n[1],i))}}),ce("DocumentProperties",r.join(""),{xmlns:Mr.o})}function VL(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",i=[];return e&&wt(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)){for(var a=0;a<cn.length;++a)if(s==cn[a][1])return;for(a=0;a<zs.length;++a)if(s==zs[a][1])return;for(a=0;a<r.length;++a)if(s==r[a])return;var o=e[s],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o=String(o),i.push(ce(I_(s),o,{"dt:dt":l}))}}),t&&wt(t).forEach(function(s){if(Object.prototype.hasOwnProperty.call(t,s)&&!(e&&Object.prototype.hasOwnProperty.call(e,s))){var a=t[s],o="string";typeof a=="number"?(o="float",a=String(a)):a===!0||a===!1?(o="boolean",a=a?"1":"0"):a instanceof Date?(o="dateTime.tz",a=a.toISOString()):a=String(a),i.push(ce(I_(s),a,{"dt:dt":o}))}}),"<"+n+' xmlns="'+Mr.o+'">'+i.join("")+"</"+n+">"}function ig(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function jL(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),i=(r-n)/Math.pow(2,32);n*=1e7,i*=1e7;var s=n/Math.pow(2,32)|0;s>0&&(n=n%Math.pow(2,32),i+=s);var a=X(8);return a.write_shift(4,n),a.write_shift(4,i),a}function rS(e,t,r){var n=e.l,i=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return i}function nS(e,t,r){var n=e.read_shift(0,"lpwstr");return n}function iS(e,t,r){return t===31?nS(e):rS(e,t,r)}function Dp(e,t,r){return iS(e,t,r===!1?0:4)}function HL(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return iS(e,t,0)}function zL(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var i=e.l;r[n]=e.read_shift(0,"lpwstr").replace(wr,""),e.l-i&2&&(e.l+=2)}return r}function $L(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(wr,"");return r}function GL(e){var t=e.l,r=a0(e,GT);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=a0(e,Sr);return[r,n]}function KL(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(GL(e));return r}function j_(e,t){for(var r=e.read_shift(4),n={},i=0;i!=r;++i){var s=e.read_shift(4),a=e.read_shift(4);n[s]=e.read_shift(a,t===1200?"utf16le":"utf8").replace(wr,"").replace(fl,"!"),t===1200&&a%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function sS(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function XL(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function a0(e,t,r){var n=e.read_shift(2),i,s=r||{};if(e.l+=2,t!==U_&&n!==t&&SL.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===U_?n:t){case 2:return i=e.read_shift(2,"i"),s.raw||(e.l+=2),i;case 3:return i=e.read_shift(4,"i"),i;case 11:return e.read_shift(4)!==0;case 19:return i=e.read_shift(4),i;case 30:return rS(e,n,4).replace(wr,"");case 31:return nS(e);case 64:return ig(e);case 65:return sS(e);case 71:return XL(e);case 80:return Dp(e,n,!s.raw).replace(wr,"");case 81:return HL(e,n).replace(wr,"");case 4108:return KL(e);case 4126:case 4127:return n==4127?zL(e):$L(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function H_(e,t){var r=X(4),n=X(4);switch(r.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=X(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=jL(t);break;case 31:case 80:for(n=X(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return zt([r,n])}function z_(e,t){var r=e.l,n=e.read_shift(4),i=e.read_shift(4),s=[],a=0,o=0,l=-1,c={};for(a=0;a!=i;++a){var u=e.read_shift(4),f=e.read_shift(4);s[a]=[u,f+r]}s.sort(function(_,v){return _[1]-v[1]});var h={};for(a=0;a!=i;++a){if(e.l!==s[a][1]){var d=!0;if(a>0&&t)switch(t[s[a-1][0]].t){case 2:e.l+2===s[a][1]&&(e.l+=2,d=!1);break;case 80:e.l<=s[a][1]&&(e.l=s[a][1],d=!1);break;case 4108:e.l<=s[a][1]&&(e.l=s[a][1],d=!1);break}if((!t||a==0)&&e.l<=s[a][1]&&(d=!1,e.l=s[a][1]),d)throw new Error("Read Error: Expected address "+s[a][1]+" at "+e.l+" :"+a)}if(t){var m=t[s[a][0]];if(h[m.n]=a0(e,m.t,{raw:!0}),m.p==="version"&&(h[m.n]=String(h[m.n]>>16)+"."+("0000"+String(h[m.n]&65535)).slice(-4)),m.n=="CodePage")switch(h[m.n]){case 0:h[m.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:En(o=h[m.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+h[m.n])}}else if(s[a][0]===1){if(o=h.CodePage=a0(e,rg),En(o),l!==-1){var p=e.l;e.l=s[l][1],c=j_(e,o),e.l=p}}else if(s[a][0]===0){if(o===0){l=a,e.l=s[a+1][1];continue}c=j_(e,o)}else{var g=c[s[a][0]],x;switch(e[e.l]){case 65:e.l+=4,x=sS(e);break;case 30:e.l+=4,x=Dp(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,x=Dp(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,x=e.read_shift(4,"i");break;case 19:e.l+=4,x=e.read_shift(4);break;case 5:e.l+=4,x=e.read_shift(8,"f");break;case 11:e.l+=4,x=Tt(e,4);break;case 64:e.l+=4,x=at(ig(e));break;default:throw new Error("unparsed value: "+e[e.l])}h[g]=x}}return e.l=r+n,h}var aS=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function YL(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function $_(e,t,r){var n=X(8),i=[],s=[],a=8,o=0,l=X(8),c=X(8);if(l.write_shift(4,2),l.write_shift(4,1200),c.write_shift(4,1),s.push(l),i.push(c),a+=8+l.length,!t){c=X(8),c.write_shift(4,0),i.unshift(c);var u=[X(4)];for(u[0].write_shift(4,e.length),o=0;o<e.length;++o){var f=e[o][0];for(l=X(8+2*(f.length+1)+(f.length%2?0:2)),l.write_shift(4,o+2),l.write_shift(4,f.length+1),l.write_shift(0,f,"dbcs");l.l!=l.length;)l.write_shift(1,0);u.push(l)}l=zt(u),s.unshift(l),a+=8+l.length}for(o=0;o<e.length;++o)if(!(t&&!t[e[o][0]])&&!(aS.indexOf(e[o][0])>-1||JT.indexOf(e[o][0])>-1)&&e[o][1]!=null){var h=e[o][1],d=0;if(t){d=+t[e[o][0]];var m=r[d];if(m.p=="version"&&typeof h=="string"){var p=h.split(".");h=(+p[0]<<16)+(+p[1]||0)}l=H_(m.t,h)}else{var g=YL(h);g==-1&&(g=31,h=String(h)),l=H_(g,h)}s.push(l),c=X(8),c.write_shift(4,t?d:2+o),i.push(c),a+=8+l.length}var x=8*(s.length+1);for(o=0;o<s.length;++o)i[o].write_shift(4,x),x+=s[o].length;return n.write_shift(4,a),n.write_shift(4,s.length),zt([n].concat(i).concat(s))}function G_(e,t,r){var n=e.content;if(!n)return{};Yt(n,0);var i,s,a,o,l=0;n.chk("feff","Byte Order: "),n.read_shift(2);var c=n.read_shift(4),u=n.read_shift(16);if(u!==we.utils.consts.HEADER_CLSID&&u!==r)throw new Error("Bad PropertySet CLSID "+u);if(i=n.read_shift(4),i!==1&&i!==2)throw new Error("Unrecognized #Sets: "+i);if(s=n.read_shift(16),o=n.read_shift(4),i===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);i===2&&(a=n.read_shift(16),l=n.read_shift(4));var f=z_(n,t),h={SystemIdentifier:c};for(var d in f)h[d]=f[d];if(h.FMTID=s,i===1)return h;if(l-n.l==2&&(n.l+=2),n.l!==l)throw new Error("Length mismatch 2: "+n.l+" !== "+l);var m;try{m=z_(n,null)}catch{}for(d in m)h[d]=m[d];return h.FMTID=[s,a],h}function K_(e,t,r,n,i,s){var a=X(i?68:48),o=[a];a.write_shift(2,65534),a.write_shift(2,0),a.write_shift(4,842412599),a.write_shift(16,we.utils.consts.HEADER_CLSID,"hex"),a.write_shift(4,i?2:1),a.write_shift(16,t,"hex"),a.write_shift(4,i?68:48);var l=$_(e,r,n);if(o.push(l),i){var c=$_(i,null,null);a.write_shift(16,s,"hex"),a.write_shift(4,68+l.length),o.push(c)}return zt(o)}function Di(e,t){return e.read_shift(t),null}function qL(e,t){t||(t=X(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function QL(e,t,r){for(var n=[],i=e.l+t;e.l<i;)n.push(r(e,i-e.l));if(i!==e.l)throw new Error("Slurp error");return n}function Tt(e,t){return e.read_shift(t)===1}function xr(e,t){return t||(t=X(2)),t.write_shift(2,+!!e),t}function Nt(e){return e.read_shift(2,"u")}function rn(e,t){return t||(t=X(2)),t.write_shift(2,e),t}function oS(e,t){return QL(e,t,Nt)}function JL(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function lS(e,t,r){return r||(r=X(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function zc(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),i="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var s=e.read_shift(1);s&&(i="dbcs-cont")}else r.biff==12&&(i="wstr");r.biff>=2&&r.biff<=5&&(i="cpstr");var a=n?e.read_shift(n,i):"";return a}function ZL(e){var t=e.read_shift(2),r=e.read_shift(1),n=r&4,i=r&8,s=1+(r&1),a=0,o,l={};i&&(a=e.read_shift(2)),n&&(o=e.read_shift(4));var c=s==2?"dbcs-cont":"sbcs-cont",u=t===0?"":e.read_shift(t,c);return i&&(e.l+=4*a),n&&(e.l+=o),l.t=u,i||(l.raw="<t>"+l.t+"</t>",l.r=l.t),l}function eM(e){var t=e.t||"",r=X(3);r.write_shift(2,t.length),r.write_shift(1,1);var n=X(2*t.length);n.write_shift(2*t.length,t,"utf16le");var i=[r,n];return zt(i)}function oa(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var i=e.read_shift(1);return i===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function $c(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):oa(e,n,r)}function Ta(e,t,r){if(r.biff>5)return $c(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function cS(e,t,r){return r||(r=X(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function tM(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function rM(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var i=e.read_shift((n?t-24:t)>>1,"utf16le").replace(wr,"");return n&&(e.l+=24),i}function nM(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var i=e.read_shift(4);if(i===0)return r+n.replace(/\\/g,"/");var s=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var a=e.read_shift(s>>1,"utf16le").replace(wr,"");return r+a}function iM(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return rM(e);case"0303000000000000c000000000000046":return nM(e);default:throw new Error("Unsupported Moniker "+r)}}function Cu(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(wr,""):"";return r}function X_(e,t){t||(t=X(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function sM(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var i=e.read_shift(2);e.l+=2;var s,a,o,l,c="",u,f;i&16&&(s=Cu(e,r-e.l)),i&128&&(a=Cu(e,r-e.l)),(i&257)===257&&(o=Cu(e,r-e.l)),(i&257)===1&&(l=iM(e,r-e.l)),i&8&&(c=Cu(e,r-e.l)),i&32&&(u=e.read_shift(16)),i&64&&(f=ig(e)),e.l=r;var h=a||o||l||"";h&&c&&(h+="#"+c),h||(h="#"+c),i&2&&h.charAt(0)=="/"&&h.charAt(1)!="/"&&(h="file://"+h);var d={Target:h};return u&&(d.guid=u),f&&(d.time=f),s&&(d.Tooltip=s),d}function aM(e){var t=X(512),r=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var i=n.indexOf("#"),s=i>-1?31:23;switch(n.charAt(0)){case"#":s=28;break;case".":s&=-3;break}t.write_shift(4,2),t.write_shift(4,s);var a=[8,6815827,6619237,4849780,83];for(r=0;r<a.length;++r)t.write_shift(4,a[r]);if(s==28)n=n.slice(1),X_(n,t);else if(s&2){for(a="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<a.length;++r)t.write_shift(1,parseInt(a[r],16));var o=i>-1?n.slice(0,i):n;for(t.write_shift(4,2*(o.length+1)),r=0;r<o.length;++r)t.write_shift(2,o.charCodeAt(r));t.write_shift(2,0),s&8&&X_(i>-1?n.slice(i+1):"",t)}else{for(a="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<a.length;++r)t.write_shift(1,parseInt(a[r],16));for(var l=0;n.slice(l*3,l*3+3)=="../"||n.slice(l*3,l*3+3)=="..\\";)++l;for(t.write_shift(2,l),t.write_shift(4,n.length-3*l+1),r=0;r<n.length-3*l;++r)t.write_shift(1,n.charCodeAt(r+3*l)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function uS(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),i=e.read_shift(1);return[t,r,n,i]}function fS(e,t){var r=uS(e);return r[3]=0,r}function qn(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function la(e,t,r,n){return n||(n=X(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function oM(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function lM(e,t,r){return t===0?"":Ta(e,t,r)}function cM(e,t,r){var n=r.biff>8?4:2,i=e.read_shift(n),s=e.read_shift(n,"i"),a=e.read_shift(n,"i");return[i,s,a]}function hS(e){var t=e.read_shift(2),r=tg(e);return[t,r]}function uM(e,t,r){e.l+=4,t-=4;var n=e.l+t,i=zc(e,t,r),s=e.read_shift(2);if(n-=e.l,s!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+s);return e.l+=s,i}function J0(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2);return{s:{c:n,r:t},e:{c:i,r}}}function dS(e,t){return t||(t=X(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function pS(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),i=e.read_shift(1);return{s:{c:n,r:t},e:{c:i,r}}}var fM=pS;function mS(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function hM(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function dM(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function ir(e){e.l+=2,e.l+=e.read_shift(2)}var pM={0:ir,4:ir,5:ir,6:ir,7:dM,8:ir,9:ir,10:ir,11:ir,12:ir,13:hM,14:ir,15:ir,16:ir,17:ir,18:ir,19:ir,20:ir,21:mS};function mM(e,t){for(var r=e.l+t,n=[];e.l<r;){var i=e.read_shift(2);e.l-=2;try{n.push(pM[i](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function Iu(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function sg(e,t,r){var n=1536,i=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,i=8;break;case"biff4":n=4,i=6;break;case"biff3":n=3,i=6;break;case"biff2":n=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=X(i);return s.write_shift(2,n),s.write_shift(2,t),i>4&&s.write_shift(2,29282),i>6&&s.write_shift(2,1997),i>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function gM(e,t){return t===0||e.read_shift(2),1200}function vM(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,i=Ta(e,0,r);return e.read_shift(t+n-e.l),i}function xM(e,t){var r=!t||t.biff==8,n=X(r?112:54);for(n.write_shift(t.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function _M(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function yM(e,t,r){var n=e.read_shift(4),i=e.read_shift(1)&3,s=e.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var a=zc(e,0,r);return a.length===0&&(a="Sheet1"),{pos:n,hs:i,dt:s,name:a}}function wM(e,t){var r=!t||t.biff>=8?2:1,n=X(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var i=n.slice(0,n.l);return i.l=n.l,i}function EM(e,t){for(var r=e.l+t,n=e.read_shift(4),i=e.read_shift(4),s=[],a=0;a!=i&&e.l<r;++a)s.push(ZL(e));return s.Count=n,s.Unique=i,s}function kM(e,t){var r=X(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],i=0;i<e.length;++i)n[i]=eM(e[i]);var s=zt([r].concat(n));return s.parts=[r.length].concat(n.map(function(a){return a.length})),s}function TM(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function SM(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function CM(e){var t=oM(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function IM(e){return e.read_shift(2),e.read_shift(4)}function Y_(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var i=e.read_shift(2);r&&r.biff==2&&(n=1-(i>>15),i&=32767);var s={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[s,i]}function AM(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2),a=e.read_shift(2),o=e.read_shift(2),l=e.read_shift(2),c=e.read_shift(2);return{Pos:[t,r],Dim:[n,i],Flags:s,CurTab:a,FirstTab:o,Selected:l,TabRatio:c}}function FM(){var e=X(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function NM(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function RM(e){var t=X(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function PM(){}function OM(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=zc(e,0,r),n}function DM(e,t){var r=e.name||"Arial",n=t&&t.biff==5,i=n?15+r.length:16+2*r.length,s=X(i);return s.write_shift(2,(e.sz||12)*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,r.length),n||s.write_shift(1,1),s.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),s}function bM(e){var t=qn(e);return t.isst=e.read_shift(4),t}function LM(e,t,r,n){var i=X(10);return la(e,t,n,i),i.write_shift(4,r),i}function MM(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,i=qn(e);r.biff==2&&e.l++;var s=$c(e,n-e.l,r);return i.val=s,i}function BM(e,t,r,n,i){var s=!i||i.biff==8,a=X(8+ +s+(1+s)*r.length);return la(e,t,n,a),a.write_shift(2,r.length),s&&a.write_shift(1,1),a.write_shift((1+s)*r.length,r,s?"utf16le":"sbcs"),a}function UM(e,t,r){var n=e.read_shift(2),i=Ta(e,0,r);return[n,i]}function WM(e,t,r,n){var i=r&&r.biff==5;n||(n=X(i?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(i?1:2,t.length),i||n.write_shift(1,1),n.write_shift((i?1:2)*t.length,t,i?"sbcs":"utf16le");var s=n.length>n.l?n.slice(0,n.l):n;return s.l==null&&(s.l=s.length),s}var VM=Ta;function q_(e,t,r){var n=e.l+t,i=r.biff==8||!r.biff?4:2,s=e.read_shift(i),a=e.read_shift(i),o=e.read_shift(2),l=e.read_shift(2);return e.l=n,{s:{r:s,c:o},e:{r:a,c:l}}}function jM(e,t){var r=t.biff==8||!t.biff?4:2,n=X(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function HM(e){var t=e.read_shift(2),r=e.read_shift(2),n=hS(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function zM(e,t){for(var r=e.l+t-2,n=e.read_shift(2),i=e.read_shift(2),s=[];e.l<r;)s.push(hS(e));if(e.l!==r)throw new Error("MulRK read error");var a=e.read_shift(2);if(s.length!=a-i+1)throw new Error("MulRK length mismatch");return{r:n,c:i,C:a,rkrec:s}}function $M(e,t){for(var r=e.l+t-2,n=e.read_shift(2),i=e.read_shift(2),s=[];e.l<r;)s.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var a=e.read_shift(2);if(s.length!=a-i+1)throw new Error("MulBlank length mismatch");return{r:n,c:i,C:a,ixfe:s}}function GM(e,t,r,n){var i={},s=e.read_shift(4),a=e.read_shift(4),o=e.read_shift(4),l=e.read_shift(2);return i.patternType=CL[o>>26],n.cellStyles&&(i.alc=s&7,i.fWrap=s>>3&1,i.alcV=s>>4&7,i.fJustLast=s>>7&1,i.trot=s>>8&255,i.cIndent=s>>16&15,i.fShrinkToFit=s>>20&1,i.iReadOrder=s>>22&2,i.fAtrNum=s>>26&1,i.fAtrFnt=s>>27&1,i.fAtrAlc=s>>28&1,i.fAtrBdr=s>>29&1,i.fAtrPat=s>>30&1,i.fAtrProt=s>>31&1,i.dgLeft=a&15,i.dgRight=a>>4&15,i.dgTop=a>>8&15,i.dgBottom=a>>12&15,i.icvLeft=a>>16&127,i.icvRight=a>>23&127,i.grbitDiag=a>>30&3,i.icvTop=o&127,i.icvBottom=o>>7&127,i.icvDiag=o>>14&127,i.dgDiag=o>>21&15,i.icvFore=l&127,i.icvBack=l>>7&127,i.fsxButton=l>>14&1),i}function KM(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=GM(e,t,n.fStyle,r),n}function Q_(e,t,r,n){var i=r&&r.biff==5;n||(n=X(i?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var s=0;return e.numFmtId>0&&i&&(s|=1024),n.write_shift(4,s),n.write_shift(4,0),i||n.write_shift(4,0),n.write_shift(2,0),n}function XM(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function YM(e){var t=X(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function J_(e,t,r){var n=qn(e);(r.biff==2||t==9)&&++e.l;var i=JL(e);return n.val=i,n.t=i===!0||i===!1?"b":"e",n}function qM(e,t,r,n,i,s){var a=X(8);return la(e,t,n,a),lS(r,s,a),a}function QM(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=qn(e),i=cr(e);return n.val=i,n}function JM(e,t,r,n){var i=X(14);return la(e,t,n,i),aa(r,i),i}var Z_=lM;function ZM(e,t,r){var n=e.l+t,i=e.read_shift(2),s=e.read_shift(2);if(r.sbcch=s,s==1025||s==14849)return[s,i];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var a=oa(e,s),o=[];n>e.l;)o.push($c(e));return[s,i,a,o]}function ey(e,t,r){var n=e.read_shift(2),i,s={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(i=uM(e,t-2,r)),s.body=i||e.read_shift(t-2),typeof i=="string"&&(s.Name=i),s}var e5=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function ty(e,t,r){var n=e.l+t,i=e.read_shift(2),s=e.read_shift(1),a=e.read_shift(1),o=e.read_shift(r&&r.biff==2?1:2),l=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),l=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var c=oa(e,a,r);i&32&&(c=e5[c.charCodeAt(0)]);var u=n-e.l;r&&r.biff==2&&--u;var f=n==e.l||o===0||!(u>0)?[]:mU(e,u,r,o);return{chKey:s,Name:c,itab:l,rgce:f}}function gS(e,t,r){if(r.biff<8)return t5(e,t,r);for(var n=[],i=e.l+t,s=e.read_shift(r.biff>8?4:2);s--!==0;)n.push(cM(e,r.biff>8?12:6,r));if(e.l!=i)throw new Error("Bad ExternSheet: "+e.l+" != "+i);return n}function t5(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=zc(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function r5(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),i=e.read_shift(2),s=oa(e,n,r),a=oa(e,i,r);return[s,a]}function n5(e,t,r){var n=pS(e);e.l++;var i=e.read_shift(1);return t-=8,[gU(e,t,r),i,n]}function ry(e,t,r){var n=fM(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,dU(e,t,r)]}function i5(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function s5(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2),a=e.read_shift(2),o=Ta(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:i},o,a,s]}}function a5(e,t,r){return s5(e,t,r)}function o5(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(J0(e));return r}function l5(e){var t=X(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)dS(e[r],t);return t}function c5(e,t,r){if(r&&r.biff<8)return f5(e,t,r);var n=mS(e),i=mM(e,t-22,n[1]);return{cmo:n,ft:i}}var u5={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var i=e.read_shift(1);return e.l+=i,e.l=r,{fmt:n}}};function f5(e,t,r){e.l+=4;var n=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var a=[];return a.push((u5[n]||hr)(e,t,r)),{cmo:[i,n,s],ft:a}}function h5(e,t,r){var n=e.l,i="";try{e.l+=4;var s=(r.lastobj||{cmo:[0,0]}).cmo[1],a;[0,5,7,11,12,14].indexOf(s)==-1?e.l+=6:a=tM(e,6,r);var o=e.read_shift(2);e.read_shift(2),Nt(e,2);var l=e.read_shift(2);e.l+=l;for(var c=1;c<e.lens.length-1;++c){if(e.l-n!=e.lens[c])throw new Error("TxO: bad continue record");var u=e[e.l],f=oa(e,e.lens[c+1]-e.lens[c]-1);if(i+=f,i.length>=(u?o:2*o))break}if(i.length!==o&&i.length!==o*2)throw new Error("cchText: "+o+" != "+i.length);return e.l=n+t,{t:i}}catch{return e.l=n+t,{t:i}}}function d5(e,t){var r=J0(e);e.l+=16;var n=sM(e,t-24);return[r,n]}function p5(e){var t=X(24),r=dt(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)t.write_shift(1,parseInt(n[i],16));return zt([t,aM(e[1])])}function m5(e,t){e.read_shift(2);var r=J0(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(wr,""),[r,n]}function g5(e){var t=e[1].Tooltip,r=X(10+2*(t.length+1));r.write_shift(2,2048);var n=dt(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var i=0;i<t.length;++i)r.write_shift(2,t.charCodeAt(i));return r.write_shift(2,0),r}function v5(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=W_[r]||r,r=e.read_shift(2),t[1]=W_[r]||r,t}function x5(e){return e||(e=X(4)),e.write_shift(2,1),e.write_shift(2,1),e}function _5(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(fS(e));return r}function y5(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(fS(e));return r}function w5(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function vS(e,t,r){if(!r.cellStyles)return hr(e,t);var n=r&&r.biff>=12?4:2,i=e.read_shift(n),s=e.read_shift(n),a=e.read_shift(n),o=e.read_shift(n),l=e.read_shift(2);n==2&&(e.l+=2);var c={s:i,e:s,w:a,ixfe:o,flags:l};return(r.biff>=5||!r.biff)&&(c.level=l>>8&7),c}function E5(e,t){var r=X(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function k5(e,t){var r={};return t<32||(e.l+=16,r.header=cr(e),r.footer=cr(e),e.l+=2),r}function T5(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var i=e.read_shift(1);return e.l+=3,i&16&&(n.area=!0),n}function S5(e){for(var t=X(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var C5=qn,I5=oS,A5=$c;function F5(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),i={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,i}function N5(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=qn(e);++e.l;var i=Ta(e,t-7,r);return n.t="str",n.val=i,n}function R5(e){var t=qn(e);++e.l;var r=cr(e);return t.t="n",t.val=r,t}function P5(e,t,r){var n=X(15);return Yc(n,e,t),n.write_shift(8,r,"f"),n}function O5(e){var t=qn(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function D5(e,t,r){var n=X(9);return Yc(n,e,t),n.write_shift(2,r),n}function b5(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function L5(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function M5(e,t,r){var n=e.l+t,i=qn(e),s=e.read_shift(2),a=oa(e,s,r);return e.l=n,i.t="str",i.val=a,i}var B5=[2,3,48,49,131,139,140,245],bp=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=Y0({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,l){var c=[],u=ms(1);switch(l.type){case"base64":u=Ur($r(o));break;case"binary":u=Ur(o);break;case"buffer":case"array":u=o;break}Yt(u,0);var f=u.read_shift(1),h=!!(f&136),d=!1,m=!1;switch(f){case 2:break;case 3:break;case 48:d=!0,h=!0;break;case 49:d=!0,h=!0;break;case 131:break;case 139:break;case 140:m=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+f.toString(16))}var p=0,g=521;f==2&&(p=u.read_shift(2)),u.l+=3,f!=2&&(p=u.read_shift(4)),p>1048576&&(p=1e6),f!=2&&(g=u.read_shift(2));var x=u.read_shift(2),_=l.codepage||1252;f!=2&&(u.l+=16,u.read_shift(1),u[u.l]!==0&&(_=e[u[u.l]]),u.l+=1,u.l+=2),m&&(u.l+=36);for(var v=[],E={},N=Math.min(u.length,f==2?521:g-10-(d?264:0)),I=m?32:11;u.l<N&&u[u.l]!=13;)switch(E={},E.name=zi.utils.decode(_,u.slice(u.l,u.l+I)).replace(/[\u0000\r\n].*$/g,""),u.l+=I,E.type=String.fromCharCode(u.read_shift(1)),f!=2&&!m&&(E.offset=u.read_shift(4)),E.len=u.read_shift(1),f==2&&(E.offset=u.read_shift(2)),E.dec=u.read_shift(1),E.name.length&&v.push(E),f!=2&&(u.l+=m?13:14),E.type){case"B":(!d||E.len!=8)&&l.WTF&&console.log("Skipping "+E.name+":"+E.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+E.name+":"+E.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+E.type)}if(u[u.l]!==13&&(u.l=g-1),u.read_shift(1)!==13)throw new Error("DBF Terminator not found "+u.l+" "+u[u.l]);u.l=g;var w=0,O=0;for(c[0]=[],O=0;O!=v.length;++O)c[0][O]=v[O].name;for(;p-- >0;){if(u[u.l]===42){u.l+=x;continue}for(++u.l,c[++w]=[],O=0,O=0;O!=v.length;++O){var P=u.slice(u.l,u.l+v[O].len);u.l+=v[O].len,Yt(P,0);var W=zi.utils.decode(_,P);switch(v[O].type){case"C":W.trim().length&&(c[w][O]=W.replace(/\s+$/,""));break;case"D":W.length===8?c[w][O]=new Date(+W.slice(0,4),+W.slice(4,6)-1,+W.slice(6,8)):c[w][O]=W;break;case"F":c[w][O]=parseFloat(W.trim());break;case"+":case"I":c[w][O]=m?P.read_shift(-4,"i")^2147483648:P.read_shift(4,"i");break;case"L":switch(W.trim().toUpperCase()){case"Y":case"T":c[w][O]=!0;break;case"N":case"F":c[w][O]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+W+"|")}break;case"M":if(!h)throw new Error("DBF Unexpected MEMO for type "+f.toString(16));c[w][O]="##MEMO##"+(m?parseInt(W.trim(),10):P.read_shift(4));break;case"N":W=W.replace(/\u0000/g,"").trim(),W&&W!="."&&(c[w][O]=+W||0);break;case"@":c[w][O]=new Date(P.read_shift(-8,"f")-621356832e5);break;case"T":c[w][O]=new Date((P.read_shift(4)-2440588)*864e5+P.read_shift(4));break;case"Y":c[w][O]=P.read_shift(4,"i")/1e4+P.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":c[w][O]=-P.read_shift(-8,"f");break;case"B":if(d&&v[O].len==8){c[w][O]=P.read_shift(8,"f");break}case"G":case"P":P.l+=v[O].len;break;case"0":if(v[O].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+v[O].type)}}}if(f!=2&&u.l<u.length&&u[u.l++]!=26)throw new Error("DBF EOF Marker missing "+(u.l-1)+" of "+u.length+" "+u[u.l-1].toString(16));return l&&l.sheetRows&&(c=c.slice(0,l.sheetRows)),l.DBF=v,c}function n(o,l){var c=l||{};c.dateNF||(c.dateNF="yyyymmdd");var u=Bo(r(o,c),c);return u["!cols"]=c.DBF.map(function(f){return{wch:f.len,DBF:f}}),delete c.DBF,u}function i(o,l){try{return Cs(n(o,l),l)}catch(c){if(l&&l.WTF)throw c}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function a(o,l){var c=l||{};if(+c.codepage>=0&&En(+c.codepage),c.type=="string")throw new Error("Cannot write DBF to JS string");var u=Or(),f=c0(o,{header:1,raw:!0,cellDates:!0}),h=f[0],d=f.slice(1),m=o["!cols"]||[],p=0,g=0,x=0,_=1;for(p=0;p<h.length;++p){if(((m[p]||{}).DBF||{}).name){h[p]=m[p].DBF.name,++x;continue}if(h[p]!=null){if(++x,typeof h[p]=="number"&&(h[p]=h[p].toString(10)),typeof h[p]!="string")throw new Error("DBF Invalid column name "+h[p]+" |"+typeof h[p]+"|");if(h.indexOf(h[p])!==p){for(g=0;g<1024;++g)if(h.indexOf(h[p]+"_"+g)==-1){h[p]+="_"+g;break}}}}var v=je(o["!ref"]),E=[],N=[],I=[];for(p=0;p<=v.e.c-v.s.c;++p){var w="",O="",P=0,W=[];for(g=0;g<d.length;++g)d[g][p]!=null&&W.push(d[g][p]);if(W.length==0||h[p]==null){E[p]="?";continue}for(g=0;g<W.length;++g){switch(typeof W[g]){case"number":O="B";break;case"string":O="C";break;case"boolean":O="L";break;case"object":O=W[g]instanceof Date?"D":"C";break;default:O="C"}P=Math.max(P,String(W[g]).length),w=w&&w!=O?"C":O}P>250&&(P=250),O=((m[p]||{}).DBF||{}).type,O=="C"&&m[p].DBF.len>P&&(P=m[p].DBF.len),w=="B"&&O=="N"&&(w="N",I[p]=m[p].DBF.dec,P=m[p].DBF.len),N[p]=w=="C"||O=="N"?P:s[w]||0,_+=N[p],E[p]=w}var j=u.next(32);for(j.write_shift(4,318902576),j.write_shift(4,d.length),j.write_shift(2,296+32*x),j.write_shift(2,_),p=0;p<4;++p)j.write_shift(4,0);for(j.write_shift(4,0|(+t[aT]||3)<<8),p=0,g=0;p<h.length;++p)if(h[p]!=null){var U=u.next(32),J=(h[p].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);U.write_shift(1,J,"sbcs"),U.write_shift(1,E[p]=="?"?"C":E[p],"sbcs"),U.write_shift(4,g),U.write_shift(1,N[p]||s[E[p]]||0),U.write_shift(1,I[p]||0),U.write_shift(1,2),U.write_shift(4,0),U.write_shift(1,0),U.write_shift(4,0),U.write_shift(4,0),g+=N[p]||s[E[p]]||0}var ge=u.next(264);for(ge.write_shift(4,13),p=0;p<65;++p)ge.write_shift(4,0);for(p=0;p<d.length;++p){var fe=u.next(_);for(fe.write_shift(1,0),g=0;g<h.length;++g)if(h[g]!=null)switch(E[g]){case"L":fe.write_shift(1,d[p][g]==null?63:d[p][g]?84:70);break;case"B":fe.write_shift(8,d[p][g]||0,"f");break;case"N":var ve="0";for(typeof d[p][g]=="number"&&(ve=d[p][g].toFixed(I[g]||0)),x=0;x<N[g]-ve.length;++x)fe.write_shift(1,32);fe.write_shift(1,ve,"sbcs");break;case"D":d[p][g]?(fe.write_shift(4,("0000"+d[p][g].getFullYear()).slice(-4),"sbcs"),fe.write_shift(2,("00"+(d[p][g].getMonth()+1)).slice(-2),"sbcs"),fe.write_shift(2,("00"+d[p][g].getDate()).slice(-2),"sbcs")):fe.write_shift(8,"00000000","sbcs");break;case"C":var de=String(d[p][g]!=null?d[p][g]:"").slice(0,N[g]);for(fe.write_shift(1,de,"sbcs"),x=0;x<N[g]-de.length;++x)fe.write_shift(1,32);break}}return u.next(1).write_shift(1,26),u.end()}return{to_workbook:i,to_sheet:n,from_sheet:a}}(),xS=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+wt(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(h,d){var m=e[d];return typeof m=="number"?d_(m):m},n=function(h,d,m){var p=d.charCodeAt(0)-32<<4|m.charCodeAt(0)-48;return p==59?h:d_(p)};e["|"]=254;function i(h,d){switch(d.type){case"base64":return s($r(h),d);case"binary":return s(h,d);case"buffer":return s(Re&&Buffer.isBuffer(h)?h.toString("binary"):Ss(h),d);case"array":return s(sa(h),d)}throw new Error("Unrecognized type "+d.type)}function s(h,d){var m=h.split(/[\n\r]+/),p=-1,g=-1,x=0,_=0,v=[],E=[],N=null,I={},w=[],O=[],P=[],W=0,j;for(+d.codepage>=0&&En(+d.codepage);x!==m.length;++x){W=0;var U=m[x].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),J=U.replace(/;;/g,"\0").split(";").map(function(b){return b.replace(/\u0000/g,";")}),ge=J[0],fe;if(U.length>0)switch(ge){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":J[1].charAt(0)=="P"&&E.push(U.slice(3).replace(/;;/g,";"));break;case"C":var ve=!1,de=!1,ee=!1,M=!1,se=-1,xe=-1;for(_=1;_<J.length;++_)switch(J[_].charAt(0)){case"A":break;case"X":g=parseInt(J[_].slice(1))-1,de=!0;break;case"Y":for(p=parseInt(J[_].slice(1))-1,de||(g=0),j=v.length;j<=p;++j)v[j]=[];break;case"K":fe=J[_].slice(1),fe.charAt(0)==='"'?fe=fe.slice(1,fe.length-1):fe==="TRUE"?fe=!0:fe==="FALSE"?fe=!1:isNaN(In(fe))?isNaN(ko(fe).getDate())||(fe=at(fe)):(fe=In(fe),N!==null&&Lo(N)&&(fe=Q0(fe))),ve=!0;break;case"E":M=!0;var A=ao(J[_].slice(1),{r:p,c:g});v[p][g]=[v[p][g],A];break;case"S":ee=!0,v[p][g]=[v[p][g],"S5S"];break;case"G":break;case"R":se=parseInt(J[_].slice(1))-1;break;case"C":xe=parseInt(J[_].slice(1))-1;break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+U)}if(ve&&(v[p][g]&&v[p][g].length==2?v[p][g][0]=fe:v[p][g]=fe,N=null),ee){if(M)throw new Error("SYLK shared formula cannot have own formula");var B=se>-1&&v[se][xe];if(!B||!B[1])throw new Error("SYLK shared formula cannot find base");v[p][g][1]=LS(B[1],{r:p-se,c:g-xe})}break;case"F":var D=0;for(_=1;_<J.length;++_)switch(J[_].charAt(0)){case"X":g=parseInt(J[_].slice(1))-1,++D;break;case"Y":for(p=parseInt(J[_].slice(1))-1,j=v.length;j<=p;++j)v[j]=[];break;case"M":W=parseInt(J[_].slice(1))/20;break;case"F":break;case"G":break;case"P":N=E[parseInt(J[_].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(P=J[_].slice(1).split(" "),j=parseInt(P[0],10);j<=parseInt(P[1],10);++j)W=parseInt(P[2],10),O[j-1]=W===0?{hidden:!0}:{wch:W},gs(O[j-1]);break;case"C":g=parseInt(J[_].slice(1))-1,O[g]||(O[g]={});break;case"R":p=parseInt(J[_].slice(1))-1,w[p]||(w[p]={}),W>0?(w[p].hpt=W,w[p].hpx=So(W)):W===0&&(w[p].hidden=!0);break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+U)}D<1&&(N=null);break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+U)}}return w.length>0&&(I["!rows"]=w),O.length>0&&(I["!cols"]=O),d&&d.sheetRows&&(v=v.slice(0,d.sheetRows)),[v,I]}function a(h,d){var m=i(h,d),p=m[0],g=m[1],x=Bo(p,d);return wt(g).forEach(function(_){x[_]=g[_]}),x}function o(h,d){return Cs(a(h,d),d)}function l(h,d,m,p){var g="C;Y"+(m+1)+";X"+(p+1)+";K";switch(h.t){case"n":g+=h.v||0,h.f&&!h.F&&(g+=";E"+fg(h.f,{r:m,c:p}));break;case"b":g+=h.v?"TRUE":"FALSE";break;case"e":g+=h.w||h.v;break;case"d":g+='"'+(h.w||h.v)+'"';break;case"s":g+='"'+h.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return g}function c(h,d){d.forEach(function(m,p){var g="F;W"+(p+1)+" "+(p+1)+" ";m.hidden?g+="0":(typeof m.width=="number"&&!m.wpx&&(m.wpx=_c(m.width)),typeof m.wpx=="number"&&!m.wch&&(m.wch=yc(m.wpx)),typeof m.wch=="number"&&(g+=Math.round(m.wch))),g.charAt(g.length-1)!=" "&&h.push(g)})}function u(h,d){d.forEach(function(m,p){var g="F;";m.hidden?g+="M0;":m.hpt?g+="M"+20*m.hpt+";":m.hpx&&(g+="M"+20*wc(m.hpx)+";"),g.length>2&&h.push(g+"R"+(p+1))})}function f(h,d){var m=["ID;PWXL;N;E"],p=[],g=je(h["!ref"]),x,_=Array.isArray(h),v=`\r
`;m.push("P;PGeneral"),m.push("F;P0;DG0G8;M255"),h["!cols"]&&c(m,h["!cols"]),h["!rows"]&&u(m,h["!rows"]),m.push("B;Y"+(g.e.r-g.s.r+1)+";X"+(g.e.c-g.s.c+1)+";D"+[g.s.c,g.s.r,g.e.c,g.e.r].join(" "));for(var E=g.s.r;E<=g.e.r;++E)for(var N=g.s.c;N<=g.e.c;++N){var I=ke({r:E,c:N});x=_?(h[E]||[])[N]:h[I],!(!x||x.v==null&&(!x.f||x.F))&&p.push(l(x,h,E,N))}return m.join(v)+v+p.join(v)+v+"E"+v}return{to_workbook:o,to_sheet:a,from_sheet:f}}(),_S=function(){function e(s,a){switch(a.type){case"base64":return t($r(s),a);case"binary":return t(s,a);case"buffer":return t(Re&&Buffer.isBuffer(s)?s.toString("binary"):Ss(s),a);case"array":return t(sa(s),a)}throw new Error("Unrecognized type "+a.type)}function t(s,a){for(var o=s.split(`
`),l=-1,c=-1,u=0,f=[];u!==o.length;++u){if(o[u].trim()==="BOT"){f[++l]=[],c=0;continue}if(!(l<0)){var h=o[u].trim().split(","),d=h[0],m=h[1];++u;for(var p=o[u]||"";(p.match(/["]/g)||[]).length&1&&u<o.length-1;)p+=`
`+o[++u];switch(p=p.trim(),+d){case-1:if(p==="BOT"){f[++l]=[],c=0;continue}else if(p!=="EOD")throw new Error("Unrecognized DIF special command "+p);break;case 0:p==="TRUE"?f[l][c]=!0:p==="FALSE"?f[l][c]=!1:isNaN(In(m))?isNaN(ko(m).getDate())?f[l][c]=m:f[l][c]=at(m):f[l][c]=In(m),++c;break;case 1:p=p.slice(1,p.length-1),p=p.replace(/""/g,'"'),p&&p.match(/^=".*"$/)&&(p=p.slice(2,-1)),f[l][c++]=p!==""?p:null;break}if(p==="EOD")break}}return a&&a.sheetRows&&(f=f.slice(0,a.sheetRows)),f}function r(s,a){return Bo(e(s,a),a)}function n(s,a){return Cs(r(s,a),a)}var i=function(){var s=function(l,c,u,f,h){l.push(c),l.push(u+","+f),l.push('"'+h.replace(/"/g,'""')+'"')},a=function(l,c,u,f){l.push(c+","+u),l.push(c==1?'"'+f.replace(/"/g,'""')+'"':f)};return function(l){var c=[],u=je(l["!ref"]),f,h=Array.isArray(l);s(c,"TABLE",0,1,"sheetjs"),s(c,"VECTORS",0,u.e.r-u.s.r+1,""),s(c,"TUPLES",0,u.e.c-u.s.c+1,""),s(c,"DATA",0,0,"");for(var d=u.s.r;d<=u.e.r;++d){a(c,-1,0,"BOT");for(var m=u.s.c;m<=u.e.c;++m){var p=ke({r:d,c:m});if(f=h?(l[d]||[])[m]:l[p],!f){a(c,1,0,"");continue}switch(f.t){case"n":var g=f.w;!g&&f.v!=null&&(g=f.v),g==null?f.f&&!f.F?a(c,1,0,"="+f.f):a(c,1,0,""):a(c,0,g,"V");break;case"b":a(c,0,f.v?1:0,f.v?"TRUE":"FALSE");break;case"s":a(c,1,0,isNaN(f.v)?f.v:'="'+f.v+'"');break;case"d":f.w||(f.w=hn(f.z||Ee[14],Mt(at(f.v)))),a(c,0,f.w,"V");break;default:a(c,1,0,"")}}}a(c,-1,0,"EOD");var x=`\r
`,_=c.join(x);return _}}();return{to_workbook:n,to_sheet:r,from_sheet:i}}(),yS=function(){function e(f){return f.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(f){return f.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(f,h){for(var d=f.split(`
`),m=-1,p=-1,g=0,x=[];g!==d.length;++g){var _=d[g].trim().split(":");if(_[0]==="cell"){var v=dt(_[1]);if(x.length<=v.r)for(m=x.length;m<=v.r;++m)x[m]||(x[m]=[]);switch(m=v.r,p=v.c,_[2]){case"t":x[m][p]=e(_[3]);break;case"v":x[m][p]=+_[3];break;case"vtf":var E=_[_.length-1];case"vtc":switch(_[3]){case"nl":x[m][p]=!!+_[4];break;default:x[m][p]=+_[4];break}_[2]=="vtf"&&(x[m][p]=[x[m][p],E])}}}return h&&h.sheetRows&&(x=x.slice(0,h.sheetRows)),x}function n(f,h){return Bo(r(f,h),h)}function i(f,h){return Cs(n(f,h),h)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),a=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function c(f){if(!f||!f["!ref"])return"";for(var h=[],d=[],m,p="",g=Dr(f["!ref"]),x=Array.isArray(f),_=g.s.r;_<=g.e.r;++_)for(var v=g.s.c;v<=g.e.c;++v)if(p=ke({r:_,c:v}),m=x?(f[_]||[])[v]:f[p],!(!m||m.v==null||m.t==="z")){switch(d=["cell",p,"t"],m.t){case"s":case"str":d.push(t(m.v));break;case"n":m.f?(d[2]="vtf",d[3]="n",d[4]=m.v,d[5]=t(m.f)):(d[2]="v",d[3]=m.v);break;case"b":d[2]="vt"+(m.f?"f":"c"),d[3]="nl",d[4]=m.v?"1":"0",d[5]=t(m.f||(m.v?"TRUE":"FALSE"));break;case"d":var E=Mt(at(m.v));d[2]="vtc",d[3]="nd",d[4]=""+E,d[5]=m.w||hn(m.z||Ee[14],E);break;case"e":continue}h.push(d.join(":"))}return h.push("sheet:c:"+(g.e.c-g.s.c+1)+":r:"+(g.e.r-g.s.r+1)+":tvf:1"),h.push("valueformat:1:text-wiki"),h.join(`
`)}function u(f){return[s,a,o,a,c(f),l].join(`
`)}return{to_workbook:i,to_sheet:n,from_sheet:u}}(),To=function(){function e(u,f,h,d,m){m.raw?f[h][d]=u:u===""||(u==="TRUE"?f[h][d]=!0:u==="FALSE"?f[h][d]=!1:isNaN(In(u))?isNaN(ko(u).getDate())?f[h][d]=u:f[h][d]=at(u):f[h][d]=In(u))}function t(u,f){var h=f||{},d=[];if(!u||u.length===0)return d;for(var m=u.split(/[\r\n]/),p=m.length-1;p>=0&&m[p].length===0;)--p;for(var g=10,x=0,_=0;_<=p;++_)x=m[_].indexOf(" "),x==-1?x=m[_].length:x++,g=Math.max(g,x);for(_=0;_<=p;++_){d[_]=[];var v=0;for(e(m[_].slice(0,g).trim(),d,_,v,h),v=1;v<=(m[_].length-g)/10+1;++v)e(m[_].slice(g+(v-1)*10,g+v*10).trim(),d,_,v,h)}return h.sheetRows&&(d=d.slice(0,h.sheetRows)),d}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function i(u){for(var f={},h=!1,d=0,m=0;d<u.length;++d)(m=u.charCodeAt(d))==34?h=!h:!h&&m in r&&(f[m]=(f[m]||0)+1);m=[];for(d in f)Object.prototype.hasOwnProperty.call(f,d)&&m.push([f[d],d]);if(!m.length){f=n;for(d in f)Object.prototype.hasOwnProperty.call(f,d)&&m.push([f[d],d])}return m.sort(function(p,g){return p[0]-g[0]||n[p[1]]-n[g[1]]}),r[m.pop()[1]]||44}function s(u,f){var h=f||{},d="",m=h.dense?[]:{},p={s:{c:0,r:0},e:{c:0,r:0}};u.slice(0,4)=="sep="?u.charCodeAt(5)==13&&u.charCodeAt(6)==10?(d=u.charAt(4),u=u.slice(7)):u.charCodeAt(5)==13||u.charCodeAt(5)==10?(d=u.charAt(4),u=u.slice(6)):d=i(u.slice(0,1024)):h&&h.FS?d=h.FS:d=i(u.slice(0,1024));var g=0,x=0,_=0,v=0,E=0,N=d.charCodeAt(0),I=!1,w=0,O=u.charCodeAt(0);u=u.replace(/\r\n/mg,`
`);var P=h.dateNF!=null?T6(h.dateNF):null;function W(){var j=u.slice(v,E),U={};if(j.charAt(0)=='"'&&j.charAt(j.length-1)=='"'&&(j=j.slice(1,-1).replace(/""/g,'"')),j.length===0)U.t="z";else if(h.raw)U.t="s",U.v=j;else if(j.trim().length===0)U.t="s",U.v=j;else if(j.charCodeAt(0)==61)j.charCodeAt(1)==34&&j.charCodeAt(j.length-1)==34?(U.t="s",U.v=j.slice(2,-1).replace(/""/g,'"')):Z7(j)?(U.t="n",U.f=j.slice(1)):(U.t="s",U.v=j);else if(j=="TRUE")U.t="b",U.v=!0;else if(j=="FALSE")U.t="b",U.v=!1;else if(!isNaN(_=In(j)))U.t="n",h.cellText!==!1&&(U.w=j),U.v=_;else if(!isNaN(ko(j).getDate())||P&&j.match(P)){U.z=h.dateNF||Ee[14];var J=0;P&&j.match(P)&&(j=S6(j,h.dateNF,j.match(P)||[]),J=1),h.cellDates?(U.t="d",U.v=at(j,J)):(U.t="n",U.v=Mt(at(j,J))),h.cellText!==!1&&(U.w=hn(U.z,U.v instanceof Date?Mt(U.v):U.v)),h.cellNF||delete U.z}else U.t="s",U.v=j;if(U.t=="z"||(h.dense?(m[g]||(m[g]=[]),m[g][x]=U):m[ke({c:x,r:g})]=U),v=E+1,O=u.charCodeAt(v),p.e.c<x&&(p.e.c=x),p.e.r<g&&(p.e.r=g),w==N)++x;else if(x=0,++g,h.sheetRows&&h.sheetRows<=g)return!0}e:for(;E<u.length;++E)switch(w=u.charCodeAt(E)){case 34:O===34&&(I=!I);break;case N:case 10:case 13:if(!I&&W())break e;break}return E-v>0&&W(),m["!ref"]=Ae(p),m}function a(u,f){return!(f&&f.PRN)||f.FS||u.slice(0,4)=="sep="||u.indexOf("	")>=0||u.indexOf(",")>=0||u.indexOf(";")>=0?s(u,f):Bo(t(u,f),f)}function o(u,f){var h="",d=f.type=="string"?[0,0,0,0]:_g(u,f);switch(f.type){case"base64":h=$r(u);break;case"binary":h=u;break;case"buffer":f.codepage==65001?h=u.toString("utf8"):f.codepage&&typeof zi<"u"?h=zi.utils.decode(f.codepage,u):h=Re&&Buffer.isBuffer(u)?u.toString("binary"):Ss(u);break;case"array":h=sa(u);break;case"string":h=u;break;default:throw new Error("Unrecognized type "+f.type)}return d[0]==239&&d[1]==187&&d[2]==191?h=qe(h.slice(3)):f.type!="string"&&f.type!="buffer"&&f.codepage==65001?h=qe(h):f.type=="binary"&&typeof zi<"u"&&f.codepage&&(h=zi.utils.decode(f.codepage,zi.utils.encode(28591,h))),h.slice(0,19)=="socialcalc:version:"?yS.to_sheet(f.type=="string"?h:qe(h),f):a(h,f)}function l(u,f){return Cs(o(u,f),f)}function c(u){for(var f=[],h=je(u["!ref"]),d,m=Array.isArray(u),p=h.s.r;p<=h.e.r;++p){for(var g=[],x=h.s.c;x<=h.e.c;++x){var _=ke({r:p,c:x});if(d=m?(u[p]||[])[x]:u[_],!d||d.v==null){g.push("          ");continue}for(var v=(d.w||(Ti(d),d.w)||"").slice(0,10);v.length<10;)v+=" ";g.push(v+(x===0?" ":""))}f.push(g.join(""))}return f.join(`
`)}return{to_workbook:l,to_sheet:o,from_sheet:c}}();function U5(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var i=xS.to_workbook(e,r);return r.WTF=n,i}catch(s){if(r.WTF=n,!s.message.match(/SYLK bad record ID/)&&n)throw s;return To.to_workbook(e,t)}}var $s=function(){function e(A,B,D){if(A){Yt(A,A.l||0);for(var b=D.Enum||se;A.l<A.length;){var K=A.read_shift(2),ie=b[K]||b[65535],le=A.read_shift(2),ne=A.l+le,Z=ie.f&&ie.f(A,le,D);if(A.l=ne,B(Z,ie,K))return}}}function t(A,B){switch(B.type){case"base64":return r(Ur($r(A)),B);case"binary":return r(Ur(A),B);case"buffer":case"array":return r(A,B)}throw"Unsupported type "+B.type}function r(A,B){if(!A)return A;var D=B||{},b=D.dense?[]:{},K="Sheet1",ie="",le=0,ne={},Z=[],Ne=[],R={s:{r:0,c:0},e:{r:0,c:0}},rt=D.sheetRows||0;if(A[2]==0&&(A[3]==8||A[3]==9)&&A.length>=16&&A[14]==5&&A[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(A[2]==2)D.Enum=se,e(A,function(pe,Et,Yr){switch(Yr){case 0:D.vers=pe,pe>=4096&&(D.qpro=!0);break;case 6:R=pe;break;case 204:pe&&(ie=pe);break;case 222:ie=pe;break;case 15:case 51:D.qpro||(pe[1].v=pe[1].v.slice(1));case 13:case 14:case 16:Yr==14&&(pe[2]&112)==112&&(pe[2]&15)>1&&(pe[2]&15)<15&&(pe[1].z=D.dateNF||Ee[14],D.cellDates&&(pe[1].t="d",pe[1].v=Q0(pe[1].v))),D.qpro&&pe[3]>le&&(b["!ref"]=Ae(R),ne[K]=b,Z.push(K),b=D.dense?[]:{},R={s:{r:0,c:0},e:{r:0,c:0}},le=pe[3],K=ie||"Sheet"+(le+1),ie="");var Pn=D.dense?(b[pe[0].r]||[])[pe[0].c]:b[ke(pe[0])];if(Pn){Pn.t=pe[1].t,Pn.v=pe[1].v,pe[1].z!=null&&(Pn.z=pe[1].z),pe[1].f!=null&&(Pn.f=pe[1].f);break}D.dense?(b[pe[0].r]||(b[pe[0].r]=[]),b[pe[0].r][pe[0].c]=pe[1]):b[ke(pe[0])]=pe[1];break}},D);else if(A[2]==26||A[2]==14)D.Enum=xe,A[2]==14&&(D.qpro=!0,A.l=0),e(A,function(pe,Et,Yr){switch(Yr){case 204:K=pe;break;case 22:pe[1].v=pe[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(pe[3]>le&&(b["!ref"]=Ae(R),ne[K]=b,Z.push(K),b=D.dense?[]:{},R={s:{r:0,c:0},e:{r:0,c:0}},le=pe[3],K="Sheet"+(le+1)),rt>0&&pe[0].r>=rt)break;D.dense?(b[pe[0].r]||(b[pe[0].r]=[]),b[pe[0].r][pe[0].c]=pe[1]):b[ke(pe[0])]=pe[1],R.e.c<pe[0].c&&(R.e.c=pe[0].c),R.e.r<pe[0].r&&(R.e.r=pe[0].r);break;case 27:pe[14e3]&&(Ne[pe[14e3][0]]=pe[14e3][1]);break;case 1537:Ne[pe[0]]=pe[1],pe[0]==le&&(K=pe[1]);break}},D);else throw new Error("Unrecognized LOTUS BOF "+A[2]);if(b["!ref"]=Ae(R),ne[ie||K]=b,Z.push(ie||K),!Ne.length)return{SheetNames:Z,Sheets:ne};for(var Ue={},Je=[],Le=0;Le<Ne.length;++Le)ne[Z[Le]]?(Je.push(Ne[Le]||Z[Le]),Ue[Ne[Le]]=ne[Ne[Le]]||ne[Z[Le]]):(Je.push(Ne[Le]),Ue[Ne[Le]]={"!ref":"A1"});return{SheetNames:Je,Sheets:Ue}}function n(A,B){var D=B||{};if(+D.codepage>=0&&En(+D.codepage),D.type=="string")throw new Error("Cannot write WK1 to JS string");var b=Or(),K=je(A["!ref"]),ie=Array.isArray(A),le=[];ue(b,0,s(1030)),ue(b,6,l(K));for(var ne=Math.min(K.e.r,8191),Z=K.s.r;Z<=ne;++Z)for(var Ne=Ct(Z),R=K.s.c;R<=K.e.c;++R){Z===K.s.r&&(le[R]=ht(R));var rt=le[R]+Ne,Ue=ie?(A[Z]||[])[R]:A[rt];if(!(!Ue||Ue.t=="z"))if(Ue.t=="n")(Ue.v|0)==Ue.v&&Ue.v>=-32768&&Ue.v<=32767?ue(b,13,d(Z,R,Ue.v)):ue(b,14,p(Z,R,Ue.v));else{var Je=Ti(Ue);ue(b,15,f(Z,R,Je.slice(0,239)))}}return ue(b,1),b.end()}function i(A,B){var D=B||{};if(+D.codepage>=0&&En(+D.codepage),D.type=="string")throw new Error("Cannot write WK3 to JS string");var b=Or();ue(b,0,a(A));for(var K=0,ie=0;K<A.SheetNames.length;++K)(A.Sheets[A.SheetNames[K]]||{})["!ref"]&&ue(b,27,M(A.SheetNames[K],ie++));var le=0;for(K=0;K<A.SheetNames.length;++K){var ne=A.Sheets[A.SheetNames[K]];if(!(!ne||!ne["!ref"])){for(var Z=je(ne["!ref"]),Ne=Array.isArray(ne),R=[],rt=Math.min(Z.e.r,8191),Ue=Z.s.r;Ue<=rt;++Ue)for(var Je=Ct(Ue),Le=Z.s.c;Le<=Z.e.c;++Le){Ue===Z.s.r&&(R[Le]=ht(Le));var pe=R[Le]+Je,Et=Ne?(ne[Ue]||[])[Le]:ne[pe];if(!(!Et||Et.t=="z"))if(Et.t=="n")ue(b,23,W(Ue,Le,le,Et.v));else{var Yr=Ti(Et);ue(b,22,w(Ue,Le,le,Yr.slice(0,239)))}}++le}}return ue(b,1),b.end()}function s(A){var B=X(2);return B.write_shift(2,A),B}function a(A){var B=X(26);B.write_shift(2,4096),B.write_shift(2,4),B.write_shift(4,0);for(var D=0,b=0,K=0,ie=0;ie<A.SheetNames.length;++ie){var le=A.SheetNames[ie],ne=A.Sheets[le];if(!(!ne||!ne["!ref"])){++K;var Z=Dr(ne["!ref"]);D<Z.e.r&&(D=Z.e.r),b<Z.e.c&&(b=Z.e.c)}}return D>8191&&(D=8191),B.write_shift(2,D),B.write_shift(1,K),B.write_shift(1,b),B.write_shift(2,0),B.write_shift(2,0),B.write_shift(1,1),B.write_shift(1,2),B.write_shift(4,0),B.write_shift(4,0),B}function o(A,B,D){var b={s:{c:0,r:0},e:{c:0,r:0}};return B==8&&D.qpro?(b.s.c=A.read_shift(1),A.l++,b.s.r=A.read_shift(2),b.e.c=A.read_shift(1),A.l++,b.e.r=A.read_shift(2),b):(b.s.c=A.read_shift(2),b.s.r=A.read_shift(2),B==12&&D.qpro&&(A.l+=2),b.e.c=A.read_shift(2),b.e.r=A.read_shift(2),B==12&&D.qpro&&(A.l+=2),b.s.c==65535&&(b.s.c=b.e.c=b.s.r=b.e.r=0),b)}function l(A){var B=X(8);return B.write_shift(2,A.s.c),B.write_shift(2,A.s.r),B.write_shift(2,A.e.c),B.write_shift(2,A.e.r),B}function c(A,B,D){var b=[{c:0,r:0},{t:"n",v:0},0,0];return D.qpro&&D.vers!=20768?(b[0].c=A.read_shift(1),b[3]=A.read_shift(1),b[0].r=A.read_shift(2),A.l+=2):(b[2]=A.read_shift(1),b[0].c=A.read_shift(2),b[0].r=A.read_shift(2)),b}function u(A,B,D){var b=A.l+B,K=c(A,B,D);if(K[1].t="s",D.vers==20768){A.l++;var ie=A.read_shift(1);return K[1].v=A.read_shift(ie,"utf8"),K}return D.qpro&&A.l++,K[1].v=A.read_shift(b-A.l,"cstr"),K}function f(A,B,D){var b=X(7+D.length);b.write_shift(1,255),b.write_shift(2,B),b.write_shift(2,A),b.write_shift(1,39);for(var K=0;K<b.length;++K){var ie=D.charCodeAt(K);b.write_shift(1,ie>=128?95:ie)}return b.write_shift(1,0),b}function h(A,B,D){var b=c(A,B,D);return b[1].v=A.read_shift(2,"i"),b}function d(A,B,D){var b=X(7);return b.write_shift(1,255),b.write_shift(2,B),b.write_shift(2,A),b.write_shift(2,D,"i"),b}function m(A,B,D){var b=c(A,B,D);return b[1].v=A.read_shift(8,"f"),b}function p(A,B,D){var b=X(13);return b.write_shift(1,255),b.write_shift(2,B),b.write_shift(2,A),b.write_shift(8,D,"f"),b}function g(A,B,D){var b=A.l+B,K=c(A,B,D);if(K[1].v=A.read_shift(8,"f"),D.qpro)A.l=b;else{var ie=A.read_shift(2);E(A.slice(A.l,A.l+ie),K),A.l+=ie}return K}function x(A,B,D){var b=B&32768;return B&=-32769,B=(b?A:0)+(B>=8192?B-16384:B),(b?"":"$")+(D?ht(B):Ct(B))}var _={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},v=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function E(A,B){Yt(A,0);for(var D=[],b=0,K="",ie="",le="",ne="";A.l<A.length;){var Z=A[A.l++];switch(Z){case 0:D.push(A.read_shift(8,"f"));break;case 1:ie=x(B[0].c,A.read_shift(2),!0),K=x(B[0].r,A.read_shift(2),!1),D.push(ie+K);break;case 2:{var Ne=x(B[0].c,A.read_shift(2),!0),R=x(B[0].r,A.read_shift(2),!1);ie=x(B[0].c,A.read_shift(2),!0),K=x(B[0].r,A.read_shift(2),!1),D.push(Ne+R+":"+ie+K)}break;case 3:if(A.l<A.length){console.error("WK1 premature formula end");return}break;case 4:D.push("("+D.pop()+")");break;case 5:D.push(A.read_shift(2));break;case 6:{for(var rt="";Z=A[A.l++];)rt+=String.fromCharCode(Z);D.push('"'+rt.replace(/"/g,'""')+'"')}break;case 8:D.push("-"+D.pop());break;case 23:D.push("+"+D.pop());break;case 22:D.push("NOT("+D.pop()+")");break;case 20:case 21:ne=D.pop(),le=D.pop(),D.push(["AND","OR"][Z-20]+"("+le+","+ne+")");break;default:if(Z<32&&v[Z])ne=D.pop(),le=D.pop(),D.push(le+v[Z]+ne);else if(_[Z]){if(b=_[Z][1],b==69&&(b=A[A.l++]),b>D.length){console.error("WK1 bad formula parse 0x"+Z.toString(16)+":|"+D.join("|")+"|");return}var Ue=D.slice(-b);D.length-=b,D.push(_[Z][0]+"("+Ue.join(",")+")")}else return Z<=7?console.error("WK1 invalid opcode "+Z.toString(16)):Z<=24?console.error("WK1 unsupported op "+Z.toString(16)):Z<=30?console.error("WK1 invalid opcode "+Z.toString(16)):Z<=115?console.error("WK1 unsupported function opcode "+Z.toString(16)):console.error("WK1 unrecognized opcode "+Z.toString(16))}}D.length==1?B[1].f=""+D[0]:console.error("WK1 bad formula parse |"+D.join("|")+"|")}function N(A){var B=[{c:0,r:0},{t:"n",v:0},0];return B[0].r=A.read_shift(2),B[3]=A[A.l++],B[0].c=A[A.l++],B}function I(A,B){var D=N(A);return D[1].t="s",D[1].v=A.read_shift(B-4,"cstr"),D}function w(A,B,D,b){var K=X(6+b.length);K.write_shift(2,A),K.write_shift(1,D),K.write_shift(1,B),K.write_shift(1,39);for(var ie=0;ie<b.length;++ie){var le=b.charCodeAt(ie);K.write_shift(1,le>=128?95:le)}return K.write_shift(1,0),K}function O(A,B){var D=N(A);D[1].v=A.read_shift(2);var b=D[1].v>>1;if(D[1].v&1)switch(b&7){case 0:b=(b>>3)*5e3;break;case 1:b=(b>>3)*500;break;case 2:b=(b>>3)/20;break;case 3:b=(b>>3)/200;break;case 4:b=(b>>3)/2e3;break;case 5:b=(b>>3)/2e4;break;case 6:b=(b>>3)/16;break;case 7:b=(b>>3)/64;break}return D[1].v=b,D}function P(A,B){var D=N(A),b=A.read_shift(4),K=A.read_shift(4),ie=A.read_shift(2);if(ie==65535)return b===0&&K===3221225472?(D[1].t="e",D[1].v=15):b===0&&K===3489660928?(D[1].t="e",D[1].v=42):D[1].v=0,D;var le=ie&32768;return ie=(ie&32767)-16446,D[1].v=(1-le*2)*(K*Math.pow(2,ie+32)+b*Math.pow(2,ie)),D}function W(A,B,D,b){var K=X(14);if(K.write_shift(2,A),K.write_shift(1,D),K.write_shift(1,B),b==0)return K.write_shift(4,0),K.write_shift(4,0),K.write_shift(2,65535),K;var ie=0,le=0,ne=0,Z=0;return b<0&&(ie=1,b=-b),le=Math.log2(b)|0,b/=Math.pow(2,le-31),Z=b>>>0,Z&2147483648||(b/=2,++le,Z=b>>>0),b-=Z,Z|=2147483648,Z>>>=0,b*=Math.pow(2,32),ne=b>>>0,K.write_shift(4,ne),K.write_shift(4,Z),le+=16383+(ie?32768:0),K.write_shift(2,le),K}function j(A,B){var D=P(A);return A.l+=B-14,D}function U(A,B){var D=N(A),b=A.read_shift(4);return D[1].v=b>>6,D}function J(A,B){var D=N(A),b=A.read_shift(8,"f");return D[1].v=b,D}function ge(A,B){var D=J(A);return A.l+=B-10,D}function fe(A,B){return A[A.l+B-1]==0?A.read_shift(B,"cstr"):""}function ve(A,B){var D=A[A.l++];D>B-1&&(D=B-1);for(var b="";b.length<D;)b+=String.fromCharCode(A[A.l++]);return b}function de(A,B,D){if(!(!D.qpro||B<21)){var b=A.read_shift(1);A.l+=17,A.l+=1,A.l+=2;var K=A.read_shift(B-21,"cstr");return[b,K]}}function ee(A,B){for(var D={},b=A.l+B;A.l<b;){var K=A.read_shift(2);if(K==14e3){for(D[K]=[0,""],D[K][0]=A.read_shift(2);A[A.l];)D[K][1]+=String.fromCharCode(A[A.l]),A.l++;A.l++}}return D}function M(A,B){var D=X(5+A.length);D.write_shift(2,14e3),D.write_shift(2,B);for(var b=0;b<A.length;++b){var K=A.charCodeAt(b);D[D.l++]=K>127?95:K}return D[D.l++]=0,D}var se={0:{n:"BOF",f:Nt},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:h},14:{n:"NUMBER",f:m},15:{n:"LABEL",f:u},16:{n:"FORMULA",f:g},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:u},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:fe},222:{n:"SHEETNAMELP",f:ve},65535:{n:""}},xe={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:I},23:{n:"NUMBER17",f:P},24:{n:"NUMBER18",f:O},25:{n:"FORMULA19",f:j},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:ee},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:U},38:{n:"??"},39:{n:"NUMBER27",f:J},40:{n:"FORMULA28",f:ge},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:fe},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:de},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:i,to_workbook:t}}();function W5(e){var t={},r=e.match(pr),n=0,i=!1;if(r)for(;n!=r.length;++n){var s=Te(r[n]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;t.cp=L1[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=s.val;break;case"<sz":t.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":s.rgb&&(t.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(s[0].charCodeAt(1)!==47&&!i)throw new Error("Unrecognized rich format "+s[0])}}return t}var V5=function(){var e=pc("t"),t=pc("rPr");function r(s){var a=s.match(e);if(!a)return{t:"s",v:""};var o={t:"s",v:Ve(a[1])},l=s.match(t);return l&&(o.s=W5(l[1])),o}var n=/<(?:\w+:)?r>/g,i=/<\/(?:\w+:)?r>/;return function(a){return a.replace(n,"").split(i).map(r).filter(function(o){return o.v})}}(),j5=function(){var t=/(\r\n|\n)/g;function r(i,s,a){var o=[];i.u&&o.push("text-decoration: underline;"),i.uval&&o.push("text-underline-style:"+i.uval+";"),i.sz&&o.push("font-size:"+i.sz+"pt;"),i.outline&&o.push("text-effect: outline;"),i.shadow&&o.push("text-shadow: auto;"),s.push('<span style="'+o.join("")+'">'),i.b&&(s.push("<b>"),a.push("</b>")),i.i&&(s.push("<i>"),a.push("</i>")),i.strike&&(s.push("<s>"),a.push("</s>"));var l=i.valign||"";return l=="superscript"||l=="super"?l="sup":l=="subscript"&&(l="sub"),l!=""&&(s.push("<"+l+">"),a.push("</"+l+">")),a.push("</span>"),i}function n(i){var s=[[],i.v,[]];return i.v?(i.s&&r(i.s,s[0],s[2]),s[0].join("")+s[1].replace(t,"<br/>")+s[2].join("")):""}return function(s){return s.map(n).join("")}}(),H5=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,z5=/<(?:\w+:)?r>/,$5=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function ag(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=Ve(qe(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=qe(e),r&&(n.h=G1(n.t))):e.match(z5)&&(n.r=qe(e),n.t=Ve(qe((e.replace($5,"").match(H5)||[]).join("").replace(pr,""))),r&&(n.h=j5(V5(n.r)))),n):{t:""}}var G5=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,K5=/<(?:\w+:)?(?:si|sstItem)>/g,X5=/<\/(?:\w+:)?(?:si|sstItem)>/;function Y5(e,t){var r=[],n="";if(!e)return r;var i=e.match(G5);if(i){n=i[2].replace(K5,"").split(X5);for(var s=0;s!=n.length;++s){var a=ag(n[s].trim(),t);a!=null&&(r[r.length]=a)}i=Te(i[1]),r.Count=i.count,r.Unique=i.uniqueCount}return r}var q5=/^\s|\s$|[\t\n\r]/;function wS(e,t){if(!t.bookSST)return"";var r=[It];r[r.length]=ce("sst",null,{xmlns:_a[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var i=e[n],s="<si>";i.r?s+=i.r:(s+="<t",i.t||(i.t=""),i.t.match(q5)&&(s+=' xml:space="preserve"'),s+=">"+Ke(i.t)+"</t>"),s+="</si>",r[r.length]=s}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function Q5(e){return[e.read_shift(4),e.read_shift(4)]}function J5(e,t){var r=[],n=!1;return Ai(e,function(s,a,o){switch(o){case 159:r.Count=s[0],r.Unique=s[1];break;case 19:r.push(s);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(a.T,!n||t.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function Z5(e,t){return t||(t=X(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var eB=uL;function tB(e){var t=Or();q(t,159,Z5(e));for(var r=0;r<e.length;++r)q(t,19,eB(e[r]));return q(t,160),t.end()}function ES(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function mi(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function rB(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=mi(e,4),t.U=mi(e,4),t.W=mi(e,4),t}function nB(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},i=e.read_shift(4),s=[];i-- >0;)s.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=s,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function iB(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(nB(e));return t}function sB(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function aB(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=mi(e,4),t.U=mi(e,4),t.W=mi(e,4),t}function oB(e){var t=aB(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function kS(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var i=!1;switch(n.AlgID){case 26126:case 26127:case 26128:i=n.Flags==36;break;case 26625:i=n.Flags==4;break;case 0:i=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!i)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function TS(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function lB(e){var t=mi(e);switch(t.Minor){case 2:return[t.Minor,cB(e)];case 3:return[t.Minor,uB()];case 4:return[t.Minor,fB(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function cB(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=kS(e,r),i=TS(e,e.length-e.l);return{t:"Std",h:n,v:i}}function uB(){throw new Error("File is password-protected: ECMA-376 Extensible")}function fB(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(pr,function(s){var a=Te(s);switch(Yn(a[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(o){n[o]=a[o]});break;case"<dataIntegrity":n.encryptedHmacKey=a.encryptedHmacKey,n.encryptedHmacValue=a.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=a.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(a);break;default:throw a[0]}}),n}function hB(e,t){var r={},n=r.EncryptionVersionInfo=mi(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var i=e.read_shift(4);return t-=4,r.EncryptionHeader=kS(e,i),t-=i,r.EncryptionVerifier=TS(e,t),r}function dB(e){var t={},r=t.EncryptionVersionInfo=mi(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function og(e){var t=0,r,n=ES(e),i=n.length+1,s,a,o,l,c;for(r=ms(i),r[0]=n.length,s=1;s!=i;++s)r[s]=n[s-1];for(s=i-1;s>=0;--s)a=r[s],o=t&16384?1:0,l=t<<1&32767,c=o|l,t=c^a;return t^52811}var SS=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(a){return(a/2|a*128)&255},i=function(a,o){return n(a^o)},s=function(a){for(var o=t[a.length-1],l=104,c=a.length-1;c>=0;--c)for(var u=a[c],f=0;f!=7;++f)u&64&&(o^=r[l]),u*=2,--l;return o};return function(a){for(var o=ES(a),l=s(o),c=o.length,u=ms(16),f=0;f!=16;++f)u[f]=0;var h,d,m;for((c&1)===1&&(h=l>>8,u[c]=i(e[0],h),--c,h=l&255,d=o[o.length-1],u[c]=i(d,h));c>0;)--c,h=l>>8,u[c]=i(o[c],h),--c,h=l&255,u[c]=i(o[c],h);for(c=15,m=15-o.length;m>0;)h=l>>8,u[c]=i(e[m],h),--c,--m,h=l&255,u[c]=i(o[c],h),--c,--m;return u}}(),pB=function(e,t,r,n,i){i||(i=t),n||(n=SS(e));var s,a;for(s=0;s!=t.length;++s)a=t[s],a^=n[r],a=(a>>5|a<<3)&255,i[s]=a,++r;return[i,r,n]},mB=function(e){var t=0,r=SS(e);return function(n){var i=pB("",n,t,r);return t=i[1],i[0]}};function gB(e,t,r,n){var i={key:Nt(e),verificationBytes:Nt(e)};return r.password&&(i.verifier=og(r.password)),n.valid=i.verificationBytes===i.verifier,n.valid&&(n.insitu=mB(r.password)),i}function vB(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=dB(e):n.Data=hB(e,t),n}function xB(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?vB(e,t-2,n):gB(e,r.biff>=8?t:t-2,r,n),n}var CS=function(){function e(i,s){switch(s.type){case"base64":return t($r(i),s);case"binary":return t(i,s);case"buffer":return t(Re&&Buffer.isBuffer(i)?i.toString("binary"):Ss(i),s);case"array":return t(sa(i),s)}throw new Error("Unrecognized type "+s.type)}function t(i,s){var a=s||{},o=a.dense?[]:{},l=i.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var c={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(u,f){Array.isArray(o)&&(o[f]=[]);for(var h=/\\\w+\b/g,d=0,m,p=-1;m=h.exec(u);){switch(m[0]){case"\\cell":var g=u.slice(d,h.lastIndex-m[0].length);if(g[0]==" "&&(g=g.slice(1)),++p,g.length){var x={v:g,t:"s"};Array.isArray(o)?o[f][p]=x:o[ke({r:f,c:p})]=x}break}d=h.lastIndex}p>c.e.c&&(c.e.c=p)}),o["!ref"]=Ae(c),o}function r(i,s){return Cs(e(i,s),s)}function n(i){for(var s=["{\\rtf1\\ansi"],a=je(i["!ref"]),o,l=Array.isArray(i),c=a.s.r;c<=a.e.r;++c){s.push("\\trowd\\trautofit1");for(var u=a.s.c;u<=a.e.c;++u)s.push("\\cellx"+(u+1));for(s.push("\\pard\\intbl"),u=a.s.c;u<=a.e.c;++u){var f=ke({r:c,c:u});o=l?(i[c]||[])[u]:i[f],!(!o||o.v==null&&(!o.f||o.F))&&(s.push(" "+(o.w||(Ti(o),o.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function _B(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function xc(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function yB(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,i=Math.max(t,r,n),s=Math.min(t,r,n),a=i-s;if(a===0)return[0,0,t];var o=0,l=0,c=i+s;switch(l=a/(c>1?2-c:c),i){case t:o=((r-n)/a+6)%6;break;case r:o=(n-t)/a+2;break;case n:o=(t-r)/a+4;break}return[o/6,l,c/2]}function wB(e){var t=e[0],r=e[1],n=e[2],i=r*2*(n<.5?n:1-n),s=n-i/2,a=[s,s,s],o=6*t,l;if(r!==0)switch(o|0){case 0:case 6:l=i*o,a[0]+=i,a[1]+=l;break;case 1:l=i*(2-o),a[0]+=l,a[1]+=i;break;case 2:l=i*(o-2),a[1]+=i,a[2]+=l;break;case 3:l=i*(4-o),a[1]+=l,a[2]+=i;break;case 4:l=i*(o-4),a[2]+=i,a[0]+=l;break;case 5:l=i*(6-o),a[2]+=l,a[0]+=i;break}for(var c=0;c!=3;++c)a[c]=Math.round(a[c]*255);return a}function o0(e,t){if(t===0)return e;var r=yB(_B(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),xc(wB(r))}var IS=6,EB=15,kB=1,lr=IS;function _c(e){return Math.floor((e+Math.round(128/lr)/256)*lr)}function yc(e){return Math.floor((e-5)/lr*100+.5)/100}function l0(e){return Math.round((e*lr+5)/lr*256)/256}function Jh(e){return l0(yc(_c(e)))}function lg(e){var t=Math.abs(e-Jh(e)),r=lr;if(t>.005)for(lr=kB;lr<EB;++lr)Math.abs(e-Jh(e))<=t&&(t=Math.abs(e-Jh(e)),r=lr);lr=r}function gs(e){e.width?(e.wpx=_c(e.width),e.wch=yc(e.wpx),e.MDW=lr):e.wpx?(e.wch=yc(e.wpx),e.width=l0(e.wch),e.MDW=lr):typeof e.wch=="number"&&(e.width=l0(e.wch),e.wpx=_c(e.width),e.MDW=lr),e.customWidth&&delete e.customWidth}var TB=96,AS=TB;function wc(e){return e*96/AS}function So(e){return e*AS/96}var SB={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function CB(e,t,r,n){t.Borders=[];var i={},s=!1;(e[0].match(pr)||[]).forEach(function(a){var o=Te(a);switch(Yn(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":i={},o.diagonalUp&&(i.diagonalUp=it(o.diagonalUp)),o.diagonalDown&&(i.diagonalDown=it(o.diagonalDown)),t.Borders.push(i);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in borders")}})}function IB(e,t,r,n){t.Fills=[];var i={},s=!1;(e[0].match(pr)||[]).forEach(function(a){var o=Te(a);switch(Yn(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":i={},t.Fills.push(i);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(i),i={};break;case"<patternFill":case"<patternFill>":o.patternType&&(i.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":i.bgColor||(i.bgColor={}),o.indexed&&(i.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(i.bgColor.theme=parseInt(o.theme,10)),o.tint&&(i.bgColor.tint=parseFloat(o.tint)),o.rgb&&(i.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":i.fgColor||(i.fgColor={}),o.theme&&(i.fgColor.theme=parseInt(o.theme,10)),o.tint&&(i.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(i.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fills")}})}function AB(e,t,r,n){t.Fonts=[];var i={},s=!1;(e[0].match(pr)||[]).forEach(function(a){var o=Te(a);switch(Yn(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(i),i={};break;case"<name":o.val&&(i.name=qe(o.val));break;case"<name/>":case"</name>":break;case"<b":i.bold=o.val?it(o.val):1;break;case"<b/>":i.bold=1;break;case"<i":i.italic=o.val?it(o.val):1;break;case"<i/>":i.italic=1;break;case"<u":switch(o.val){case"none":i.underline=0;break;case"single":i.underline=1;break;case"double":i.underline=2;break;case"singleAccounting":i.underline=33;break;case"doubleAccounting":i.underline=34;break}break;case"<u/>":i.underline=1;break;case"<strike":i.strike=o.val?it(o.val):1;break;case"<strike/>":i.strike=1;break;case"<outline":i.outline=o.val?it(o.val):1;break;case"<outline/>":i.outline=1;break;case"<shadow":i.shadow=o.val?it(o.val):1;break;case"<shadow/>":i.shadow=1;break;case"<condense":i.condense=o.val?it(o.val):1;break;case"<condense/>":i.condense=1;break;case"<extend":i.extend=o.val?it(o.val):1;break;case"<extend/>":i.extend=1;break;case"<sz":o.val&&(i.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(i.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(i.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(i.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=L1[parseInt(o.val,10)];break;case"<color":if(i.color||(i.color={}),o.auto&&(i.color.auto=it(o.auto)),o.rgb)i.color.rgb=o.rgb.slice(-6);else if(o.indexed){i.color.index=parseInt(o.indexed,10);var l=Hs[i.color.index];i.color.index==81&&(l=Hs[1]),l||(l=Hs[1]),i.color.rgb=l[0].toString(16)+l[1].toString(16)+l[2].toString(16)}else o.theme&&(i.color.theme=parseInt(o.theme,10),o.tint&&(i.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(i.color.rgb=o0(r.themeElements.clrScheme[i.color.theme].rgb,i.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fonts")}})}function FB(e,t,r){t.NumberFmt=[];for(var n=wt(Ee),i=0;i<n.length;++i)t.NumberFmt[n[i]]=Ee[n[i]];var s=e[0].match(pr);if(s)for(i=0;i<s.length;++i){var a=Te(s[i]);switch(Yn(a[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=Ve(qe(a.formatCode)),l=parseInt(a.numFmtId,10);if(t.NumberFmt[l]=o,l>0){if(l>392){for(l=392;l>60&&t.NumberFmt[l]!=null;--l);t.NumberFmt[l]=o}pi(o,l)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+a[0]+" in numFmts")}}}function NB(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&(t[t.length]=ce("numFmt",null,{numFmtId:n,formatCode:Ke(e[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=ce("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var Au=["numFmtId","fillId","fontId","borderId","xfId"],Fu=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function RB(e,t,r){t.CellXf=[];var n,i=!1;(e[0].match(pr)||[]).forEach(function(s){var a=Te(s),o=0;switch(Yn(a[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=a,delete n[0],o=0;o<Au.length;++o)n[Au[o]]&&(n[Au[o]]=parseInt(n[Au[o]],10));for(o=0;o<Fu.length;++o)n[Fu[o]]&&(n[Fu[o]]=it(n[Fu[o]]));if(t.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[o]){n.numFmtId=o;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var l={};a.vertical&&(l.vertical=a.vertical),a.horizontal&&(l.horizontal=a.horizontal),a.textRotation!=null&&(l.textRotation=a.textRotation),a.indent&&(l.indent=a.indent),a.wrapText&&(l.wrapText=it(a.wrapText)),n.alignment=l;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(r&&r.WTF&&!i)throw new Error("unrecognized "+a[0]+" in cellXfs")}})}function PB(e){var t=[];return t[t.length]=ce("cellXfs",null),e.forEach(function(r){t[t.length]=ce("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=ce("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var OB=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,i=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,l,c){var u={};if(!o)return u;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var f;return(f=o.match(t))&&FB(f,u,c),(f=o.match(i))&&AB(f,u,l,c),(f=o.match(n))&&IB(f,u,l,c),(f=o.match(s))&&CB(f,u,l,c),(f=o.match(r))&&RB(f,u,c),u}}();function FS(e,t){var r=[It,ce("styleSheet",null,{xmlns:_a[0],"xmlns:vt":bt.vt})],n;return e.SSF&&(n=NB(e.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=PB(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function DB(e,t){var r=e.read_shift(2),n=ur(e);return[r,n]}function bB(e,t,r){r||(r=X(6+4*t.length)),r.write_shift(2,e),$t(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function LB(e,t,r){var n={};n.sz=e.read_shift(2)/20;var i=vL(e);i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1);var s=e.read_shift(2);switch(s===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var a=e.read_shift(1);a!=0&&(n.underline=a);var o=e.read_shift(1);o>0&&(n.family=o);var l=e.read_shift(1);switch(l>0&&(n.charset=l),e.l++,n.color=gL(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=ur(e),n}function MB(e,t){t||(t=X(25+4*32)),t.write_shift(2,e.sz*20),xL(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),i0(e.color,t);var n=0;return e.scheme=="major"&&(n=1),e.scheme=="minor"&&(n=2),t.write_shift(1,n),$t(e.name,t),t.length>t.l?t.slice(0,t.l):t}var BB=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Zh,UB=hr;function ny(e,t){t||(t=X(4*3+8*7+16*1)),Zh||(Zh=Y0(BB));var r=Zh[e.patternType];r==null&&(r=40),t.write_shift(4,r);var n=0;if(r!=40)for(i0({auto:1},t),i0({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function WB(e,t){var r=e.l+t,n=e.read_shift(2),i=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:i}}function NS(e,t,r){r||(r=X(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function nl(e,t){return t||(t=X(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var VB=hr;function jB(e,t){return t||(t=X(51)),t.write_shift(1,0),nl(null,t),nl(null,t),nl(null,t),nl(null,t),nl(null,t),t.length>t.l?t.slice(0,t.l):t}function HB(e,t){return t||(t=X(12+4*10)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,+e.builtinId),t.write_shift(1,0),n0(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function zB(e,t,r){var n=X(2052);return n.write_shift(4,e),n0(t,n),n0(r,n),n.length>n.l?n.slice(0,n.l):n}function $B(e,t,r){var n={};n.NumberFmt=[];for(var i in Ee)n.NumberFmt[i]=Ee[i];n.CellXf=[],n.Fonts=[];var s=[],a=!1;return Ai(e,function(l,c,u){switch(u){case 44:n.NumberFmt[l[0]]=l[1],pi(l[1],l[0]);break;case 43:n.Fonts.push(l),l.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(l.color.rgb=o0(t.themeElements.clrScheme[l.color.theme].rgb,l.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&n.CellXf.push(l);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:s.push(u),a=!0;break;case 38:s.pop(),a=!1;break;default:if(c.T>0)s.push(u);else if(c.T<0)s.pop();else if(!a||r.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+u.toString(16))}}),n}function GB(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)t[i]!=null&&++r}),r!=0&&(q(e,615,An(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)t[i]!=null&&q(e,44,bB(i,t[i]))}),q(e,616))}}function KB(e){var t=1;q(e,611,An(t)),q(e,43,MB({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),q(e,612)}function XB(e){var t=2;q(e,603,An(t)),q(e,45,ny({patternType:"none"})),q(e,45,ny({patternType:"gray125"})),q(e,604)}function YB(e){var t=1;q(e,613,An(t)),q(e,46,jB()),q(e,614)}function qB(e){var t=1;q(e,626,An(t)),q(e,47,NS({numFmtId:0,fontId:0,fillId:0,borderId:0},65535)),q(e,627)}function QB(e,t){q(e,617,An(t.length)),t.forEach(function(r){q(e,47,NS(r,0))}),q(e,618)}function JB(e){var t=1;q(e,619,An(t)),q(e,48,HB({xfId:0,builtinId:0,name:"Normal"})),q(e,620)}function ZB(e){var t=0;q(e,505,An(t)),q(e,506)}function e7(e){var t=0;q(e,508,zB(t,"TableStyleMedium9","PivotStyleMedium4")),q(e,509)}function t7(e,t){var r=Or();return q(r,278),GB(r,e.SSF),KB(r),XB(r),YB(r),qB(r),QB(r,t.cellXfs),JB(r),ZB(r),e7(r),q(r,279),r.end()}var r7=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function n7(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(pr)||[]).forEach(function(i){var s=Te(i);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=s.val;break;case"<a:sysClr":n.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(t.themeElements.clrScheme[r7.indexOf(s[0])]=n,n={}):n.name=s[0].slice(3,s[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function i7(){}function s7(){}var a7=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,o7=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,l7=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function c7(e,t,r){t.themeElements={};var n;[["clrScheme",a7,n7],["fontScheme",o7,i7],["fmtScheme",l7,s7]].forEach(function(i){if(!(n=e.match(i[1])))throw new Error(i[0]+" not found in themeElements");i[2](n,t,r)})}var u7=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function RS(e,t){(!e||e.length===0)&&(e=cg());var r,n={};if(!(r=e.match(u7)))throw new Error("themeElements not found in theme");return c7(r[0],n,t),n.raw=e,n}function cg(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[It];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function f7(e,t,r){var n=e.l+t,i=e.read_shift(4);if(i!==124226){if(!r.cellStyles){e.l=n;return}var s=e.slice(e.l);e.l=n;var a;try{a=kT(s,{type:"array"})}catch{return}var o=Wr(a,"theme/theme/theme1.xml",!0);if(o)return RS(o,r)}}function h7(e){return e.read_shift(4)}function d7(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=p7(e,4);break;case 2:t.xclrValue=uS(e);break;case 3:t.xclrValue=h7(e);break;case 4:e.l+=4;break}return e.l+=8,t}function p7(e,t){return hr(e,t)}function m7(e,t){return hr(e,t)}function g7(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=d7(e);break;case 6:n[1]=m7(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function v7(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var i=e.read_shift(2),s=[];i-- >0;)s.push(g7(e,r-e.l));return{ixfe:n,ext:s}}function x7(e,t){t.forEach(function(r){switch(r[0]){}})}function _7(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:ur(e)}}function y7(e){var t=X(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),$t(e.name,t),t.slice(0,t.l)}function w7(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function E7(e){var t=X(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function k7(e,t){var r=X(8+2*t.length);return r.write_shift(4,e),$t(t,r),r.slice(0,r.l)}function T7(e){return e.l+=4,e.read_shift(4)!=0}function S7(e,t){var r=X(8);return r.write_shift(4,e),r.write_shift(4,1),r}function C7(e,t,r){var n={Types:[],Cell:[],Value:[]},i=r||{},s=[],a=!1,o=2;return Ai(e,function(l,c,u){switch(u){case 335:n.Types.push({name:l.name});break;case 51:l.forEach(function(f){o==1?n.Cell.push({type:n.Types[f[0]-1].name,index:f[1]}):o==0&&n.Value.push({type:n.Types[f[0]-1].name,index:f[1]})});break;case 337:o=l?1:0;break;case 338:o=2;break;case 35:s.push(u),a=!0;break;case 36:s.pop(),a=!1;break;default:if(!c.T){if(!a||i.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}}),n}function I7(){var e=Or();return q(e,332),q(e,334,An(1)),q(e,335,y7({name:"XLDAPR",version:12e4,flags:3496657072})),q(e,336),q(e,339,k7(1,"XLDAPR")),q(e,52),q(e,35,An(514)),q(e,4096,An(0)),q(e,4097,rn(1)),q(e,36),q(e,53),q(e,340),q(e,337,S7(1)),q(e,51,E7([[1,0]])),q(e,338),q(e,333),e.end()}function A7(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var i=!1,s=2,a;return e.replace(pr,function(o){var l=Te(o);switch(Yn(l[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:l.name});break;case"</metadataType>":break;case"<futureMetadata":for(var c=0;c<n.Types.length;++c)n.Types[c].name==l.name&&(a=n.Types[c]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?n.Cell.push({type:n.Types[l.t-1].name,index:+l.v}):s==0&&n.Value.push({type:n.Types[l.t-1].name,index:+l.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<rvb":if(!a)break;a.offsets||(a.offsets=[]),a.offsets.push(+l.i);break;default:if(!i&&r.WTF)throw new Error("unrecognized "+l[0]+" in metadata")}return o}),n}function PS(){var e=[It];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function F7(e){var t=[];if(!e)return t;var r=1;return(e.match(pr)||[]).forEach(function(n){var i=Te(n);switch(i[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete i[0],i.i?r=i.i:i.i=r,t.push(i);break}}),t}function N7(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=ke(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function R7(e,t,r){var n=[];return Ai(e,function(s,a,o){switch(o){case 63:n.push(s);break;default:if(!a.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function P7(e,t,r,n){if(!e)return e;var i=n||{},s=!1;Ai(e,function(o,l,c){switch(c){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!l.T){if(!s||i.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}},i)}function O7(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}var $a=1024;function OS(e,t){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),i=[ce("xml",null,{"xmlns:v":Mr.v,"xmlns:o":Mr.o,"xmlns:x":Mr.x,"xmlns:mv":Mr.mv}).replace(/\/>/,">"),ce("o:shapelayout",ce("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),ce("v:shapetype",[ce("v:stroke",null,{joinstyle:"miter"}),ce("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];$a<e*1e3;)$a+=1e3;return t.forEach(function(s){var a=dt(s[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var l=o.type=="gradient"?ce("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,c=ce("v:fill",l,o),u={on:"t",obscured:"t"};++$a,i=i.concat(["<v:shape"+mc({id:"_x0000_s"+$a,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",c,ce("v:shadow",null,u),ce("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Qt("x:Anchor",[a.c+1,0,a.r+1,0,a.c+3,20,a.r+5,20].join(",")),Qt("x:AutoFill","False"),Qt("x:Row",String(a.r)),Qt("x:Column",String(a.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),i.push("</xml>"),i.join("")}function iy(e,t,r,n){var i=Array.isArray(e),s;t.forEach(function(a){var o=dt(a.ref);if(i?(e[o.r]||(e[o.r]=[]),s=e[o.r][o.c]):s=e[a.ref],!s){s={t:"z"},i?e[o.r][o.c]=s:e[a.ref]=s;var l=je(e["!ref"]||"BDWGO1000001:A1");l.s.r>o.r&&(l.s.r=o.r),l.e.r<o.r&&(l.e.r=o.r),l.s.c>o.c&&(l.s.c=o.c),l.e.c<o.c&&(l.e.c=o.c);var c=Ae(l);c!==e["!ref"]&&(e["!ref"]=c)}s.c||(s.c=[]);var u={a:a.author,t:a.t,r:a.r,T:r};a.h&&(u.h=a.h);for(var f=s.c.length-1;f>=0;--f){if(!r&&s.c[f].T)return;r&&!s.c[f].T&&s.c.splice(f,1)}if(r&&n){for(f=0;f<n.length;++f)if(u.a==n[f].id){u.a=n[f].name||u.a;break}}s.c.push(u)})}function D7(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],i=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);i&&i[1]&&i[1].split(/<\/\w*:?author>/).forEach(function(a){if(!(a===""||a.trim()==="")){var o=a.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var s=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(a){if(!(a===""||a.trim()==="")){var o=a.match(/<(?:\w+:)?comment[^>]*>/);if(o){var l=Te(o[0]),c={author:l.authorId&&r[l.authorId]||"sheetjsghost",ref:l.ref,guid:l.guid},u=dt(l.ref);if(!(t.sheetRows&&t.sheetRows<=u.r)){var f=a.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),h=!!f&&!!f[1]&&ag(f[1])||{r:"",t:"",h:""};c.r=h.r,h.r=="<t></t>"&&(h.t=h.h=""),c.t=(h.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(c.h=h.h),n.push(c)}}}}),n}function DS(e){var t=[It,ce("comments",null,{xmlns:_a[0]})],r=[];return t.push("<authors>"),e.forEach(function(n){n[1].forEach(function(i){var s=Ke(i.a);r.indexOf(s)==-1&&(r.push(s),t.push("<author>"+s+"</author>")),i.T&&i.ID&&r.indexOf("tc="+i.ID)==-1&&(r.push("tc="+i.ID),t.push("<author>tc="+i.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(n){var i=0,s=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?i=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(l){l.a&&(i=r.indexOf(Ke(l.a))),s.push(l.t||"")}),t.push('<comment ref="'+n[0]+'" authorId="'+i+'"><text>'),s.length<=1)t.push(Qt("t",Ke(s[0]||"")));else{for(var a=`Comment:
    `+s[0]+`
`,o=1;o<s.length;++o)a+=`Reply:
    `+s[o]+`
`;t.push(Qt("t",Ke(a)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function b7(e,t){var r=[],n=!1,i={},s=0;return e.replace(pr,function(o,l){var c=Te(o);switch(Yn(c[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":i={author:c.personId,guid:c.id,ref:c.ref,T:1};break;case"</threadedComment>":i.t!=null&&r.push(i);break;case"<text>":case"<text":s=l+o.length;break;case"</text>":i.t=e.slice(s,l).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+c[0]+" in threaded comments")}return o}),r}function L7(e,t,r){var n=[It,ce("ThreadedComments",null,{xmlns:bt.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(i){var s="";(i[1]||[]).forEach(function(a,o){if(!a.T){delete a.ID;return}a.a&&t.indexOf(a.a)==-1&&t.push(a.a);var l={ref:i[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};o==0?s=l.id:l.parentId=s,a.ID=l.id,a.a&&(l.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(a.a)).slice(-12)+"}"),n.push(ce("threadedComment",Qt("text",a.t||""),l))})}),n.push("</ThreadedComments>"),n.join("")}function M7(e,t){var r=[],n=!1;return e.replace(pr,function(s){var a=Te(s);switch(Yn(a[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:a.displayname,id:a.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+a[0]+" in threaded comments")}return s}),r}function B7(e){var t=[It,ce("personList",null,{xmlns:bt.TCMNT,"xmlns:x":_a[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,n){t.push(ce("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function U7(e){var t={};t.iauthor=e.read_shift(4);var r=ka(e);return t.rfx=r.s,t.ref=ke(r.s),e.l+=16,t}function W7(e,t){return t==null&&(t=X(36)),t.write_shift(4,e[1].iauthor),Uo(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var V7=ur;function j7(e){return $t(e.slice(0,54))}function H7(e,t){var r=[],n=[],i={},s=!1;return Ai(e,function(o,l,c){switch(c){case 632:n.push(o);break;case 635:i=o;break;case 637:i.t=o.t,i.h=o.h,i.r=o.r;break;case 636:if(i.author=n[i.iauthor],delete i.iauthor,t.sheetRows&&i.rfx&&t.sheetRows<=i.rfx.r)break;i.t||(i.t=""),delete i.rfx,r.push(i);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!l.T){if(!s||t.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}}),r}function z7(e){var t=Or(),r=[];return q(t,628),q(t,630),e.forEach(function(n){n[1].forEach(function(i){r.indexOf(i.a)>-1||(r.push(i.a.slice(0,54)),q(t,632,j7(i.a)))})}),q(t,631),q(t,633),e.forEach(function(n){n[1].forEach(function(i){i.iauthor=r.indexOf(i.a);var s={s:dt(n[0]),e:dt(n[0])};q(t,635,W7([s,i])),i.t&&i.t.length>0&&q(t,637,hL(i)),q(t,636),delete i.iauthor})}),q(t,634),q(t,629),t.end()}var $7="application/vnd.ms-office.vbaProject";function G7(e){var t=we.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var i=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");we.utils.cfb_add(t,i,e.FileIndex[n].content)}}),we.write(t)}function K7(e,t){t.FullPaths.forEach(function(r,n){if(n!=0){var i=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");i.slice(-1)!=="/"&&we.utils.cfb_add(e,i,t.FileIndex[n].content)}})}var bS=["xlsb","xlsm","xlam","biff8","xla"];function X7(){return{"!type":"dialog"}}function Y7(){return{"!type":"dialog"}}function q7(){return{"!type":"macro"}}function Q7(){return{"!type":"macro"}}var ao=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,i,s,a){var o=!1,l=!1;s.length==0?l=!0:s.charAt(0)=="["&&(l=!0,s=s.slice(1,-1)),a.length==0?o=!0:a.charAt(0)=="["&&(o=!0,a=a.slice(1,-1));var c=s.length>0?parseInt(s,10)|0:0,u=a.length>0?parseInt(a,10)|0:0;return o?u+=t.c:--u,l?c+=t.r:--c,i+(o?"":"$")+ht(u)+(l?"":"$")+Ct(c)}return function(i,s){return t=s,i.replace(e,r)}}(),ug=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,fg=function(){return function(t,r){return t.replace(ug,function(n,i,s,a,o,l){var c=Q1(a)-(s?0:r.c),u=q1(l)-(o?0:r.r),f=u==0?"":o?u+1:"["+u+"]",h=c==0?"":s?c+1:"["+c+"]";return i+"R"+f+"C"+h})}}();function LS(e,t){return e.replace(ug,function(r,n,i,s,a,o){return n+(i=="$"?i+s:ht(Q1(s)+t.c))+(a=="$"?a+o:Ct(q1(o)+t.r))})}function J7(e,t,r){var n=Dr(t),i=n.s,s=dt(r),a={r:s.r-i.r,c:s.c-i.c};return LS(e,a)}function Z7(e){return e.length!=1}function sy(e){return e.replace(/_xlfn\./g,"")}function At(e){e.l+=1}function vs(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function MS(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return BS(e);r.biff==12&&(n=4)}var i=e.read_shift(n),s=e.read_shift(n),a=vs(e),o=vs(e);return{s:{r:i,c:a[0],cRel:a[1],rRel:a[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function BS(e){var t=vs(e),r=vs(e),n=e.read_shift(1),i=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:i,cRel:r[1],rRel:r[2]}}}function e9(e,t,r){if(r.biff<8)return BS(e);var n=e.read_shift(r.biff==12?4:2),i=e.read_shift(r.biff==12?4:2),s=vs(e),a=vs(e);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:a[0],cRel:a[1],rRel:a[2]}}}function US(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return t9(e);var n=e.read_shift(r&&r.biff==12?4:2),i=vs(e);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function t9(e){var t=vs(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function r9(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function n9(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return i9(e);var i=e.read_shift(n>=12?4:2),s=e.read_shift(2),a=(s&16384)>>14,o=(s&32768)>>15;if(s&=16383,o==1)for(;i>524287;)i-=1048576;if(a==1)for(;s>8191;)s=s-16384;return{r:i,c:s,cRel:a,rRel:o}}function i9(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,i=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),i==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:i,rRel:n}}function s9(e,t,r){var n=(e[e.l++]&96)>>5,i=MS(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,i]}function a9(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2,"i"),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}var a=MS(e,s,r);return[n,i,a]}function o9(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function l9(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}return e.l+=s,[n,i]}function c9(e,t,r){var n=(e[e.l++]&96)>>5,i=e9(e,t-1,r);return[n,i]}function u9(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function ay(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function f9(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),i=[],s=0;s<=n;++s)i.push(e.read_shift(r&&r.biff==2?1:2));return i}function h9(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function d9(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function p9(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function m9(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function WS(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function g9(e){return e.read_shift(2),WS(e)}function v9(e){return e.read_shift(2),WS(e)}function x9(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=US(e,0,r);return[n,i]}function _9(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=n9(e,0,r);return[n,i]}function y9(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var s=US(e,0,r);return[n,i,s]}function w9(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(r&&r.biff<=3?1:2);return[TU[i],HS[i],n]}function E9(e,t,r){var n=e[e.l++],i=e.read_shift(1),s=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:k9(e);return[i,(s[0]===0?HS:kU)[s[1]]]}function k9(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function T9(e,t,r){e.l+=r&&r.biff==2?3:4}function S9(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function C9(e){return e.l++,Fi[e.read_shift(1)]}function I9(e){return e.l++,e.read_shift(2)}function A9(e){return e.l++,e.read_shift(1)!==0}function F9(e){return e.l++,cr(e)}function N9(e,t,r){return e.l++,zc(e,t-1,r)}function R9(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Tt(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=Fi[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=cr(e);break;case 2:r[1]=Ta(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function P9(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),i=[],s=0;s!=n;++s)i.push((r.biff==12?ka:J0)(e));return i}function O9(e,t,r){var n=0,i=0;r.biff==12?(n=e.read_shift(4),i=e.read_shift(4)):(i=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--i==0&&(i=256));for(var s=0,a=[];s!=n&&(a[s]=[]);++s)for(var o=0;o!=i;++o)a[s][o]=R9(e,r.biff);return a}function D9(e,t,r){var n=e.read_shift(1)>>>5&3,i=!r||r.biff>=8?4:2,s=e.read_shift(i);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,s]}function b9(e,t,r){if(r.biff==5)return L9(e);var n=e.read_shift(1)>>>5&3,i=e.read_shift(2),s=e.read_shift(4);return[n,i,s]}function L9(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function M9(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function B9(e,t,r){var n=e.read_shift(1)>>>5&3,i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function U9(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function W9(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6;break}return e.l+=s,[n,i]}var V9=hr,j9=hr,H9=hr;function Gc(e,t,r){return e.l+=2,[r9(e)]}function hg(e){return e.l+=6,[]}var z9=Gc,$9=hg,G9=hg,K9=Gc;function VS(e){return e.l+=2,[Nt(e),e.read_shift(2)&1]}var X9=Gc,Y9=VS,q9=hg,Q9=Gc,J9=Gc,Z9=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function eU(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),i=e.read_shift(2),s=e.read_shift(2),a=Z9[r>>2&31];return{ixti:t,coltype:r&3,rt:a,idx:n,c:i,C:s}}function tU(e){return e.l+=2,[e.read_shift(4)]}function rU(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function nU(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function iU(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function sU(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function aU(e){return e.l+=4,[0,0]}var oy={1:{n:"PtgExp",f:S9},2:{n:"PtgTbl",f:H9},3:{n:"PtgAdd",f:At},4:{n:"PtgSub",f:At},5:{n:"PtgMul",f:At},6:{n:"PtgDiv",f:At},7:{n:"PtgPower",f:At},8:{n:"PtgConcat",f:At},9:{n:"PtgLt",f:At},10:{n:"PtgLe",f:At},11:{n:"PtgEq",f:At},12:{n:"PtgGe",f:At},13:{n:"PtgGt",f:At},14:{n:"PtgNe",f:At},15:{n:"PtgIsect",f:At},16:{n:"PtgUnion",f:At},17:{n:"PtgRange",f:At},18:{n:"PtgUplus",f:At},19:{n:"PtgUminus",f:At},20:{n:"PtgPercent",f:At},21:{n:"PtgParen",f:At},22:{n:"PtgMissArg",f:At},23:{n:"PtgStr",f:N9},26:{n:"PtgSheet",f:rU},27:{n:"PtgEndSheet",f:nU},28:{n:"PtgErr",f:C9},29:{n:"PtgBool",f:A9},30:{n:"PtgInt",f:I9},31:{n:"PtgNum",f:F9},32:{n:"PtgArray",f:u9},33:{n:"PtgFunc",f:w9},34:{n:"PtgFuncVar",f:E9},35:{n:"PtgName",f:D9},36:{n:"PtgRef",f:x9},37:{n:"PtgArea",f:s9},38:{n:"PtgMemArea",f:M9},39:{n:"PtgMemErr",f:V9},40:{n:"PtgMemNoMem",f:j9},41:{n:"PtgMemFunc",f:B9},42:{n:"PtgRefErr",f:U9},43:{n:"PtgAreaErr",f:o9},44:{n:"PtgRefN",f:_9},45:{n:"PtgAreaN",f:c9},46:{n:"PtgMemAreaN",f:iU},47:{n:"PtgMemNoMemN",f:sU},57:{n:"PtgNameX",f:b9},58:{n:"PtgRef3d",f:y9},59:{n:"PtgArea3d",f:a9},60:{n:"PtgRefErr3d",f:W9},61:{n:"PtgAreaErr3d",f:l9},255:{}},oU={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},lU={1:{n:"PtgElfLel",f:VS},2:{n:"PtgElfRw",f:Q9},3:{n:"PtgElfCol",f:z9},6:{n:"PtgElfRwV",f:J9},7:{n:"PtgElfColV",f:K9},10:{n:"PtgElfRadical",f:X9},11:{n:"PtgElfRadicalS",f:q9},13:{n:"PtgElfColS",f:$9},15:{n:"PtgElfColSV",f:G9},16:{n:"PtgElfRadicalLel",f:Y9},25:{n:"PtgList",f:eU},29:{n:"PtgSxName",f:tU},255:{}},cU={0:{n:"PtgAttrNoop",f:aU},1:{n:"PtgAttrSemi",f:m9},2:{n:"PtgAttrIf",f:d9},4:{n:"PtgAttrChoose",f:f9},8:{n:"PtgAttrGoto",f:h9},16:{n:"PtgAttrSum",f:T9},32:{n:"PtgAttrBaxcel",f:ay},33:{n:"PtgAttrBaxcel",f:ay},64:{n:"PtgAttrSpace",f:g9},65:{n:"PtgAttrSpaceSemi",f:v9},128:{n:"PtgAttrIfError",f:p9},255:{}};function Kc(e,t,r,n){if(n.biff<8)return hr(e,t);for(var i=e.l+t,s=[],a=0;a!==r.length;++a)switch(r[a][0]){case"PtgArray":r[a][1]=O9(e,0,n),s.push(r[a][1]);break;case"PtgMemArea":r[a][2]=P9(e,r[a][1],n),s.push(r[a][2]);break;case"PtgExp":n&&n.biff==12&&(r[a][1][1]=e.read_shift(4),s.push(r[a][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[a][0]}return t=i-e.l,t!==0&&s.push(hr(e,t)),s}function Xc(e,t,r){for(var n=e.l+t,i,s,a=[];n!=e.l;)t=n-e.l,s=e[e.l],i=oy[s]||oy[oU[s]],(s===24||s===25)&&(i=(s===24?lU:cU)[e[e.l+1]]),!i||!i.f?hr(e,t):a.push([i.n,i.f(e,t,r)]);return a}function uU(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],i=[],s=0;s<n.length;++s){var a=n[s];if(a)switch(a[0]){case 2:i.push('"'+a[1].replace(/"/g,'""')+'"');break;default:i.push(a[1])}else i.push("")}t.push(i.join(","))}return t.join(";")}var fU={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function hU(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function jS(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var i="";if(r.biff>8)switch(e[n[0]][0]){case 357:return i=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return i=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return e[n[0]][0][3]?(i=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function ly(e,t,r){var n=jS(e,t,r);return n=="#REF"?n:hU(n,r)}function ar(e,t,r,n,i){var s=i&&i.biff||8,a={s:{c:0,r:0},e:{c:0,r:0}},o=[],l,c,u,f=0,h=0,d,m="";if(!e[0]||!e[0][0])return"";for(var p=-1,g="",x=0,_=e[0].length;x<_;++x){var v=e[0][x];switch(v[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=o.pop(),c=o.pop(),p>=0){switch(e[0][p][1][0]){case 0:g=vt(" ",e[0][p][1][1]);break;case 1:g=vt("\r",e[0][p][1][1]);break;default:if(g="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}c=c+g,p=-1}o.push(c+fU[v[0]]+l);break;case"PtgIsect":l=o.pop(),c=o.pop(),o.push(c+" "+l);break;case"PtgUnion":l=o.pop(),c=o.pop(),o.push(c+","+l);break;case"PtgRange":l=o.pop(),c=o.pop(),o.push(c+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":u=Fl(v[1][1],a,i),o.push(Nl(u,s));break;case"PtgRefN":u=r?Fl(v[1][1],r,i):v[1][1],o.push(Nl(u,s));break;case"PtgRef3d":f=v[1][1],u=Fl(v[1][2],a,i),m=ly(n,f,i),o.push(m+"!"+Nl(u,s));break;case"PtgFunc":case"PtgFuncVar":var E=v[1][0],N=v[1][1];E||(E=0),E&=127;var I=E==0?[]:o.slice(-E);o.length-=E,N==="User"&&(N=I.shift()),o.push(N+"("+I.join(",")+")");break;case"PtgBool":o.push(v[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(v[1]);break;case"PtgNum":o.push(String(v[1]));break;case"PtgStr":o.push('"'+v[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(v[1]);break;case"PtgAreaN":d=M_(v[1][1],r?{s:r}:a,i),o.push(Yh(d,i));break;case"PtgArea":d=M_(v[1][1],a,i),o.push(Yh(d,i));break;case"PtgArea3d":f=v[1][1],d=v[1][2],m=ly(n,f,i),o.push(m+"!"+Yh(d,i));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":h=v[1][2];var w=(n.names||[])[h-1]||(n[0]||[])[h],O=w?w.Name:"SH33TJSNAME"+String(h);O&&O.slice(0,6)=="_xlfn."&&!i.xlfn&&(O=O.slice(6)),o.push(O);break;case"PtgNameX":var P=v[1][1];h=v[1][2];var W;if(i.biff<=5)P<0&&(P=-P),n[P]&&(W=n[P][h]);else{var j="";if(((n[P]||[])[0]||[])[0]==14849||(((n[P]||[])[0]||[])[0]==1025?n[P][h]&&n[P][h].itab>0&&(j=n.SheetNames[n[P][h].itab-1]+"!"):j=n.SheetNames[h-1]+"!"),n[P]&&n[P][h])j+=n[P][h].Name;else if(n[0]&&n[0][h])j+=n[0][h].Name;else{var U=(jS(n,P,i)||"").split(";;");U[h-1]?j=U[h-1]:j+="SH33TJSERRX"}o.push(j);break}W||(W={Name:"SH33TJSERRY"}),o.push(W.Name);break;case"PtgParen":var J="(",ge=")";if(p>=0){switch(g="",e[0][p][1][0]){case 2:J=vt(" ",e[0][p][1][1])+J;break;case 3:J=vt("\r",e[0][p][1][1])+J;break;case 4:ge=vt(" ",e[0][p][1][1])+ge;break;case 5:ge=vt("\r",e[0][p][1][1])+ge;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}p=-1}o.push(J+o.pop()+ge);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":u={c:v[1][1],r:v[1][0]};var fe={c:r.c,r:r.r};if(n.sharedf[ke(u)]){var ve=n.sharedf[ke(u)];o.push(ar(ve,a,fe,n,i))}else{var de=!1;for(l=0;l!=n.arrayf.length;++l)if(c=n.arrayf[l],!(u.c<c[0].s.c||u.c>c[0].e.c)&&!(u.r<c[0].s.r||u.r>c[0].e.r)){o.push(ar(c[1],a,fe,n,i)),de=!0;break}de||o.push(v[1])}break;case"PtgArray":o.push("{"+uU(v[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":p=x;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+v[1].idx+"[#"+v[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(v));default:throw new Error("Unrecognized Formula Token: "+String(v))}var ee=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&p>=0&&ee.indexOf(e[0][x][0])==-1){v=e[0][p];var M=!0;switch(v[1][0]){case 4:M=!1;case 0:g=vt(" ",v[1][1]);break;case 5:M=!1;case 1:g=vt("\r",v[1][1]);break;default:if(g="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+v[1][0])}o.push((M?g:"")+o.pop()+(M?"":g)),p=-1}}if(o.length>1&&i.WTF)throw new Error("bad formula stack");return o[0]}function dU(e,t,r){var n=e.l+t,i=r.biff==2?1:2,s,a=e.read_shift(i);if(a==65535)return[[],hr(e,t-2)];var o=Xc(e,a,r);return t!==a+i&&(s=Kc(e,t-a-i,o,r)),e.l=n,[o,s]}function pU(e,t,r){var n=e.l+t,i=r.biff==2?1:2,s,a=e.read_shift(i);if(a==65535)return[[],hr(e,t-2)];var o=Xc(e,a,r);return t!==a+i&&(s=Kc(e,t-a-i,o,r)),e.l=n,[o,s]}function mU(e,t,r,n){var i=e.l+t,s=Xc(e,n,r),a;return i!==e.l&&(a=Kc(e,i-e.l,s,r)),[s,a]}function gU(e,t,r){var n=e.l+t,i,s=e.read_shift(2),a=Xc(e,s,r);return s==65535?[[],hr(e,t-2)]:(t!==s+2&&(i=Kc(e,n-s-2,a,r)),[a,i])}function vU(e){var t;if(ui(e,e.l+6)!==65535)return[cr(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function xU(e){if(e==null){var t=X(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return aa(e);return aa(0)}function ed(e,t,r){var n=e.l+t,i=qn(e);r.biff==2&&++e.l;var s=vU(e),a=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var o=pU(e,n-e.l,r);return{cell:i,val:s[0],formula:o,shared:a>>3&1,tt:s[1]}}function _U(e,t,r,n,i){var s=la(t,r,i),a=xU(e.v),o=X(6),l=33;o.write_shift(2,l),o.write_shift(4,0);for(var c=X(e.bf.length),u=0;u<e.bf.length;++u)c[u]=e.bf[u];var f=zt([s,a,o,c]);return f}function Z0(e,t,r){var n=e.read_shift(4),i=Xc(e,n,r),s=e.read_shift(4),a=s>0?Kc(e,s,i,r):null;return[i,a]}var yU=Z0,eh=Z0,wU=Z0,EU=Z0,kU={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},HS={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},TU={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function cy(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function SU(e){var t="of:="+e.replace(ug,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function td(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function CU(e){return e.replace(/\./,"!")}var Pl={},oo={},Ol=typeof Map<"u";function dg(e,t,r){var n=0,i=e.length;if(r){if(Ol?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var s=Ol?r.get(t):r[t];n<s.length;++n)if(e[s[n]].t===t)return e.Count++,s[n]}}else for(;n<i;++n)if(e[n].t===t)return e.Count++,n;return e[i]={t},e.Count++,e.Unique++,r&&(Ol?(r.has(t)||r.set(t,[]),r.get(t).push(i)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(i))),i}function th(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(lr=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?n=yc(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(r.width=l0(n),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function Gs(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function Is(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"],i=60,s=e.length;if(n==null&&r.ssf){for(;i<392;++i)if(r.ssf[i]==null){pi(t.z,i),r.ssf[i]=t.z,r.revssf[t.z]=n=i;break}}for(i=0;i!=s;++i)if(e[i].numFmtId===n)return i;return e[s]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function zS(e,t,r,n,i,s){try{n.cellNF&&(e.z=Ee[t])}catch(o){if(n.WTF)throw o}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=at(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(Ee[t]==null&&pi(k6[t]||"General",t),e.t==="e")e.w=e.w||Fi[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=dc(e.v);else if(e.t==="d"){var a=Mt(e.v);(a|0)===a?e.w=a.toString(10):e.w=dc(a)}else{if(e.v===void 0)return"";e.w=ia(e.v,oo)}else e.t==="d"?e.w=hn(t,Mt(e.v),oo):e.w=hn(t,e.v,oo)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&r!=null)try{e.s=s.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=o0(i.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=i.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=o0(i.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=i.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&s.Fills)throw o}}}function IU(e,t,r){if(e&&e["!ref"]){var n=je(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function AU(e,t){var r=je(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=Ae(r))}var FU=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,NU=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,RU=/<(?:\w:)?hyperlink [^>]*>/mg,PU=/"(\w*:\w*)"/,OU=/<(?:\w:)?col\b[^>]*[\/]?>/g,DU=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,bU=/<(?:\w:)?pageMargins[^>]*\/>/g,$S=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,LU=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,MU=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function BU(e,t,r,n,i,s,a){if(!e)return e;n||(n={"!id":{}});var o=t.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},c="",u="",f=e.match(NU);f?(c=e.slice(0,f.index),u=e.slice(f.index+f[0].length)):c=u=e;var h=c.match($S);h?pg(h[0],o,i,r):(h=c.match(LU))&&WU(h[0],h[1]||"",o,i,r);var d=(c.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(d>0){var m=c.slice(d,d+50).match(PU);m&&AU(o,m[1])}var p=c.match(MU);p&&p[1]&&ZU(p[1],i);var g=[];if(t.cellStyles){var x=c.match(OU);x&&XU(g,x)}f&&rW(f[1],o,t,l,s,a);var _=u.match(DU);_&&(o["!autofilter"]=qU(_[0]));var v=[],E=u.match(FU);if(E)for(d=0;d!=E.length;++d)v[d]=je(E[d].slice(E[d].indexOf('"')+1));var N=u.match(RU);N&&$U(o,N,n);var I=u.match(bU);if(I&&(o["!margins"]=GU(Te(I[0]))),!o["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(o["!ref"]=Ae(l)),t.sheetRows>0&&o["!ref"]){var w=je(o["!ref"]);t.sheetRows<=+w.e.r&&(w.e.r=t.sheetRows-1,w.e.r>l.e.r&&(w.e.r=l.e.r),w.e.r<w.s.r&&(w.s.r=w.e.r),w.e.c>l.e.c&&(w.e.c=l.e.c),w.e.c<w.s.c&&(w.s.c=w.e.c),o["!fullref"]=o["!ref"],o["!ref"]=Ae(w))}return g.length>0&&(o["!cols"]=g),v.length>0&&(o["!merges"]=v),o}function UU(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+Ae(e[r])+'"/>';return t+"</mergeCells>"}function pg(e,t,r,n){var i=Te(e);r.Sheets[n]||(r.Sheets[n]={}),i.codeName&&(r.Sheets[n].CodeName=Ve(qe(i.codeName)))}function WU(e,t,r,n,i){pg(e.slice(0,e.indexOf(">")),r,n,i)}function VU(e,t,r,n,i){var s=!1,a={},o=null;if(n.bookType!=="xlsx"&&t.vbaraw){var l=t.SheetNames[r];try{t.Workbook&&(l=t.Workbook.Sheets[r].CodeName||l)}catch{}s=!0,a.codeName=Wn(Ke(l))}if(e&&e["!outline"]){var c={summaryBelow:1,summaryRight:1};e["!outline"].above&&(c.summaryBelow=0),e["!outline"].left&&(c.summaryRight=0),o=(o||"")+ce("outlinePr",null,c)}!s&&!o||(i[i.length]=ce("sheetPr",o,a))}var jU=["objects","scenarios","selectLockedCells","selectUnlockedCells"],HU=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function zU(e){var t={sheet:1};return jU.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),HU.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=og(e.password).toString(16).toUpperCase()),ce("sheetProtection",null,t)}function $U(e,t,r){for(var n=Array.isArray(e),i=0;i!=t.length;++i){var s=Te(qe(t[i]),!0);if(!s.ref)return;var a=((r||{})["!id"]||[])[s.id];a?(s.Target=a.Target,s.location&&(s.Target+="#"+Ve(s.location))):(s.Target="#"+Ve(s.location),a={Target:s.Target,TargetMode:"Internal"}),s.Rel=a,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var o=je(s.ref),l=o.s.r;l<=o.e.r;++l)for(var c=o.s.c;c<=o.e.c;++c){var u=ke({c,r:l});n?(e[l]||(e[l]=[]),e[l][c]||(e[l][c]={t:"z",v:void 0}),e[l][c].l=s):(e[u]||(e[u]={t:"z",v:void 0}),e[u].l=s)}}}function GU(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function KU(e){return Gs(e),ce("pageMargins",null,e)}function XU(e,t){for(var r=!1,n=0;n!=t.length;++n){var i=Te(t[n],!0);i.hidden&&(i.hidden=it(i.hidden));var s=parseInt(i.min,10)-1,a=parseInt(i.max,10)-1;for(i.outlineLevel&&(i.level=+i.outlineLevel||0),delete i.min,delete i.max,i.width=+i.width,!r&&i.width&&(r=!0,lg(i.width)),gs(i);s<=a;)e[s++]=ot(i)}}function YU(e,t){for(var r=["<cols>"],n,i=0;i!=t.length;++i)(n=t[i])&&(r[r.length]=ce("col",null,th(i,n)));return r[r.length]="</cols>",r.join("")}function qU(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function QU(e,t,r,n){var i=typeof e.ref=="string"?e.ref:Ae(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,a=Dr(i);a.s.r==a.e.r&&(a.e.r=Dr(t["!ref"]).e.r,i=Ae(a));for(var o=0;o<s.length;++o){var l=s[o];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==n){l.Ref="'"+r.SheetNames[n]+"'!"+i;break}}return o==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+i}),ce("autoFilter",null,{ref:i})}var JU=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function ZU(e,t){t.Views||(t.Views=[{}]),(e.match(JU)||[]).forEach(function(r,n){var i=Te(r);t.Views[n]||(t.Views[n]={}),+i.zoomScale&&(t.Views[n].zoom=+i.zoomScale),it(i.rightToLeft)&&(t.Views[n].RTL=!0)})}function eW(e,t,r,n){var i={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),ce("sheetViews",ce("sheetView",null,i),{})}function tW(e,t,r,n){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var i="",s=e.t,a=e.v;if(e.t!=="z")switch(e.t){case"b":i=e.v?"1":"0";break;case"n":i=""+e.v;break;case"e":i=Fi[e.v];break;case"d":n&&n.cellDates?i=at(e.v,-1).toISOString():(e=ot(e),e.t="n",i=""+(e.v=Mt(at(e.v)))),typeof e.z>"u"&&(e.z=Ee[14]);break;default:i=e.v;break}var o=Qt("v",Ke(i)),l={r:t},c=Is(n.cellXfs,e,n);switch(c!==0&&(l.s=c),e.t){case"n":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){o=Qt("v",""+dg(n.Strings,e.v,n.revStrings)),l.t="s";break}l.t="str";break}if(e.t!=s&&(e.t=s,e.v=a),typeof e.f=="string"&&e.f){var u=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;o=ce("f",Ke(e.f),u)+(e.v!=null?o:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(l.cm=1),ce("c",o,l)}var rW=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,i=/ref=["']([^"']*)["']/,s=pc("v"),a=pc("f");return function(l,c,u,f,h,d){for(var m=0,p="",g=[],x=[],_=0,v=0,E=0,N="",I,w,O=0,P=0,W,j,U=0,J=0,ge=Array.isArray(d.CellXf),fe,ve=[],de=[],ee=Array.isArray(c),M=[],se={},xe=!1,A=!!u.sheetStubs,B=l.split(t),D=0,b=B.length;D!=b;++D){p=B[D].trim();var K=p.length;if(K!==0){var ie=0;e:for(m=0;m<K;++m)switch(p[m]){case">":if(p[m-1]!="/"){++m;break e}if(u&&u.cellStyles){if(w=Te(p.slice(ie,m),!0),O=w.r!=null?parseInt(w.r,10):O+1,P=-1,u.sheetRows&&u.sheetRows<O)continue;se={},xe=!1,w.ht&&(xe=!0,se.hpt=parseFloat(w.ht),se.hpx=So(se.hpt)),w.hidden=="1"&&(xe=!0,se.hidden=!0),w.outlineLevel!=null&&(xe=!0,se.level=+w.outlineLevel),xe&&(M[O-1]=se)}break;case"<":ie=m;break}if(ie>=m)break;if(w=Te(p.slice(ie,m),!0),O=w.r!=null?parseInt(w.r,10):O+1,P=-1,!(u.sheetRows&&u.sheetRows<O)){f.s.r>O-1&&(f.s.r=O-1),f.e.r<O-1&&(f.e.r=O-1),u&&u.cellStyles&&(se={},xe=!1,w.ht&&(xe=!0,se.hpt=parseFloat(w.ht),se.hpx=So(se.hpt)),w.hidden=="1"&&(xe=!0,se.hidden=!0),w.outlineLevel!=null&&(xe=!0,se.level=+w.outlineLevel),xe&&(M[O-1]=se)),g=p.slice(m).split(e);for(var le=0;le!=g.length&&g[le].trim().charAt(0)=="<";++le);for(g=g.slice(le),m=0;m!=g.length;++m)if(p=g[m].trim(),p.length!==0){if(x=p.match(r),_=m,v=0,E=0,p="<c "+(p.slice(0,1)=="<"?">":"")+p,x!=null&&x.length===2){for(_=0,N=x[1],v=0;v!=N.length&&!((E=N.charCodeAt(v)-64)<1||E>26);++v)_=26*_+E;--_,P=_}else++P;for(v=0;v!=p.length&&p.charCodeAt(v)!==62;++v);if(++v,w=Te(p.slice(0,v),!0),w.r||(w.r=ke({r:O-1,c:P})),N=p.slice(v),I={t:""},(x=N.match(s))!=null&&x[1]!==""&&(I.v=Ve(x[1])),u.cellFormula){if((x=N.match(a))!=null&&x[1]!==""){if(I.f=Ve(qe(x[1])).replace(/\r\n/g,`
`),u.xlfn||(I.f=sy(I.f)),x[0].indexOf('t="array"')>-1)I.F=(N.match(i)||[])[1],I.F.indexOf(":")>-1&&ve.push([je(I.F),I.F]);else if(x[0].indexOf('t="shared"')>-1){j=Te(x[0]);var ne=Ve(qe(x[1]));u.xlfn||(ne=sy(ne)),de[parseInt(j.si,10)]=[j,ne,w.r]}}else(x=N.match(/<f[^>]*\/>/))&&(j=Te(x[0]),de[j.si]&&(I.f=J7(de[j.si][1],de[j.si][2],w.r)));var Z=dt(w.r);for(v=0;v<ve.length;++v)Z.r>=ve[v][0].s.r&&Z.r<=ve[v][0].e.r&&Z.c>=ve[v][0].s.c&&Z.c<=ve[v][0].e.c&&(I.F=ve[v][1])}if(w.t==null&&I.v===void 0)if(I.f||I.F)I.v=0,I.t="n";else if(A)I.t="z";else continue;else I.t=w.t||"n";switch(f.s.c>P&&(f.s.c=P),f.e.c<P&&(f.e.c=P),I.t){case"n":if(I.v==""||I.v==null){if(!A)continue;I.t="z"}else I.v=parseFloat(I.v);break;case"s":if(typeof I.v>"u"){if(!A)continue;I.t="z"}else W=Pl[parseInt(I.v,10)],I.v=W.t,I.r=W.r,u.cellHTML&&(I.h=W.h);break;case"str":I.t="s",I.v=I.v!=null?qe(I.v):"",u.cellHTML&&(I.h=G1(I.v));break;case"inlineStr":x=N.match(n),I.t="s",x!=null&&(W=ag(x[1]))?(I.v=W.t,u.cellHTML&&(I.h=W.h)):I.v="";break;case"b":I.v=it(I.v);break;case"d":u.cellDates?I.v=at(I.v,1):(I.v=Mt(at(I.v,1)),I.t="n");break;case"e":(!u||u.cellText!==!1)&&(I.w=I.v),I.v=KT[I.v];break}if(U=J=0,fe=null,ge&&w.s!==void 0&&(fe=d.CellXf[w.s],fe!=null&&(fe.numFmtId!=null&&(U=fe.numFmtId),u.cellStyles&&fe.fillId!=null&&(J=fe.fillId))),zS(I,U,J,u,h,d),u.cellDates&&ge&&I.t=="n"&&Lo(Ee[U])&&(I.t="d",I.v=Q0(I.v)),w.cm&&u.xlmeta){var Ne=(u.xlmeta.Cell||[])[+w.cm-1];Ne&&Ne.type=="XLDAPR"&&(I.D=!0)}if(ee){var R=dt(w.r);c[R.r]||(c[R.r]=[]),c[R.r][R.c]=I}else c[w.r]=I}}}}M.length>0&&(c["!rows"]=M)}}();function nW(e,t,r,n){var i=[],s=[],a=je(e["!ref"]),o="",l,c="",u=[],f=0,h=0,d=e["!rows"],m=Array.isArray(e),p={r:c},g,x=-1;for(h=a.s.c;h<=a.e.c;++h)u[h]=ht(h);for(f=a.s.r;f<=a.e.r;++f){for(s=[],c=Ct(f),h=a.s.c;h<=a.e.c;++h){l=u[h]+c;var _=m?(e[f]||[])[h]:e[l];_!==void 0&&(o=tW(_,l,e,t))!=null&&s.push(o)}(s.length>0||d&&d[f])&&(p={r:c},d&&d[f]&&(g=d[f],g.hidden&&(p.hidden=1),x=-1,g.hpx?x=wc(g.hpx):g.hpt&&(x=g.hpt),x>-1&&(p.ht=x,p.customHeight=1),g.level&&(p.outlineLevel=g.level)),i[i.length]=ce("row",s.join(""),p))}if(d)for(;f<d.length;++f)d&&d[f]&&(p={r:f+1},g=d[f],g.hidden&&(p.hidden=1),x=-1,g.hpx?x=wc(g.hpx):g.hpt&&(x=g.hpt),x>-1&&(p.ht=x,p.customHeight=1),g.level&&(p.outlineLevel=g.level),i[i.length]=ce("row","",p));return i.join("")}function GS(e,t,r,n){var i=[It,ce("worksheet",null,{xmlns:_a[0],"xmlns:r":bt.r})],s=r.SheetNames[e],a=0,o="",l=r.Sheets[s];l==null&&(l={});var c=l["!ref"]||"A1",u=je(c);if(u.e.c>16383||u.e.r>1048575){if(t.WTF)throw new Error("Range "+c+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575),c=Ae(u)}n||(n={}),l["!comments"]=[];var f=[];VU(l,r,e,t,i),i[i.length]=ce("dimension",null,{ref:c}),i[i.length]=eW(l,t,e,r),t.sheetFormat&&(i[i.length]=ce("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),l["!cols"]!=null&&l["!cols"].length>0&&(i[i.length]=YU(l,l["!cols"])),i[a=i.length]="<sheetData/>",l["!links"]=[],l["!ref"]!=null&&(o=nW(l,t),o.length>0&&(i[i.length]=o)),i.length>a+1&&(i[i.length]="</sheetData>",i[a]=i[a].replace("/>",">")),l["!protect"]&&(i[i.length]=zU(l["!protect"])),l["!autofilter"]!=null&&(i[i.length]=QU(l["!autofilter"],l,r,e)),l["!merges"]!=null&&l["!merges"].length>0&&(i[i.length]=UU(l["!merges"]));var h=-1,d,m=-1;return l["!links"].length>0&&(i[i.length]="<hyperlinks>",l["!links"].forEach(function(p){p[1].Target&&(d={ref:p[0]},p[1].Target.charAt(0)!="#"&&(m=Ge(n,-1,Ke(p[1].Target).replace(/#.*$/,""),Oe.HLINK),d["r:id"]="rId"+m),(h=p[1].Target.indexOf("#"))>-1&&(d.location=Ke(p[1].Target.slice(h+1))),p[1].Tooltip&&(d.tooltip=Ke(p[1].Tooltip)),i[i.length]=ce("hyperlink",null,d))}),i[i.length]="</hyperlinks>"),delete l["!links"],l["!margins"]!=null&&(i[i.length]=KU(l["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(i[i.length]=Qt("ignoredErrors",ce("ignoredError",null,{numberStoredAsText:1,sqref:c}))),f.length>0&&(m=Ge(n,-1,"../drawings/drawing"+(e+1)+".xml",Oe.DRAW),i[i.length]=ce("drawing",null,{"r:id":"rId"+m}),l["!drawing"]=f),l["!comments"].length>0&&(m=Ge(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",Oe.VML),i[i.length]=ce("legacyDrawing",null,{"r:id":"rId"+m}),l["!legacy"]=m),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function iW(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var i=e.read_shift(2);e.l+=1;var s=e.read_shift(1);return e.l=n,s&7&&(r.level=s&7),s&16&&(r.hidden=!0),s&32&&(r.hpt=i/20),r}function sW(e,t,r){var n=X(145),i=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var s=320;i.hpx?s=wc(i.hpx)*20:i.hpt&&(s=i.hpt*20),n.write_shift(2,s),n.write_shift(1,0);var a=0;i.level&&(a|=i.level),i.hidden&&(a|=16),(i.hpx||i.hpt)&&(a|=32),n.write_shift(1,a),n.write_shift(1,0);var o=0,l=n.l;n.l+=4;for(var c={r:e,c:0},u=0;u<16;++u)if(!(t.s.c>u+1<<10||t.e.c<u<<10)){for(var f=-1,h=-1,d=u<<10;d<u+1<<10;++d){c.c=d;var m=Array.isArray(r)?(r[c.r]||[])[c.c]:r[ke(c)];m&&(f<0&&(f=d),h=d)}f<0||(++o,n.write_shift(4,f),n.write_shift(4,h))}var p=n.l;return n.l=l,n.write_shift(4,o),n.l=p,n.length>n.l?n.slice(0,n.l):n}function aW(e,t,r,n){var i=sW(n,r,t);(i.length>17||(t["!rows"]||[])[n])&&q(e,0,i)}var oW=ka,lW=Uo;function cW(){}function uW(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=dL(e),r}function fW(e,t,r){r==null&&(r=X(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var i=1;i<3;++i)r.write_shift(1,0);return i0({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),jT(e,r),r.slice(0,r.l)}function hW(e){var t=dn(e);return[t]}function dW(e,t,r){return r==null&&(r=X(8)),ya(t,r)}function pW(e){var t=wa(e);return[t]}function mW(e,t,r){return r==null&&(r=X(4)),Ea(t,r)}function gW(e){var t=dn(e),r=e.read_shift(1);return[t,r,"b"]}function vW(e,t,r){return r==null&&(r=X(9)),ya(t,r),r.write_shift(1,e.v?1:0),r}function xW(e){var t=wa(e),r=e.read_shift(1);return[t,r,"b"]}function _W(e,t,r){return r==null&&(r=X(5)),Ea(t,r),r.write_shift(1,e.v?1:0),r}function yW(e){var t=dn(e),r=e.read_shift(1);return[t,r,"e"]}function wW(e,t,r){return r==null&&(r=X(9)),ya(t,r),r.write_shift(1,e.v),r}function EW(e){var t=wa(e),r=e.read_shift(1);return[t,r,"e"]}function kW(e,t,r){return r==null&&(r=X(8)),Ea(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function TW(e){var t=dn(e),r=e.read_shift(4);return[t,r,"s"]}function SW(e,t,r){return r==null&&(r=X(12)),ya(t,r),r.write_shift(4,t.v),r}function CW(e){var t=wa(e),r=e.read_shift(4);return[t,r,"s"]}function IW(e,t,r){return r==null&&(r=X(8)),Ea(t,r),r.write_shift(4,t.v),r}function AW(e){var t=dn(e),r=cr(e);return[t,r,"n"]}function FW(e,t,r){return r==null&&(r=X(16)),ya(t,r),aa(e.v,r),r}function KS(e){var t=wa(e),r=cr(e);return[t,r,"n"]}function NW(e,t,r){return r==null&&(r=X(12)),Ea(t,r),aa(e.v,r),r}function RW(e){var t=dn(e),r=tg(e);return[t,r,"n"]}function PW(e,t,r){return r==null&&(r=X(12)),ya(t,r),HT(e.v,r),r}function OW(e){var t=wa(e),r=tg(e);return[t,r,"n"]}function DW(e,t,r){return r==null&&(r=X(8)),Ea(t,r),HT(e.v,r),r}function bW(e){var t=dn(e),r=J1(e);return[t,r,"is"]}function LW(e){var t=dn(e),r=ur(e);return[t,r,"str"]}function MW(e,t,r){return r==null&&(r=X(12+4*e.v.length)),ya(t,r),$t(e.v,r),r.length>r.l?r.slice(0,r.l):r}function BW(e){var t=wa(e),r=ur(e);return[t,r,"str"]}function UW(e,t,r){return r==null&&(r=X(8+4*e.v.length)),Ea(t,r),$t(e.v,r),r.length>r.l?r.slice(0,r.l):r}function WW(e,t,r){var n=e.l+t,i=dn(e);i.r=r["!row"];var s=e.read_shift(1),a=[i,s,"b"];if(r.cellFormula){e.l+=2;var o=eh(e,n-e.l,r);a[3]=ar(o,null,i,r.supbooks,r)}else e.l=n;return a}function VW(e,t,r){var n=e.l+t,i=dn(e);i.r=r["!row"];var s=e.read_shift(1),a=[i,s,"e"];if(r.cellFormula){e.l+=2;var o=eh(e,n-e.l,r);a[3]=ar(o,null,i,r.supbooks,r)}else e.l=n;return a}function jW(e,t,r){var n=e.l+t,i=dn(e);i.r=r["!row"];var s=cr(e),a=[i,s,"n"];if(r.cellFormula){e.l+=2;var o=eh(e,n-e.l,r);a[3]=ar(o,null,i,r.supbooks,r)}else e.l=n;return a}function HW(e,t,r){var n=e.l+t,i=dn(e);i.r=r["!row"];var s=ur(e),a=[i,s,"str"];if(r.cellFormula){e.l+=2;var o=eh(e,n-e.l,r);a[3]=ar(o,null,i,r.supbooks,r)}else e.l=n;return a}var zW=ka,$W=Uo;function GW(e,t){return t==null&&(t=X(4)),t.write_shift(4,e),t}function KW(e,t){var r=e.l+t,n=ka(e),i=Z1(e),s=ur(e),a=ur(e),o=ur(e);e.l=r;var l={rfx:n,relId:i,loc:s,display:o};return a&&(l.Tooltip=a),l}function XW(e,t){var r=X(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));Uo({s:dt(e[0]),e:dt(e[0])},r),eg("rId"+t,r);var n=e[1].Target.indexOf("#"),i=n==-1?"":e[1].Target.slice(n+1);return $t(i||"",r),$t(e[1].Tooltip||"",r),$t("",r),r.slice(0,r.l)}function YW(){}function qW(e,t,r){var n=e.l+t,i=zT(e),s=e.read_shift(1),a=[i];if(a[2]=s,r.cellFormula){var o=yU(e,n-e.l,r);a[1]=o}else e.l=n;return a}function QW(e,t,r){var n=e.l+t,i=ka(e),s=[i];if(r.cellFormula){var a=EU(e,n-e.l,r);s[1]=a,e.l=n}else e.l=n;return s}function JW(e,t,r){r==null&&(r=X(18));var n=th(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var i=0;return t.hidden&&(i|=1),typeof n.width=="number"&&(i|=2),t.level&&(i|=t.level<<8),r.write_shift(2,i),r}var XS=["left","right","top","bottom","header","footer"];function ZW(e){var t={};return XS.forEach(function(r){t[r]=cr(e)}),t}function eV(e,t){return t==null&&(t=X(6*8)),Gs(e),XS.forEach(function(r){aa(e[r],t)}),t}function tV(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function rV(e,t,r){r==null&&(r=X(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function nV(e){var t=X(24);return t.write_shift(4,4),t.write_shift(4,1),Uo(e,t),t}function iV(e,t){return t==null&&(t=X(16*4+2)),t.write_shift(2,e.password?og(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function sV(){}function aV(){}function oV(e,t,r,n,i,s,a){if(!e)return e;var o=t||{};n||(n={"!id":{}});var l=o.dense?[]:{},c,u={s:{r:2e6,c:2e6},e:{r:0,c:0}},f=!1,h=!1,d,m,p,g,x,_,v,E,N,I=[];o.biff=12,o["!row"]=0;var w=0,O=!1,P=[],W={},j=o.supbooks||i.supbooks||[[]];if(j.sharedf=W,j.arrayf=P,j.SheetNames=i.SheetNames||i.Sheets.map(function(ee){return ee.name}),!o.supbooks&&(o.supbooks=j,i.Names))for(var U=0;U<i.Names.length;++U)j[0][U+1]=i.Names[U];var J=[],ge=[],fe=!1;Ec[16]={n:"BrtShortReal",f:KS};var ve;if(Ai(e,function(M,se,xe){if(!h)switch(xe){case 148:c=M;break;case 0:d=M,o.sheetRows&&o.sheetRows<=d.r&&(h=!0),E=Ct(g=d.r),o["!row"]=d.r,(M.hidden||M.hpt||M.level!=null)&&(M.hpt&&(M.hpx=So(M.hpt)),ge[M.r]=M);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(m={t:M[2]},M[2]){case"n":m.v=M[1];break;case"s":v=Pl[M[1]],m.v=v.t,m.r=v.r;break;case"b":m.v=!!M[1];break;case"e":m.v=M[1],o.cellText!==!1&&(m.w=Fi[m.v]);break;case"str":m.t="s",m.v=M[1];break;case"is":m.t="s",m.v=M[1].t;break}if((p=a.CellXf[M[0].iStyleRef])&&zS(m,p.numFmtId,null,o,s,a),x=M[0].c==-1?x+1:M[0].c,o.dense?(l[g]||(l[g]=[]),l[g][x]=m):l[ht(x)+E]=m,o.cellFormula){for(O=!1,w=0;w<P.length;++w){var A=P[w];d.r>=A[0].s.r&&d.r<=A[0].e.r&&x>=A[0].s.c&&x<=A[0].e.c&&(m.F=Ae(A[0]),O=!0)}!O&&M.length>3&&(m.f=M[3])}if(u.s.r>d.r&&(u.s.r=d.r),u.s.c>x&&(u.s.c=x),u.e.r<d.r&&(u.e.r=d.r),u.e.c<x&&(u.e.c=x),o.cellDates&&p&&m.t=="n"&&Lo(Ee[p.numFmtId])){var B=Us(m.v);B&&(m.t="d",m.v=new Date(B.y,B.m-1,B.d,B.H,B.M,B.S,B.u))}ve&&(ve.type=="XLDAPR"&&(m.D=!0),ve=void 0);break;case 1:case 12:if(!o.sheetStubs||f)break;m={t:"z",v:void 0},x=M[0].c==-1?x+1:M[0].c,o.dense?(l[g]||(l[g]=[]),l[g][x]=m):l[ht(x)+E]=m,u.s.r>d.r&&(u.s.r=d.r),u.s.c>x&&(u.s.c=x),u.e.r<d.r&&(u.e.r=d.r),u.e.c<x&&(u.e.c=x),ve&&(ve.type=="XLDAPR"&&(m.D=!0),ve=void 0);break;case 176:I.push(M);break;case 49:ve=((o.xlmeta||{}).Cell||[])[M-1];break;case 494:var D=n["!id"][M.relId];for(D?(M.Target=D.Target,M.loc&&(M.Target+="#"+M.loc),M.Rel=D):M.relId==""&&(M.Target="#"+M.loc),g=M.rfx.s.r;g<=M.rfx.e.r;++g)for(x=M.rfx.s.c;x<=M.rfx.e.c;++x)o.dense?(l[g]||(l[g]=[]),l[g][x]||(l[g][x]={t:"z",v:void 0}),l[g][x].l=M):(_=ke({c:x,r:g}),l[_]||(l[_]={t:"z",v:void 0}),l[_].l=M);break;case 426:if(!o.cellFormula)break;P.push(M),N=o.dense?l[g][x]:l[ht(x)+E],N.f=ar(M[1],u,{r:d.r,c:x},j,o),N.F=Ae(M[0]);break;case 427:if(!o.cellFormula)break;W[ke(M[0].s)]=M[1],N=o.dense?l[g][x]:l[ht(x)+E],N.f=ar(M[1],u,{r:d.r,c:x},j,o);break;case 60:if(!o.cellStyles)break;for(;M.e>=M.s;)J[M.e--]={width:M.w/256,hidden:!!(M.flags&1),level:M.level},fe||(fe=!0,lg(M.w/256)),gs(J[M.e+1]);break;case 161:l["!autofilter"]={ref:Ae(M)};break;case 476:l["!margins"]=M;break;case 147:i.Sheets[r]||(i.Sheets[r]={}),M.name&&(i.Sheets[r].CodeName=M.name),(M.above||M.left)&&(l["!outline"]={above:M.above,left:M.left});break;case 137:i.Views||(i.Views=[{}]),i.Views[0]||(i.Views[0]={}),M.RTL&&(i.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:f=!0;break;case 36:f=!1;break;case 37:f=!0;break;case 38:f=!1;break;default:if(!se.T){if(!f||o.WTF)throw new Error("Unexpected record 0x"+xe.toString(16))}}},o),delete o.supbooks,delete o["!row"],!l["!ref"]&&(u.s.r<2e6||c&&(c.e.r>0||c.e.c>0||c.s.r>0||c.s.c>0))&&(l["!ref"]=Ae(c||u)),o.sheetRows&&l["!ref"]){var de=je(l["!ref"]);o.sheetRows<=+de.e.r&&(de.e.r=o.sheetRows-1,de.e.r>u.e.r&&(de.e.r=u.e.r),de.e.r<de.s.r&&(de.s.r=de.e.r),de.e.c>u.e.c&&(de.e.c=u.e.c),de.e.c<de.s.c&&(de.s.c=de.e.c),l["!fullref"]=l["!ref"],l["!ref"]=Ae(de))}return I.length>0&&(l["!merges"]=I),J.length>0&&(l["!cols"]=J),ge.length>0&&(l["!rows"]=ge),l}function lV(e,t,r,n,i,s,a){if(t.v===void 0)return!1;var o="";switch(t.t){case"b":o=t.v?"1":"0";break;case"d":t=ot(t),t.z=t.z||Ee[14],t.v=Mt(at(t.v)),t.t="n";break;case"n":case"e":o=""+t.v;break;default:o=t.v;break}var l={r,c:n};switch(l.s=Is(i.cellXfs,t,i),t.l&&s["!links"].push([ke(l),t.l]),t.c&&s["!comments"].push([ke(l),t.c]),t.t){case"s":case"str":return i.bookSST?(o=dg(i.Strings,t.v,i.revStrings),l.t="s",l.v=o,a?q(e,18,IW(t,l)):q(e,7,SW(t,l))):(l.t="str",a?q(e,17,UW(t,l)):q(e,6,MW(t,l))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?a?q(e,13,DW(t,l)):q(e,2,PW(t,l)):a?q(e,16,NW(t,l)):q(e,5,FW(t,l)),!0;case"b":return l.t="b",a?q(e,15,_W(t,l)):q(e,4,vW(t,l)),!0;case"e":return l.t="e",a?q(e,14,kW(t,l)):q(e,3,wW(t,l)),!0}return a?q(e,12,mW(t,l)):q(e,1,dW(t,l)),!0}function cV(e,t,r,n){var i=je(t["!ref"]||"A1"),s,a="",o=[];q(e,145);var l=Array.isArray(t),c=i.e.r;t["!rows"]&&(c=Math.max(i.e.r,t["!rows"].length-1));for(var u=i.s.r;u<=c;++u){a=Ct(u),aW(e,t,i,u);var f=!1;if(u<=i.e.r)for(var h=i.s.c;h<=i.e.c;++h){u===i.s.r&&(o[h]=ht(h)),s=o[h]+a;var d=l?(t[u]||[])[h]:t[s];if(!d){f=!1;continue}f=lV(e,d,u,h,n,t,f)}}q(e,146)}function uV(e,t){!t||!t["!merges"]||(q(e,177,GW(t["!merges"].length)),t["!merges"].forEach(function(r){q(e,176,$W(r))}),q(e,178))}function fV(e,t){!t||!t["!cols"]||(q(e,390),t["!cols"].forEach(function(r,n){r&&q(e,60,JW(n,r))}),q(e,391))}function hV(e,t){!t||!t["!ref"]||(q(e,648),q(e,649,nV(je(t["!ref"]))),q(e,650))}function dV(e,t,r){t["!links"].forEach(function(n){if(n[1].Target){var i=Ge(r,-1,n[1].Target.replace(/#.*$/,""),Oe.HLINK);q(e,494,XW(n,i))}}),delete t["!links"]}function pV(e,t,r,n){if(t["!comments"].length>0){var i=Ge(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",Oe.VML);q(e,551,eg("rId"+i)),t["!legacy"]=i}}function mV(e,t,r,n){if(t["!autofilter"]){var i=t["!autofilter"],s=typeof i.ref=="string"?i.ref:Ae(i.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var a=r.Workbook.Names,o=Dr(s);o.s.r==o.e.r&&(o.e.r=Dr(t["!ref"]).e.r,s=Ae(o));for(var l=0;l<a.length;++l){var c=a[l];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+r.SheetNames[n]+"'!"+s;break}}l==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),q(e,161,Uo(je(s))),q(e,162)}}function gV(e,t,r){q(e,133),q(e,137,rV(t,r)),q(e,138),q(e,134)}function vV(e,t){t["!protect"]&&q(e,535,iV(t["!protect"]))}function xV(e,t,r,n){var i=Or(),s=r.SheetNames[e],a=r.Sheets[s]||{},o=s;try{r&&r.Workbook&&(o=r.Workbook.Sheets[e].CodeName||o)}catch{}var l=je(a["!ref"]||"A1");if(l.e.c>16383||l.e.r>1048575){if(t.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");l.e.c=Math.min(l.e.c,16383),l.e.r=Math.min(l.e.c,1048575)}return a["!links"]=[],a["!comments"]=[],q(i,129),(r.vbaraw||a["!outline"])&&q(i,147,fW(o,a["!outline"])),q(i,148,lW(l)),gV(i,a,r.Workbook),fV(i,a),cV(i,a,e,t),vV(i,a),mV(i,a,r,e),uV(i,a),dV(i,a,n),a["!margins"]&&q(i,476,eV(a["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&hV(i,a),pV(i,a,e,n),q(i,130),i.end()}function _V(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var a=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);a&&(t[+a[1]]=r?+a[2]:a[2])});var i=Ve((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){n=s.replace(/<.*?>/g,"")}),[t,i,n]}function yV(e,t,r,n,i,s){var a=s||{"!type":"chart"};if(!e)return s;var o=0,l=0,c="A",u={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(f){var h=_V(f);u.s.r=u.s.c=0,u.e.c=o,c=ht(o),h[0].forEach(function(d,m){a[c+Ct(m)]={t:"n",v:d,z:h[1]},l=m}),u.e.r<l&&(u.e.r=l),++o}),o>0&&(a["!ref"]=Ae(u)),a}function wV(e,t,r,n,i){if(!e)return e;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},a,o=e.match($S);return o&&pg(o[0],s,i,r),(a=e.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=a[1]),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}function EV(e,t){e.l+=10;var r=ur(e);return{name:r}}function kV(e,t,r,n,i){if(!e)return e;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},a=!1;return Ai(e,function(l,c,u){switch(u){case 550:s["!rel"]=l;break;case 651:i.Sheets[r]||(i.Sheets[r]={}),l.name&&(i.Sheets[r].CodeName=l.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:break;case 38:break;default:if(!(c.T>0)){if(!(c.T<0)){if(!a||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}},t),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}var mg=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],TV=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],SV=[],CV=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function uy(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],i=0;i!=t.length;++i){var s=t[i];if(n[s[0]]==null)n[s[0]]=s[1];else switch(s[2]){case"bool":typeof n[s[0]]=="string"&&(n[s[0]]=it(n[s[0]]));break;case"int":typeof n[s[0]]=="string"&&(n[s[0]]=parseInt(n[s[0]],10));break}}}function fy(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=it(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function YS(e){fy(e.WBProps,mg),fy(e.CalcPr,CV),uy(e.WBView,TV),uy(e.Sheets,SV),oo.date1904=it(e.WBProps.date1904)}function IV(e){return!e.Workbook||!e.Workbook.WBProps?"false":it(e.Workbook.WBProps.date1904)?"true":"false"}var AV="][*?/\\".split("");function qS(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return AV.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function FV(e,t,r){e.forEach(function(n,i){qS(n);for(var s=0;s<i;++s)if(n==e[s])throw new Error("Duplicate Sheet Name: "+n);if(r){var a=t&&t[i]&&t[i].CodeName||n;if(a.charCodeAt(0)==95&&a.length>22)throw new Error("Bad Code Name: Worksheet"+a)}})}function NV(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];FV(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)IU(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var RV=/<\w+:workbook/;function PV(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,i="xmlns",s={},a=0;if(e.replace(pr,function(l,c){var u=Te(l);switch(Yn(u[0])){case"<?xml":break;case"<workbook":l.match(RV)&&(i="xmlns"+l.match(/<(\w+):/)[1]),r.xmlns=u[i];break;case"</workbook>":break;case"<fileVersion":delete u[0],r.AppVersion=u;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":mg.forEach(function(f){if(u[f[0]]!=null)switch(f[2]){case"bool":r.WBProps[f[0]]=it(u[f[0]]);break;case"int":r.WBProps[f[0]]=parseInt(u[f[0]],10);break;default:r.WBProps[f[0]]=u[f[0]]}}),u.codeName&&(r.WBProps.CodeName=qe(u.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete u[0],r.WBView.push(u);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(u.state){case"hidden":u.Hidden=1;break;case"veryHidden":u.Hidden=2;break;default:u.Hidden=0}delete u.state,u.name=Ve(qe(u.name)),delete u[0],r.Sheets.push(u);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":s={},s.Name=qe(u.name),u.comment&&(s.Comment=u.comment),u.localSheetId&&(s.Sheet=+u.localSheetId),it(u.hidden||"0")&&(s.Hidden=!0),a=c+l.length;break;case"</definedName>":s.Ref=Ve(qe(e.slice(a,c))),r.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete u[0],r.CalcPr=u;break;case"<calcPr/>":delete u[0],r.CalcPr=u;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+u[0]+" in workbook")}return l}),_a.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return YS(r),r}function QS(e){var t=[It];t[t.length]=ce("workbook",null,{xmlns:_a[0],"xmlns:r":bt.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(mg.forEach(function(o){e.Workbook.WBProps[o[0]]!=null&&e.Workbook.WBProps[o[0]]!=o[1]&&(n[o[0]]=e.Workbook.WBProps[o[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=ce("workbookPr",null,n);var i=e.Workbook&&e.Workbook.Sheets||[],s=0;if(i&&i[0]&&i[0].Hidden){for(t[t.length]="<bookViews>",s=0;s!=e.SheetNames.length&&!(!i[s]||!i[s].Hidden);++s);s==e.SheetNames.length&&(s=0),t[t.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",s=0;s!=e.SheetNames.length;++s){var a={name:Ke(e.SheetNames[s].slice(0,31))};if(a.sheetId=""+(s+1),a["r:id"]="rId"+(s+1),i[s])switch(i[s].Hidden){case 1:a.state="hidden";break;case 2:a.state="veryHidden";break}t[t.length]=ce("sheet",null,a)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(o){var l={name:o.Name};o.Comment&&(l.comment=o.Comment),o.Sheet!=null&&(l.localSheetId=""+o.Sheet),o.Hidden&&(l.hidden="1"),o.Ref&&(t[t.length]=ce("definedName",Ke(o.Ref),l))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function OV(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=Fp(e),r.name=ur(e),r}function DV(e,t){return t||(t=X(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),eg(e.strRelID,t),$t(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function bV(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var i=t>8?ur(e):"";return i.length>0&&(r.CodeName=i),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function LV(e,t){t||(t=X(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),jT(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function MV(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function BV(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var i=e.read_shift(4),s=pL(e),a=wU(e,0,r),o=Z1(e);e.l=n;var l={Name:s,Ptg:a};return i<268435455&&(l.Sheet=i),o&&(l.Comment=o),l}function UV(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],i=!1;t||(t={}),t.biff=12;var s=[],a=[[]];return a.SheetNames=[],a.XTI=[],Ec[16]={n:"BrtFRTArchID$",f:MV},Ai(e,function(l,c,u){switch(u){case 156:a.SheetNames.push(l.name),r.Sheets.push(l);break;case 153:r.WBProps=l;break;case 39:l.Sheet!=null&&(t.SID=l.Sheet),l.Ref=ar(l.Ptg,null,null,a,t),delete t.SID,delete l.Ptg,s.push(l);break;case 1036:break;case 357:case 358:case 355:case 667:a[0].length?a.push([u,l]):a[0]=[u,l],a[a.length-1].XTI=[];break;case 362:a.length===0&&(a[0]=[],a[0].XTI=[]),a[a.length-1].XTI=a[a.length-1].XTI.concat(l),a.XTI=a.XTI.concat(l);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(u),i=!0;break;case 36:n.pop(),i=!1;break;case 37:n.push(u),i=!0;break;case 38:n.pop(),i=!1;break;case 16:break;default:if(!c.T){if(!i||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}},t),YS(r),r.Names=s,r.supbooks=a,r}function WV(e,t){q(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,i={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};q(e,156,DV(i))}q(e,144)}function VV(e,t){t||(t=X(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return $t("SheetJS",t),$t(Qf.version,t),$t(Qf.version,t),$t("7262",t),t.length>t.l?t.slice(0,t.l):t}function jV(e,t){t||(t=X(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function HV(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,n=0,i=-1,s=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&i==-1?i=n:r[n].Hidden==1&&s==-1&&(s=n);s>i||(q(e,135),q(e,158,jV(i)),q(e,136))}}function zV(e,t){var r=Or();return q(r,131),q(r,128,VV()),q(r,153,LV(e.Workbook&&e.Workbook.WBProps||null)),HV(r,e),WV(r,e),q(r,132),r.end()}function $V(e,t,r){return t.slice(-4)===".bin"?UV(e,r):PV(e,r)}function GV(e,t,r,n,i,s,a,o){return t.slice(-4)===".bin"?oV(e,n,r,i,s,a,o):BU(e,n,r,i,s,a,o)}function KV(e,t,r,n,i,s,a,o){return t.slice(-4)===".bin"?kV(e,n,r,i,s):wV(e,n,r,i,s)}function XV(e,t,r,n,i,s,a,o){return t.slice(-4)===".bin"?q7():Q7()}function YV(e,t,r,n,i,s,a,o){return t.slice(-4)===".bin"?X7():Y7()}function qV(e,t,r,n){return t.slice(-4)===".bin"?$B(e,r,n):OB(e,r,n)}function QV(e,t,r){return RS(e,r)}function JV(e,t,r){return t.slice(-4)===".bin"?J5(e,r):Y5(e,r)}function ZV(e,t,r){return t.slice(-4)===".bin"?H7(e,r):D7(e,r)}function ej(e,t,r){return t.slice(-4)===".bin"?R7(e):F7(e)}function tj(e,t,r,n){return r.slice(-4)===".bin"?P7(e,t,r,n):void 0}function rj(e,t,r){return t.slice(-4)===".bin"?C7(e,t,r):A7(e,t,r)}function nj(e,t,r){return(t.slice(-4)===".bin"?zV:QS)(e)}function ij(e,t,r,n,i){return(t.slice(-4)===".bin"?xV:GS)(e,r,n,i)}function sj(e,t,r){return(t.slice(-4)===".bin"?t7:FS)(e,r)}function aj(e,t,r){return(t.slice(-4)===".bin"?tB:wS)(e,r)}function oj(e,t,r){return(t.slice(-4)===".bin"?z7:DS)(e)}function lj(e){return(e.slice(-4)===".bin"?I7:PS)()}var JS=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,ZS=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function mn(e,t){var r=e.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var i=e.match(JS),s,a,o,l;if(i)for(l=0;l!=i.length;++l)s=i[l].match(ZS),(a=s[1].indexOf(":"))===-1?n[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?o="xmlns"+s[1].slice(6):o=s[1].slice(a+1),n[o]=s[2].slice(1,s[2].length-1));return n}function cj(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(JS),i,s,a,o;if(n)for(o=0;o!=n.length;++o)i=n[o].match(ZS),(s=i[1].indexOf(":"))===-1?r[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?a="xmlns"+i[1].slice(6):a=i[1].slice(s+1),r[a]=i[2].slice(1,i[2].length-1));return r}var Dl;function uj(e,t){var r=Dl[e]||Ve(e);return r==="General"?ia(t):hn(r,t)}function fj(e,t,r,n){var i=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":i=it(n);break;case"i2":case"int":i=parseInt(n,10);break;case"r4":case"float":i=parseFloat(n);break;case"date":case"dateTime.tz":i=at(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[Ve(t)]=i}function hj(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||Fi[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=dc(e.v):e.w=ia(e.v):e.w=uj(t||"General",e.v)}catch(s){if(r.WTF)throw s}try{var n=Dl[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&Lo(n)){var i=Us(e.v);i&&(e.t="d",e.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}catch(s){if(r.WTF)throw s}}}function dj(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=SB[n.Pattern]||n.Pattern)}e[t.ID]=t}function pj(e,t,r,n,i,s,a,o,l,c){var u="General",f=n.StyleID,h={};c=c||{};var d=[],m=0;for(f===void 0&&o&&(f=o.StyleID),f===void 0&&a&&(f=a.StyleID);s[f]!==void 0&&(s[f].nf&&(u=s[f].nf),s[f].Interior&&d.push(s[f].Interior),!!s[f].Parent);)f=s[f].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=it(e);break;case"String":n.t="s",n.r=A_(Ve(e)),n.v=e.indexOf("<")>-1?Ve(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(at(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=Ve(e):n.v<60&&(n.v=n.v-1),(!u||u=="General")&&(u="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=KT[e],c.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=A_(t||e));break}if(hj(n,u,c),c.cellFormula!==!1)if(n.Formula){var p=Ve(n.Formula);p.charCodeAt(0)==61&&(p=p.slice(1)),n.f=ao(p,i),delete n.Formula,n.ArrayRange=="RC"?n.F=ao("RC:RC",i):n.ArrayRange&&(n.F=ao(n.ArrayRange,i),l.push([je(n.F),n.F]))}else for(m=0;m<l.length;++m)i.r>=l[m][0].s.r&&i.r<=l[m][0].e.r&&i.c>=l[m][0].s.c&&i.c<=l[m][0].e.c&&(n.F=l[m][1]);c.cellStyles&&(d.forEach(function(g){!h.patternType&&g.patternType&&(h.patternType=g.patternType)}),n.s=h),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function mj(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function rd(e,t){var r=t||{};Mo();var n=ul(K1(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=qe(n));var i=n.slice(0,1024).toLowerCase(),s=!1;if(i=i.replace(/".*?"/g,""),(i.indexOf(">")&1023)>Math.min(i.indexOf(",")&1023,i.indexOf(";")&1023)){var a=ot(r);return a.type="string",To.to_workbook(n,a)}if(i.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Et){i.indexOf("<"+Et)>=0&&(s=!0)}),s)return eH(n,r);Dl={"General Number":"General","General Date":Ee[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Ee[15],"Short Date":Ee[14],"Long Time":Ee[19],"Medium Time":Ee[18],"Short Time":Ee[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Ee[2],Standard:Ee[4],Percent:Ee[10],Scientific:Ee[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,l=[],c,u={},f=[],h=r.dense?[]:{},d="",m={},p={},g=mn('<Data ss:Type="String">'),x=0,_=0,v=0,E={s:{r:2e6,c:2e6},e:{r:0,c:0}},N={},I={},w="",O=0,P=[],W={},j={},U=0,J=[],ge=[],fe={},ve=[],de,ee=!1,M=[],se=[],xe={},A=0,B=0,D={Sheets:[],WBProps:{date1904:!1}},b={};gc.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var K="";o=gc.exec(n);)switch(o[3]=(K=o[3]).toLowerCase()){case"data":if(K=="data"){if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break}if(l[l.length-1][1])break;o[1]==="/"?pj(n.slice(x,o.index),w,g,l[l.length-1][0]=="comment"?fe:m,{c:_,r:v},N,ve[_],p,M,r):(w="",g=mn(o[0]),x=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(ge.length>0&&(m.c=ge),(!r.sheetRows||r.sheetRows>v)&&m.v!==void 0&&(r.dense?(h[v]||(h[v]=[]),h[v][_]=m):h[ht(_)+Ct(v)]=m),m.HRef&&(m.l={Target:Ve(m.HRef)},m.HRefScreenTip&&(m.l.Tooltip=m.HRefScreenTip),delete m.HRef,delete m.HRefScreenTip),(m.MergeAcross||m.MergeDown)&&(A=_+(parseInt(m.MergeAcross,10)|0),B=v+(parseInt(m.MergeDown,10)|0),P.push({s:{c:_,r:v},e:{c:A,r:B}})),!r.sheetStubs)m.MergeAcross?_=A+1:++_;else if(m.MergeAcross||m.MergeDown){for(var ie=_;ie<=A;++ie)for(var le=v;le<=B;++le)(ie>_||le>v)&&(r.dense?(h[le]||(h[le]=[]),h[le][ie]={t:"z"}):h[ht(ie)+Ct(le)]={t:"z"});_=A+1}else++_;else m=cj(o[0]),m.Index&&(_=+m.Index-1),_<E.s.c&&(E.s.c=_),_>E.e.c&&(E.e.c=_),o[0].slice(-2)==="/>"&&++_,ge=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(v<E.s.r&&(E.s.r=v),v>E.e.r&&(E.e.r=v),o[0].slice(-2)==="/>"&&(p=mn(o[0]),p.Index&&(v=+p.Index-1)),_=0,++v):(p=mn(o[0]),p.Index&&(v=+p.Index-1),xe={},(p.AutoFitHeight=="0"||p.Height)&&(xe.hpx=parseInt(p.Height,10),xe.hpt=wc(xe.hpx),se[v]=xe),p.Hidden=="1"&&(xe.hidden=!0,se[v]=xe));break;case"worksheet":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));f.push(d),E.s.r<=E.e.r&&E.s.c<=E.e.c&&(h["!ref"]=Ae(E),r.sheetRows&&r.sheetRows<=E.e.r&&(h["!fullref"]=h["!ref"],E.e.r=r.sheetRows-1,h["!ref"]=Ae(E))),P.length&&(h["!merges"]=P),ve.length>0&&(h["!cols"]=ve),se.length>0&&(h["!rows"]=se),u[d]=h}else E={s:{r:2e6,c:2e6},e:{r:0,c:0}},v=_=0,l.push([o[3],!1]),c=mn(o[0]),d=Ve(c.Name),h=r.dense?[]:{},P=[],M=[],se=[],b={name:d,Hidden:0},D.Sheets.push(b);break;case"table":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else{if(o[0].slice(-2)=="/>")break;l.push([o[3],!1]),ve=[],ee=!1}break;case"style":o[1]==="/"?dj(N,I,r):I=mn(o[0]);break;case"numberformat":I.nf=Ve(mn(o[0]).Format||"General"),Dl[I.nf]&&(I.nf=Dl[I.nf]);for(var ne=0;ne!=392&&Ee[ne]!=I.nf;++ne);if(ne==392){for(ne=57;ne!=392;++ne)if(Ee[ne]==null){pi(I.nf,ne);break}}break;case"column":if(l[l.length-1][0]!=="table")break;if(de=mn(o[0]),de.Hidden&&(de.hidden=!0,delete de.Hidden),de.Width&&(de.wpx=parseInt(de.Width,10)),!ee&&de.wpx>10){ee=!0,lr=IS;for(var Z=0;Z<ve.length;++Z)ve[Z]&&gs(ve[Z])}ee&&gs(de),ve[de.Index-1||ve.length]=de;for(var Ne=0;Ne<+de.Span;++Ne)ve[ve.length]=ot(de);break;case"namedrange":if(o[1]==="/")break;D.Names||(D.Names=[]);var R=Te(o[0]),rt={Name:R.Name,Ref:ao(R.RefersTo.slice(1),{r:0,c:0})};D.Sheets.length>0&&(rt.Sheet=D.Sheets.length-1),D.Names.push(rt);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?w+=n.slice(O,o.index):O=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;I.Interior=mn(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?UL(W,K,n.slice(U,o.index)):U=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else l.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));mj(fe),ge.push(fe)}else l.push([o[3],!1]),c=mn(o[0]),fe={a:c.Author};break;case"autofilter":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var Ue=mn(o[0]);h["!autofilter"]={ref:ao(Ue.Range).replace(/\$/g,"")},l.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"null":break;default:if(l.length==0&&o[3]=="document"||l.length==0&&o[3]=="uof")return gy(n,r);var Je=!0;switch(l[l.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Je=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Je=!1}break;case"excelworkbook":switch(o[3]){case"date1904":D.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Je=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:Je=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(U,o.index)){case"SheetHidden":b.Hidden=1;break;case"SheetVeryHidden":b.Hidden=2;break}else U=o.index+o[0].length;break;case"header":h["!margins"]||Gs(h["!margins"]={},"xlml"),isNaN(+Te(o[0]).Margin)||(h["!margins"].header=+Te(o[0]).Margin);break;case"footer":h["!margins"]||Gs(h["!margins"]={},"xlml"),isNaN(+Te(o[0]).Margin)||(h["!margins"].footer=+Te(o[0]).Margin);break;case"pagemargins":var Le=Te(o[0]);h["!margins"]||Gs(h["!margins"]={},"xlml"),isNaN(+Le.Top)||(h["!margins"].top=+Le.Top),isNaN(+Le.Left)||(h["!margins"].left=+Le.Left),isNaN(+Le.Right)||(h["!margins"].right=+Le.Right),isNaN(+Le.Bottom)||(h["!margins"].bottom=+Le.Bottom);break;case"displayrighttoleft":D.Views||(D.Views=[]),D.Views[0]||(D.Views[0]={}),D.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Je=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Je=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Je=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Je=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Je=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Je=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Je=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Je=!1}break;case"smarttags":break;default:Je=!1;break}if(Je||o[3].match(/!\[CDATA/))break;if(!l[l.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+l.join("|");if(l[l.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?fj(j,K,J,n.slice(U,o.index)):(J=o,U=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+l.join("|")}var pe={};return!r.bookSheets&&!r.bookProps&&(pe.Sheets=u),pe.SheetNames=f,pe.Workbook=D,pe.SSF=ot(Ee),pe.Props=W,pe.Custprops=j,pe}function Lp(e,t){switch(vg(t=t||{}),t.type||"base64"){case"base64":return rd($r(e),t);case"binary":case"buffer":case"file":return rd(e,t);case"array":return rd(Ss(e),t)}}function gj(e,t){var r=[];return e.Props&&r.push(WL(e.Props,t)),e.Custprops&&r.push(VL(e.Props,e.Custprops)),r.join("")}function vj(){return""}function xj(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,i){var s=[];s.push(ce("NumberFormat",null,{"ss:Format":Ke(Ee[n.numFmtId])}));var a={"ss:ID":"s"+(21+i)};r.push(ce("Style",s.join(""),a))}),ce("Styles",r.join(""))}function eC(e){return ce("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+fg(e.Ref,{r:0,c:0})})}function _j(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var i=t[n];i.Sheet==null&&(i.Name.match(/^_xlfn\./)||r.push(eC(i)))}return ce("Names",r.join(""))}function yj(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var i=n.Workbook.Names,s=[],a=0;a<i.length;++a){var o=i[a];o.Sheet==r&&(o.Name.match(/^_xlfn\./)||s.push(eC(o)))}return s.join("")}function wj(e,t,r,n){if(!e)return"";var i=[];if(e["!margins"]&&(i.push("<PageSetup>"),e["!margins"].header&&i.push(ce("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&i.push(ce("Footer",null,{"x:Margin":e["!margins"].footer})),i.push(ce("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),i.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)i.push(ce("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<r&&!(n.Workbook.Sheets[s]&&!n.Workbook.Sheets[s].Hidden);++s);s==r&&i.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),e["!protect"]&&(i.push(Qt("ProtectContents","True")),e["!protect"].objects&&i.push(Qt("ProtectObjects","True")),e["!protect"].scenarios&&i.push(Qt("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?i.push(Qt("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&i.push(Qt("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(a){e["!protect"][a[0]]&&i.push("<"+a[1]+"/>")})),i.length==0?"":ce("WorksheetOptions",i.join(""),{xmlns:Mr.x})}function Ej(e){return e.map(function(t){var r=H6(t.t||""),n=ce("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return ce("Comment",n,{"ss:Author":t.a})}).join("")}function kj(e,t,r,n,i,s,a){if(!e||e.v==null&&e.f==null)return"";var o={};if(e.f&&(o["ss:Formula"]="="+Ke(fg(e.f,a))),e.F&&e.F.slice(0,t.length)==t){var l=dt(e.F.slice(t.length+1));o["ss:ArrayRange"]="RC:R"+(l.r==a.r?"":"["+(l.r-a.r)+"]")+"C"+(l.c==a.c?"":"["+(l.c-a.c)+"]")}if(e.l&&e.l.Target&&(o["ss:HRef"]=Ke(e.l.Target),e.l.Tooltip&&(o["x:HRefScreenTip"]=Ke(e.l.Tooltip))),r["!merges"])for(var c=r["!merges"],u=0;u!=c.length;++u)c[u].s.c!=a.c||c[u].s.r!=a.r||(c[u].e.c>c[u].s.c&&(o["ss:MergeAcross"]=c[u].e.c-c[u].s.c),c[u].e.r>c[u].s.r&&(o["ss:MergeDown"]=c[u].e.r-c[u].s.r));var f="",h="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":f="Number",h=String(e.v);break;case"b":f="Boolean",h=e.v?"1":"0";break;case"e":f="Error",h=Fi[e.v];break;case"d":f="DateTime",h=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||Ee[14]);break;case"s":f="String",h=j6(e.v||"");break}var d=Is(n.cellXfs,e,n);o["ss:StyleID"]="s"+(21+d),o["ss:Index"]=a.c+1;var m=e.v!=null?h:"",p=e.t=="z"?"":'<Data ss:Type="'+f+'">'+m+"</Data>";return(e.c||[]).length>0&&(p+=Ej(e.c)),ce("Cell",p,o)}function Tj(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=So(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function Sj(e,t,r,n){if(!e["!ref"])return"";var i=je(e["!ref"]),s=e["!merges"]||[],a=0,o=[];e["!cols"]&&e["!cols"].forEach(function(g,x){gs(g);var _=!!g.width,v=th(x,g),E={"ss:Index":x+1};_&&(E["ss:Width"]=_c(v.width)),g.hidden&&(E["ss:Hidden"]="1"),o.push(ce("Column",null,E))});for(var l=Array.isArray(e),c=i.s.r;c<=i.e.r;++c){for(var u=[Tj(c,(e["!rows"]||[])[c])],f=i.s.c;f<=i.e.c;++f){var h=!1;for(a=0;a!=s.length;++a)if(!(s[a].s.c>f)&&!(s[a].s.r>c)&&!(s[a].e.c<f)&&!(s[a].e.r<c)){(s[a].s.c!=f||s[a].s.r!=c)&&(h=!0);break}if(!h){var d={r:c,c:f},m=ke(d),p=l?(e[c]||[])[f]:e[m];u.push(kj(p,m,e,t,r,n,d))}}u.push("</Row>"),u.length>2&&o.push(u.join(""))}return o.join("")}function Cj(e,t,r){var n=[],i=r.SheetNames[e],s=r.Sheets[i],a=s?yj(s,t,e,r):"";return a.length>0&&n.push("<Names>"+a+"</Names>"),a=s?Sj(s,t,e,r):"",a.length>0&&n.push("<Table>"+a+"</Table>"),n.push(wj(s,t,e,r)),n.join("")}function Ij(e,t){t||(t={}),e.SSF||(e.SSF=ot(Ee)),e.SSF&&(Mo(),X0(e.SSF),t.revssf=q0(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],Is(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(gj(e,t)),r.push(vj()),r.push(""),r.push("");for(var n=0;n<e.SheetNames.length;++n)r.push(ce("Worksheet",Cj(n,t,e),{"ss:Name":Ke(e.SheetNames[n])}));return r[2]=xj(e,t),r[3]=_j(e),It+ce("Workbook",r.join(""),{xmlns:Mr.ss,"xmlns:o":Mr.o,"xmlns:x":Mr.x,"xmlns:ss":Mr.ss,"xmlns:dt":Mr.dt,"xmlns:html":Mr.html})}function Aj(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=_L(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=yL(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var Fj=[60,1084,2066,2165,2175];function Nj(e,t,r,n,i){var s=n,a=[],o=r.slice(r.l,r.l+s);if(i&&i.enc&&i.enc.insitu&&o.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:i.enc.insitu(o)}a.push(o),r.l+=s;for(var l=ui(r,r.l),c=Mp[l],u=0;c!=null&&Fj.indexOf(l)>-1;)s=ui(r,r.l+2),u=r.l+4,l==2066?u+=4:(l==2165||l==2175)&&(u+=12),o=r.slice(u,r.l+4+s),a.push(o),r.l+=4+s,c=Mp[l=ui(r,r.l)];var f=zt(a);Yt(f,0);var h=0;f.lens=[];for(var d=0;d<a.length;++d)f.lens.push(h),h+=a[d].length;if(f.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+f.length+" < "+n;return t.f(f,f.length,i)}function bn(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=Ee[n])}catch(s){if(t.WTF)throw s}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||Fi[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=dc(e.v):e.w=ia(e.v):e.w=hn(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(s){if(t.WTF)throw s}if(t.cellDates&&n&&e.t=="n"&&Lo(Ee[n]||String(n))){var i=Us(e.v);i&&(e.t="d",e.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}}function Nu(e,t,r){return{v:e,ixfe:t,t:r}}function Rj(e,t){var r={opts:{}},n={},i=t.dense?[]:{},s={},a={},o=null,l=[],c="",u={},f,h="",d,m,p,g,x={},_=[],v,E,N=[],I=[],w={Sheets:[],WBProps:{date1904:!1},Views:[{}]},O={},P=function(Pe){return Pe<8?Hs[Pe]:Pe<64&&I[Pe-8]||Hs[Pe]},W=function(Pe,kt,qr){var Ot=kt.XF.data;if(!(!Ot||!Ot.patternType||!qr||!qr.cellStyles)){kt.s={},kt.s.patternType=Ot.patternType;var As;(As=xc(P(Ot.icvFore)))&&(kt.s.fgColor={rgb:As}),(As=xc(P(Ot.icvBack)))&&(kt.s.bgColor={rgb:As})}},j=function(Pe,kt,qr){if(!(xe>1)&&!(qr.sheetRows&&Pe.r>=qr.sheetRows)){if(qr.cellStyles&&kt.XF&&kt.XF.data&&W(Pe,kt,qr),delete kt.ixfe,delete kt.XF,f=Pe,h=ke(Pe),(!a||!a.s||!a.e)&&(a={s:{r:0,c:0},e:{r:0,c:0}}),Pe.r<a.s.r&&(a.s.r=Pe.r),Pe.c<a.s.c&&(a.s.c=Pe.c),Pe.r+1>a.e.r&&(a.e.r=Pe.r+1),Pe.c+1>a.e.c&&(a.e.c=Pe.c+1),qr.cellFormula&&kt.f){for(var Ot=0;Ot<_.length;++Ot)if(!(_[Ot][0].s.c>Pe.c||_[Ot][0].s.r>Pe.r)&&!(_[Ot][0].e.c<Pe.c||_[Ot][0].e.r<Pe.r)){kt.F=Ae(_[Ot][0]),(_[Ot][0].s.c!=Pe.c||_[Ot][0].s.r!=Pe.r)&&delete kt.f,kt.f&&(kt.f=""+ar(_[Ot][1],a,Pe,M,U));break}}qr.dense?(i[Pe.r]||(i[Pe.r]=[]),i[Pe.r][Pe.c]=kt):i[h]=kt}},U={enc:!1,sbcch:0,snames:[],sharedf:x,arrayf:_,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(U.password=t.password);var J,ge=[],fe=[],ve=[],de=[],ee=!1,M=[];M.SheetNames=U.snames,M.sharedf=U.sharedf,M.arrayf=U.arrayf,M.names=[],M.XTI=[];var se=0,xe=0,A=0,B=[],D=[],b;U.codepage=1200,En(1200);for(var K=!1;e.l<e.length-1;){var ie=e.l,le=e.read_shift(2);if(le===0&&se===10)break;var ne=e.l===e.length?0:e.read_shift(2),Z=Mp[le];if(Z&&Z.f){if(t.bookSheets&&se===133&&le!==133)break;if(se=le,Z.r===2||Z.r==12){var Ne=e.read_shift(2);if(ne-=2,!U.enc&&Ne!==le&&((Ne&255)<<8|Ne>>8)!==le)throw new Error("rt mismatch: "+Ne+"!="+le);Z.r==12&&(e.l+=10,ne-=10)}var R={};if(le===10?R=Z.f(e,ne,U):R=Nj(le,Z,e,ne,U),xe==0&&[9,521,1033,2057].indexOf(se)===-1)continue;switch(le){case 34:r.opts.Date1904=w.WBProps.date1904=R;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(U.enc||(e.l=0),U.enc=R,!t.password)throw new Error("File is password-protected");if(R.valid==null)throw new Error("Encryption scheme unsupported");if(!R.valid)throw new Error("Password is incorrect");break;case 92:U.lastuser=R;break;case 66:var rt=Number(R);switch(rt){case 21010:rt=1200;break;case 32768:rt=1e4;break;case 32769:rt=1252;break}En(U.codepage=rt),K=!0;break;case 317:U.rrtabid=R;break;case 25:U.winlocked=R;break;case 439:r.opts.RefreshAll=R;break;case 12:r.opts.CalcCount=R;break;case 16:r.opts.CalcDelta=R;break;case 17:r.opts.CalcIter=R;break;case 13:r.opts.CalcMode=R;break;case 14:r.opts.CalcPrecision=R;break;case 95:r.opts.CalcSaveRecalc=R;break;case 15:U.CalcRefMode=R;break;case 2211:r.opts.FullCalc=R;break;case 129:R.fDialog&&(i["!type"]="dialog"),R.fBelow||((i["!outline"]||(i["!outline"]={})).above=!0),R.fRight||((i["!outline"]||(i["!outline"]={})).left=!0);break;case 224:N.push(R);break;case 430:M.push([R]),M[M.length-1].XTI=[];break;case 35:case 547:M[M.length-1].push(R);break;case 24:case 536:b={Name:R.Name,Ref:ar(R.rgce,a,null,M,U)},R.itab>0&&(b.Sheet=R.itab-1),M.names.push(b),M[0]||(M[0]=[],M[0].XTI=[]),M[M.length-1].push(R),R.Name=="_xlnm._FilterDatabase"&&R.itab>0&&R.rgce&&R.rgce[0]&&R.rgce[0][0]&&R.rgce[0][0][0]=="PtgArea3d"&&(D[R.itab-1]={ref:Ae(R.rgce[0][0][1][2])});break;case 22:U.ExternCount=R;break;case 23:M.length==0&&(M[0]=[],M[0].XTI=[]),M[M.length-1].XTI=M[M.length-1].XTI.concat(R),M.XTI=M.XTI.concat(R);break;case 2196:if(U.biff<8)break;b!=null&&(b.Comment=R[1]);break;case 18:i["!protect"]=R;break;case 19:R!==0&&U.WTF&&console.error("Password verifier: "+R);break;case 133:s[R.pos]=R,U.snames.push(R.name);break;case 10:{if(--xe)break;if(a.e){if(a.e.r>0&&a.e.c>0){if(a.e.r--,a.e.c--,i["!ref"]=Ae(a),t.sheetRows&&t.sheetRows<=a.e.r){var Ue=a.e.r;a.e.r=t.sheetRows-1,i["!fullref"]=i["!ref"],i["!ref"]=Ae(a),a.e.r=Ue}a.e.r++,a.e.c++}ge.length>0&&(i["!merges"]=ge),fe.length>0&&(i["!objects"]=fe),ve.length>0&&(i["!cols"]=ve),de.length>0&&(i["!rows"]=de),w.Sheets.push(O)}c===""?u=i:n[c]=i,i=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(U.biff===8&&(U.biff={9:2,521:3,1033:4}[le]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[R.BIFFVer]||8),U.biffguess=R.BIFFVer==0,R.BIFFVer==0&&R.dt==4096&&(U.biff=5,K=!0,En(U.codepage=28591)),U.biff==8&&R.BIFFVer==0&&R.dt==16&&(U.biff=2),xe++)break;if(i=t.dense?[]:{},U.biff<8&&!K&&(K=!0,En(U.codepage=t.codepage||1252)),U.biff<5||R.BIFFVer==0&&R.dt==4096){c===""&&(c="Sheet1"),a={s:{r:0,c:0},e:{r:0,c:0}};var Je={pos:e.l-ne,name:c};s[Je.pos]=Je,U.snames.push(c)}else c=(s[ie]||{name:""}).name;R.dt==32&&(i["!type"]="chart"),R.dt==64&&(i["!type"]="macro"),ge=[],fe=[],U.arrayf=_=[],ve=[],de=[],ee=!1,O={Hidden:(s[ie]||{hs:0}).hs,name:c}}break;case 515:case 3:case 2:i["!type"]=="chart"&&(t.dense?(i[R.r]||[])[R.c]:i[ke({c:R.c,r:R.r})])&&++R.c,v={ixfe:R.ixfe,XF:N[R.ixfe]||{},v:R.val,t:"n"},A>0&&(v.z=B[v.ixfe>>8&63]),bn(v,t,r.opts.Date1904),j({c:R.c,r:R.r},v,t);break;case 5:case 517:v={ixfe:R.ixfe,XF:N[R.ixfe],v:R.val,t:R.t},A>0&&(v.z=B[v.ixfe>>8&63]),bn(v,t,r.opts.Date1904),j({c:R.c,r:R.r},v,t);break;case 638:v={ixfe:R.ixfe,XF:N[R.ixfe],v:R.rknum,t:"n"},A>0&&(v.z=B[v.ixfe>>8&63]),bn(v,t,r.opts.Date1904),j({c:R.c,r:R.r},v,t);break;case 189:for(var Le=R.c;Le<=R.C;++Le){var pe=R.rkrec[Le-R.c][0];v={ixfe:pe,XF:N[pe],v:R.rkrec[Le-R.c][1],t:"n"},A>0&&(v.z=B[v.ixfe>>8&63]),bn(v,t,r.opts.Date1904),j({c:Le,r:R.r},v,t)}break;case 6:case 518:case 1030:{if(R.val=="String"){o=R;break}if(v=Nu(R.val,R.cell.ixfe,R.tt),v.XF=N[v.ixfe],t.cellFormula){var Et=R.formula;if(Et&&Et[0]&&Et[0][0]&&Et[0][0][0]=="PtgExp"){var Yr=Et[0][0][1][0],Pn=Et[0][0][1][1],Qn=ke({r:Yr,c:Pn});x[Qn]?v.f=""+ar(R.formula,a,R.cell,M,U):v.F=((t.dense?(i[Yr]||[])[Pn]:i[Qn])||{}).F}else v.f=""+ar(R.formula,a,R.cell,M,U)}A>0&&(v.z=B[v.ixfe>>8&63]),bn(v,t,r.opts.Date1904),j(R.cell,v,t),o=R}break;case 7:case 519:if(o)o.val=R,v=Nu(R,o.cell.ixfe,"s"),v.XF=N[v.ixfe],t.cellFormula&&(v.f=""+ar(o.formula,a,o.cell,M,U)),A>0&&(v.z=B[v.ixfe>>8&63]),bn(v,t,r.opts.Date1904),j(o.cell,v,t),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{_.push(R);var Wo=ke(R[0].s);if(d=t.dense?(i[R[0].s.r]||[])[R[0].s.c]:i[Wo],t.cellFormula&&d){if(!o||!Wo||!d)break;d.f=""+ar(R[1],a,R[0],M,U),d.F=Ae(R[0])}}break;case 1212:{if(!t.cellFormula)break;if(h){if(!o)break;x[ke(o.cell)]=R[0],d=t.dense?(i[o.cell.r]||[])[o.cell.c]:i[ke(o.cell)],(d||{}).f=""+ar(R[0],a,f,M,U)}}break;case 253:v=Nu(l[R.isst].t,R.ixfe,"s"),l[R.isst].h&&(v.h=l[R.isst].h),v.XF=N[v.ixfe],A>0&&(v.z=B[v.ixfe>>8&63]),bn(v,t,r.opts.Date1904),j({c:R.c,r:R.r},v,t);break;case 513:t.sheetStubs&&(v={ixfe:R.ixfe,XF:N[R.ixfe],t:"z"},A>0&&(v.z=B[v.ixfe>>8&63]),bn(v,t,r.opts.Date1904),j({c:R.c,r:R.r},v,t));break;case 190:if(t.sheetStubs)for(var Ni=R.c;Ni<=R.C;++Ni){var br=R.ixfe[Ni-R.c];v={ixfe:br,XF:N[br],t:"z"},A>0&&(v.z=B[v.ixfe>>8&63]),bn(v,t,r.opts.Date1904),j({c:Ni,r:R.r},v,t)}break;case 214:case 516:case 4:v=Nu(R.val,R.ixfe,"s"),v.XF=N[v.ixfe],A>0&&(v.z=B[v.ixfe>>8&63]),bn(v,t,r.opts.Date1904),j({c:R.c,r:R.r},v,t);break;case 0:case 512:xe===1&&(a=R);break;case 252:l=R;break;case 1054:if(U.biff==4){B[A++]=R[1];for(var Jn=0;Jn<A+163&&Ee[Jn]!=R[1];++Jn);Jn>=163&&pi(R[1],A+163)}else pi(R[1],R[0]);break;case 30:{B[A++]=R;for(var Ri=0;Ri<A+163&&Ee[Ri]!=R;++Ri);Ri>=163&&pi(R,A+163)}break;case 229:ge=ge.concat(R);break;case 93:fe[R.cmo[0]]=U.lastobj=R;break;case 438:U.lastobj.TxO=R;break;case 127:U.lastobj.ImData=R;break;case 440:for(g=R[0].s.r;g<=R[0].e.r;++g)for(p=R[0].s.c;p<=R[0].e.c;++p)d=t.dense?(i[g]||[])[p]:i[ke({c:p,r:g})],d&&(d.l=R[1]);break;case 2048:for(g=R[0].s.r;g<=R[0].e.r;++g)for(p=R[0].s.c;p<=R[0].e.c;++p)d=t.dense?(i[g]||[])[p]:i[ke({c:p,r:g})],d&&d.l&&(d.l.Tooltip=R[1]);break;case 28:{if(U.biff<=5&&U.biff>=2)break;d=t.dense?(i[R[0].r]||[])[R[0].c]:i[ke(R[0])];var Vo=fe[R[2]];d||(t.dense?(i[R[0].r]||(i[R[0].r]=[]),d=i[R[0].r][R[0].c]={t:"z"}):d=i[ke(R[0])]={t:"z"},a.e.r=Math.max(a.e.r,R[0].r),a.s.r=Math.min(a.s.r,R[0].r),a.e.c=Math.max(a.e.c,R[0].c),a.s.c=Math.min(a.s.c,R[0].c)),d.c||(d.c=[]),m={a:R[1],t:Vo.TxO.t},d.c.push(m)}break;case 2173:x7(N[R.ixfe],R.ext);break;case 125:{if(!U.cellStyles)break;for(;R.e>=R.s;)ve[R.e--]={width:R.w/256,level:R.level||0,hidden:!!(R.flags&1)},ee||(ee=!0,lg(R.w/256)),gs(ve[R.e+1])}break;case 520:{var mr={};R.level!=null&&(de[R.r]=mr,mr.level=R.level),R.hidden&&(de[R.r]=mr,mr.hidden=!0),R.hpt&&(de[R.r]=mr,mr.hpt=R.hpt,mr.hpx=So(R.hpt))}break;case 38:case 39:case 40:case 41:i["!margins"]||Gs(i["!margins"]={}),i["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[le]]=R;break;case 161:i["!margins"]||Gs(i["!margins"]={}),i["!margins"].header=R.header,i["!margins"].footer=R.footer;break;case 574:R.RTL&&(w.Views[0].RTL=!0);break;case 146:I=R;break;case 2198:J=R;break;case 140:E=R;break;case 442:c?O.CodeName=R||O.name:w.WBProps.CodeName=R||"ThisWorkbook";break}}else Z||console.error("Missing Info for XLS Record 0x"+le.toString(16)),e.l+=ne}return r.SheetNames=wt(s).sort(function(On,Pe){return Number(On)-Number(Pe)}).map(function(On){return s[On].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&u["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=u)):r.Preamble=u,r.Sheets&&D.forEach(function(On,Pe){r.Sheets[r.SheetNames[Pe]]["!autofilter"]=On}),r.Strings=l,r.SSF=ot(Ee),U.enc&&(r.Encryption=U.enc),J&&(r.Themes=J),r.Metadata={},E!==void 0&&(r.Metadata.Country=E),M.names.length>0&&(w.Names=M.names),r.Workbook=w,r}var bl={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function Pj(e,t,r){var n=we.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var i=G_(n,Np,bl.DSI);for(var s in i)t[s]=i[s]}catch(c){if(r.WTF)throw c}var a=we.find(e,"/!SummaryInformation");if(a&&a.size>0)try{var o=G_(a,Rp,bl.SI);for(var l in o)t[l]==null&&(t[l]=o[l])}catch(c){if(r.WTF)throw c}t.HeadingPairs&&t.TitlesOfParts&&(ZT(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function Oj(e,t){var r=[],n=[],i=[],s=0,a,o=E_(Np,"n"),l=E_(Rp,"n");if(e.Props)for(a=wt(e.Props),s=0;s<a.length;++s)(Object.prototype.hasOwnProperty.call(o,a[s])?r:Object.prototype.hasOwnProperty.call(l,a[s])?n:i).push([a[s],e.Props[a[s]]]);if(e.Custprops)for(a=wt(e.Custprops),s=0;s<a.length;++s)Object.prototype.hasOwnProperty.call(e.Props||{},a[s])||(Object.prototype.hasOwnProperty.call(o,a[s])?r:Object.prototype.hasOwnProperty.call(l,a[s])?n:i).push([a[s],e.Custprops[a[s]]]);var c=[];for(s=0;s<i.length;++s)aS.indexOf(i[s][0])>-1||JT.indexOf(i[s][0])>-1||i[s][1]!=null&&c.push(i[s]);n.length&&we.utils.cfb_add(t,"/SummaryInformation",K_(n,bl.SI,l,Rp)),(r.length||c.length)&&we.utils.cfb_add(t,"/DocumentSummaryInformation",K_(r,bl.DSI,o,Np,c.length?c:null,bl.UDI))}function tC(e,t){t||(t={}),vg(t),B1(),t.codepage&&M1(t.codepage);var r,n;if(e.FullPaths){if(we.find(e,"/encryption"))throw new Error("File is password-protected");r=we.find(e,"!CompObj"),n=we.find(e,"/Workbook")||we.find(e,"/Book")}else{switch(t.type){case"base64":e=Ur($r(e));break;case"binary":e=Ur(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}Yt(e,0),n={content:e}}var i,s;if(r&&Aj(r),t.bookProps&&!t.bookSheets)i={};else{var a=Re?"buffer":"array";if(n&&n.content)i=Rj(n.content,t);else if((s=we.find(e,"PerfectOffice_MAIN"))&&s.content)i=$s.to_workbook(s.content,(t.type=a,t));else if((s=we.find(e,"NativeContent_MAIN"))&&s.content)i=$s.to_workbook(s.content,(t.type=a,t));else throw(s=we.find(e,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&we.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(i.vbaraw=G7(e))}var o={};return e.FullPaths&&Pj(e,o,t),i.Props=i.Custprops=o,t.bookFiles&&(i.cfb=e),i}function Dj(e,t){var r=t||{},n=we.utils.cfb_new({root:"R"}),i="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":i="/Workbook",r.biff=8;break;case"biff5":i="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return we.utils.cfb_add(n,i,rC(e,r)),r.biff==8&&(e.Props||e.Custprops)&&Oj(e,n),r.biff==8&&e.vbaraw&&K7(n,we.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var Ec={0:{f:iW},1:{f:hW},2:{f:RW},3:{f:yW},4:{f:gW},5:{f:AW},6:{f:LW},7:{f:TW},8:{f:HW},9:{f:jW},10:{f:WW},11:{f:VW},12:{f:pW},13:{f:OW},14:{f:EW},15:{f:xW},16:{f:KS},17:{f:BW},18:{f:CW},19:{f:J1},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:BV},40:{},42:{},43:{f:LB},44:{f:DB},45:{f:UB},46:{f:VB},47:{f:WB},48:{},49:{f:oL},50:{},51:{f:w7},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:vS},62:{f:bW},63:{f:N7},64:{f:sV},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:hr,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:tV},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:uW},148:{f:oW,p:16},151:{f:YW},152:{},153:{f:bV},154:{},155:{},156:{f:OV},157:{},158:{},159:{T:1,f:Q5},160:{T:-1},161:{T:1,f:ka},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:zW},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:_7},336:{T:-1},337:{f:T7,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Fp},357:{},358:{},359:{},360:{T:1},361:{},362:{f:gS},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:qW},427:{f:QW},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:ZW},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:cW},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:KW},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Fp},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:V7},633:{T:1},634:{T:-1},635:{T:1,f:U7},636:{T:-1},637:{f:fL},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:EV},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:aV},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Mp={6:{f:ed},10:{f:Di},12:{f:Nt},13:{f:Nt},14:{f:Tt},15:{f:Tt},16:{f:cr},17:{f:Tt},18:{f:Tt},19:{f:Nt},20:{f:Z_},21:{f:Z_},23:{f:gS},24:{f:ty},25:{f:Tt},26:{},27:{},28:{f:a5},29:{},34:{f:Tt},35:{f:ey},38:{f:cr},39:{f:cr},40:{f:cr},41:{f:cr},42:{f:Tt},43:{f:Tt},47:{f:xB},49:{f:OM},51:{f:Nt},60:{},61:{f:AM},64:{f:Tt},65:{f:PM},66:{f:Nt},77:{},80:{},81:{},82:{},85:{f:Nt},89:{},90:{},91:{},92:{f:vM},93:{f:c5},94:{},95:{f:Tt},96:{},97:{},99:{f:Tt},125:{f:vS},128:{f:XM},129:{f:_M},130:{f:Nt},131:{f:Tt},132:{f:Tt},133:{f:yM},134:{},140:{f:v5},141:{f:Nt},144:{},146:{f:y5},151:{},152:{},153:{},154:{},155:{},156:{f:Nt},157:{},158:{},160:{f:I5},161:{f:k5},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:zM},190:{f:$M},193:{f:Di},197:{},198:{},199:{},200:{},201:{},202:{f:Tt},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Nt},220:{},221:{f:Tt},222:{},224:{f:KM},225:{f:gM},226:{f:Di},227:{},229:{f:o5},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:EM},253:{f:bM},255:{f:TM},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:oS},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Tt},353:{f:Di},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:ZM},431:{f:Tt},432:{},433:{},434:{},437:{},438:{f:h5},439:{f:Tt},440:{f:d5},441:{},442:{f:$c},443:{},444:{f:Nt},445:{},446:{},448:{f:Di},449:{f:IM,r:2},450:{f:Di},512:{f:q_},513:{f:C5},515:{f:QM},516:{f:MM},517:{f:J_},519:{f:A5},520:{f:SM},523:{},545:{f:ry},549:{f:Y_},566:{},574:{f:NM},638:{f:HM},659:{},1048:{},1054:{f:UM},1084:{},1212:{f:n5},2048:{f:m5},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Iu},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Di},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:w5,r:12},2173:{f:v7,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Tt,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:r5,r:12},2197:{},2198:{f:f7,r:12},2199:{},2200:{},2201:{},2202:{f:i5,r:12},2203:{f:Di},2204:{},2205:{},2206:{},2207:{},2211:{f:CM},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Nt},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:T5},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:_5},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:q_},1:{},2:{f:O5},3:{f:R5},4:{f:N5},5:{f:J_},7:{f:b5},8:{},9:{f:Iu},11:{},22:{f:Nt},30:{f:VM},31:{},32:{},33:{f:ry},36:{},37:{f:Y_},50:{f:L5},62:{},52:{},67:{},68:{f:Nt},69:{},86:{},126:{},127:{f:F5},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:M5},223:{},234:{},354:{},421:{},518:{f:ed},521:{f:Iu},536:{f:ty},547:{f:ey},561:{},579:{},1030:{f:ed},1033:{f:Iu},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function ue(e,t,r,n){var i=t;if(!isNaN(i)){var s=n||(r||[]).length||0,a=e.next(4);a.write_shift(2,i),a.write_shift(2,s),s>0&&Y1(r)&&e.push(r)}}function bj(e,t,r,n){var i=(r||[]).length||0;if(i<=8224)return ue(e,t,r,i);var s=t;if(!isNaN(s)){for(var a=r.parts||[],o=0,l=0,c=0;c+(a[o]||8224)<=8224;)c+=a[o]||8224,o++;var u=e.next(4);for(u.write_shift(2,s),u.write_shift(2,c),e.push(r.slice(l,l+c)),l+=c;l<i;){for(u=e.next(4),u.write_shift(2,60),c=0;c+(a[o]||8224)<=8224;)c+=a[o]||8224,o++;u.write_shift(2,c),e.push(r.slice(l,l+c)),l+=c}}}function Yc(e,t,r){return e||(e=X(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function Lj(e,t,r,n){var i=X(9);return Yc(i,e,t),lS(r,n||"b",i),i}function Mj(e,t,r){var n=X(8+2*r.length);return Yc(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function Bj(e,t,r,n){if(t.v!=null)switch(t.t){case"d":case"n":var i=t.t=="d"?Mt(at(t.v)):t.v;i==(i|0)&&i>=0&&i<65536?ue(e,2,D5(r,n,i)):ue(e,3,P5(r,n,i));return;case"b":case"e":ue(e,5,Lj(r,n,t.v,t.t));return;case"s":case"str":ue(e,4,Mj(r,n,(t.v||"").slice(0,255)));return}ue(e,1,Yc(null,r,n))}function Uj(e,t,r,n){var i=Array.isArray(t),s=je(t["!ref"]||"A1"),a,o="",l=[];if(s.e.c>255||s.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),a=Ae(s)}for(var c=s.s.r;c<=s.e.r;++c){o=Ct(c);for(var u=s.s.c;u<=s.e.c;++u){c===s.s.r&&(l[u]=ht(u)),a=l[u]+o;var f=i?(t[c]||[])[u]:t[a];f&&Bj(e,f,c,u)}}}function Wj(e,t){for(var r=t||{},n=Or(),i=0,s=0;s<e.SheetNames.length;++s)e.SheetNames[s]==r.sheet&&(i=s);if(i==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return ue(n,r.biff==4?1033:r.biff==3?521:9,sg(e,16,r)),Uj(n,e.Sheets[e.SheetNames[i]],i,r),ue(n,10),n.end()}function Vj(e,t,r){ue(e,49,DM({sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"},r))}function jj(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)t[i]!=null&&ue(e,1054,WM(i,t[i],r))})}function Hj(e,t){var r=X(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),ue(e,2151,r),r=X(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),dS(je(t["!ref"]||"A1"),r),r.write_shift(4,4),ue(e,2152,r)}function zj(e,t){for(var r=0;r<16;++r)ue(e,224,Q_({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){ue(e,224,Q_(n,0,t))})}function $j(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];ue(e,440,p5(n)),n[1].Tooltip&&ue(e,2048,g5(n))}delete t["!links"]}function Gj(e,t){if(t){var r=0;t.forEach(function(n,i){++r<=256&&n&&ue(e,125,E5(th(i,n),i))})}}function Kj(e,t,r,n,i){var s=16+Is(i.cellXfs,t,i);if(t.v==null&&!t.bf){ue(e,513,la(r,n,s));return}if(t.bf)ue(e,6,_U(t,r,n,i,s));else switch(t.t){case"d":case"n":var a=t.t=="d"?Mt(at(t.v)):t.v;ue(e,515,JM(r,n,a,s));break;case"b":case"e":ue(e,517,qM(r,n,t.v,s,i,t.t));break;case"s":case"str":if(i.bookSST){var o=dg(i.Strings,t.v,i.revStrings);ue(e,253,LM(r,n,o,s))}else ue(e,516,BM(r,n,(t.v||"").slice(0,255),s,i));break;default:ue(e,513,la(r,n,s))}}function Xj(e,t,r){var n=Or(),i=r.SheetNames[e],s=r.Sheets[i]||{},a=(r||{}).Workbook||{},o=(a.Sheets||[])[e]||{},l=Array.isArray(s),c=t.biff==8,u,f="",h=[],d=je(s["!ref"]||"A1"),m=c?65536:16384;if(d.e.c>255||d.e.r>=m){if(t.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");d.e.c=Math.min(d.e.c,255),d.e.r=Math.min(d.e.c,m-1)}ue(n,2057,sg(r,16,t)),ue(n,13,rn(1)),ue(n,12,rn(100)),ue(n,15,xr(!0)),ue(n,17,xr(!1)),ue(n,16,aa(.001)),ue(n,95,xr(!0)),ue(n,42,xr(!1)),ue(n,43,xr(!1)),ue(n,130,rn(1)),ue(n,128,YM()),ue(n,131,xr(!1)),ue(n,132,xr(!1)),c&&Gj(n,s["!cols"]),ue(n,512,jM(d,t)),c&&(s["!links"]=[]);for(var p=d.s.r;p<=d.e.r;++p){f=Ct(p);for(var g=d.s.c;g<=d.e.c;++g){p===d.s.r&&(h[g]=ht(g)),u=h[g]+f;var x=l?(s[p]||[])[g]:s[u];x&&(Kj(n,x,p,g,t),c&&x.l&&s["!links"].push([u,x.l]))}}var _=o.CodeName||o.name||i;return c&&ue(n,574,RM((a.Views||[])[0])),c&&(s["!merges"]||[]).length&&ue(n,229,l5(s["!merges"])),c&&$j(n,s),ue(n,442,cS(_)),c&&Hj(n,s),ue(n,10),n.end()}function Yj(e,t,r){var n=Or(),i=(e||{}).Workbook||{},s=i.Sheets||[],a=i.WBProps||{},o=r.biff==8,l=r.biff==5;if(ue(n,2057,sg(e,5,r)),r.bookType=="xla"&&ue(n,135),ue(n,225,o?rn(1200):null),ue(n,193,qL(2)),l&&ue(n,191),l&&ue(n,192),ue(n,226),ue(n,92,xM("SheetJS",r)),ue(n,66,rn(o?1200:1252)),o&&ue(n,353,rn(0)),o&&ue(n,448),ue(n,317,S5(e.SheetNames.length)),o&&e.vbaraw&&ue(n,211),o&&e.vbaraw){var c=a.CodeName||"ThisWorkbook";ue(n,442,cS(c))}ue(n,156,rn(17)),ue(n,25,xr(!1)),ue(n,18,xr(!1)),ue(n,19,rn(0)),o&&ue(n,431,xr(!1)),o&&ue(n,444,rn(0)),ue(n,61,FM()),ue(n,64,xr(!1)),ue(n,141,rn(0)),ue(n,34,xr(IV(e)=="true")),ue(n,14,xr(!0)),o&&ue(n,439,xr(!1)),ue(n,218,rn(0)),Vj(n,e,r),jj(n,e.SSF,r),zj(n,r),o&&ue(n,352,xr(!1));var u=n.end(),f=Or();o&&ue(f,140,x5()),o&&r.Strings&&bj(f,252,kM(r.Strings)),ue(f,10);var h=f.end(),d=Or(),m=0,p=0;for(p=0;p<e.SheetNames.length;++p)m+=(o?12:11)+(o?2:1)*e.SheetNames[p].length;var g=u.length+m+h.length;for(p=0;p<e.SheetNames.length;++p){var x=s[p]||{};ue(d,133,wM({pos:g,hs:x.Hidden||0,dt:0,name:e.SheetNames[p]},r)),g+=t[p].length}var _=d.end();if(m!=_.length)throw new Error("BS8 "+m+" != "+_.length);var v=[];return u.length&&v.push(u),_.length&&v.push(_),h.length&&v.push(h),zt(v)}function qj(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=ot(Ee)),e&&e.SSF&&(Mo(),X0(e.SSF),r.revssf=q0(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,xg(r),r.cellXfs=[],Is(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var i=0;i<e.SheetNames.length;++i)n[n.length]=Xj(i,r,e);return n.unshift(Yj(e,n,r)),zt(n)}function rC(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(!(!n||!n["!ref"])){var i=Dr(n["!ref"]);i.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var s=t||{};switch(s.biff||2){case 8:case 5:return qj(e,t);case 4:case 3:case 2:return Wj(e,t)}throw new Error("invalid type "+s.bookType+" for BIFF")}function hy(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var i=e.match(/<table/i);if(!i)throw new Error("Invalid HTML: could not find <table>");var s=e.match(/<\/table/i),a=i.index,o=s&&s.index||e.length,l=D6(e.slice(a,o),/(:?<tr[^>]*>)/i,"<tr>"),c=-1,u=0,f=0,h=0,d={s:{r:1e7,c:1e7},e:{r:0,c:0}},m=[];for(a=0;a<l.length;++a){var p=l[a].trim(),g=p.slice(0,3).toLowerCase();if(g=="<tr"){if(++c,r.sheetRows&&r.sheetRows<=c){--c;break}u=0;continue}if(!(g!="<td"&&g!="<th")){var x=p.split(/<\/t[dh]>/i);for(o=0;o<x.length;++o){var _=x[o].trim();if(_.match(/<t[dh]/i)){for(var v=_,E=0;v.charAt(0)=="<"&&(E=v.indexOf(">"))>-1;)v=v.slice(E+1);for(var N=0;N<m.length;++N){var I=m[N];I.s.c==u&&I.s.r<c&&c<=I.e.r&&(u=I.e.c+1,N=-1)}var w=Te(_.slice(0,_.indexOf(">")));h=w.colspan?+w.colspan:1,((f=+w.rowspan)>1||h>1)&&m.push({s:{r:c,c:u},e:{r:c+(f||1)-1,c:u+h-1}});var O=w.t||w["data-t"]||"";if(!v.length){u+=h;continue}if(v=CT(v),d.s.r>c&&(d.s.r=c),d.e.r<c&&(d.e.r=c),d.s.c>u&&(d.s.c=u),d.e.c<u&&(d.e.c=u),!v.length){u+=h;continue}var P={t:"s",v};r.raw||!v.trim().length||O=="s"||(v==="TRUE"?P={t:"b",v:!0}:v==="FALSE"?P={t:"b",v:!1}:isNaN(In(v))?isNaN(ko(v).getDate())||(P={t:"d",v:at(v)},r.cellDates||(P={t:"n",v:Mt(P.v)}),P.z=r.dateNF||Ee[14]):P={t:"n",v:In(v)}),r.dense?(n[c]||(n[c]=[]),n[c][u]=P):n[ke({r:c,c:u})]=P,u+=h}}}}return n["!ref"]=Ae(d),m.length&&(n["!merges"]=m),n}function Qj(e,t,r,n){for(var i=e["!merges"]||[],s=[],a=t.s.c;a<=t.e.c;++a){for(var o=0,l=0,c=0;c<i.length;++c)if(!(i[c].s.r>r||i[c].s.c>a)&&!(i[c].e.r<r||i[c].e.c<a)){if(i[c].s.r<r||i[c].s.c<a){o=-1;break}o=i[c].e.r-i[c].s.r+1,l=i[c].e.c-i[c].s.c+1;break}if(!(o<0)){var u=ke({r,c:a}),f=n.dense?(e[r]||[])[a]:e[u],h=f&&f.v!=null&&(f.h||G1(f.w||(Ti(f),f.w)||""))||"",d={};o>1&&(d.rowspan=o),l>1&&(d.colspan=l),n.editable?h='<span contenteditable="true">'+h+"</span>":f&&(d["data-t"]=f&&f.t||"z",f.v!=null&&(d["data-v"]=f.v),f.z!=null&&(d["data-z"]=f.z),f.l&&(f.l.Target||"#").charAt(0)!="#"&&(h='<a href="'+f.l.Target+'">'+h+"</a>")),d.id=(n.id||"sjs")+"-"+u,s.push(ce("td",h,d))}}var m="<tr>";return m+s.join("")+"</tr>"}var Jj='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',Zj="</body></html>";function eH(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Cs(hy(r[0],t),t);var n=wg();return r.forEach(function(i,s){Eg(n,hy(i,t),"Sheet"+(s+1))}),n}function tH(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function nC(e,t){var r=t||{},n=r.header!=null?r.header:Jj,i=r.footer!=null?r.footer:Zj,s=[n],a=Dr(e["!ref"]);r.dense=Array.isArray(e),s.push(tH(e,a,r));for(var o=a.s.r;o<=a.e.r;++o)s.push(Qj(e,a,o,r));return s.push("</table>"+i),s.join("")}function iC(e,t,r){var n=r||{},i=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var a=typeof n.origin=="string"?dt(n.origin):n.origin;i=a.r,s=a.c}var o=t.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,o.length),c={s:{r:0,c:0},e:{r:i,c:s}};if(e["!ref"]){var u=Dr(e["!ref"]);c.s.r=Math.min(c.s.r,u.s.r),c.s.c=Math.min(c.s.c,u.s.c),c.e.r=Math.max(c.e.r,u.e.r),c.e.c=Math.max(c.e.c,u.e.c),i==-1&&(c.e.r=i=u.e.r+1)}var f=[],h=0,d=e["!rows"]||(e["!rows"]=[]),m=0,p=0,g=0,x=0,_=0,v=0;for(e["!cols"]||(e["!cols"]=[]);m<o.length&&p<l;++m){var E=o[m];if(dy(E)){if(n.display)continue;d[p]={hidden:!0}}var N=E.children;for(g=x=0;g<N.length;++g){var I=N[g];if(!(n.display&&dy(I))){var w=I.hasAttribute("data-v")?I.getAttribute("data-v"):I.hasAttribute("v")?I.getAttribute("v"):CT(I.innerHTML),O=I.getAttribute("data-z")||I.getAttribute("z");for(h=0;h<f.length;++h){var P=f[h];P.s.c==x+s&&P.s.r<p+i&&p+i<=P.e.r&&(x=P.e.c+1-s,h=-1)}v=+I.getAttribute("colspan")||1,((_=+I.getAttribute("rowspan")||1)>1||v>1)&&f.push({s:{r:p+i,c:x+s},e:{r:p+i+(_||1)-1,c:x+s+(v||1)-1}});var W={t:"s",v:w},j=I.getAttribute("data-t")||I.getAttribute("t")||"";w!=null&&(w.length==0?W.t=j||"z":n.raw||w.trim().length==0||j=="s"||(w==="TRUE"?W={t:"b",v:!0}:w==="FALSE"?W={t:"b",v:!1}:isNaN(In(w))?isNaN(ko(w).getDate())||(W={t:"d",v:at(w)},n.cellDates||(W={t:"n",v:Mt(W.v)}),W.z=n.dateNF||Ee[14]):W={t:"n",v:In(w)})),W.z===void 0&&O!=null&&(W.z=O);var U="",J=I.getElementsByTagName("A");if(J&&J.length)for(var ge=0;ge<J.length&&!(J[ge].hasAttribute("href")&&(U=J[ge].getAttribute("href"),U.charAt(0)!="#"));++ge);U&&U.charAt(0)!="#"&&(W.l={Target:U}),n.dense?(e[p+i]||(e[p+i]=[]),e[p+i][x+s]=W):e[ke({c:x+s,r:p+i})]=W,c.e.c<x+s&&(c.e.c=x+s),x+=v}}++p}return f.length&&(e["!merges"]=(e["!merges"]||[]).concat(f)),c.e.r=Math.max(c.e.r,p-1+i),e["!ref"]=Ae(c),p>=l&&(e["!fullref"]=Ae((c.e.r=o.length-m+p-1+i,c))),e}function sC(e,t){var r=t||{},n=r.dense?[]:{};return iC(n,e,t)}function rH(e,t){return Cs(sC(e,t),t)}function dy(e){var t="",r=nH(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function nH(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function iH(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,i){return Array(parseInt(i,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=Ve(t.replace(/<[^>]*>/g,""));return[r]}var py={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function aC(e,t){var r=t||{},n=K1(e),i=[],s,a,o={name:""},l="",c=0,u,f,h={},d=[],m=r.dense?[]:{},p,g,x={value:""},_="",v=0,E=[],N=-1,I=-1,w={s:{r:1e6,c:1e7},e:{r:0,c:0}},O=0,P={},W=[],j={},U=0,J=0,ge=[],fe=1,ve=1,de=[],ee={Names:[]},M={},se=["",""],xe=[],A={},B="",D=0,b=!1,K=!1,ie=0;for(gc.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");p=gc.exec(n);)switch(p[3]=p[3].replace(/_.*$/,"")){case"table":case"":p[1]==="/"?(w.e.c>=w.s.c&&w.e.r>=w.s.r?m["!ref"]=Ae(w):m["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=w.e.r&&(m["!fullref"]=m["!ref"],w.e.r=r.sheetRows-1,m["!ref"]=Ae(w)),W.length&&(m["!merges"]=W),ge.length&&(m["!rows"]=ge),u.name=u.||u.name,typeof JSON<"u"&&JSON.stringify(u),d.push(u.name),h[u.name]=m,K=!1):p[0].charAt(p[0].length-2)!=="/"&&(u=Te(p[0],!1),N=I=-1,w.s.r=w.s.c=1e7,w.e.r=w.e.c=0,m=r.dense?[]:{},W=[],ge=[],K=!0);break;case"table-row-group":p[1]==="/"?--O:++O;break;case"table-row":case"":if(p[1]==="/"){N+=fe,fe=1;break}if(f=Te(p[0],!1),f.?N=f.-1:N==-1&&(N=0),fe=+f["number-rows-repeated"]||1,fe<10)for(ie=0;ie<fe;++ie)O>0&&(ge[N+ie]={level:O});I=-1;break;case"covered-table-cell":p[1]!=="/"&&++I,r.sheetStubs&&(r.dense?(m[N]||(m[N]=[]),m[N][I]={t:"z"}):m[ke({r:N,c:I})]={t:"z"}),_="",E=[];break;case"table-cell":case"":if(p[0].charAt(p[0].length-2)==="/")++I,x=Te(p[0],!1),ve=parseInt(x["number-columns-repeated"]||"1",10),g={t:"z",v:null},x.formula&&r.cellFormula!=!1&&(g.f=cy(Ve(x.formula))),(x.||x["value-type"])=="string"&&(g.t="s",g.v=Ve(x["string-value"]||""),r.dense?(m[N]||(m[N]=[]),m[N][I]=g):m[ke({r:N,c:I})]=g),I+=ve-1;else if(p[1]!=="/"){++I,_="",v=0,E=[],ve=1;var le=fe?N+fe-1:N;if(I>w.e.c&&(w.e.c=I),I<w.s.c&&(w.s.c=I),N<w.s.r&&(w.s.r=N),le>w.e.r&&(w.e.r=le),x=Te(p[0],!1),xe=[],A={},g={t:x.||x["value-type"],v:null},r.cellFormula)if(x.formula&&(x.formula=Ve(x.formula)),x["number-matrix-columns-spanned"]&&x["number-matrix-rows-spanned"]&&(U=parseInt(x["number-matrix-rows-spanned"],10)||0,J=parseInt(x["number-matrix-columns-spanned"],10)||0,j={s:{r:N,c:I},e:{r:N+U-1,c:I+J-1}},g.F=Ae(j),de.push([j,g.F])),x.formula)g.f=cy(x.formula);else for(ie=0;ie<de.length;++ie)N>=de[ie][0].s.r&&N<=de[ie][0].e.r&&I>=de[ie][0].s.c&&I<=de[ie][0].e.c&&(g.F=de[ie][1]);switch((x["number-columns-spanned"]||x["number-rows-spanned"])&&(U=parseInt(x["number-rows-spanned"],10)||0,J=parseInt(x["number-columns-spanned"],10)||0,j={s:{r:N,c:I},e:{r:N+U-1,c:I+J-1}},W.push(j)),x["number-columns-repeated"]&&(ve=parseInt(x["number-columns-repeated"],10)),g.t){case"boolean":g.t="b",g.v=it(x["boolean-value"]);break;case"float":g.t="n",g.v=parseFloat(x.value);break;case"percentage":g.t="n",g.v=parseFloat(x.value);break;case"currency":g.t="n",g.v=parseFloat(x.value);break;case"date":g.t="d",g.v=at(x["date-value"]),r.cellDates||(g.t="n",g.v=Mt(g.v)),g.z="m/d/yy";break;case"time":g.t="n",g.v=R6(x["time-value"])/86400,r.cellDates&&(g.t="d",g.v=Q0(g.v)),g.z="HH:MM:SS";break;case"number":g.t="n",g.v=parseFloat(x.);break;default:if(g.t==="string"||g.t==="text"||!g.t)g.t="s",x["string-value"]!=null&&(_=Ve(x["string-value"]),E=[]);else throw new Error("Unsupported value type "+g.t)}}else{if(b=!1,g.t==="s"&&(g.v=_||"",E.length&&(g.R=E),b=v==0),M.Target&&(g.l=M),xe.length>0&&(g.c=xe,xe=[]),_&&r.cellText!==!1&&(g.w=_),b&&(g.t="z",delete g.v),(!b||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=N))for(var ne=0;ne<fe;++ne){if(ve=parseInt(x["number-columns-repeated"]||"1",10),r.dense)for(m[N+ne]||(m[N+ne]=[]),m[N+ne][I]=ne==0?g:ot(g);--ve>0;)m[N+ne][I+ve]=ot(g);else for(m[ke({r:N+ne,c:I})]=g;--ve>0;)m[ke({r:N+ne,c:I+ve})]=ot(g);w.e.c<=I&&(w.e.c=I)}ve=parseInt(x["number-columns-repeated"]||"1",10),I+=ve-1,ve=0,g={},_="",E=[]}M={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(p[1]==="/"){if((s=i.pop())[0]!==p[3])throw"Bad state: "+s}else p[0].charAt(p[0].length-2)!=="/"&&i.push([p[3],!0]);break;case"annotation":if(p[1]==="/"){if((s=i.pop())[0]!==p[3])throw"Bad state: "+s;A.t=_,E.length&&(A.R=E),A.a=B,xe.push(A)}else p[0].charAt(p[0].length-2)!=="/"&&i.push([p[3],!1]);B="",D=0,_="",v=0,E=[];break;case"creator":p[1]==="/"?B=n.slice(D,p.index):D=p.index+p[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(p[1]==="/"){if((s=i.pop())[0]!==p[3])throw"Bad state: "+s}else p[0].charAt(p[0].length-2)!=="/"&&i.push([p[3],!1]);_="",v=0,E=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(p[1]==="/"){if(P[o.name]=l,(s=i.pop())[0]!==p[3])throw"Bad state: "+s}else p[0].charAt(p[0].length-2)!=="/"&&(l="",o=Te(p[0],!1),i.push([p[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(i[i.length-1][0]){case"time-style":case"date-style":a=Te(p[0],!1),l+=py[p[3]][a.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(i[i.length-1][0]){case"time-style":case"date-style":a=Te(p[0],!1),l+=py[p[3]][a.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(p[0].slice(-2)==="/>")break;if(p[1]==="/")switch(i[i.length-1][0]){case"number-style":case"date-style":case"time-style":l+=n.slice(c,p.index);break}else c=p.index+p[0].length;break;case"named-range":a=Te(p[0],!1),se=td(a["cell-range-address"]);var Z={Name:a.name,Ref:se[0]+"!"+se[1]};K&&(Z.Sheet=d.length),ee.Names.push(Z);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(i[i.length-1][0])>-1)break;if(p[1]==="/"&&(!x||!x["string-value"])){var Ne=iH(n.slice(v,p.index));_=(_.length>0?_+`
`:"")+Ne[0]}else Te(p[0],!1),v=p.index+p[0].length;break;case"s":break;case"database-range":if(p[1]==="/")break;try{se=td(Te(p[0])["target-range-address"]),h[se[0]]["!autofilter"]={ref:se[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(p[1]!=="/"){if(M=Te(p[0],!1),!M.href)break;M.Target=Ve(M.href),delete M.href,M.Target.charAt(0)=="#"&&M.Target.indexOf(".")>-1?(se=td(M.Target.slice(1)),M.Target="#"+se[0]+"!"+se[1]):M.Target.match(/^\.\.[\\\/]/)&&(M.Target=M.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(p[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(p)}}var R={Sheets:h,SheetNames:d,Workbook:ee};return r.bookSheets&&delete R.Sheets,R}function my(e,t){t=t||{},tn(e,"META-INF/manifest.xml")&&RL(Ft(e,"META-INF/manifest.xml"),t);var r=Wr(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=aC(qe(r),t);return tn(e,"meta.xml")&&(n.Props=qT(Ft(e,"meta.xml"))),n}function gy(e,t){return aC(e,t)}var sH=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+mc({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return It+t}}(),vy=function(){var e=function(s){return Ke(s).replace(/  +/g,function(a){return'<text:s text:c="'+a.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(s,a,o){var l=[];l.push('      <table:table table:name="'+Ke(a.SheetNames[o])+`" table:style-name="ta1">
`);var c=0,u=0,f=Dr(s["!ref"]||"A1"),h=s["!merges"]||[],d=0,m=Array.isArray(s);if(s["!cols"])for(u=0;u<=f.e.c;++u)l.push("        <table:table-column"+(s["!cols"][u]?' table:style-name="co'+s["!cols"][u].ods+'"':"")+`></table:table-column>
`);var p="",g=s["!rows"]||[];for(c=0;c<f.s.r;++c)p=g[c]?' table:style-name="ro'+g[c].ods+'"':"",l.push("        <table:table-row"+p+`></table:table-row>
`);for(;c<=f.e.r;++c){for(p=g[c]?' table:style-name="ro'+g[c].ods+'"':"",l.push("        <table:table-row"+p+`>
`),u=0;u<f.s.c;++u)l.push(t);for(;u<=f.e.c;++u){var x=!1,_={},v="";for(d=0;d!=h.length;++d)if(!(h[d].s.c>u)&&!(h[d].s.r>c)&&!(h[d].e.c<u)&&!(h[d].e.r<c)){(h[d].s.c!=u||h[d].s.r!=c)&&(x=!0),_["table:number-columns-spanned"]=h[d].e.c-h[d].s.c+1,_["table:number-rows-spanned"]=h[d].e.r-h[d].s.r+1;break}if(x){l.push(r);continue}var E=ke({r:c,c:u}),N=m?(s[c]||[])[u]:s[E];if(N&&N.f&&(_["table:formula"]=Ke(SU(N.f)),N.F&&N.F.slice(0,E.length)==E)){var I=Dr(N.F);_["table:number-matrix-columns-spanned"]=I.e.c-I.s.c+1,_["table:number-matrix-rows-spanned"]=I.e.r-I.s.r+1}if(!N){l.push(t);continue}switch(N.t){case"b":v=N.v?"TRUE":"FALSE",_["office:value-type"]="boolean",_["office:boolean-value"]=N.v?"true":"false";break;case"n":v=N.w||String(N.v||0),_["office:value-type"]="float",_["office:value"]=N.v||0;break;case"s":case"str":v=N.v==null?"":N.v,_["office:value-type"]="string";break;case"d":v=N.w||at(N.v).toISOString(),_["office:value-type"]="date",_["office:date-value"]=at(N.v).toISOString(),_["table:style-name"]="ce1";break;default:l.push(t);continue}var w=e(v);if(N.l&&N.l.Target){var O=N.l.Target;O=O.charAt(0)=="#"?"#"+CU(O.slice(1)):O,O.charAt(0)!="#"&&!O.match(/^\w+:/)&&(O="../"+O),w=ce("text:a",w,{"xlink:href":O.replace(/&/g,"&amp;")})}l.push("          "+ce("table:table-cell",ce("text:p",w,{}),_)+`
`)}l.push(`        </table:table-row>
`)}return l.push(`      </table:table>
`),l.join("")},i=function(s,a){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var o=0;a.SheetNames.map(function(c){return a.Sheets[c]}).forEach(function(c){if(c&&c["!cols"]){for(var u=0;u<c["!cols"].length;++u)if(c["!cols"][u]){var f=c["!cols"][u];if(f.width==null&&f.wpx==null&&f.wch==null)continue;gs(f),f.ods=o;var h=c["!cols"][u].wpx+"px";s.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+h+`"/>
`),s.push(`  </style:style>
`),++o}}});var l=0;a.SheetNames.map(function(c){return a.Sheets[c]}).forEach(function(c){if(c&&c["!rows"]){for(var u=0;u<c["!rows"].length;++u)if(c["!rows"][u]){c["!rows"][u].ods=l;var f=c["!rows"][u].hpx+"px";s.push('  <style:style style:name="ro'+l+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+f+`"/>
`),s.push(`  </style:style>
`),++l}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(a,o){var l=[It],c=mc({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),u=mc({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(l.push("<office:document"+c+u+`>
`),l.push(YT().replace(/office:document-meta/g,"office:meta"))):l.push("<office:document-content"+c+`>
`),i(l,a),l.push(`  <office:body>
`),l.push(`    <office:spreadsheet>
`);for(var f=0;f!=a.SheetNames.length;++f)l.push(n(a.Sheets[a.SheetNames[f]],a,f));return l.push(`    </office:spreadsheet>
`),l.push(`  </office:body>
`),o.bookType=="fods"?l.push("</office:document>"):l.push("</office:document-content>"),l.join("")}}();function oC(e,t){if(t.bookType=="fods")return vy(e,t);var r=H1(),n="",i=[],s=[];return n="mimetype",Fe(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",Fe(r,n,vy(e,t)),i.push([n,"text/xml"]),s.push([n,"ContentFile"]),n="styles.xml",Fe(r,n,sH(e,t)),i.push([n,"text/xml"]),s.push([n,"StylesFile"]),n="meta.xml",Fe(r,n,It+YT()),i.push([n,"text/xml"]),s.push([n,"MetadataFile"]),n="manifest.rdf",Fe(r,n,DL(s)),i.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",Fe(r,n,PL(i)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function ca(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Bp(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):qe(Ss(e))}function aH(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):Ur(Wn(e))}function oH(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var n=0;n<t.length;++n)if(e[r+n]!=t[n])continue e;return!0}return!1}function xs(e){var t=e.reduce(function(i,s){return i+s.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(i){r.set(i,n),n+=i.length}),r}function xy(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function lH(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,i=t+13;i>=t;--i)n=n*256+e[i];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function cH(e,t,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,i=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(n&127)<<1;for(var s=0;i>=1;++s,i/=256)e[t+s]=i&255;e[t+15]|=r>=0?0:128}function kc(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function $e(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function yt(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function He(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],i=kc(e,r),s=i&7;i=Math.floor(i/8);var a=0,o;if(i==0)break;switch(s){case 0:{for(var l=r[0];e[r[0]++]>=128;);o=e.slice(l,r[0])}break;case 5:a=4,o=e.slice(r[0],r[0]+a),r[0]+=a;break;case 1:a=8,o=e.slice(r[0],r[0]+a),r[0]+=a;break;case 2:a=kc(e,r),o=e.slice(r[0],r[0]+a),r[0]+=a;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(i," at offset ").concat(n))}var c={data:o,type:s};t[i]==null?t[i]=[c]:t[i].push(c)}return t}function Kt(e){var t=[];return e.forEach(function(r,n){r.forEach(function(i){i.data&&(t.push($e(n*8+i.type)),i.type==2&&t.push($e(i.data.length)),t.push(i.data))})}),xs(t)}function gg(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function Zr(e){for(var t,r=[],n=[0];n[0]<e.length;){var i=kc(e,n),s=He(e.slice(n[0],n[0]+i));n[0]+=i;var a={id:yt(s[1][0].data),messages:[]};s[2].forEach(function(o){var l=He(o.data),c=yt(l[3][0].data);a.messages.push({meta:l,data:e.slice(n[0],n[0]+c)}),n[0]+=c}),(t=s[3])!=null&&t[0]&&(a.merge=yt(s[3][0].data)>>>0>0),r.push(a)}return r}function Aa(e){var t=[];return e.forEach(function(r){var n=[];n[1]=[{data:$e(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:$e(+!!r.merge),type:0}]);var i=[];r.messages.forEach(function(a){i.push(a.data),a.meta[3]=[{type:0,data:$e(a.data.length)}],n[2].push({data:Kt(a.meta),type:2})});var s=Kt(n);t.push($e(s.length)),t.push(s),i.forEach(function(a){return t.push(a)})}),xs(t)}function uH(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=kc(t,r),i=[];r[0]<t.length;){var s=t[r[0]]&3;if(s==0){var a=t[r[0]++]>>2;if(a<60)++a;else{var o=a-59;a=t[r[0]],o>1&&(a|=t[r[0]+1]<<8),o>2&&(a|=t[r[0]+2]<<16),o>3&&(a|=t[r[0]+3]<<24),a>>>=0,a++,r[0]+=o}i.push(t.slice(r[0],r[0]+a)),r[0]+=a;continue}else{var l=0,c=0;if(s==1?(c=(t[r[0]]>>2&7)+4,l=(t[r[0]++]&224)<<3,l|=t[r[0]++]):(c=(t[r[0]++]>>2)+1,s==2?(l=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(l=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),i=[xs(i)],l==0)throw new Error("Invalid offset 0");if(l>i[0].length)throw new Error("Invalid offset beyond length");if(c>=l)for(i.push(i[0].slice(-l)),c-=l;c>=i[i.length-1].length;)i.push(i[i.length-1]),c-=i[i.length-1].length;i.push(i[0].slice(-l,-l+c))}}var u=xs(i);if(u.length!=n)throw new Error("Unexpected length: ".concat(u.length," != ").concat(n));return u}function en(e){for(var t=[],r=0;r<e.length;){var n=e[r++],i=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(uH(n,e.slice(r,r+i))),r+=i}if(r!==e.length)throw new Error("data is not a valid framed stream!");return xs(t)}function Fa(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),i=new Uint8Array(4);t.push(i);var s=$e(n),a=s.length;t.push(s),n<=60?(a++,t.push(new Uint8Array([n-1<<2]))):n<=256?(a+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(a+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(a+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(a+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e.slice(r,r+n)),a+=n,i[0]=0,i[1]=a&255,i[2]=a>>8&255,i[3]=a>>16&255,r+=n}return xs(t)}function fH(e,t,r,n){var i=ca(e),s=i.getUint32(4,!0),a=(n>1?12:8)+xy(s&(n>1?3470:398))*4,o=-1,l=-1,c=NaN,u=new Date(2001,0,1);s&512&&(o=i.getUint32(a,!0),a+=4),a+=xy(s&(n>1?12288:4096))*4,s&16&&(l=i.getUint32(a,!0),a+=4),s&32&&(c=i.getFloat64(a,!0),a+=8),s&64&&(u.setTime(u.getTime()+i.getFloat64(a,!0)*1e3),a+=8);var f;switch(e[2]){case 0:break;case 2:f={t:"n",v:c};break;case 3:f={t:"s",v:t[l]};break;case 5:f={t:"d",v:u};break;case 6:f={t:"b",v:c>0};break;case 7:f={t:"n",v:c/86400};break;case 8:f={t:"e",v:0};break;case 9:if(o>-1)f={t:"s",v:r[o]};else if(l>-1)f={t:"s",v:t[l]};else if(!isNaN(c))f={t:"n",v:c};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return f}function hH(e,t,r){var n=ca(e),i=n.getUint32(8,!0),s=12,a=-1,o=-1,l=NaN,c=NaN,u=new Date(2001,0,1);i&1&&(l=lH(e,s),s+=16),i&2&&(c=n.getFloat64(s,!0),s+=8),i&4&&(u.setTime(u.getTime()+n.getFloat64(s,!0)*1e3),s+=8),i&8&&(o=n.getUint32(s,!0),s+=4),i&16&&(a=n.getUint32(s,!0),s+=4);var f;switch(e[1]){case 0:break;case 2:f={t:"n",v:l};break;case 3:f={t:"s",v:t[o]};break;case 5:f={t:"d",v:u};break;case 6:f={t:"b",v:c>0};break;case 7:f={t:"n",v:c/86400};break;case 8:f={t:"e",v:0};break;case 9:if(a>-1)f={t:"s",v:r[a]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(i&31," : ").concat(e.slice(0,4)));break;case 10:f={t:"n",v:l};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(i&31," : ").concat(e.slice(0,4)))}return f}function nd(e,t){var r=new Uint8Array(32),n=ca(r),i=12,s=0;switch(r[0]=5,e.t){case"n":r[1]=2,cH(r,i,e.v),s|=1,i+=16;break;case"b":r[1]=6,n.setFloat64(i,e.v?1:0,!0),s|=2,i+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,n.setUint32(i,t.indexOf(e.v),!0),s|=8,i+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,s,!0),r.slice(0,i)}function id(e,t){var r=new Uint8Array(32),n=ca(r),i=12,s=0;switch(r[0]=3,e.t){case"n":r[2]=2,n.setFloat64(i,e.v,!0),s|=32,i+=8;break;case"b":r[2]=6,n.setFloat64(i,e.v?1:0,!0),s|=32,i+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,n.setUint32(i,t.indexOf(e.v),!0),s|=16,i+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,s,!0),r.slice(0,i)}function dH(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return fH(e,t,r,e[0]);case 5:return hH(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function sr(e){var t=He(e);return kc(t[1][0].data)}function _y(e,t){var r=He(t.data),n=yt(r[1][0].data),i=r[3],s=[];return(i||[]).forEach(function(a){var o=He(a.data),l=yt(o[1][0].data)>>>0;switch(n){case 1:s[l]=Bp(o[3][0].data);break;case 8:{var c=e[sr(o[9][0].data)][0],u=He(c.data),f=e[sr(u[1][0].data)][0],h=yt(f.meta[1][0].data);if(h!=2001)throw new Error("2000 unexpected reference to ".concat(h));var d=He(f.data);s[l]=d[3].map(function(m){return Bp(m.data)}).join("")}break}}),s}function pH(e,t){var r,n,i,s,a,o,l,c,u,f,h,d,m,p,g=He(e),x=yt(g[1][0].data)>>>0,_=yt(g[2][0].data)>>>0,v=((n=(r=g[8])==null?void 0:r[0])==null?void 0:n.data)&&yt(g[8][0].data)>0||!1,E,N;if((s=(i=g[7])==null?void 0:i[0])!=null&&s.data&&t!=0)E=(o=(a=g[7])==null?void 0:a[0])==null?void 0:o.data,N=(c=(l=g[6])==null?void 0:l[0])==null?void 0:c.data;else if((f=(u=g[4])==null?void 0:u[0])!=null&&f.data&&t!=1)E=(d=(h=g[4])==null?void 0:h[0])==null?void 0:d.data,N=(p=(m=g[3])==null?void 0:m[0])==null?void 0:p.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var I=v?4:1,w=ca(E),O=[],P=0;P<E.length/2;++P){var W=w.getUint16(P*2,!0);W<65535&&O.push([P,W])}if(O.length!=_)throw"Expected ".concat(_," cells, found ").concat(O.length);var j=[];for(P=0;P<O.length-1;++P)j[O[P][0]]=N.subarray(O[P][1]*I,O[P+1][1]*I);return O.length>=1&&(j[O[O.length-1][0]]=N.subarray(O[O.length-1][1]*I)),{R:x,cells:j}}function mH(e,t){var r,n=He(t.data),i=(r=n==null?void 0:n[7])!=null&&r[0]?yt(n[7][0].data)>>>0>0?1:0:-1,s=gg(n[5],function(a){return pH(a,i)});return{nrows:yt(n[4][0].data)>>>0,data:s.reduce(function(a,o){return a[o.R]||(a[o.R]=[]),o.cells.forEach(function(l,c){if(a[o.R][c])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(c));a[o.R][c]=l}),a},[])}}function gH(e,t,r){var n,i=He(t.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(yt(i[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(i[6][0].data));if(s.e.c=(yt(i[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(i[7][0].data));r["!ref"]=Ae(s);var a=He(i[4][0].data),o=_y(e,e[sr(a[4][0].data)][0]),l=(n=a[17])!=null&&n[0]?_y(e,e[sr(a[17][0].data)][0]):[],c=He(a[3][0].data),u=0;c[1].forEach(function(f){var h=He(f.data),d=e[sr(h[2][0].data)][0],m=yt(d.meta[1][0].data);if(m!=6002)throw new Error("6001 unexpected reference to ".concat(m));var p=mH(e,d);p.data.forEach(function(g,x){g.forEach(function(_,v){var E=ke({r:u+x,c:v}),N=dH(_,o,l);N&&(r[E]=N)})}),u+=p.nrows})}function vH(e,t){var r=He(t.data),n={"!ref":"A1"},i=e[sr(r[2][0].data)],s=yt(i[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return gH(e,i[0],n),n}function xH(e,t){var r,n=He(t.data),i={name:(r=n[1])!=null&&r[0]?Bp(n[1][0].data):"",sheets:[]},s=gg(n[2],sr);return s.forEach(function(a){e[a].forEach(function(o){var l=yt(o.meta[1][0].data);l==6e3&&i.sheets.push(vH(e,o))})}),i}function _H(e,t){var r=wg(),n=He(t.data),i=gg(n[1],sr);if(i.forEach(function(s){e[s].forEach(function(a){var o=yt(a.meta[1][0].data);if(o==2){var l=xH(e,a);l.sheets.forEach(function(c,u){Eg(r,c,u==0?l.name:l.name+"_"+u,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function sd(e){var t,r,n,i,s={},a=[];if(e.FullPaths.forEach(function(l){if(l.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(l){if(l.name.match(/\.iwa$/)){var c;try{c=en(l.content)}catch(f){return console.log("?? "+l.content.length+" "+(f.message||f))}var u;try{u=Zr(c)}catch(f){return console.log("## "+(f.message||f))}u.forEach(function(f){s[f.id]=f.messages,a.push(f.id)})}}),!a.length)throw new Error("File has no messages");var o=((i=(n=(r=(t=s==null?void 0:s[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:i[0].data)&&yt(s[1][0].meta[1][0].data)==1&&s[1][0];if(o||a.forEach(function(l){s[l].forEach(function(c){var u=yt(c.meta[1][0].data)>>>0;if(u==1)if(!o)o=c;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return _H(s,o)}function yH(e,t,r){var n,i,s,a;if(!((n=e[6])!=null&&n[0])||!((i=e[7])!=null&&i[0]))throw"Mutation only works on post-BNC storages!";var o=((a=(s=e[8])==null?void 0:s[0])==null?void 0:a.data)&&yt(e[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var l=0,c=ca(e[7][0].data),u=0,f=[],h=ca(e[4][0].data),d=0,m=[],p=0;p<t.length;++p){if(t[p]==null){c.setUint16(p*2,65535,!0),h.setUint16(p*2,65535);continue}c.setUint16(p*2,u,!0),h.setUint16(p*2,d,!0);var g,x;switch(typeof t[p]){case"string":g=nd({t:"s",v:t[p]},r),x=id({t:"s",v:t[p]},r);break;case"number":g=nd({t:"n",v:t[p]},r),x=id({t:"n",v:t[p]},r);break;case"boolean":g=nd({t:"b",v:t[p]},r),x=id({t:"b",v:t[p]},r);break;default:throw new Error("Unsupported value "+t[p])}f.push(g),u+=g.length,m.push(x),d+=x.length,++l}for(e[2][0].data=$e(l);p<e[7][0].data.length/2;++p)c.setUint16(p*2,65535,!0),h.setUint16(p*2,65535,!0);return e[6][0].data=xs(f),e[3][0].data=xs(m),l}function wH(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=Dr(r["!ref"]);n.s.r=n.s.c=0;var i=!1;n.e.c>9&&(i=!0,n.e.c=9),n.e.r>49&&(i=!0,n.e.r=49),i&&console.error("The Numbers writer is currently limited to ".concat(Ae(n)));var s=c0(r,{range:n,header:1}),a=["~Sh33tJ5~"];s.forEach(function(B){return B.forEach(function(D){typeof D=="string"&&a.push(D)})});var o={},l=[],c=we.read(t.numbers,{type:"base64"});c.FileIndex.map(function(B,D){return[B,c.FullPaths[D]]}).forEach(function(B){var D=B[0],b=B[1];if(D.type==2&&D.name.match(/\.iwa/)){var K=D.content,ie=en(K),le=Zr(ie);le.forEach(function(ne){l.push(ne.id),o[ne.id]={deps:[],location:b,type:yt(ne.messages[0].meta[1][0].data)}})}}),l.sort(function(B,D){return B-D});var u=l.filter(function(B){return B>1}).map(function(B){return[B,$e(B)]});c.FileIndex.map(function(B,D){return[B,c.FullPaths[D]]}).forEach(function(B){var D=B[0];if(B[1],!!D.name.match(/\.iwa/)){var b=Zr(en(D.content));b.forEach(function(K){K.messages.forEach(function(ie){u.forEach(function(le){K.messages.some(function(ne){return yt(ne.meta[1][0].data)!=11006&&oH(ne.data,le[1])})&&o[le[0]].deps.push(K.id)})})})}});for(var f=we.find(c,o[1].location),h=Zr(en(f.content)),d,m=0;m<h.length;++m){var p=h[m];p.id==1&&(d=p)}var g=sr(He(d.messages[0].data)[1][0].data);for(f=we.find(c,o[g].location),h=Zr(en(f.content)),m=0;m<h.length;++m)p=h[m],p.id==g&&(d=p);for(g=sr(He(d.messages[0].data)[2][0].data),f=we.find(c,o[g].location),h=Zr(en(f.content)),m=0;m<h.length;++m)p=h[m],p.id==g&&(d=p);for(g=sr(He(d.messages[0].data)[2][0].data),f=we.find(c,o[g].location),h=Zr(en(f.content)),m=0;m<h.length;++m)p=h[m],p.id==g&&(d=p);var x=He(d.messages[0].data);{x[6][0].data=$e(n.e.r+1),x[7][0].data=$e(n.e.c+1);var _=sr(x[46][0].data),v=we.find(c,o[_].location),E=Zr(en(v.content));{for(var N=0;N<E.length&&E[N].id!=_;++N);if(E[N].id!=_)throw"Bad ColumnRowUIDMapArchive";var I=He(E[N].messages[0].data);I[1]=[],I[2]=[],I[3]=[];for(var w=0;w<=n.e.c;++w){var O=[];O[1]=O[2]=[{type:0,data:$e(w+420690)}],I[1].push({type:2,data:Kt(O)}),I[2].push({type:0,data:$e(w)}),I[3].push({type:0,data:$e(w)})}I[4]=[],I[5]=[],I[6]=[];for(var P=0;P<=n.e.r;++P)O=[],O[1]=O[2]=[{type:0,data:$e(P+726270)}],I[4].push({type:2,data:Kt(O)}),I[5].push({type:0,data:$e(P)}),I[6].push({type:0,data:$e(P)});E[N].messages[0].data=Kt(I)}v.content=Fa(Aa(E)),v.size=v.content.length,delete x[46];var W=He(x[4][0].data);{W[7][0].data=$e(n.e.r+1);var j=He(W[1][0].data),U=sr(j[2][0].data);v=we.find(c,o[U].location),E=Zr(en(v.content));{if(E[0].id!=U)throw"Bad HeaderStorageBucket";var J=He(E[0].messages[0].data);for(P=0;P<s.length;++P){var ge=He(J[2][0].data);ge[1][0].data=$e(P),ge[4][0].data=$e(s[P].length),J[2][P]={type:J[2][0].type,data:Kt(ge)}}E[0].messages[0].data=Kt(J)}v.content=Fa(Aa(E)),v.size=v.content.length;var fe=sr(W[2][0].data);v=we.find(c,o[fe].location),E=Zr(en(v.content));{if(E[0].id!=fe)throw"Bad HeaderStorageBucket";for(J=He(E[0].messages[0].data),w=0;w<=n.e.c;++w)ge=He(J[2][0].data),ge[1][0].data=$e(w),ge[4][0].data=$e(n.e.r+1),J[2][w]={type:J[2][0].type,data:Kt(ge)};E[0].messages[0].data=Kt(J)}v.content=Fa(Aa(E)),v.size=v.content.length;var ve=sr(W[4][0].data);(function(){for(var B=we.find(c,o[ve].location),D=Zr(en(B.content)),b,K=0;K<D.length;++K){var ie=D[K];ie.id==ve&&(b=ie)}var le=He(b.messages[0].data);{le[3]=[];var ne=[];a.forEach(function(R,rt){ne[1]=[{type:0,data:$e(rt)}],ne[2]=[{type:0,data:$e(1)}],ne[3]=[{type:2,data:aH(R)}],le[3].push({type:2,data:Kt(ne)})})}b.messages[0].data=Kt(le);var Z=Aa(D),Ne=Fa(Z);B.content=Ne,B.size=B.content.length})();var de=He(W[3][0].data);{var ee=de[1][0];delete de[2];var M=He(ee.data);{var se=sr(M[2][0].data);(function(){for(var B=we.find(c,o[se].location),D=Zr(en(B.content)),b,K=0;K<D.length;++K){var ie=D[K];ie.id==se&&(b=ie)}var le=He(b.messages[0].data);{delete le[6],delete de[7];var ne=new Uint8Array(le[5][0].data);le[5]=[];for(var Z=0,Ne=0;Ne<=n.e.r;++Ne){var R=He(ne);Z+=yH(R,s[Ne],a),R[1][0].data=$e(Ne),le[5].push({data:Kt(R),type:2})}le[1]=[{type:0,data:$e(n.e.c+1)}],le[2]=[{type:0,data:$e(n.e.r+1)}],le[3]=[{type:0,data:$e(Z)}],le[4]=[{type:0,data:$e(n.e.r+1)}]}b.messages[0].data=Kt(le);var rt=Aa(D),Ue=Fa(rt);B.content=Ue,B.size=B.content.length})()}ee.data=Kt(M)}W[3][0].data=Kt(de)}x[4][0].data=Kt(W)}d.messages[0].data=Kt(x);var xe=Aa(h),A=Fa(xe);return f.content=A,f.size=f.content.length,c}function lC(e){return function(r){for(var n=0;n!=e.length;++n){var i=e[n];r[i[0]]===void 0&&(r[i[0]]=i[1]),i[2]==="n"&&(r[i[0]]=Number(r[i[0]]))}}}function vg(e){lC([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function xg(e){lC([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function EH(e){return Oe.WS.indexOf(e)>-1?"sheet":e==Oe.CS?"chart":e==Oe.DS?"dialog":e==Oe.MS?"macro":e&&e.length?e:"sheet"}function kH(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,EH(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function TH(e,t,r,n,i,s,a,o,l,c,u,f){try{s[n]=Rl(Wr(e,r,!0),t);var h=Ft(e,t),d;switch(o){case"sheet":d=GV(h,t,i,l,s[n],c,u,f);break;case"chart":if(d=KV(h,t,i,l,s[n],c,u,f),!d||!d["!drawel"])break;var m=hl(d["!drawel"].Target,t),p=vc(m),g=O7(Wr(e,m,!0),Rl(Wr(e,p,!0),m)),x=hl(g,m),_=vc(x);d=yV(Wr(e,x,!0),x,l,Rl(Wr(e,_,!0),x),c,d);break;case"macro":d=XV(h,t,i,l,s[n],c,u,f);break;case"dialog":d=YV(h,t,i,l,s[n],c,u,f);break;default:throw new Error("Unrecognized sheet type "+o)}a[n]=d;var v=[];s&&s[n]&&wt(s[n]).forEach(function(E){var N="";if(s[n][E].Type==Oe.CMNT){N=hl(s[n][E].Target,t);var I=ZV(Ft(e,N,!0),N,l);if(!I||!I.length)return;iy(d,I,!1)}s[n][E].Type==Oe.TCMNT&&(N=hl(s[n][E].Target,t),v=v.concat(b7(Ft(e,N,!0),l)))}),v&&v.length&&iy(d,v,!0,l.people||[])}catch(E){if(l.WTF)throw E}}function Qr(e){return e.charAt(0)=="/"?e.slice(1):e}function SH(e,t){if(Mo(),t=t||{},vg(t),tn(e,"META-INF/manifest.xml")||tn(e,"objectdata.xml"))return my(e,t);if(tn(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof sd<"u"){if(e.FileIndex)return sd(e);var r=we.utils.cfb_new();return S_(e).forEach(function(ge){Fe(r,ge,L6(e,ge))}),sd(r)}throw new Error("Unsupported NUMBERS file")}if(!tn(e,"[Content_Types].xml"))throw tn(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):tn(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=S_(e),i=FL(Wr(e,"[Content_Types].xml")),s=!1,a,o;if(i.workbooks.length===0&&(o="xl/workbook.xml",Ft(e,o,!0)&&i.workbooks.push(o)),i.workbooks.length===0){if(o="xl/workbook.bin",!Ft(e,o,!0))throw new Error("Could not find workbook");i.workbooks.push(o),s=!0}i.workbooks[0].slice(-3)=="bin"&&(s=!0);var l={},c={};if(!t.bookSheets&&!t.bookProps){if(Pl=[],i.sst)try{Pl=JV(Ft(e,Qr(i.sst)),i.sst,t)}catch(ge){if(t.WTF)throw ge}t.cellStyles&&i.themes.length&&(l=QV(Wr(e,i.themes[0].replace(/^\//,""),!0)||"",i.themes[0],t)),i.style&&(c=qV(Ft(e,Qr(i.style)),i.style,l,t))}i.links.map(function(ge){try{var fe=Rl(Wr(e,vc(Qr(ge))),ge);return tj(Ft(e,Qr(ge)),fe,ge,t)}catch{}});var u=$V(Ft(e,Qr(i.workbooks[0])),i.workbooks[0],t),f={},h="";i.coreprops.length&&(h=Ft(e,Qr(i.coreprops[0]),!0),h&&(f=qT(h)),i.extprops.length!==0&&(h=Ft(e,Qr(i.extprops[0]),!0),h&&LL(h,f,t)));var d={};(!t.bookSheets||t.bookProps)&&i.custprops.length!==0&&(h=Wr(e,Qr(i.custprops[0]),!0),h&&(d=BL(h,t)));var m={};if((t.bookSheets||t.bookProps)&&(u.Sheets?a=u.Sheets.map(function(fe){return fe.name}):f.Worksheets&&f.SheetNames.length>0&&(a=f.SheetNames),t.bookProps&&(m.Props=f,m.Custprops=d),t.bookSheets&&typeof a<"u"&&(m.SheetNames=a),t.bookSheets?m.SheetNames:t.bookProps))return m;a={};var p={};t.bookDeps&&i.calcchain&&(p=ej(Ft(e,Qr(i.calcchain)),i.calcchain));var g=0,x={},_,v;{var E=u.Sheets;f.Worksheets=E.length,f.SheetNames=[];for(var N=0;N!=E.length;++N)f.SheetNames[N]=E[N].name}var I=s?"bin":"xml",w=i.workbooks[0].lastIndexOf("/"),O=(i.workbooks[0].slice(0,w+1)+"_rels/"+i.workbooks[0].slice(w+1)+".rels").replace(/^\//,"");tn(e,O)||(O="xl/_rels/workbook."+I+".rels");var P=Rl(Wr(e,O,!0),O.replace(/_rels.*/,"s5s"));(i.metadata||[]).length>=1&&(t.xlmeta=rj(Ft(e,Qr(i.metadata[0])),i.metadata[0],t)),(i.people||[]).length>=1&&(t.people=M7(Ft(e,Qr(i.people[0])),t)),P&&(P=kH(P,u.Sheets));var W=Ft(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(g=0;g!=f.Worksheets;++g){var j="sheet";if(P&&P[g]?(_="xl/"+P[g][1].replace(/[\/]?xl\//,""),tn(e,_)||(_=P[g][1]),tn(e,_)||(_=O.replace(/_rels\/.*$/,"")+P[g][1]),j=P[g][2]):(_="xl/worksheets/sheet"+(g+1-W)+"."+I,_=_.replace(/sheet0\./,"sheet.")),v=_.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(g!=t.sheets)continue e;break;case"string":if(f.SheetNames[g].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var U=!1,J=0;J!=t.sheets.length;++J)typeof t.sheets[J]=="number"&&t.sheets[J]==g&&(U=1),typeof t.sheets[J]=="string"&&t.sheets[J].toLowerCase()==f.SheetNames[g].toLowerCase()&&(U=1);if(!U)continue e}}TH(e,_,v,f.SheetNames[g],g,x,a,j,t,u,l,c)}return m={Directory:i,Workbook:u,Props:f,Custprops:d,Deps:p,Sheets:a,SheetNames:f.SheetNames,Strings:Pl,Styles:c,Themes:l,SSF:ot(Ee)},t&&t.bookFiles&&(e.files?(m.keys=n,m.files=e.files):(m.keys=[],m.files={},e.FullPaths.forEach(function(ge,fe){ge=ge.replace(/^Root Entry[\/]/,""),m.keys.push(ge),m.files[ge]=e.FileIndex[fe]}))),t&&t.bookVBA&&(i.vba.length>0?m.vbaraw=Ft(e,Qr(i.vba[0]),!0):i.defaults&&i.defaults.bin===$7&&(m.vbaraw=Ft(e,"xl/vbaProject.bin",!0))),m}function CH(e,t){var r=t||{},n="Workbook",i=we.find(e,n);try{if(n="/!DataSpaces/Version",i=we.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(rB(i.content),n="/!DataSpaces/DataSpaceMap",i=we.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=iB(i.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",i=we.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var a=sB(i.content);if(a.length!=1||a[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",i=we.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);oB(i.content)}catch{}if(n="/EncryptionInfo",i=we.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=lB(i.content);if(n="/EncryptedPackage",i=we.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],i.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],i.content,r.password||"",r);throw new Error("File is password-protected")}function IH(e,t){return t.bookType=="ods"?oC(e,t):t.bookType=="numbers"?wH(e,t):t.bookType=="xlsb"?AH(e,t):FH(e,t)}function AH(e,t){$a=1024,e&&!e.SSF&&(e.SSF=ot(Ee)),e&&e.SSF&&(Mo(),X0(e.SSF),t.revssf=q0(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Ol?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",n=bS.indexOf(t.bookType)>-1,i=ng();xg(t=t||{});var s=H1(),a="",o=0;if(t.cellXfs=[],Is(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),a="docProps/core.xml",Fe(s,a,QT(e.Props,t)),i.coreprops.push(a),Ge(t.rels,2,a,Oe.CORE_PROPS),a="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var l=[],c=0;c<e.SheetNames.length;++c)(e.Workbook.Sheets[c]||{}).Hidden!=2&&l.push(e.SheetNames[c]);e.Props.SheetNames=l}for(e.Props.Worksheets=e.Props.SheetNames.length,Fe(s,a,eS(e.Props)),i.extprops.push(a),Ge(t.rels,3,a,Oe.EXT_PROPS),e.Custprops!==e.Props&&wt(e.Custprops||{}).length>0&&(a="docProps/custom.xml",Fe(s,a,tS(e.Custprops)),i.custprops.push(a),Ge(t.rels,4,a,Oe.CUST_PROPS)),o=1;o<=e.SheetNames.length;++o){var u={"!id":{}},f=e.Sheets[e.SheetNames[o-1]],h=(f||{})["!type"]||"sheet";switch(h){case"chart":default:a="xl/worksheets/sheet"+o+"."+r,Fe(s,a,ij(o-1,a,t,e,u)),i.sheets.push(a),Ge(t.wbrels,-1,"worksheets/sheet"+o+"."+r,Oe.WS[0])}if(f){var d=f["!comments"],m=!1,p="";d&&d.length>0&&(p="xl/comments"+o+"."+r,Fe(s,p,oj(d,p)),i.comments.push(p),Ge(u,-1,"../comments"+o+"."+r,Oe.CMNT),m=!0),f["!legacy"]&&m&&Fe(s,"xl/drawings/vmlDrawing"+o+".vml",OS(o,f["!comments"])),delete f["!comments"],delete f["!legacy"]}u["!id"].rId1&&Fe(s,vc(a),so(u))}return t.Strings!=null&&t.Strings.length>0&&(a="xl/sharedStrings."+r,Fe(s,a,aj(t.Strings,a,t)),i.strs.push(a),Ge(t.wbrels,-1,"sharedStrings."+r,Oe.SST)),a="xl/workbook."+r,Fe(s,a,nj(e,a)),i.workbooks.push(a),Ge(t.rels,1,a,Oe.WB),a="xl/theme/theme1.xml",Fe(s,a,cg(e.Themes,t)),i.themes.push(a),Ge(t.wbrels,-1,"theme/theme1.xml",Oe.THEME),a="xl/styles."+r,Fe(s,a,sj(e,a,t)),i.styles.push(a),Ge(t.wbrels,-1,"styles."+r,Oe.STY),e.vbaraw&&n&&(a="xl/vbaProject.bin",Fe(s,a,e.vbaraw),i.vba.push(a),Ge(t.wbrels,-1,"vbaProject.bin",Oe.VBA)),a="xl/metadata."+r,Fe(s,a,lj(a)),i.metadata.push(a),Ge(t.wbrels,-1,"metadata."+r,Oe.XLMETA),Fe(s,"[Content_Types].xml",XT(i,t)),Fe(s,"_rels/.rels",so(t.rels)),Fe(s,"xl/_rels/workbook."+r+".rels",so(t.wbrels)),delete t.revssf,delete t.ssf,s}function FH(e,t){$a=1024,e&&!e.SSF&&(e.SSF=ot(Ee)),e&&e.SSF&&(Mo(),X0(e.SSF),t.revssf=q0(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Ol?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=bS.indexOf(t.bookType)>-1,i=ng();xg(t=t||{});var s=H1(),a="",o=0;if(t.cellXfs=[],Is(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),a="docProps/core.xml",Fe(s,a,QT(e.Props,t)),i.coreprops.push(a),Ge(t.rels,2,a,Oe.CORE_PROPS),a="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var l=[],c=0;c<e.SheetNames.length;++c)(e.Workbook.Sheets[c]||{}).Hidden!=2&&l.push(e.SheetNames[c]);e.Props.SheetNames=l}e.Props.Worksheets=e.Props.SheetNames.length,Fe(s,a,eS(e.Props)),i.extprops.push(a),Ge(t.rels,3,a,Oe.EXT_PROPS),e.Custprops!==e.Props&&wt(e.Custprops||{}).length>0&&(a="docProps/custom.xml",Fe(s,a,tS(e.Custprops)),i.custprops.push(a),Ge(t.rels,4,a,Oe.CUST_PROPS));var u=["SheetJ5"];for(t.tcid=0,o=1;o<=e.SheetNames.length;++o){var f={"!id":{}},h=e.Sheets[e.SheetNames[o-1]],d=(h||{})["!type"]||"sheet";switch(d){case"chart":default:a="xl/worksheets/sheet"+o+"."+r,Fe(s,a,GS(o-1,t,e,f)),i.sheets.push(a),Ge(t.wbrels,-1,"worksheets/sheet"+o+"."+r,Oe.WS[0])}if(h){var m=h["!comments"],p=!1,g="";if(m&&m.length>0){var x=!1;m.forEach(function(_){_[1].forEach(function(v){v.T==!0&&(x=!0)})}),x&&(g="xl/threadedComments/threadedComment"+o+"."+r,Fe(s,g,L7(m,u,t)),i.threadedcomments.push(g),Ge(f,-1,"../threadedComments/threadedComment"+o+"."+r,Oe.TCMNT)),g="xl/comments"+o+"."+r,Fe(s,g,DS(m)),i.comments.push(g),Ge(f,-1,"../comments"+o+"."+r,Oe.CMNT),p=!0}h["!legacy"]&&p&&Fe(s,"xl/drawings/vmlDrawing"+o+".vml",OS(o,h["!comments"])),delete h["!comments"],delete h["!legacy"]}f["!id"].rId1&&Fe(s,vc(a),so(f))}return t.Strings!=null&&t.Strings.length>0&&(a="xl/sharedStrings."+r,Fe(s,a,wS(t.Strings,t)),i.strs.push(a),Ge(t.wbrels,-1,"sharedStrings."+r,Oe.SST)),a="xl/workbook."+r,Fe(s,a,QS(e)),i.workbooks.push(a),Ge(t.rels,1,a,Oe.WB),a="xl/theme/theme1.xml",Fe(s,a,cg(e.Themes,t)),i.themes.push(a),Ge(t.wbrels,-1,"theme/theme1.xml",Oe.THEME),a="xl/styles."+r,Fe(s,a,FS(e,t)),i.styles.push(a),Ge(t.wbrels,-1,"styles."+r,Oe.STY),e.vbaraw&&n&&(a="xl/vbaProject.bin",Fe(s,a,e.vbaraw),i.vba.push(a),Ge(t.wbrels,-1,"vbaProject.bin",Oe.VBA)),a="xl/metadata."+r,Fe(s,a,PS()),i.metadata.push(a),Ge(t.wbrels,-1,"metadata."+r,Oe.XLMETA),u.length>1&&(a="xl/persons/person.xml",Fe(s,a,B7(u)),i.people.push(a),Ge(t.wbrels,-1,"persons/person.xml",Oe.PEOPLE)),Fe(s,"[Content_Types].xml",XT(i,t)),Fe(s,"_rels/.rels",so(t.rels)),Fe(s,"xl/_rels/workbook."+r+".rels",so(t.wbrels)),delete t.revssf,delete t.ssf,s}function _g(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=$r(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function NH(e,t){return we.find(e,"EncryptedPackage")?CH(e,t):tC(e,t)}function RH(e,t){var r,n=e,i=t||{};return i.type||(i.type=Re&&Buffer.isBuffer(e)?"buffer":"base64"),r=kT(n,i),SH(r,i)}function cC(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return Lp(e.slice(r),t);default:break e}return To.to_workbook(e,t)}function PH(e,t){var r="",n=_g(e,t);switch(t.type){case"base64":r=$r(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=sa(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=qe(r)),t.type="binary",cC(r,t)}function OH(e,t){var r=e;return t.type=="base64"&&(r=$r(r)),r=zi.utils.decode(1200,r.slice(2),"str"),t.type="binary",cC(r,t)}function DH(e){return e.match(/[^\x00-\x7F]/)?Wn(e):e}function ad(e,t,r,n){return n?(r.type="string",To.to_workbook(e,r)):To.to_workbook(t,r)}function Up(e,t){B1();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return Up(new Uint8Array(e),(r=ot(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,i=[0,0,0,0],s=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),oo={},r.dateNF&&(oo.dateNF=r.dateNF),r.type||(r.type=Re&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=Re?"buffer":"binary",n=A6(e),typeof Uint8Array<"u"&&!Re&&(r.type="array")),r.type=="string"&&(s=!0,r.type="binary",r.codepage=65001,n=DH(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var a=new ArrayBuffer(3),o=new Uint8Array(a);if(o.foo="bar",!o.foo)return r=ot(r),r.type="array",Up(U1(n),r)}switch((i=_g(n,r))[0]){case 208:if(i[1]===207&&i[2]===17&&i[3]===224&&i[4]===161&&i[5]===177&&i[6]===26&&i[7]===225)return NH(we.read(n,r),r);break;case 9:if(i[1]<=8)return tC(n,r);break;case 60:return Lp(n,r);case 73:if(i[1]===73&&i[2]===42&&i[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(i[1]===68)return U5(n,r);break;case 84:if(i[1]===65&&i[2]===66&&i[3]===76)return _S.to_workbook(n,r);break;case 80:return i[1]===75&&i[2]<9&&i[3]<9?RH(n,r):ad(e,n,r,s);case 239:return i[3]===60?Lp(n,r):ad(e,n,r,s);case 255:if(i[1]===254)return OH(n,r);if(i[1]===0&&i[2]===2&&i[3]===0)return $s.to_workbook(n,r);break;case 0:if(i[1]===0&&(i[2]>=2&&i[3]===0||i[2]===0&&(i[3]===8||i[3]===9)))return $s.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return bp.to_workbook(n,r);case 123:if(i[1]===92&&i[2]===114&&i[3]===116)return CS.to_workbook(n,r);break;case 10:case 13:case 32:return PH(n,r);case 137:if(i[1]===80&&i[2]===78&&i[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return B5.indexOf(i[0])>-1&&i[2]<=12&&i[3]<=31?bp.to_workbook(n,r):ad(e,n,r,s)}function uC(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return jc(t.file,we.write(e,{type:Re?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return we.write(e,t)}function bH(e,t){var r=ot(t||{}),n=IH(e,r);return LH(n,r)}function LH(e,t){var r={},n=Re?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var i=e.FullPaths?we.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof i=="string"){if(t.type=="binary"||t.type=="base64")return i;i=new Uint8Array(K0(i))}return t.password&&typeof encrypt_agile<"u"?uC(encrypt_agile(i,t.password),t):t.type==="file"?jc(t.file,i):t.type=="string"?qe(i):i}function MH(e,t){var r=t||{},n=Dj(e,r);return uC(n,r)}function Mn(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return hc(Wn(n));case"binary":return Wn(n);case"string":return e;case"file":return jc(t.file,n,"utf8");case"buffer":return Re?Ii(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):Mn(n,{type:"binary"}).split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function BH(e,t){switch(t.type){case"base64":return hc(e);case"binary":return e;case"string":return e;case"file":return jc(t.file,e,"binary");case"buffer":return Re?Ii(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function Ru(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?hc(r):t.type=="string"?qe(r):r;case"file":return jc(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function fC(e,t){B1(),NV(e);var r=ot(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=fC(e,r);return r.type="array",K0(n)}var i=0;if(r.sheet&&(typeof r.sheet=="number"?i=r.sheet:i=e.SheetNames.indexOf(r.sheet),!e.SheetNames[i]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return Mn(Ij(e,r),r);case"slk":case"sylk":return Mn(xS.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"htm":case"html":return Mn(nC(e.Sheets[e.SheetNames[i]],r),r);case"txt":return BH(hC(e.Sheets[e.SheetNames[i]],r),r);case"csv":return Mn(yg(e.Sheets[e.SheetNames[i]],r),r,"\uFEFF");case"dif":return Mn(_S.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"dbf":return Ru(bp.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"prn":return Mn(To.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"rtf":return Mn(CS.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"eth":return Mn(yS.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"fods":return Mn(oC(e,r),r);case"wk1":return Ru($s.sheet_to_wk1(e.Sheets[e.SheetNames[i]],r),r);case"wk3":return Ru($s.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),Ru(rC(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),MH(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return bH(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function UH(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function WH(e,t,r){var n={};return n.type="file",n.file=t,UH(n),fC(e,n)}function VH(e,t,r,n,i,s,a,o){var l=Ct(r),c=o.defval,u=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),f=!0,h=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(h,"__rowNum__",{value:r,enumerable:!1})}catch{h.__rowNum__=r}else h.__rowNum__=r;if(!a||e[r])for(var d=t.s.c;d<=t.e.c;++d){var m=a?e[r][d]:e[n[d]+l];if(m===void 0||m.t===void 0){if(c===void 0)continue;s[d]!=null&&(h[s[d]]=c);continue}var p=m.v;switch(m.t){case"z":if(p==null)break;continue;case"e":p=p==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+m.t)}if(s[d]!=null){if(p==null)if(m.t=="e"&&p===null)h[s[d]]=null;else if(c!==void 0)h[s[d]]=c;else if(u&&p===null)h[s[d]]=null;else continue;else h[s[d]]=u&&(m.t!=="n"||m.t==="n"&&o.rawNumbers!==!1)?p:Ti(m,p,o);p!=null&&(f=!1)}}return{row:h,isempty:f}}function c0(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,i=1,s=[],a=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},c=t||{},u=c.range!=null?c.range:e["!ref"];switch(c.header===1?n=1:c.header==="A"?n=2:Array.isArray(c.header)?n=3:c.header==null&&(n=0),typeof u){case"string":l=je(u);break;case"number":l=je(e["!ref"]),l.s.r=u;break;default:l=u}n>0&&(i=0);var f=Ct(l.s.r),h=[],d=[],m=0,p=0,g=Array.isArray(e),x=l.s.r,_=0,v={};g&&!e[x]&&(e[x]=[]);var E=c.skipHidden&&e["!cols"]||[],N=c.skipHidden&&e["!rows"]||[];for(_=l.s.c;_<=l.e.c;++_)if(!(E[_]||{}).hidden)switch(h[_]=ht(_),r=g?e[x][_]:e[h[_]+f],n){case 1:s[_]=_-l.s.c;break;case 2:s[_]=h[_];break;case 3:s[_]=c.header[_-l.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=a=Ti(r,null,c),p=v[a]||0,!p)v[a]=1;else{do o=a+"_"+p++;while(v[o]);v[a]=p,v[o]=1}s[_]=o}for(x=l.s.r+i;x<=l.e.r;++x)if(!(N[x]||{}).hidden){var I=VH(e,l,x,h,n,s,g,c);(I.isempty===!1||(n===1?c.blankrows!==!1:c.blankrows))&&(d[m++]=I.row)}return d.length=m,d}var yy=/"/g;function jH(e,t,r,n,i,s,a,o){for(var l=!0,c=[],u="",f=Ct(r),h=t.s.c;h<=t.e.c;++h)if(n[h]){var d=o.dense?(e[r]||[])[h]:e[n[h]+f];if(d==null)u="";else if(d.v!=null){l=!1,u=""+(o.rawNumbers&&d.t=="n"?d.v:Ti(d,null,o));for(var m=0,p=0;m!==u.length;++m)if((p=u.charCodeAt(m))===i||p===s||p===34||o.forceQuotes){u='"'+u.replace(yy,'""')+'"';break}u=="ID"&&(u='"ID"')}else d.f!=null&&!d.F?(l=!1,u="="+d.f,u.indexOf(",")>=0&&(u='"'+u.replace(yy,'""')+'"')):u="";c.push(u)}return o.blankrows===!1&&l?null:c.join(a)}function yg(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var i=je(e["!ref"]),s=n.FS!==void 0?n.FS:",",a=s.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,l=o.charCodeAt(0),c=new RegExp((s=="|"?"\\|":s)+"+$"),u="",f=[];n.dense=Array.isArray(e);for(var h=n.skipHidden&&e["!cols"]||[],d=n.skipHidden&&e["!rows"]||[],m=i.s.c;m<=i.e.c;++m)(h[m]||{}).hidden||(f[m]=ht(m));for(var p=0,g=i.s.r;g<=i.e.r;++g)(d[g]||{}).hidden||(u=jH(e,i,g,f,a,l,s,n),u!=null&&(n.strip&&(u=u.replace(c,"")),(u||n.blankrows!==!1)&&r.push((p++?o:"")+u)));return delete n.dense,r.join("")}function hC(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=yg(e,t);return r}function HH(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var i=je(e["!ref"]),s="",a=[],o,l=[],c=Array.isArray(e);for(o=i.s.c;o<=i.e.c;++o)a[o]=ht(o);for(var u=i.s.r;u<=i.e.r;++u)for(s=Ct(u),o=i.s.c;o<=i.e.c;++o)if(t=a[o]+s,r=c?(e[u]||[])[o]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}l[l.length]=t+"="+n}return l}function dC(e,t,r){var n=r||{},i=+!n.skipHeader,s=e||{},a=0,o=0;if(s&&n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var l=typeof n.origin=="string"?dt(n.origin):n.origin;a=l.r,o=l.c}var c,u={s:{c:0,r:0},e:{c:o,r:a+t.length-1+i}};if(s["!ref"]){var f=je(s["!ref"]);u.e.c=Math.max(u.e.c,f.e.c),u.e.r=Math.max(u.e.r,f.e.r),a==-1&&(a=f.e.r+1,u.e.r=a+t.length-1+i)}else a==-1&&(a=0,u.e.r=t.length-1+i);var h=n.header||[],d=0;t.forEach(function(p,g){wt(p).forEach(function(x){(d=h.indexOf(x))==-1&&(h[d=h.length]=x);var _=p[x],v="z",E="",N=ke({c:o+d,r:a+g+i});c=Tc(s,N),_&&typeof _=="object"&&!(_ instanceof Date)?s[N]=_:(typeof _=="number"?v="n":typeof _=="boolean"?v="b":typeof _=="string"?v="s":_ instanceof Date?(v="d",n.cellDates||(v="n",_=Mt(_)),E=n.dateNF||Ee[14]):_===null&&n.nullError&&(v="e",_=0),c?(c.t=v,c.v=_,delete c.w,delete c.R,E&&(c.z=E)):s[N]=c={t:v,v:_},E&&(c.z=E))})}),u.e.c=Math.max(u.e.c,o+h.length-1);var m=Ct(a);if(i)for(d=0;d<h.length;++d)s[ht(d+o)+m]={t:"s",v:h[d]};return s["!ref"]=Ae(u),s}function zH(e,t){return dC(null,e,t)}function Tc(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=dt(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?Tc(e,ke(t)):Tc(e,ke({r:t,c:r||0}))}function $H(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function wg(){return{SheetNames:[],Sheets:{}}}function Eg(e,t,r,n){var i=1;if(!r)for(;i<=65535&&e.SheetNames.indexOf(r="Sheet"+i)!=-1;++i,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);i=s&&+s[2]||0;var a=s&&s[1]||r;for(++i;i<=65535&&e.SheetNames.indexOf(r=a+i)!=-1;++i);}if(qS(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function GH(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=$H(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function KH(e,t){return e.z=t,e}function pC(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function XH(e,t,r){return pC(e,"#"+t,r)}function YH(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function qH(e,t,r,n){for(var i=typeof t!="string"?t:je(t),s=typeof t=="string"?t:Ae(t),a=i.s.r;a<=i.e.r;++a)for(var o=i.s.c;o<=i.e.c;++o){var l=Tc(e,a,o);l.t="n",l.F=s,delete l.v,a==i.s.r&&o==i.s.c&&(l.f=r,n&&(l.D=!0))}return e}var Ju={encode_col:ht,encode_row:Ct,encode_cell:ke,encode_range:Ae,decode_col:Q1,decode_row:q1,split_cell:aL,decode_cell:dt,decode_range:Dr,format_cell:Ti,sheet_add_aoa:VT,sheet_add_json:dC,sheet_add_dom:iC,aoa_to_sheet:Bo,json_to_sheet:zH,table_to_sheet:sC,table_to_book:rH,sheet_to_csv:yg,sheet_to_txt:hC,sheet_to_json:c0,sheet_to_html:nC,sheet_to_formulae:HH,sheet_to_row_object_array:c0,sheet_get_cell:Tc,book_new:wg,book_append_sheet:Eg,book_set_sheet_visibility:GH,cell_set_number_format:KH,cell_set_hyperlink:pC,cell_set_internal_link:XH,cell_add_comment:YH,sheet_set_array_formula:qH,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const QH=e=>{const t=e.map(a=>({"Nombre del producto":a.name,Precio:a.price,"Cdigo de barras(Obligatorio)":a.barcode,SKU:a.sku,"Cantidad mxima (de unidades para vender por pedido)":a.maxQuantity,Activo:a.status?"Activo":"Inactivo",Seccin:a.section,Imagen:a.imageUrl})),r=Ju.json_to_sheet(t),n=Ju.book_new();Ju.book_append_sheet(n,r,"Catlogo");const i=50,s=Object.keys(t[0]||{}).map(a=>Math.min(i,Math.max(a.length,...t.map(o=>String(o[a]).length))));r["!cols"]=s.map(a=>({width:a})),WH(n,"catalogo_productos.xlsx")},JH=e=>new Promise((t,r)=>{const n=new FileReader;n.onload=i=>{var s;try{const a=(s=i.target)==null?void 0:s.result,l=Up(a,{type:"binary"}).Sheets.Products;if(!l)throw new Error('No se encontr la hoja "Products" en el archivo Excel');const c=Ju.sheet_to_json(l);if(c.length===0)throw new Error("El archivo Excel no contiene productos");t(c)}catch(a){r(a instanceof Error?a:new Error("Error al leer el archivo Excel"))}},n.onerror=()=>{r(new Error("Error al leer el archivo"))},n.readAsBinaryString(e)}),ZH=e=>{var r,n,i;const t=[];return(r=e.sku)!=null&&r.toString().trim()||t.push("SKU es requerido"),(n=e.name)!=null&&n.toString().trim()||t.push("Nombre es requerido"),(i=e["category 1"])!=null&&i.toString().trim()||t.push("Categora es requerida"),e.price===void 0||e.price===null?t.push("Precio es requerido"):K8(e.price.toString())||t.push("Precio debe ser un nmero vlido mayor o igual a 0"),e.active===void 0||e.active===null?t.push("Estado es requerido"):[0,1].includes(Number(e.active))||t.push("Estado debe ser 0 o 1"),e.maximumSalesQuantity===void 0||e.maximumSalesQuantity===null?t.push("Cantidad mxima es requerida"):X8(e.maximumSalesQuantity.toString())||t.push("Cantidad mxima debe ser un nmero entero positivo"),t},ez=e=>{const t=()=>{let r;do r=Array.from({length:13},()=>Math.floor(Math.random()*10)).join("");while(!$8(r));return r};return{name:String(e.name).trim(),price:Number(e.price),barcode:t(),sku:String(e.sku).trim(),maxQuantity:Math.floor(Number(e.maximumSalesQuantity)),status:Number(e.active),section:String(e["category 1"]).trim(),imageUrl:""}},tz=async(e,t,r,n)=>{const i={created:0,updated:0,errors:[]};try{const s=await JH(e);for(const a of s)try{const o=ZH(a);if(o.length>0){i.errors.push({sku:String(a.sku||"SKU no especificado"),errors:o});continue}const l=ez(a),c=t.find(u=>u.sku===l.sku);c?(await n(c.id,l),i.updated++):(await r(l),i.created++)}catch(o){i.errors.push({sku:String(a.sku||"SKU no especificado"),errors:[o.message||"Error desconocido"]})}}catch(s){throw s}return i},rz=({isOpen:e,onClose:t,title:r,children:n})=>e?L.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:L.jsxs("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-hidden",children:[L.jsxs("div",{className:"px-6 py-4 border-b flex justify-between items-center",children:[L.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:r}),L.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-500 focus:outline-none",children:L.jsx(iT,{className:"h-6 w-6"})})]}),L.jsx("div",{className:"p-6 overflow-y-auto max-h-[calc(90vh-8rem)]",children:n})]})}):null,nz=({isOpen:e,onClose:t,results:r})=>L.jsx(rz,{isOpen:e,onClose:t,title:"Resultados de la Importacin",children:L.jsxs("div",{className:"space-y-6",children:[L.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[L.jsxs("div",{className:"bg-green-50 p-4 rounded-lg",children:[L.jsx("div",{className:"font-semibold text-green-800",children:"Productos Creados"}),L.jsx("div",{className:"text-2xl font-bold text-green-600",children:r.created})]}),L.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[L.jsx("div",{className:"font-semibold text-blue-800",children:"Productos Actualizados"}),L.jsx("div",{className:"text-2xl font-bold text-blue-600",children:r.updated})]}),L.jsxs("div",{className:"bg-orange-50 p-4 rounded-lg",children:[L.jsx("div",{className:"font-semibold text-orange-800",children:"Errores"}),L.jsx("div",{className:"text-2xl font-bold text-orange-600",children:r.errors.length})]})]}),(r.created>0||r.updated>0)&&L.jsxs("div",{className:"flex items-start space-x-3 bg-green-50 p-4 rounded-lg",children:[L.jsx(N8,{className:"h-5 w-5 text-green-500 mt-0.5"}),L.jsxs("div",{children:[L.jsx("h3",{className:"font-medium text-green-800",children:"Operaciones Exitosas"}),L.jsxs("p",{className:"text-green-700 text-sm mt-1",children:["Se ",r.created>0?`crearon ${r.created} productos`:"",r.created>0&&r.updated>0?" y ":"",r.updated>0?`actualizaron ${r.updated} productos`:"","correctamente."]})]})]}),r.errors.length>0&&L.jsxs("div",{className:"space-y-4",children:[L.jsxs("div",{className:"flex items-start space-x-3 bg-orange-50 p-4 rounded-lg",children:[L.jsx(F8,{className:"h-5 w-5 text-orange-500 mt-0.5"}),L.jsxs("div",{children:[L.jsx("h3",{className:"font-medium text-orange-800",children:"Errores Encontrados"}),L.jsxs("p",{className:"text-orange-700 text-sm mt-1",children:["Se encontraron errores en ",r.errors.length," productos."]})]})]}),L.jsx("div",{className:"border rounded-lg overflow-hidden",children:L.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[L.jsx("thead",{className:"bg-gray-50",children:L.jsxs("tr",{children:[L.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"SKU"}),L.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Errores"})]})}),L.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:r.errors.map((n,i)=>L.jsxs("tr",{children:[L.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:n.sku}),L.jsx("td",{className:"px-6 py-4 text-sm text-gray-500",children:L.jsx("ul",{className:"list-disc list-inside",children:n.errors.map((s,a)=>L.jsx("li",{children:s},a))})})]},i))})]})})]})]})}),iz=()=>{const e=Q.useRef(null),{products:t,updateProduct:r,addProduct:n}=G0(),[i,s]=Q.useState(null),[a,o]=Q.useState(!1),l=async c=>{var h;const u=(h=c.target.files)==null?void 0:h[0];if(!u)return;const f=Xi.loading("Procesando archivo...");try{const d=await tz(u,t,n,r);s(d),o(!0),Xi.success("Archivo procesado correctamente",{id:f})}catch(d){Xi.error(d instanceof Error?d.message:"Error al procesar el archivo Excel",{id:f})}e.current&&(e.current.value="")};return L.jsxs(L.Fragment,{children:[L.jsx("input",{type:"file",ref:e,onChange:l,accept:".xlsx,.xls",className:"hidden"}),L.jsxs("button",{onClick:()=>{var c;return(c=e.current)==null?void 0:c.click()},className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-lg text-white bg-orange-600 hover:bg-orange-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-orange-500",children:[L.jsx(U8,{className:"h-5 w-5 mr-2"}),"Importar"]}),i&&L.jsx(nz,{isOpen:a,onClose:()=>o(!1),results:i})]})},sz=({products:e,onNewProduct:t})=>L.jsxs("div",{className:"flex items-center space-x-3",children:[L.jsxs("button",{onClick:()=>QH(e),className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-lg text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500",children:[L.jsx(P8,{className:"h-5 w-5 mr-2"}),"Exportar"]}),L.jsx(iz,{}),L.jsxs("button",{onClick:t,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-lg text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:[L.jsx(b8,{className:"h-5 w-5 mr-2"}),"Nuevo Producto"]})]}),az=({products:e,onNewProduct:t})=>L.jsxs("div",{className:"flex justify-between items-center mb-6",children:[L.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Productos"}),L.jsx(sz,{products:e,onNewProduct:t})]}),oz=(e,t,r,n)=>e.filter(i=>{const s=i.name.toLowerCase().includes(t.toLowerCase())||i.sku.toLowerCase().includes(t.toLowerCase())||i.barcode.includes(t),a=r?i.section===r:!0,o=n?i.status===Number(n):!0;return s&&a&&o}),lz=()=>{const{products:e,loading:t}=G0(),[r,n]=Q.useState(""),[i,s]=Q.useState(""),[a,o]=Q.useState(""),[l,c]=Q.useState(!1),[u,f]=Q.useState(),h=[...new Set(e.map(g=>g.section))],d=oz(e,r,i,a),m=g=>{f(g),c(!0)},p=()=>{c(!1),f(void 0)};return L.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-6",children:[L.jsx(az,{products:e,onNewProduct:()=>c(!0)}),L.jsx(V8,{search:r,setSearch:n,section:i,setSection:s,status:a,setStatus:o,sections:h}),L.jsx(z8,{products:d,loading:t,onEdit:m}),l&&L.jsx(Y8,{product:u,onClose:p})]})},cz=()=>L.jsx("div",{className:"container mx-auto px-4 py-8",children:L.jsx(lz,{})}),uz=()=>{const{user:e,signOut:t}=b1(),[r,n]=Ry.useState(!1);return L.jsxs("nav",{className:"bg-indigo-600 text-white shadow-lg",children:[L.jsx("div",{className:"max-w-7xl mx-auto px-4",children:L.jsxs("div",{className:"flex justify-between h-16",children:[L.jsx("div",{className:"flex items-center",children:L.jsx("h1",{className:"text-xl font-bold",children:"Catlogo"})}),L.jsx("div",{className:"hidden md:flex items-center space-x-4",children:e&&L.jsxs(L.Fragment,{children:[L.jsx("span",{children:e.email}),L.jsxs("button",{onClick:t,className:"inline-flex items-center px-3 py-2 border border-transparent text-sm leading-4 font-medium rounded-md text-white bg-indigo-700 hover:bg-indigo-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:[L.jsx(f_,{className:"h-4 w-4 mr-2"}),"Cerrar Sesin"]})]})}),L.jsx("div",{className:"md:hidden flex items-center",children:L.jsx("button",{onClick:()=>n(!r),className:"inline-flex items-center justify-center p-2 rounded-md text-white hover:bg-indigo-700 focus:outline-none",children:L.jsx(D8,{className:"h-6 w-6"})})})]})}),r&&L.jsx("div",{className:"md:hidden",children:L.jsx("div",{className:"px-2 pt-2 pb-3 space-y-1 sm:px-3",children:e&&L.jsxs("div",{className:"space-y-2",children:[L.jsx("p",{className:"px-3 text-sm",children:e.email}),L.jsxs("button",{onClick:t,className:"w-full text-left px-3 py-2 text-sm font-medium hover:bg-indigo-700 rounded-md flex items-center",children:[L.jsx(f_,{className:"h-4 w-4 mr-2"}),"Cerrar Sesin"]})]})})})]})};function fz(){const{user:e,loading:t}=b1();return t?L.jsx("div",{className:"min-h-screen flex items-center justify-center",children:L.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600"})}):L.jsx(QA,{children:L.jsxs("div",{className:"min-h-screen bg-gray-100",children:[e&&L.jsx(uz,{}),L.jsxs(XA,{children:[L.jsx(ep,{path:"/login",element:e?L.jsx(Hv,{to:"/"}):L.jsx(W8,{})}),L.jsx(ep,{path:"/",element:e?L.jsx(cz,{}):L.jsx(Hv,{to:"/login"})})]}),L.jsx(VF,{position:"top-right"})]})})}D2(document.getElementById("root")).render(L.jsx(Q.StrictMode,{children:L.jsx(fz,{})}));
